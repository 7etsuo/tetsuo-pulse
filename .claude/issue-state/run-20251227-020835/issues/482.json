{
  "number": 482,
  "title": "refactor(proxy): simplify duplicate colon search logic in URL parsing",
  "body": "## Duplication Found\n\nThe `socketproxy_parse_userinfo()` function contains duplicate loop logic for finding a colon character before the '@' sign when parsing proxy URL userinfo. The same loop appears twice, and there's also a dead `else if` branch.\n\n## Location\n\n- `src/socket/SocketProxy.c:212-239` - `socketproxy_parse_userinfo()` function\n\n## Current Implementation\n\n```c\ncolon = strchr (start, ':');\nif (colon != NULL && colon > at_sign)\n  {\n    colon = NULL;\n    for (const char *p = start; p < at_sign; p++)  // Loop 1\n      {\n        if (*p == ':')\n          {\n            colon = p;\n            break;\n          }\n      }\n  }\nelse if (colon != NULL && colon < at_sign)\n  {\n    // DEAD CODE - empty branch\n  }\nelse\n  {\n    colon = NULL;\n    for (const char *p = start; p < at_sign; p++)  // Loop 2 - IDENTICAL to Loop 1\n      {\n        if (*p == ':')\n          {\n            colon = p;\n            break;\n          }\n      }\n  }\n```\n\n## Problems\n\n1. **Duplicate loops** - Lines 216-223 and 231-238 are identical\n2. **Dead code** - The `else if` branch at lines 225-227 is empty\n3. **Overcomplicated logic** - The entire block can be simplified\n\n## Proposed Fix\n\nReplace the entire block with one of these simpler alternatives:\n\n**Option A: Simplified conditional loop**\n```c\ncolon = strchr(start, ':');\nif (colon == NULL || colon > at_sign)\n{\n    colon = NULL;\n    for (const char *p = start; p < at_sign; p++)\n    {\n        if (*p == ':')\n        {\n            colon = p;\n            break;\n        }\n    }\n}\n```\n\n**Option B: Use memchr (preferred)**\n```c\ncolon = memchr(start, ':', (size_t)(at_sign - start));\n```\n\nOption B is a single line that does exactly what the 28-line block does.\n\n## Lines Saved\n\n~25 lines (from 28 lines down to 1-3 lines)\n\n## Category\n\nRedundancy / Dead Code",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}