{
  "number": 1629,
  "title": "docs(syn-protect): clarify errno reset rationale in parse_cidr_notation",
  "body": "## Issue\n**File**: `src/core/SocketSYNProtect.c`\n**Line**: 558-560\n**Category**: Documentation/Security\n**Severity**: HIGH (for documentation quality)\n**Pattern**: ERRNO_RESET_COMMENT\n\n## Description\nThe comment at line 558 states \"Reset errno before strtol to detect ERANGE accurately\" which is correct, but could be misleading about the reason. The comment might imply this is for thread-safety, when actually `errno` is thread-local and the reset is required by POSIX semantics.\n\n## Current Code\n```c\nchar *endptr;\nerrno = 0; /* Reset errno before strtol to detect ERANGE accurately */\nlong prefix_long = strtol (prefix_str, &endptr, 10);\nif (prefix_str == endptr || *endptr != '\\0' || errno == ERANGE\n    || prefix_long < 0 || prefix_long > SOCKET_IPV6_MAX_PREFIX)\n{\n    return 0;\n}\n```\n\n## Problem\nThe comment doesn't explain **why** errno must be reset:\n- `strtol()` only sets `errno` on error (ERANGE, EINVAL)\n- `strtol()` does **not** clear `errno` on success\n- Per POSIX: \"No function in this document shall set errno to zero\"\n- Without reset, leftover errno from previous calls would cause false positives\n\n## Impact\n- Developers might misunderstand the errno reset as thread-safety concern\n- Future maintainers might incorrectly remove the reset thinking errno is \"already thread-safe\"\n- The current behavior is CORRECT, just poorly documented\n\n## Recommendation\nUpdate the comment to be more explicit:\n\n```c\n/* Reset errno before strtol per POSIX 7.5: strtol only sets errno on error,\n * never clears it on success. Without reset, stale errno from prior calls\n * would cause false ERANGE detection. errno is thread-local (no race). */\nerrno = 0;\nlong prefix_long = strtol (prefix_str, &endptr, 10);\n```\n\nOr more concisely:\n```c\n/* strtol sets but never clears errno - reset to detect ERANGE reliably */\nerrno = 0;\n```\n\n## References\n- POSIX.1-2017 Section 7.5: Use of errno\n- strtol(3) man page: \"Since 0 and LONG_MAX can legitimately be returned on both success and failure, the calling program should set errno to 0 before the call\"\n\n## Priority\nDocumentation quality issue - the code is correct, but the comment could lead to future bugs if misunderstood.",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}