{
  "number": 1638,
  "title": "refactor(metrics): move extern declaration to file scope",
  "body": "## Summary\n\nThe function `SocketMetrics_get_socket_count()` contains an `extern` function declaration inside the function body. This is non-standard C style and should be moved to file scope or included from a header.\n\n## Location\n\n- **File**: `/home/tetsuo/git/tetsuo-socket/src/core/SocketMetrics.c`\n- **Lines**: 1100-1104\n- **Function**: `SocketMetrics_get_socket_count()`\n\n## Issue Details\n\n**Category**: Refactoring  \n**Severity**: LOW  \n**Pattern**: EXTERN_IN_FUNCTION\n\n### Current Code (Lines 1099-1104)\n\n```c\nint\nSocketMetrics_get_socket_count (void)\n{\n  extern int Socket_debug_live_count (void);\n  return Socket_debug_live_count ();\n}\n```\n\n### Problem\n\n1. **Non-Standard Style**: While technically valid C, declaring `extern` functions inside function bodies is unconventional and discouraged by most coding standards\n2. **Maintainability**: Makes it harder to track function dependencies and relationships\n3. **Tooling Issues**: Some static analysis tools may flag this pattern\n4. **Inconsistency**: Other functions in the codebase don't use this pattern\n\n## Recommendation\n\n### Option 1: Move to file scope (preferred)\n\nAt the top of the file with other declarations:\n\n```c\n/* Forward declaration for Socket module */\nstatic int Socket_debug_live_count (void);\n\n// ... later in the file ...\n\nint\nSocketMetrics_get_socket_count (void)\n{\n  return Socket_debug_live_count ();\n}\n```\n\n### Option 2: Include from header\n\nIf `Socket_debug_live_count()` is meant to be a public API, add it to the appropriate header:\n\n```c\n/* In include/socket/Socket.h or include/core/SocketUtil.h */\nextern int Socket_debug_live_count (void);\n```\n\nThen include that header in `SocketMetrics.c`.\n\n### Option 3: Keep as extern at file scope\n\nIf this is an internal cross-module dependency:\n\n```c\n/* At file scope, near top of SocketMetrics.c */\nextern int Socket_debug_live_count (void);\n\n// ... later ...\n\nint\nSocketMetrics_get_socket_count (void)\n{\n  return Socket_debug_live_count ();\n}\n```\n\n## Impact\n\n- **Current**: Unconventional style, minor readability issue\n- **After Fix**: Standard C idiom, improved maintainability\n\n## Priority\n\nLow - This is a code quality issue rather than a bug. Consider addressing during regular refactoring.",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}