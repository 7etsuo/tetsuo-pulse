{
  "number": 2333,
  "title": "Defense-in-depth: Add NULL check in configure_ticket_keys",
  "body": "## Summary\n\nThe `configure_ticket_keys` function in `SocketTLSContext-session.c` uses the `key` parameter in `memcpy` without validating it's non-NULL. While both callers currently check for NULL, defense-in-depth suggests the function should validate its own inputs to prevent future programming errors.\n\n## Location\n\n- **File**: `/home/tetsuo/git/tetsuo-socket/src/tls/SocketTLSContext-session.c`\n- **Line**: 204\n- **Function**: `configure_ticket_keys`\n\n## Current Code\n\n```c\nstatic int\nconfigure_ticket_keys (T ctx, const unsigned char *key, size_t key_len)\n{\n  memcpy (ctx->ticket_key, key, key_len);  // No NULL check on 'key'\n  \n  if (SSL_CTX_ctrl (ctx->ssl_ctx, SSL_CTRL_SET_TLSEXT_TICKET_KEYS,\n                    (int)key_len, ctx->ticket_key)\n      != 1)\n    {\n      OPENSSL_cleanse (ctx->ticket_key, SOCKET_TLS_TICKET_KEY_LEN);\n      return 0;\n    }\n\n  return 1;\n}\n```\n\n## Issue\n\nThe function does not check if `key` is NULL before passing it to `memcpy`. Both callers (lines 238 and 277) currently validate this, but the function itself should enforce its preconditions.\n\n## Recommendation\n\nAdd an assertion at the start of the function:\n\n```c\nstatic int\nconfigure_ticket_keys (T ctx, const unsigned char *key, size_t key_len)\n{\n  assert(key != NULL);\n  assert(ctx != NULL);\n  \n  memcpy (ctx->ticket_key, key, key_len);\n  // ... rest of function\n}\n```\n\nThis provides:\n- Early detection of programming errors during development\n- Clear documentation of function requirements\n- Defense-in-depth if callers are modified later\n\n## Category\n\n- **Type**: Security (Defense-in-depth)\n- **Severity**: MEDIUM\n- **Pattern**: MISSING_NULL_CHECK\n\n## Labels\n\n`security`, `defense-in-depth`, `tls`, `assertions`",
  "labels": [
    "wip:claude-1767093661-4175290"
  ],
  "state": "OPEN",
  "dependencies": []
}