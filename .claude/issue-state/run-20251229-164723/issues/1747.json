{
  "number": 1747,
  "title": "refactor(http-server-static): inline or document single-use get_mime_type function",
  "body": "## Summary\n\nThe `get_mime_type` function is called only once (at line 451) and is small enough (29 lines) to be inlined into `server_serve_static_file`. Single-use helper functions add indirection without clear benefit unless there's a documented reason for separation.\n\n## Location\n\n**File**: `src/http/SocketHTTPServer-static.c`  \n**Function**: `get_mime_type`  \n**Lines**: 112-140 (29 lines)  \n**Called**: Once at line 451  \n**Pattern**: `SINGLE_USE_INLINE`  \n**Severity**: HIGH\n\n## Current Code\n\n```c\nstatic const char *\nget_mime_type (const char *path)\n{\n  const char *ext;\n  size_t path_len, ext_len;\n\n  if (path == NULL)\n    return \"application/octet-stream\";\n\n  path_len = strlen (path);\n\n  /* Find the last dot in the path */\n  ext = strrchr (path, '.');\n  if (ext == NULL)\n    return \"application/octet-stream\";\n\n  ext_len = path_len - (size_t)(ext - path);\n\n  /* Check against known extensions (case-insensitive) */\n  for (int i = 0; mime_types[i].extension != NULL; i++)\n    {\n      if (strlen (mime_types[i].extension) == ext_len\n          && strcasecmp (ext, mime_types[i].extension) == 0)\n        {\n          return mime_types[i].mime_type;\n        }\n    }\n\n  return \"application/octet-stream\";\n}\n```\n\n**Single call site (line 451):**\n```c\nmime_type = get_mime_type (resolved_path);\n```\n\n## Recommendation\n\nEither:\n1. **Inline the function** into `server_serve_static_file` to reduce indirection\n2. **Document why it's separate** if there's a future plan to reuse it (e.g., for directory listings, WebDAV, etc.)\n\nIf inlining, the logic is straightforward:\n```c\n/* Determine MIME type from file extension */\nconst char *mime_type = \"application/octet-stream\";\nconst char *ext = strrchr (resolved_path, '.');\nif (ext != NULL)\n  {\n    size_t ext_len = strlen(resolved_path) - (size_t)(ext - resolved_path);\n    for (int i = 0; mime_types[i].extension != NULL; i++)\n      {\n        if (strlen (mime_types[i].extension) == ext_len\n            && strcasecmp (ext, mime_types[i].extension) == 0)\n          {\n            mime_type = mime_types[i].mime_type;\n            break;\n          }\n      }\n  }\n```",
  "labels": [
    "enhancement"
  ],
  "state": "OPEN",
  "dependencies": []
}