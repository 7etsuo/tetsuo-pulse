{
  "number": 1727,
  "title": "refactor(http-client-async): flatten 3-level nesting in SocketHTTPClient_post_async",
  "body": "## Summary\n\n3-level nested if statements in SocketHTTPClient_post_async function reduce code readability and can be flattened with guard clauses.\n\n**Category**: Refactoring\n**Severity**: MEDIUM\n**Pattern**: `DEEP_NESTING_3`\n**Files Affected**: 1\n\n## Affected Location\n\n| File | Lines | Context |\n|------|-------|---------|\n| `src/http/SocketHTTPClient-async.c` | 430-448 | Body and Content-Type header validation |\n\n## Problem\n\nThe function has 3 levels of nesting when handling optional request body and Content-Type header:\n\n```c\nif (body != NULL && body_len > 0)                         // Level 1\n  {\n    if (SocketHTTPClient_Request_body (req, body, body_len) != 0)  // Level 2\n      {\n        SocketHTTPClient_Request_free (&req);\n        return NULL;\n      }\n\n    /* Set Content-Type header */\n    if (content_type != NULL)                             // Level 2\n      {\n        if (SocketHTTPClient_Request_header (req, \"Content-Type\",\n                                             content_type)\n            != 0)                                         // Level 3\n          {\n            SocketHTTPClient_Request_free (&req);\n            return NULL;\n          }\n      }\n  }\n```\n\nThis nesting makes the code harder to follow and increases cognitive load.\n\n## Recommended Fix\n\nFlatten the nesting using guard clauses and early returns:\n\n```c\n/* Set body if provided */\nif (body != NULL && body_len > 0)\n  {\n    if (SocketHTTPClient_Request_body (req, body, body_len) != 0)\n      {\n        SocketHTTPClient_Request_free (&req);\n        return NULL;\n      }\n  }\n\n/* Set Content-Type header if provided with body */\nif (body != NULL && body_len > 0 && content_type != NULL)\n  {\n    if (SocketHTTPClient_Request_header (req, \"Content-Type\",\n                                         content_type)\n        != 0)\n      {\n        SocketHTTPClient_Request_free (&req);\n        return NULL;\n      }\n  }\n```\n\nOr alternatively, extract validation to helper functions to reduce complexity.\n\n## Checklist\n\n- [ ] Flatten nesting in `src/http/SocketHTTPClient-async.c:430-448`\n- [ ] Run tests with `cd build && ctest -j$(nproc) --output-on-failure`\n- [ ] Verify no functional changes introduced\n\n## References\n\n- Recent similar refactorings: #1678, #1677, #1672\n- Project pattern: Flatten nesting to improve readability\n\n---\n*Generated by readability-focused pipeline analysis*",
  "labels": [
    "enhancement"
  ],
  "state": "OPEN",
  "dependencies": []
}