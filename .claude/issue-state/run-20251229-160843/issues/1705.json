{
  "number": 1705,
  "title": "refactor(hpack-huffman): inline single-use flush_complete_bytes",
  "body": "## Issue\n`flush_complete_bytes` is a static function called exactly once, making it a candidate for inlining.\n\n**File:** `src/http/SocketHPACK-huffman.c`  \n**Lines:** 401-414 (14 lines)  \n**Called at:** Line 618  \n**Severity:** HIGH  \n**Pattern:** SINGLE_USE_INLINE  \n**Category:** Readability Refactor\n\n## Current Code\n```c\nstatic int\nflush_complete_bytes (uint64_t *bits, int *bits_avail, unsigned char *output,\n                      size_t *out_pos, size_t output_size)\n{\n  while (*bits_avail >= HUFFMAN_BITS_PER_BYTE)\n    {\n      if (*out_pos >= output_size)\n        return -1;\n\n      *bits_avail -= HUFFMAN_BITS_PER_BYTE;\n      output[(*out_pos)++] = (unsigned char) (*bits >> *bits_avail);\n    }\n  return 0;\n}\n```\n\n**Single call site (line 618):**\n```c\nif (flush_complete_bytes (&bits, &bits_avail, output, &out_pos,\n                          output_size) < 0)\n  return -1;\n```\n\n## Recommendation\nInline the function body at line 618 in `SocketHPACK_huffman_encode`:\n\n```c\n// Flush complete bytes from bit accumulator\nwhile (bits_avail >= HUFFMAN_BITS_PER_BYTE)\n  {\n    if (out_pos >= output_size)\n      return -1;\n    \n    bits_avail -= HUFFMAN_BITS_PER_BYTE;\n    output[out_pos++] = (unsigned char) (bits >> bits_avail);\n  }\n```\n\n## Impact\n- Reduces indirection (one fewer function call)\n- Simplifies code navigation\n- Small function body (14 lines) is easy to inline\n- No loss of clarity since it's only used once",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}