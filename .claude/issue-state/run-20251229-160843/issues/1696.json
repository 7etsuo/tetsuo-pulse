{
  "number": 1696,
  "title": "refactor(hpack): flatten 3-level nesting in Encoder_set_table_size",
  "body": "## Summary\n\nThe function `SocketHPACK_Encoder_set_table_size` (lines 509-539) has 3 levels of nested if-else statements managing pending table size updates.\n\n## File\n`src/http/SocketHPACK.c`\n\n## Line Range\n509-539\n\n## Pattern\nDEEP_NESTING_3\n\n## Severity\nMEDIUM\n\n## Issue\nThe function uses nested if-else-if-else to handle three states (count==0, count==1, count>=2), with additional nesting inside the count==1 and count>=2 branches to compare sizes.\n\n```c\nvoid SocketHPACK_Encoder_set_table_size (SocketHPACK_Encoder_T encoder, size_t max_size)\n{\n  if (encoder->pending_table_size_count == 0)\n    {\n      // State 1\n    }\n  else if (encoder->pending_table_size_count == 1)\n    {\n      if (max_size < encoder->pending_table_sizes[0])  // Level 3 nesting\n        {\n          // ...\n        }\n      else\n        {\n          // ...\n        }\n    }\n  else\n    {\n      if (max_size < encoder->pending_table_sizes[0])  // Level 3 nesting\n        {\n          // ...\n        }\n      else\n        {\n          // ...\n        }\n    }\n}\n```\n\n## Recommendation\n\nOption 1: Use early returns with state-based logic:\n```c\nvoid SocketHPACK_Encoder_set_table_size (SocketHPACK_Encoder_T encoder, size_t max_size)\n{\n  // Handle count == 0\n  if (encoder->pending_table_size_count == 0)\n    {\n      encoder->pending_table_sizes[0] = max_size;\n      encoder->pending_table_size_count = 1;\n      return;\n    }\n  \n  // Handle count == 1\n  if (encoder->pending_table_size_count == 1)\n    {\n      // Flatten nested logic\n      return;\n    }\n  \n  // Handle count >= 2\n  // ...\n}\n```\n\nOption 2: Extract helper functions for each state transition.\n\n## Category\nrefactor\n\n## Analysis Source\nAutomated readability analysis - HPACK pipeline run",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}