{
  "number": 1706,
  "title": "refactor(hpack-huffman): inline single-use hpack_find_symbol",
  "body": "## Issue\n`hpack_find_symbol` is a static function called exactly once, making it a candidate for inlining.\n\n**File:** `src/http/SocketHPACK-huffman.c`  \n**Lines:** 449-464 (16 lines)  \n**Called at:** Line 481 (in try_full_decode)  \n**Severity:** HIGH  \n**Pattern:** SINGLE_USE_INLINE  \n**Category:** Readability Refactor\n\n## Current Code\n```c\n/* Linear search for longer codes (9-30 bits). O(257) worst case. */\nstatic int\nhpack_find_symbol (uint64_t code, int cl)\n{\n  size_t s;\n\n  if (cl < HUFFMAN_MIN_CODE_BITS || cl > HPACK_HUFFMAN_MAX_BITS)\n    return -1;\n\n  for (s = 0; s < HPACK_HUFFMAN_SYMBOLS; s++)\n    {\n      const HPACK_HuffmanSymbol *sym = &hpack_huffman_encode[s];\n      if (sym->bits == (unsigned) cl && sym->code == code)\n        return (int) s;\n    }\n  return -1;\n}\n```\n\n**Single call site (line 481):**\n```c\nint sym = hpack_find_symbol (thiscode, cl);\n```\n\n## Recommendation\nInline the function body at line 481 in `try_full_decode`:\n\n```c\n// Linear search for longer codes (9-30 bits). O(257) worst case.\nint sym = -1;\nif (cl >= HUFFMAN_MIN_CODE_BITS && cl <= HPACK_HUFFMAN_MAX_BITS)\n  {\n    for (size_t s = 0; s < HPACK_HUFFMAN_SYMBOLS; s++)\n      {\n        const HPACK_HuffmanSymbol *sym_entry = &hpack_huffman_encode[s];\n        if (sym_entry->bits == (unsigned) cl && sym_entry->code == thiscode)\n          {\n            sym = (int) s;\n            break;\n          }\n      }\n  }\n```\n\n## Impact\n- Reduces indirection (one fewer function call)\n- Keeps the linear search logic close to its single use case\n- Function body (16 lines) is small enough to inline\n- Preserves the O(257) worst-case comment at the usage site",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}