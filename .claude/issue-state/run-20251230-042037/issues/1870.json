{
  "number": 1870,
  "title": "CRITICAL: Missing constant definitions in SocketPool-ops.c prevents compilation",
  "body": "## Summary\n\nMultiple security-critical constants are referenced but not defined anywhere in the codebase, preventing compilation and potentially bypassing important security limits.\n\n## Location\n\n**File**: `/home/tetsuo/git/tetsuo-socket/src/pool/SocketPool-ops.c`  \n**Lines**: 837, 1051, 1286, 471, 479, 1386, 1408\n\n## Missing Constants\n\n### 1. `SOCKET_POOL_MAX_BATCH_ACCEPTS` (Line 837)\nUsed to validate maximum batch accept size:\n```c\nif (max_accepts <= 0 || max_accepts > SOCKET_POOL_MAX_BATCH_ACCEPTS)\n```\n**Impact**: Without this limit, attackers could request enormous batch sizes, causing resource exhaustion.\n\n### 2. `SOCKET_POOL_MAX_ASYNC_PENDING` (Lines 1051, 1286)\nUsed to prevent resource exhaustion from excessive concurrent async connections:\n```c\nreturn pool->async_pending_count < SOCKET_POOL_MAX_ASYNC_PENDING;\n```\n**Impact**: Critical security control missing - no limit on pending async connections.\n\n### 3. `SOCKET_PERCENTAGE_DIVISOR` (Lines 471, 479)\nUsed in prewarm calculation:\n```c\nprewarm_count = tmp / SOCKET_PERCENTAGE_DIVISOR;\n```\n**Impact**: Division by undefined value - likely division by zero or garbage.\n\n### 4. `SOCKET_SYN_DEFAULT_THROTTLE_DELAY_MS` (Line 1386)\nUsed in SYN flood protection throttling:\n```c\ntarget = Socket_get_monotonic_ms() + SOCKET_SYN_DEFAULT_THROTTLE_DELAY_MS;\n```\n**Impact**: SYN flood protection ineffective without proper delay value.\n\n### 5. `SOCKET_SYN_DEFAULT_DEFER_SEC` (Line 1408)\nUsed in TCP challenge mechanism:\n```c\nSocket_setdeferaccept(socket, SOCKET_SYN_DEFAULT_DEFER_SEC);\n```\n**Impact**: TCP SYN cookie challenge mechanism broken.\n\n## Verification\n\nSearched entire codebase - these constants are not defined:\n```bash\ngrep -r \"define SOCKET_POOL_MAX_BATCH\" include/ src/\ngrep -r \"define SOCKET_POOL_MAX_ASYNC\" include/ src/\ngrep -r \"define SOCKET_PERCENTAGE\" include/ src/\ngrep -r \"define SOCKET_SYN_DEFAULT\" include/ src/\n```\nAll searches returned no results.\n\n## Recommended Fix\n\nAdd these definitions to `include/pool/SocketPool.h` or create a new `include/pool/SocketPool-limits.h`:\n\n```c\n/* Pool operation limits */\n#define SOCKET_POOL_MAX_BATCH_ACCEPTS 128    /* Max connections per batch accept */\n#define SOCKET_POOL_MAX_ASYNC_PENDING 1000   /* Max concurrent async connections */\n#define SOCKET_PERCENTAGE_DIVISOR 100        /* Divisor for percentage calculations */\n\n/* SYN flood protection defaults */\n#define SOCKET_SYN_DEFAULT_THROTTLE_DELAY_MS 100  /* Throttle delay in milliseconds */\n#define SOCKET_SYN_DEFAULT_DEFER_SEC 3            /* TCP_DEFER_ACCEPT timeout in seconds */\n```\n\n## Severity\n\n**CRITICAL** - Code will not compile without these definitions, or if it does compile (due to implicit declarations), security limits will be bypassed entirely.\n\n## Pattern ID\n\n`MISSING_CONSTANT_DEFINITIONS`\n\n## Labels\n\n- security\n- critical\n- compilation-error\n- pool",
  "labels": [
    "wip:claude-1767076235-1089877"
  ],
  "state": "OPEN",
  "dependencies": []
}