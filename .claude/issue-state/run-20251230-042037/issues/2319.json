{
  "number": 2319,
  "title": "sec: Add bounds check for off_t to ssize_t cast in socket_sendfile_bsd",
  "body": "## Summary\nIn `socket_sendfile_bsd()` (Socket-iov.c:227), `off_t len` is cast to `ssize_t` for the return value without checking if `len > SSIZE_MAX`. This could cause a successful large transfer to be interpreted as an error.\n\n## Location\n- **File**: src/socket/Socket-iov.c\n- **Line**: 227\n- **Function**: socket_sendfile_bsd\n- **Category**: Security (CWE-190: Integer Overflow)\n- **Severity**: MEDIUM\n\n## Issue\n```c\nreturn (ssize_t)len;  // \u274c No SSIZE_MAX check\n```\n\nIf `len > SSIZE_MAX`, the cast wraps to a negative value, causing:\n- Caller interprets success as error (-1 typically means failure)\n- Incorrect error handling in application logic\n- Potential data loss or incomplete transfers\n\n## Recommendation\nAdd bounds check before return:\n```c\nif (len > SSIZE_MAX) {\n    errno = EOVERFLOW;\n    return -1;\n}\nreturn (ssize_t)len;\n```\n\n## Test Plan\n- [ ] Test sendfile with len > SSIZE_MAX\n- [ ] Verify errno set to EOVERFLOW\n- [ ] Ensure return value is -1, not wrapped negative\n\n## References\n- CWE-190: Integer Overflow or Wraparound\n- POSIX ssize_t definition and limits",
  "labels": [
    "bug"
  ],
  "state": "OPEN",
  "dependencies": []
}