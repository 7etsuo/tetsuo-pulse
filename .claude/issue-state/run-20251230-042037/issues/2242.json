{
  "number": 2242,
  "title": "fix(pool): undefined constant SOCKET_SYN_DEFAULT_DEFER_SEC in SocketPool-ops.c",
  "body": "## Summary\n\nSocketPool-ops.c references undefined constant `SOCKET_SYN_DEFAULT_DEFER_SEC` at line 1480, breaking SYN challenge functionality.\n\n## Location\n\n**File**: `src/pool/SocketPool-ops.c`  \n**Line**: 1480  \n**Function**: `apply_syn_challenge`\n\n## Issue Details\n\n**Category**: Security / Compilation Error  \n**Severity**: CRITICAL  \n**Pattern**: UNDEFINED_CONSTANT\n\n### Code Context\n\n```c\nstatic void\napply_syn_challenge (Socket_T socket, SocketSYN_Action action,\n                     SocketSYNProtect_T protect)\n{\n  if (action != SYN_ACTION_CHALLENGE || protect == NULL || socket == NULL)\n    return;\n\n  /* Note: TCP_DEFER_ACCEPT is typically set on listening socket, but\n   * for per-connection challenge we apply it to accepted socket to\n   * ensure data is received before proceeding. This is less effective\n   * than listener-level defer but still adds a challenge. */\n  TRY { Socket_setdeferaccept (socket, SOCKET_SYN_DEFAULT_DEFER_SEC); }  // Line 1480 - UNDEFINED\n  ELSE\n  {\n    /* Ignore failures - best effort protection */\n    SocketLog_emitf (SOCKET_LOG_DEBUG, SOCKET_LOG_COMPONENT,\n                     \"SYN challenge: TCP_DEFER_ACCEPT failed (continuing)\");\n  }\n  END_TRY;\n}\n```\n\n### Impact\n\n- Code will not compile\n- SYN flood protection challenge mechanism is broken\n- TCP_DEFER_ACCEPT security feature non-functional\n- Potential vulnerability to SYN flood attacks\n\n## Recommendation\n\nDefine `SOCKET_SYN_DEFAULT_DEFER_SEC` in an appropriate header file:\n\n**Option 1**: Add to `include/core/SocketConfig.h`:\n```c\n#ifndef SOCKET_SYN_DEFAULT_DEFER_SEC\n#define SOCKET_SYN_DEFAULT_DEFER_SEC 5  /* 5 seconds defer accept */\n#endif\n```\n\n**Option 2**: Add to `include/socket/SocketSYNProtect.h`:\n```c\n#ifndef SOCKET_SYN_DEFAULT_DEFER_SEC\n#define SOCKET_SYN_DEFAULT_DEFER_SEC 5\n#endif\n```\n\n**Recommended value**: 3-10 seconds for effective SYN flood protection\n\n### Background: TCP_DEFER_ACCEPT\n\nTCP_DEFER_ACCEPT (Linux-specific) causes accept() to wait until data arrives, preventing resource exhaustion from incomplete connections. Common values:\n- 3 seconds: Aggressive protection, may timeout legitimate slow clients\n- 5 seconds: Balanced (recommended)\n- 10 seconds: Conservative, tolerant of slow networks\n\n## Verification\n\nSearch confirms constant is not defined anywhere in codebase:\n```bash\n$ grep -r \"SOCKET_SYN_DEFAULT_DEFER_SEC\" include/ src/\n# No results\n```\n\n## Related Issues\n\n- See also: #2240 (SOCKET_SYN_DEFAULT_THROTTLE_DELAY_MS)\n- See also: SOCKET_PERCENTAGE_DIVISOR (line 471)\n\n---\n**Automated Analysis**: Pipeline per-file agent  \n**Repository**: 7etsuo/tetsuo-socket",
  "labels": [
    "bug",
    "wip:claude-1767092676-3930812"
  ],
  "state": "OPEN",
  "dependencies": []
}