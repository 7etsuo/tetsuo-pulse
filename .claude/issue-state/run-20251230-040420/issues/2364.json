{
  "number": 2364,
  "title": "refactor(tls): simplify SocketTLS_get_ocsp_response_status",
  "body": "## Summary\n\nThe `SocketTLS_get_ocsp_response_status()` function is 48 lines long. While it already uses helper functions `ocsp_parse_response()` and `ocsp_verify_signature()`, the certificate status check logic at the end could also be extracted for better separation of concerns.\n\n## Location\n\n**File**: `src/tls/SocketTLS.c`\n**Lines**: 2130-2178\n**Function**: `SocketTLS_get_ocsp_response_status()`\n\n## Issue\n\nThe function is partially refactored but still does inline certificate status checking. The helper `ocsp_check_cert_status()` exists (line 2079) but isn't called from this function - the logic is duplicated.\n\n## Recommendation\n\nUse the existing helper function:\n\n```c\nint SocketTLS_get_ocsp_response_status(Socket_T socket) {\n    assert(socket);\n    \n    SSL *ssl = tls_socket_get_ssl(socket);\n    if (!ssl) return -1;\n    \n    // Check if OCSP response is present\n    const unsigned char *ocsp_resp_check;\n    long ocsp_len_check = SSL_get_tlsext_status_ocsp_resp(ssl, &ocsp_resp_check);\n    if (ocsp_len_check <= 0 || !ocsp_resp_check)\n        return -1;\n    \n    OCSP_BASICRESP *basic = ocsp_parse_response(ssl);\n    if (!basic) return -2;\n    \n    X509 *peer_cert = SSL_get_peer_certificate(ssl);\n    if (!peer_cert) {\n        OCSP_BASICRESP_free(basic);\n        return -2;\n    }\n    \n    if (ocsp_verify_signature(basic, ssl) != 0) {\n        X509_free(peer_cert);\n        OCSP_BASICRESP_free(basic);\n        return -2;\n    }\n    \n    // Use existing helper instead of duplicating logic\n    int cert_status = ocsp_check_cert_status(basic);\n    \n    X509_free(peer_cert);\n    OCSP_BASICRESP_free(basic);\n    return cert_status;\n}\n```\n\n## Impact\n\n- **Severity**: MEDIUM\n- **Category**: Refactoring\n- **Pattern**: LONG_FUNCTION_48\n\n## Labels\n\n- `refactoring`\n- `code-quality`\n- `low-priority`",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}