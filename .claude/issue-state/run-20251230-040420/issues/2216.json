{
  "number": 2216,
  "title": "refactor(http): consolidate duplicate validation in post_async",
  "body": "## Summary\n\nIn `src/http/SocketHTTPClient-async.c`, the `SocketHTTPClient_post_async` function has duplicate validation logic checking `(body != NULL && body_len > 0)` twice.\n\n## Location\n\n- **File**: `/home/tetsuo/git/tetsuo-socket/src/http/SocketHTTPClient-async.c`\n- **Lines**: 430-437, 440-449\n- **Function**: `SocketHTTPClient_post_async`\n\n## Issue Details\n\n**Pattern**: `DUPLICATE_VALIDATION`\n**Severity**: MEDIUM\n**Category**: Refactoring\n\nLines 430-437 check the condition:\n```c\n/* Set body if provided */\nif (body != NULL && body_len > 0)\n  {\n    if (SocketHTTPClient_Request_body (req, body, body_len) != 0)\n      {\n        SocketHTTPClient_Request_free (&req);\n        return NULL;\n      }\n  }\n```\n\nLines 440-449 check the same condition again:\n```c\n/* Set Content-Type header if provided with body */\nif (body != NULL && body_len > 0 && content_type != NULL)\n  {\n    if (SocketHTTPClient_Request_header (req, \"Content-Type\",\n                                         content_type)\n        != 0)\n      {\n        SocketHTTPClient_Request_free (&req);\n        return NULL;\n      }\n  }\n```\n\n## Recommendation\n\nConsolidate into a single conditional block:\n\n```c\n/* Set body and Content-Type if provided */\nif (body != NULL && body_len > 0)\n  {\n    if (SocketHTTPClient_Request_body (req, body, body_len) != 0)\n      {\n        SocketHTTPClient_Request_free (&req);\n        return NULL;\n      }\n    \n    if (content_type != NULL)\n      {\n        if (SocketHTTPClient_Request_header (req, \"Content-Type\",\n                                             content_type) != 0)\n          {\n            SocketHTTPClient_Request_free (&req);\n            return NULL;\n          }\n      }\n  }\n```\n\n## Impact\n\n- Reduces code duplication\n- Improves readability\n- Makes the relationship between body and content-type clearer",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}