{
  "number": 2299,
  "title": "refactor(simple-poll): extract duplicate core socket extraction to helper",
  "body": "**File**: `src/simple/SocketSimple-poll.c`  \n**Lines**: 188, 222, 256  \n**Category**: Redundancy  \n**Severity**: MEDIUM  \n\n## Issue\nDuplicate core socket extraction and validation pattern appears in 3 functions:\n- `Socket_simple_poll_mod()` - line 188\n- `Socket_simple_poll_del()` - line 222  \n- `Socket_simple_poll_modify_events()` - line 256\n\n```c\nSocket_T core_sock = sock->socket;\nif (!core_sock)\n{\n    simple_set_error (SOCKET_SIMPLE_ERR_INVALID_ARG,\n                      \"Invalid socket handle\");\n    return -1;\n}\n```\n\nThis is separate from (but related to) issue #2292 about inconsistent dgram validation.\n\n## Impact\n- Code duplication (3+ instances)\n- Harder to maintain consistent behavior\n- Violates DRY principle\n- Misses dgram validation (see issue #2292)\n\n## Recommendation\nExtract to a helper function (this would also address the dgram validation issue):\n\n```c\nstatic Socket_T\nget_core_socket(SocketSimple_Socket_T sock)\n{\n    if (!sock)\n    {\n        simple_set_error(SOCKET_SIMPLE_ERR_INVALID_ARG, \"Null socket\");\n        return NULL;\n    }\n    \n    if (sock->socket)\n        return sock->socket;\n    \n    if (sock->dgram)\n    {\n        simple_set_error(SOCKET_SIMPLE_ERR_UNSUPPORTED,\n                        \"UDP sockets not supported in poll\");\n        return NULL;\n    }\n    \n    simple_set_error(SOCKET_SIMPLE_ERR_INVALID_ARG,\n                    \"Invalid socket handle\");\n    return NULL;\n}\n```\n\nUsage:\n```c\nSocket_T core_sock = get_core_socket(sock);\nif (!core_sock) return -1;\n```\n\n## References\n- Pattern ID: `DUPLICATE_CORE_SOCK_CHECK`\n- Related: Issue #2292 (inconsistent dgram validation)\n- Functions: `Socket_simple_poll_{mod,del,modify_events}`",
  "labels": [
    "enhancement"
  ],
  "state": "OPEN",
  "dependencies": []
}