{
  "number": 2246,
  "title": "refactor(quic): extract safe arithmetic helpers to shared utility module",
  "body": "## Summary\n\nThe QUIC connection termination module implements overflow-safe arithmetic operations (`safe_add_timeout` and `calculate_termination_timeout`) that use different overflow protection patterns. These could be extracted to a shared utility module for reuse across the codebase.\n\n## Location\n\n**File**: `src/quic/SocketQUICConnection-termination.c`\n**Lines**: 41-46, 74-80\n\n## Current Implementation\n\n```c\n// Line 41-46: Addition overflow check\nstatic inline uint64_t\nsafe_add_timeout(uint64_t base, uint64_t offset)\n{\n  if (base > UINT64_MAX - offset)\n    return UINT64_MAX;\n  return base + offset;\n}\n\n// Line 74-80: Multiplication overflow check  \nstatic inline uint64_t\ncalculate_termination_timeout(uint64_t pto_ms)\n{\n  if (pto_ms > UINT64_MAX / QUIC_CLOSING_TIMEOUT_PTO_MULT)\n    return UINT64_MAX;\n  return pto_ms * QUIC_CLOSING_TIMEOUT_PTO_MULT;\n}\n```\n\n## Issue\n\n1. **Inconsistent patterns**: Addition uses subtraction-based check, multiplication uses division-based check\n2. **Low reusability**: These are static inline functions that can't be shared across modules\n3. **Potential duplication**: Other modules may need similar overflow protection\n\n## Recommendation\n\nCreate a new utility module `include/core/SocketArithmetic.h` with standardized safe arithmetic functions:\n\n```c\n/**\n * @brief Safe addition with overflow protection.\n * @return a + b, or UINT64_MAX if overflow would occur.\n */\nstatic inline uint64_t safe_add_u64(uint64_t a, uint64_t b);\n\n/**\n * @brief Safe multiplication with overflow protection.\n * @return a * b, or UINT64_MAX if overflow would occur.\n */\nstatic inline uint64_t safe_mul_u64(uint64_t a, uint64_t b);\n```\n\nThen update the QUIC module to use these standardized helpers.\n\n## Benefits\n\n- **Consistency**: Uniform overflow handling patterns\n- **Reusability**: Other modules can use the same helpers\n- **Testability**: Centralized arithmetic operations can be thoroughly tested\n- **Maintainability**: Single source of truth for overflow protection logic\n\n## Category\n\n- Type: Refactoring\n- Severity: Low\n- Pattern: MANUAL_SAFE_ADD, OVERFLOW_CHECK_MULTIPLY",
  "labels": [
    "enhancement",
    "quic"
  ],
  "state": "OPEN",
  "dependencies": []
}