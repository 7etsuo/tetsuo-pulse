{
  "number": 2277,
  "title": "refactor(simple-async): remove unnecessary volatile on safe_socket",
  "body": "## Summary\n\nThe \\`safe_socket\\` variable in \\`async_operation_common\\` is declared \\`volatile\\` but is only assigned once and never modified, making the qualifier unnecessary.\n\n## Details\n\n**File:** \\`src/simple/SocketSimple-async.c\\`\n**Line:** 192\n**Severity:** LOW\n**Pattern:** UNNECESSARY_VOLATILE\n\n## Current Code\n\n\\`\\`\\`c\nstatic unsigned\nasync_operation_common (SocketSimple_Async_T async,\n                        SocketSimple_Socket_T socket, void *buf, size_t len,\n                        SocketSimple_AsyncCallback cb, void *user_data,\n                        SocketSimple_AsyncFlags flags, int64_t timeout_ms,\n                        AsyncOpFunc op_func, AsyncOpTimeoutFunc op_timeout_func,\n                        const char *error_msg)\n{\n  /* Volatile copy to survive potential longjmp in TRY/EXCEPT */\n  SocketSimple_Socket_T volatile safe_socket = socket;  // Line 192\n  Socket_T core_socket;\n  struct CallbackContext *ctx;\n  volatile unsigned request_id = 0;\n\n  // ... later usage:\n  core_socket = get_core_socket ((SocketSimple_Socket_T)safe_socket);  // Line 205\n  ctx->simple_socket = (SocketSimple_Socket_T)safe_socket;  // Line 230\n}\n\\`\\`\\`\n\n## Analysis\n\nThe \\`volatile\\` qualifier is needed for variables that are:\n1. Modified inside a TRY block AND\n2. Read after exception handling\n\nIn this case:\n- \\`safe_socket\\` is assigned once at line 192\n- It is only **read** at lines 205 and 230\n- It is never modified in the TRY block (lines 232-254)\n\nVariables that **do** need \\`volatile\\`:\n- \\`request_id\\` - Modified inside TRY block at lines 236, 243\n\n## Recommendation\n\nRemove the \\`volatile\\` qualifier:\n\n\\`\\`\\`c\nSocketSimple_Socket_T safe_socket = socket;  // No volatile needed\nSocket_T core_socket;\nstruct CallbackContext *ctx;\nvolatile unsigned request_id = 0;  // Keep volatile - modified in TRY\n\\`\\`\\`\n\n## Impact\n\n- Allows compiler optimizations\n- Clearer intent - only truly mutable variables are marked volatile\n- Follows exception safety guidelines from CLAUDE.md\n\n## References\n\nPer CLAUDE.md \"Exception Safety\" section:\n> Use \\`volatile\\` for variables modified inside TRY that are read after exception\n\nThe \\`core_socket\\` variable also doesn't need volatile since it's assigned before TRY and not modified.",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}