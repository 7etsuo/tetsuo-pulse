{
  "number": 2363,
  "title": "refactor(tls): break down SocketTLS_get_peer_cert_info function (63 lines)",
  "body": "## Summary\n\nThe `SocketTLS_get_peer_cert_info()` function is 63 lines long and extracts multiple certificate fields. It should be refactored to use helper functions for each extraction task.\n\n## Location\n\n**File**: `src/tls/SocketTLS.c`\n**Lines**: 1835-1898\n**Function**: `SocketTLS_get_peer_cert_info()`\n\n## Issue\n\nThe function extracts:\n1. Subject name\n2. Issuer name\n3. Validity period (not_before, not_after)\n4. Version\n5. Serial number (with BIGNUM conversion to hex)\n6. SHA256 fingerprint (with digest computation)\n\nEach of these is a distinct responsibility that could be a helper function.\n\n## Recommendation\n\nExtract helper functions:\n\n```c\nstatic void extract_cert_subject(X509 *cert, char *buf, size_t size);\nstatic void extract_cert_issuer(X509 *cert, char *buf, size_t size);\nstatic void extract_cert_serial(X509 *cert, char *buf, size_t size);\nstatic void extract_cert_fingerprint(X509 *cert, char *buf, size_t size);\n\nint SocketTLS_get_peer_cert_info(Socket_T socket, SocketTLS_CertInfo *info) {\n    assert(socket);\n    assert(info);\n    \n    memset(info, 0, sizeof(*info));\n    \n    SSL *ssl = tls_socket_get_ssl(socket);\n    if (!ssl) return -1;\n    \n    X509 *cert = SSL_get_peer_certificate(ssl);\n    if (!cert) return 0;\n    \n    extract_cert_subject(cert, info->subject, sizeof(info->subject));\n    extract_cert_issuer(cert, info->issuer, sizeof(info->issuer));\n    extract_cert_serial(cert, info->serial, sizeof(info->serial));\n    extract_cert_fingerprint(cert, info->fingerprint, sizeof(info->fingerprint));\n    \n    info->not_before = asn1_time_to_time_t(X509_get0_notBefore(cert));\n    info->not_after = asn1_time_to_time_t(X509_get0_notAfter(cert));\n    info->version = (int)X509_get_version(cert) + 1;\n    \n    X509_free(cert);\n    return 1;\n}\n```\n\n## Impact\n\n- **Severity**: MEDIUM\n- **Category**: Refactoring\n- **Pattern**: LONG_FUNCTION_63\n\n## Labels\n\n- `refactoring`\n- `code-quality`\n- `low-priority`",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}