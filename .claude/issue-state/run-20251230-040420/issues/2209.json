{
  "number": 2209,
  "title": "refactor(dns): extract helpers from long functions in SocketDNSResolver",
  "body": "## Summary\n\nThree functions in `src/dns/SocketDNSResolver.c` exceed 50 lines and would benefit from extracting helper functions for improved readability and maintainability.\n\n## Findings\n\n### 1. `generate_unique_id` (lines 329-381, 52 lines)\n**Issue**: Function handles both crypto random generation AND collision checking in single function.\n\n**Recommendation**: Extract collision checking into separate helper:\n```c\nstatic int is_query_id_in_use(T resolver, uint16_t id);\n```\n\n### 2. `transport_callback` (lines 989-1052, 63 lines)  \n**Issue**: Handles transport errors, response parsing, CNAME logic, and dual-stack queries in one function.\n\n**Recommendation**: Extract transport error handling:\n```c\nstatic void handle_transport_error(struct SocketDNSResolver_Query *q, int error);\n```\n\n### 3. `SocketDNSResolver_resolve` (lines 1522-1576, 54 lines)\n**Issue**: Multiple fast-path checks (IP literal, localhost, cache) make function dense.\n\n**Recommendation**: Consolidate fast-path checks into single helper:\n```c\nstatic int try_fast_path_resolution(T resolver, const char *hostname, \n                                     int flags, SocketDNSResolver_Callback callback,\n                                     void *userdata);\n```\n\n## Benefits\n\n- Improved readability (each function does one thing)\n- Easier testing (helpers can be unit tested independently)\n- Reduced cognitive complexity\n- Follows codebase style guide (50 line function limit)\n\n## Impact\n\n- **Severity**: MEDIUM\n- **Category**: Refactoring\n- **Module**: DNS Resolver\n- **Files**: `src/dns/SocketDNSResolver.c`\n- **Lines**: 329-381, 989-1052, 1522-1576\n- **Estimated effort**: 2-3 hours",
  "labels": [
    "enhancement"
  ],
  "state": "OPEN",
  "dependencies": []
}