{
  "number": 2236,
  "title": "refactor: optimize store_challenge_field with dispatch table or switch",
  "body": "## Summary\n\nIn `SocketHTTPClient-auth.c` lines 142-158, the `store_challenge_field()` function uses a chain of 6 `strcasecmp()` comparisons to dispatch parameter storage. This is inefficient for hot parsing paths.\n\n## Location\n\n**File:** `/home/tetsuo/git/tetsuo-socket/src/http/SocketHTTPClient-auth.c`  \n**Lines:** 142-158  \n**Function:** `store_challenge_field`\n\n## Current Code\n\n```c\nstatic void\nstore_challenge_field (DigestChallenge *ch, const char *name,\n                       const char *value)\n{\n  if (strcasecmp (name, \"realm\") == 0)\n    socket_util_safe_strncpy (ch->realm, value, sizeof (ch->realm));\n  else if (strcasecmp (name, \"nonce\") == 0)\n    socket_util_safe_strncpy (ch->nonce, value, sizeof (ch->nonce));\n  else if (strcasecmp (name, \"opaque\") == 0)\n    socket_util_safe_strncpy (ch->opaque, value, sizeof (ch->opaque));\n  else if (strcasecmp (name, \"qop\") == 0)\n    socket_util_safe_strncpy (ch->qop, value, sizeof (ch->qop));\n  else if (strcasecmp (name, \"algorithm\") == 0)\n    socket_util_safe_strncpy (ch->algorithm, value, sizeof (ch->algorithm));\n  else if (strcasecmp (name, \"stale\") == 0)\n    ch->stale = check_stale_value(value);\n}\n```\n\n## Issue\n\nEach parameter lookup requires up to 6 case-insensitive string comparisons. For common parameters like \"realm\" and \"nonce\", this is inefficient. A dispatch table would provide O(1) lookup.\n\n## Recommendation\n\nUse a lookup table or switch on first character:\n\n```c\ntypedef struct {\n  const char *name;\n  void (*handler)(DigestChallenge *ch, const char *value);\n} ParamHandler;\n\nstatic void store_realm(DigestChallenge *ch, const char *value) {\n  socket_util_safe_strncpy(ch->realm, value, sizeof(ch->realm));\n}\n/* ... similar handlers ... */\n\nstatic const ParamHandler handlers[] = {\n  { \"realm\", store_realm },\n  { \"nonce\", store_nonce },\n  { \"opaque\", store_opaque },\n  { \"qop\", store_qop },\n  { \"algorithm\", store_algorithm },\n  { \"stale\", store_stale },\n  { NULL, NULL }\n};\n\nstatic void\nstore_challenge_field(DigestChallenge *ch, const char *name, const char *value)\n{\n  for (const ParamHandler *h = handlers; h->name != NULL; h++) {\n    if (strcasecmp(name, h->name) == 0) {\n      h->handler(ch, value);\n      return;\n    }\n  }\n}\n```\n\nFor even better performance, sort the table and use `bsearch()` or switch on `name[0]`.\n\n## Severity\n\n**LOW** - Performance optimization, not a bug\n\n## Pattern ID\n\n`LONG_IF_ELSE_CHAIN`",
  "labels": [],
  "state": "OPEN",
  "dependencies": []
}