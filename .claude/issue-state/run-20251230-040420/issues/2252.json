{
  "number": 2252,
  "title": "refactor(hpack): replace magic numbers with named constants in decode config",
  "body": "**File**: `src/http/SocketHPACK-huffman.c`\n**Line**: 434-438\n**Category**: Refactoring / Code Quality\n**Severity**: Medium\n\n## Description\n\nThe Huffman decode configuration table uses hardcoded magic numbers without named constants, reducing code readability and maintainability.\n\n## Current Code\n\n```c\nstatic const HuffmanDecodeConfig hpack_decode_configs[] = {\n  { 5, 0x1Fu, 0x00u, 0x09u, 0u },  /* 5-bit: 10 symbols */\n  { 6, 0x3Fu, 0x14u, 0x2Du, 10u }, /* 6-bit: 26 symbols */\n  { 7, 0x7Fu, 0x5Cu, 0x7Bu, 36u }, /* 7-bit: 32 symbols */\n  { 8, 0xFFu, 0xF8u, 0xFDu, 68u }  /* 8-bit: 6 symbols */\n};\n```\n\n## Issue\n\nThe bit masks (`0x1Fu`, `0x3Fu`, `0x7Fu`, `0xFFu`) and code ranges (`0x00u`, `0x09u`, `0x14u`, etc.) are raw hex constants derived from RFC 7541 Appendix B, but their derivation isn't immediately obvious from the code.\n\n## Recommendation\n\nDefine named constants for the decode configuration to improve code clarity:\n\n```c\n#define HPACK_DECODE_5BIT_MASK      0x1Fu\n#define HPACK_DECODE_5BIT_FIRST     0x00u\n#define HPACK_DECODE_5BIT_LAST      0x09u\n#define HPACK_DECODE_5BIT_COUNT     10u\n#define HPACK_DECODE_5BIT_OFFSET    0u\n\n#define HPACK_DECODE_6BIT_MASK      0x3Fu\n#define HPACK_DECODE_6BIT_FIRST     0x14u\n#define HPACK_DECODE_6BIT_LAST      0x2Du\n#define HPACK_DECODE_6BIT_COUNT     26u\n#define HPACK_DECODE_6BIT_OFFSET    10u\n\n// ... etc for 7-bit and 8-bit\n\nstatic const HuffmanDecodeConfig hpack_decode_configs[] = {\n  { 5, HPACK_DECODE_5BIT_MASK, HPACK_DECODE_5BIT_FIRST, HPACK_DECODE_5BIT_LAST, HPACK_DECODE_5BIT_OFFSET },\n  { 6, HPACK_DECODE_6BIT_MASK, HPACK_DECODE_6BIT_FIRST, HPACK_DECODE_6BIT_LAST, HPACK_DECODE_6BIT_OFFSET },\n  { 7, HPACK_DECODE_7BIT_MASK, HPACK_DECODE_7BIT_FIRST, HPACK_DECODE_7BIT_LAST, HPACK_DECODE_7BIT_OFFSET },\n  { 8, HPACK_DECODE_8BIT_MASK, HPACK_DECODE_8BIT_FIRST, HPACK_DECODE_8BIT_LAST, HPACK_DECODE_8BIT_OFFSET }\n};\n```\n\nAlternatively, add comprehensive comments explaining the derivation from RFC 7541.\n\n## Impact\n\n- **Maintainability**: Easier to understand and modify decode table configuration\n- **Documentation**: Self-documenting code reduces cognitive load\n- **Testing**: Named constants make it easier to write targeted tests\n\n## References\n\n- RFC 7541 Appendix B (HPACK Static Huffman Code)\n- Current implementation: Lines 434-441",
  "labels": [
    "enhancement"
  ],
  "state": "OPEN",
  "dependencies": []
}