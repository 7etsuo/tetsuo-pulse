<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tetsuo Pulse: SocketTLS.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="socket-brand.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Tetsuo Pulse<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-performance networking from Tetsuo</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('SocketTLS_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">SocketTLS.h</div></div>
</div><!--header-->
<div class="contents">
<a href="SocketTLS_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span><span class="preprocessor">#ifndef SOCKETTLS_INCLUDED</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="preprocessor">#define SOCKETTLS_INCLUDED</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="preprocessor">#include &quot;<a class="code" href="Except_8h.html">core/Except.h</a>&quot;</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="preprocessor">#include &quot;<a class="code" href="Socket_8h.html">socket/Socket.h</a>&quot;</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="preprocessor">#if SOCKET_HAS_TLS</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="preprocessor">#include &lt;openssl/x509.h&gt;</span> <span class="comment">/* For X509, X509_NAME, etc. */</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span><span class="preprocessor">#include &lt;time.h&gt;</span>         <span class="comment">/* For time_t */</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span><span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span><span class="keyword">extern</span> __declspec (thread) <span class="keywordtype">char</span> <a class="code hl_variable" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a>[];</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span><span class="keyword">extern</span> __thread <span class="keywordtype">char</span> <a class="code hl_variable" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a>[];</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno"><a class="line" href="group__security.html#ga0acb682b8260ab1c60b918599864e2e5">  358</a></span><span class="preprocessor">#define T SocketTLS_T</span></div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno"><a class="line" href="group__security.html#ga63e73c93350813167a68162c5cb3d819">  359</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_define" href="group__security.html#ga0acb682b8260ab1c60b918599864e2e5">T</a> *<a class="code hl_define" href="group__security.html#ga0acb682b8260ab1c60b918599864e2e5">T</a>;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span> </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span><span class="comment"> * Exception Types</span></div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment"> *</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span><span class="comment"> * RETRYABILITY: TLS errors are generally NOT retryable as they indicate</span></div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span><span class="comment"> * configuration issues, certificate problems, or protocol mismatches.</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span><span class="comment"> */</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span> </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_struct" href="group__foundation.html#structExcept__T">Except_T</a> <a class="code hl_variable" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a>;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_struct" href="group__foundation.html#structExcept__T">Except_T</a> <a class="code hl_variable" href="group__security.html#ga82be75dd764021fb64cd6824768e2254">SocketTLS_HandshakeFailed</a>;</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_struct" href="group__foundation.html#structExcept__T">Except_T</a> <a class="code hl_variable" href="group__security.html#gabe406e483a861198db5bca58300f1728">SocketTLS_VerifyFailed</a>;</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_struct" href="group__foundation.html#structExcept__T">Except_T</a> <a class="code hl_variable" href="group__security.html#gad97195716332983bae10a77f275740bd">SocketTLS_ProtocolError</a>;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span><span class="keyword">extern</span> <span class="keyword">const</span> <a class="code hl_struct" href="group__foundation.html#structExcept__T">Except_T</a> <a class="code hl_variable" href="group__security.html#gaa724dbe4115729ef621c0f1f74b5afd6">SocketTLS_ShutdownFailed</a>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span> </div>
<div class="foldopen" id="foldopen00552" data-start="{" data-end="};">
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno"><a class="line" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">  552</a></span><span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>{</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno"><a class="line" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2">  554</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2">TLS_HANDSHAKE_NOT_STARTED</a> = 0, </div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno"><a class="line" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a">  555</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a">TLS_HANDSHAKE_IN_PROGRESS</a> = 1, </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno"><a class="line" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">  556</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a> = 2,  </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno"><a class="line" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">  557</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a> = 3, </div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno"><a class="line" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">  558</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a> = 4, </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>  <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2">TLS_HANDSHAKE_ERROR</a> = 5     </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno"><a class="line" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2">  560</a></span>} <a class="code hl_enumeration" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>;</div>
</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span> </div>
<div class="foldopen" id="foldopen00662" data-start="{" data-end="};">
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno"><a class="line" href="group__security.html#gac32c3958835b92ff683ae15f78448694">  662</a></span><span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>{</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f">TLS_VERIFY_NONE</a></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno"><a class="line" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f">  665</a></span>  = 0, </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno"><a class="line" href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">  666</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a> = 1, </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">TLS_VERIFY_FAIL_IF_NO_PEER_CERT</a></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno"><a class="line" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">  668</a></span>  = 2, </div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183">TLS_VERIFY_CLIENT_ONCE</a></div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  = 4 </div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno"><a class="line" href="group__security.html#ggac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183">  671</a></span>} <a class="code hl_enumeration" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a>;</div>
</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span> </div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> *<a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>;</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span> </div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span><span class="comment">/* TLS socket operations */</span></div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno"><a class="line" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f">  713</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a> (Socket_T socket, <a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx);</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno"><a class="line" href="group__security.html#ga74a1bb762e089cf8333327270d355cd9">  762</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga74a1bb762e089cf8333327270d355cd9">SocketTLS_disable</a> (Socket_T socket);</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno"><a class="line" href="group__security.html#ga15d2c8f4eaea80114bbd2123da025e56">  779</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#ga15d2c8f4eaea80114bbd2123da025e56">SocketTLS_set_hostname</a> (Socket_T socket, <span class="keyword">const</span> <span class="keywordtype">char</span> *hostname);</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span> </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno"><a class="line" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454">  801</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> <a class="code hl_function" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a> (Socket_T socket);</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno"><a class="line" href="group__security.html#ga439248f2ff7b87470520de0607569d06">  829</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> <a class="code hl_function" href="group__security.html#ga439248f2ff7b87470520de0607569d06">SocketTLS_handshake_loop</a> (Socket_T socket,</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>                                                   <span class="keywordtype">int</span> timeout_ms);</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span> </div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno"><a class="line" href="group__security.html#ga40e9a3973a946e6ce5d5f89c3f400c74">  862</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> <a class="code hl_function" href="group__security.html#ga40e9a3973a946e6ce5d5f89c3f400c74">SocketTLS_handshake_loop_ex</a> (Socket_T socket,</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>                                                      <span class="keywordtype">int</span> timeout_ms,</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>                                                      <span class="keywordtype">int</span> poll_interval_ms);</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno"><a class="line" href="group__security.html#ga54a01327e253586278c0f740c2764010">  883</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> <a class="code hl_function" href="group__security.html#ga54a01327e253586278c0f740c2764010">SocketTLS_handshake_auto</a> (Socket_T socket);</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> </div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno"><a class="line" href="group__security.html#gab11506db6f41f31e9fc170b3d0e848f1">  920</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#gab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a> (Socket_T socket);</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno"><a class="line" href="group__security.html#ga90cac20743ff408f66c4454bbc0e1288">  960</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga90cac20743ff408f66c4454bbc0e1288">SocketTLS_shutdown_send</a> (Socket_T socket);</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span> </div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span><span class="comment">/* TLS I/O operations */</span></div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"><a class="line" href="group__security.html#gabdb38e692dde58bbec4ab905eeb8b3aa"> 1013</a></span><span class="keyword">extern</span> ssize_t <a class="code hl_function" href="group__security.html#gabdb38e692dde58bbec4ab905eeb8b3aa">SocketTLS_send</a> (Socket_T socket, <span class="keyword">const</span> <span class="keywordtype">void</span> *buf, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span> </div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"><a class="line" href="group__security.html#ga1c71fc02141cd9e6da4fdf1c88dbbaf3"> 1076</a></span><span class="keyword">extern</span> ssize_t <a class="code hl_function" href="group__security.html#ga1c71fc02141cd9e6da4fdf1c88dbbaf3">SocketTLS_recv</a> (Socket_T socket, <span class="keywordtype">void</span> *buf, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span> </div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span><span class="comment">/* TLS information */</span></div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"><a class="line" href="group__security.html#ga0859f0a6e05840bdc037c3765e22b7b1"> 1096</a></span><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="group__security.html#ga0859f0a6e05840bdc037c3765e22b7b1">SocketTLS_get_cipher</a> (Socket_T socket);</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span> </div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"><a class="line" href="group__security.html#gaef0f67021658d05419f1da479be2957e"> 1113</a></span><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="group__security.html#gaef0f67021658d05419f1da479be2957e">SocketTLS_get_version</a> (Socket_T socket);</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span> </div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"><a class="line" href="group__security.html#ga4fd56e743762151aa449744a8d574164"> 1136</a></span><span class="keyword">extern</span> <span class="keywordtype">long</span> <a class="code hl_function" href="group__security.html#ga4fd56e743762151aa449744a8d574164">SocketTLS_get_verify_result</a> (Socket_T socket);</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span> </div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"><a class="line" href="group__security.html#ga39a966c33421653c64f78261f24ee1f1"> 1159</a></span><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="group__security.html#ga39a966c33421653c64f78261f24ee1f1">SocketTLS_get_verify_error_string</a> (Socket_T socket,</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>                                                      <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> size);</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span> </div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"><a class="line" href="group__security.html#ga315ccceb9cb5b74d8b90f1439ce57344"> 1204</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga315ccceb9cb5b74d8b90f1439ce57344">SocketTLS_is_session_reused</a> (Socket_T socket);</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span> </div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"><a class="line" href="group__security.html#ga56acd283757bb0af4f4d59d3c0f218ea"> 1225</a></span><span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_function" href="group__security.html#ga56acd283757bb0af4f4d59d3c0f218ea">SocketTLS_get_alpn_selected</a> (Socket_T socket);</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span><span class="comment"> * TLS Session Management</span></div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span><span class="comment"> */</span></div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span> </div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"><a class="line" href="group__security.html#gab62e7185c08eb9459341471f56f400c5"> 1302</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#gab62e7185c08eb9459341471f56f400c5">SocketTLS_session_save</a> (Socket_T socket, <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buffer,</div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>                                   <span class="keywordtype">size_t</span> *len);</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span> </div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"><a class="line" href="group__security.html#ga134fb43e30e16e0061eb633384c1cfa9"> 1373</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga134fb43e30e16e0061eb633384c1cfa9">SocketTLS_session_restore</a> (Socket_T socket,</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buffer, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span> </div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span><span class="comment"> * TLS Renegotiation Control</span></div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span><span class="comment"> */</span></div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span> </div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"><a class="line" href="group__security.html#ga2cd8dfa27f0caeb2838b97fc2be1dd02"> 1400</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga2cd8dfa27f0caeb2838b97fc2be1dd02">SocketTLS_check_renegotiation</a> (Socket_T socket);</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span> </div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"><a class="line" href="group__security.html#gaee27dc7f30471a33200568801ee37900"> 1433</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#gaee27dc7f30471a33200568801ee37900">SocketTLS_disable_renegotiation</a> (Socket_T socket);</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span> </div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"><a class="line" href="group__security.html#ga6473e0077c17107f043a90236052b752"> 1467</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga6473e0077c17107f043a90236052b752">SocketTLS_get_renegotiation_count</a> (Socket_T socket);</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span> </div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span><span class="comment"> * TLS Certificate Information</span></div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span><span class="comment"> */</span></div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span> </div>
<div class="foldopen" id="foldopen01478" data-start="{" data-end="};">
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"><a class="line" href="group__security.html"> 1478</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code hl_struct" href="group__security.html#structSocketTLS__CertInfo">SocketTLS_CertInfo</a></div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>{</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"><a class="line" href="group__security.html#a95120f912765f1882556759a008dfb63"> 1480</a></span>  <span class="keywordtype">char</span> <a class="code hl_variable" href="group__security.html#a95120f912765f1882556759a008dfb63">subject</a>[256];   </div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"><a class="line" href="group__security.html#ae15a7a277b659924ef3de9abc7052605"> 1481</a></span>  <span class="keywordtype">char</span> <a class="code hl_variable" href="group__security.html#ae15a7a277b659924ef3de9abc7052605">issuer</a>[256];    </div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"><a class="line" href="group__security.html#a764ac9fb79e352bc67ee8414d43fa09f"> 1482</a></span>  time_t <a class="code hl_variable" href="group__security.html#a764ac9fb79e352bc67ee8414d43fa09f">not_before</a>;   </div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"><a class="line" href="group__security.html#a4175505d25b3b8f61d21f6a24fb1511a"> 1483</a></span>  time_t <a class="code hl_variable" href="group__security.html#a4175505d25b3b8f61d21f6a24fb1511a">not_after</a>;    </div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"><a class="line" href="group__security.html#a1549bb9bbc247c1e339f8e31f81b4d7e"> 1484</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__security.html#a1549bb9bbc247c1e339f8e31f81b4d7e">version</a>;         </div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"><a class="line" href="group__security.html#a71ea13a2841536a62bddb859d2a6e062"> 1485</a></span>  <span class="keywordtype">char</span> <a class="code hl_variable" href="group__security.html#a71ea13a2841536a62bddb859d2a6e062">serial</a>[64];     </div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"><a class="line" href="group__security.html#a2c9adae17f794b220866dbae246a4cdc"> 1486</a></span>  <span class="keywordtype">char</span> <a class="code hl_variable" href="group__security.html#a2c9adae17f794b220866dbae246a4cdc">fingerprint</a>[65]; </div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>} <a class="code hl_struct" href="group__security.html#structSocketTLS__CertInfo">SocketTLS_CertInfo</a>;</div>
</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span> </div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"><a class="line" href="group__security.html#gaaa422a6083ae2ec362780b294c95bf5f"> 1518</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#gaaa422a6083ae2ec362780b294c95bf5f">SocketTLS_get_peer_cert_info</a> (Socket_T socket,</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>                                         <a class="code hl_struct" href="group__security.html#structSocketTLS__CertInfo">SocketTLS_CertInfo</a> *info);</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span> </div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"><a class="line" href="group__security.html#ga0528a24494f1c78b3eebefdba52916de"> 1548</a></span><span class="keyword">extern</span> time_t <a class="code hl_function" href="group__security.html#ga0528a24494f1c78b3eebefdba52916de">SocketTLS_get_cert_expiry</a> (Socket_T socket);</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span> </div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"><a class="line" href="group__security.html#ga079fa7393dcf51155d5a6ecd7ddb58b8"> 1584</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga079fa7393dcf51155d5a6ecd7ddb58b8">SocketTLS_get_cert_subject</a> (Socket_T socket, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span> </div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"><a class="line" href="group__security.html#ga036de463b3bea3d488e2b30692b1bb48"> 1633</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga036de463b3bea3d488e2b30692b1bb48">SocketTLS_get_peer_cert_chain</a> (Socket_T socket, X509 ***chain_out,</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>                                          <span class="keywordtype">int</span> *chain_len);</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span> </div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span><span class="comment"> * OCSP Status (Client-side)</span></div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span><span class="comment"> */</span></div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span> </div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"><a class="line" href="group__security.html#gaf80f10ed221220a75e520733953ed58c"> 1694</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#gaf80f10ed221220a75e520733953ed58c">SocketTLS_get_ocsp_response_status</a> (Socket_T socket);</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span> </div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"><a class="line" href="group__security.html#ga986e153551070b7d855a82a8dfbdc655"> 1729</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga986e153551070b7d855a82a8dfbdc655">SocketTLS_get_ocsp_next_update</a> (Socket_T socket, time_t *next_update);</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span> </div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span><span class="comment"> * Kernel TLS (kTLS) Offload Support</span></div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span><span class="comment"> *</span></div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span><span class="comment"> * kTLS offloads TLS record encryption/decryption to the Linux kernel,</span></div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span><span class="comment"> * reducing context switches and improving performance for high-throughput</span></div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span><span class="comment"> * applications. When kTLS is active, SSL_write/SSL_read continue to work</span></div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span><span class="comment"> * normally - OpenSSL handles the kernel offload internally through its</span></div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span><span class="comment"> * BIO layer.</span></div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span><span class="comment"> *</span></div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span><span class="comment"> * ## Kernel Requirements</span></div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span><span class="comment"> *</span></div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span><span class="comment"> * | Feature | Minimum Kernel | Notes |</span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span><span class="comment"> * |---------|----------------|-------|</span></div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span><span class="comment"> * | TLS_TX (transmit offload) | Linux 4.13+ | send() uses kernel crypto |</span></div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span><span class="comment"> * | TLS_RX (receive offload) | Linux 4.17+ | recv() uses kernel crypto |</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span><span class="comment"> * | ChaCha20-Poly1305 | Linux 5.11+ | In addition to AES-GCM |</span></div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span><span class="comment"> * | CONFIG_TLS | Required | Kernel TLS module |</span></div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span><span class="comment"> *</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span><span class="comment"> * ## OpenSSL Requirements</span></div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span><span class="comment"> *</span></div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span><span class="comment"> * - OpenSSL 3.0+ compiled with `enable-ktls` option</span></div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span><span class="comment"> * - Check with: `openssl version -a | grep KTLS`</span></div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span><span class="comment"> * - At runtime: `#ifndef OPENSSL_NO_KTLS`</span></div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span><span class="comment"> *</span></div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span><span class="comment"> * ## Supported Cipher Suites</span></div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span><span class="comment"> *</span></div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span><span class="comment"> * | Cipher | kTLS Support | Notes |</span></div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span><span class="comment"> * |--------|--------------|-------|</span></div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span><span class="comment"> * | TLS_AES_128_GCM_SHA256 | Yes | Most widely supported |</span></div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span><span class="comment"> * | TLS_AES_256_GCM_SHA384 | Yes | Highest security |</span></div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span><span class="comment"> * | TLS_CHACHA20_POLY1305_SHA256 | Linux 5.11+ | ARM-friendly |</span></div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span><span class="comment"> *</span></div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span><span class="comment"> * ## Performance Characteristics</span></div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span><span class="comment"> *</span></div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span><span class="comment"> * - **Reduced syscalls**: Single syscall vs user/kernel copies per record</span></div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span><span class="comment"> * - **Zero-copy sendfile**: SSL_sendfile() for file transfers when TX active</span></div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span><span class="comment"> * - **CPU savings**: 10-30% reduction in TLS overhead on supported hardware</span></div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span><span class="comment"> * - **Best for**: High-throughput bulk transfers (file serving, streaming)</span></div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span><span class="comment"> *</span></div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span><span class="comment"> * ## Usage Example</span></div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span><span class="comment"> *</span></div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span><span class="comment"> * @code{.c}</span></div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span><span class="comment"> * // Check system support first</span></div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span><span class="comment"> * if (SocketTLS_ktls_available()) {</span></div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span><span class="comment"> *     printf(&quot;kTLS is available on this system\n&quot;);</span></div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span><span class="comment"> * }</span></div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span><span class="comment"> *</span></div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span><span class="comment"> * // Enable kTLS before handshake</span></div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span><span class="comment"> * Socket_T sock = Socket_new(AF_INET, SOCK_STREAM, 0);</span></div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span><span class="comment"> * Socket_connect(sock, &quot;example.com&quot;, 443);</span></div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span><span class="comment"> *</span></div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span><span class="comment"> * SocketTLSContext_T ctx = SocketTLSContext_new_client(NULL);</span></div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span><span class="comment"> * SocketTLS_enable(sock, ctx);</span></div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span><span class="comment"> * SocketTLS_enable_ktls(sock);  // Request kTLS offload</span></div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span><span class="comment"> * SocketTLS_set_hostname(sock, &quot;example.com&quot;);</span></div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span><span class="comment"> *</span></div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span><span class="comment"> * // Handshake - kTLS activated automatically if possible</span></div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span><span class="comment"> * SocketTLS_handshake_auto(sock);</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span><span class="comment"> *</span></div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span><span class="comment"> * // Check what was activated</span></div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span><span class="comment"> * if (SocketTLS_is_ktls_tx_active(sock)) {</span></div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span><span class="comment"> *     printf(&quot;TX offload active - using kernel encryption\n&quot;);</span></div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span><span class="comment"> * }</span></div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span><span class="comment"> * if (SocketTLS_is_ktls_rx_active(sock)) {</span></div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span><span class="comment"> *     printf(&quot;RX offload active - using kernel decryption\n&quot;);</span></div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span><span class="comment"> * }</span></div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span><span class="comment"> *</span></div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span><span class="comment"> * // I/O works normally - OpenSSL uses kernel internally</span></div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span><span class="comment"> * SocketTLS_send(sock, data, len);</span></div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span><span class="comment"> * SocketTLS_recv(sock, buf, sizeof(buf));</span></div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span><span class="comment"> *</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span><span class="comment"> * // Zero-copy file transfer when TX offload active</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span><span class="comment"> * if (SocketTLS_is_ktls_tx_active(sock)) {</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span><span class="comment"> *     SocketTLS_sendfile(sock, file_fd, 0, file_size);</span></div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span><span class="comment"> * }</span></div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span><span class="comment"> * @endcode</span></div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span><span class="comment"> *</span></div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span><span class="comment"> * @note kTLS is opportunistic - falls back to userspace if unavailable</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span><span class="comment"> * @warning kTLS does not support TLS renegotiation (TLS 1.2 only)</span></div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span><span class="comment"> * @warning kTLS may not work with all OpenSSL features (e.g., custom BIOs)</span></div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span><span class="comment"> */</span></div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span> </div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"><a class="line" href="group__security.html#ga8a2bd7705b963e0fab06b8c8fe8a9b0f"> 1848</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga8a2bd7705b963e0fab06b8c8fe8a9b0f">SocketTLS_ktls_available</a> (<span class="keywordtype">void</span>);</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span> </div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"><a class="line" href="group__security.html#ga9ef3eb8241b6fdc4c7c6d3342c6a08b2"> 1902</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#ga9ef3eb8241b6fdc4c7c6d3342c6a08b2">SocketTLS_enable_ktls</a> (Socket_T socket);</div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span> </div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"><a class="line" href="group__security.html#ga880f640ae9470a406e16e8241a598bde"> 1939</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga880f640ae9470a406e16e8241a598bde">SocketTLS_is_ktls_tx_active</a> (Socket_T socket);</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span> </div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"><a class="line" href="group__security.html#ga71d422e71f229101bf77dbf163b87c34"> 1965</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga71d422e71f229101bf77dbf163b87c34">SocketTLS_is_ktls_rx_active</a> (Socket_T socket);</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span> </div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"><a class="line" href="group__security.html#ga2493a265fcd1f0e43f4cfea93605763c"> 2030</a></span><span class="keyword">extern</span> ssize_t <a class="code hl_function" href="group__security.html#ga2493a265fcd1f0e43f4cfea93605763c">SocketTLS_sendfile</a> (Socket_T socket, <span class="keywordtype">int</span> file_fd, off_t offset,</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>                                   <span class="keywordtype">size_t</span> size);</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span> </div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span><span class="comment"> * TLS Performance Optimizations</span></div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span><span class="comment"> *</span></div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span><span class="comment"> * These functions provide performance optimizations for TLS connections:</span></div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span><span class="comment"> * - TCP tuning for handshake latency reduction</span></div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span><span class="comment"> * - TLS 1.3 0-RTT early data support</span></div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span><span class="comment"> * - Session cache sharding for multi-threaded servers</span></div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span><span class="comment"> * - Buffer pooling for high-connection scenarios</span></div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span><span class="comment"> */</span></div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span> </div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"><a class="line" href="group__security.html#ga71e0d481463feccca934f2fa3329f7d5"> 2073</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga71e0d481463feccca934f2fa3329f7d5">SocketTLS_optimize_handshake</a> (Socket_T socket);</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span> </div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"><a class="line" href="group__security.html#ga69800cce36b9b5d42d4f12d9f80d8d02"> 2094</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga69800cce36b9b5d42d4f12d9f80d8d02">SocketTLS_restore_tcp_defaults</a> (Socket_T socket);</div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span> </div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span><span class="comment"> * TLS 1.3 0-RTT Early Data Support</span></div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span><span class="comment"> *</span></div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span><span class="comment"> * 0-RTT (Zero Round Trip Time) allows sending data in the first handshake</span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span><span class="comment"> * flight, reducing latency by one RTT. Available in TLS 1.3 with session</span></div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span><span class="comment"> * resumption.</span></div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span><span class="comment"> *</span></div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span><span class="comment"> * ## Security Warning</span></div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span><span class="comment"> *</span></div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span><span class="comment"> * Early data is NOT replay-protected by the TLS protocol. Applications MUST:</span></div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span><span class="comment"> * - Only use early data for idempotent operations (GET, not POST)</span></div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span><span class="comment"> * - Implement application-level replay detection</span></div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span><span class="comment"> * - Never include sensitive state-changing operations</span></div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span><span class="comment"> *</span></div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span><span class="comment"> * ## Recommended Use Cases</span></div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span><span class="comment"> * - HTTP GET requests</span></div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span><span class="comment"> * - DNS queries</span></div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span><span class="comment"> * - Heartbeat/ping messages</span></div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span><span class="comment"> *</span></div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span><span class="comment"> * ## NOT Recommended For</span></div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span><span class="comment"> * - POST requests that modify state</span></div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span><span class="comment"> * - Financial transactions</span></div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span><span class="comment"> * - Any non-idempotent operation</span></div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span><span class="comment"> */</span></div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span> </div>
<div class="foldopen" id="foldopen02126" data-start="{" data-end="};">
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"><a class="line" href="group__security.html#gae3e3dd2318b86ecc13a06c313f904036"> 2126</a></span><span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>{</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"><a class="line" href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036a0cc57f9add21f7c9427934e61e371073"> 2128</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036a0cc57f9add21f7c9427934e61e371073">SOCKET_EARLY_DATA_NOT_SENT</a> = 0, </div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"><a class="line" href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036add3155f3f8b945959b83617f25d1afa9"> 2129</a></span>  <a class="code hl_enumvalue" href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036add3155f3f8b945959b83617f25d1afa9">SOCKET_EARLY_DATA_ACCEPTED</a> = 1, </div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>  <a class="code hl_enumvalue" href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036a75d8ab4ba515e850a849878edcad3ab6">SOCKET_EARLY_DATA_REJECTED</a> = 2  </div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"><a class="line" href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036a75d8ab4ba515e850a849878edcad3ab6"> 2131</a></span>} <a class="code hl_enumeration" href="group__security.html#gae3e3dd2318b86ecc13a06c313f904036">SocketTLS_EarlyDataStatus</a>;</div>
</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span> </div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"><a class="line" href="group__security.html#gae0eac9b1e7ec32b5c16b71ca3eda8aa7"> 2152</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#gae0eac9b1e7ec32b5c16b71ca3eda8aa7">SocketTLSContext_enable_early_data</a> (<a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx,</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>                                                uint32_t max_early_data);</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span> </div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"><a class="line" href="group__security.html#ga48079c3c69fe7d5ef8a38fa06b404565"> 2165</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#ga48079c3c69fe7d5ef8a38fa06b404565">SocketTLSContext_disable_early_data</a> (<a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx);</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span> </div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"><a class="line" href="group__security.html#ga09bf446253c6bd2d11fbaf960760bd1d"> 2212</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga09bf446253c6bd2d11fbaf960760bd1d">SocketTLS_write_early_data</a> (Socket_T socket, <span class="keyword">const</span> <span class="keywordtype">void</span> *buf,</div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>                                       <span class="keywordtype">size_t</span> len, <span class="keywordtype">size_t</span> *written);</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span> </div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"><a class="line" href="group__security.html#ga14bb384b23f08c49d900d3a4a7a092d2"> 2239</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga14bb384b23f08c49d900d3a4a7a092d2">SocketTLS_read_early_data</a> (Socket_T socket, <span class="keywordtype">void</span> *buf, <span class="keywordtype">size_t</span> len,</div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span>                                      <span class="keywordtype">size_t</span> *readbytes);</div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span> </div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"><a class="line" href="group__security.html#gae117c11e5036d03dac93b9634e1b7fad"> 2259</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__security.html#gae3e3dd2318b86ecc13a06c313f904036">SocketTLS_EarlyDataStatus</a> <a class="code hl_function" href="group__security.html#gae117c11e5036d03dac93b9634e1b7fad">SocketTLS_get_early_data_status</a> (Socket_T socket);</div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span> </div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span><span class="comment"> * TLS 1.3 KeyUpdate Support</span></div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span><span class="comment"> *</span></div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span><span class="comment"> * TLS 1.3 replaces renegotiation with KeyUpdate, a lightweight mechanism to</span></div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span><span class="comment"> * rotate encryption keys without a full handshake. This provides forward</span></div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span><span class="comment"> * secrecy for long-lived connections.</span></div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span><span class="comment"> *</span></div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span><span class="comment"> * ## Use Cases</span></div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span><span class="comment"> *</span></div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span><span class="comment"> * - Long-lived database connections</span></div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span><span class="comment"> * - VPN tunnels</span></div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span><span class="comment"> * - Persistent WebSocket connections</span></div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span><span class="comment"> * - Any connection open for hours/days</span></div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span><span class="comment"> *</span></div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span><span class="comment"> * ## Comparison to Renegotiation</span></div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span><span class="comment"> *</span></div>
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"> 2278</span><span class="comment"> * | Aspect | KeyUpdate (TLS 1.3) | Renegotiation (TLS 1.2) |</span></div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span><span class="comment"> * |--------|---------------------|-------------------------|</span></div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span><span class="comment"> * | Overhead | Very light | Full handshake |</span></div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span><span class="comment"> * | Cert change | No | Yes |</span></div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span><span class="comment"> * | Cipher change | No | Yes |</span></div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span><span class="comment"> * | Security | Forward secrecy | Vulnerable to attacks |</span></div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span><span class="comment"> *</span></div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span><span class="comment"> * ## Recommended Usage</span></div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span><span class="comment"> *</span></div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span><span class="comment"> * For connections lasting hours or processing large data volumes, call</span></div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span><span class="comment"> * SocketTLS_request_key_update() periodically (e.g., every hour or every</span></div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span><span class="comment"> * 1GB of data transferred) to maintain forward secrecy.</span></div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span><span class="comment"> */</span></div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span> </div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"><a class="line" href="group__security.html#ga0e70857dbb81f8283271d646e5f99ccd"> 2332</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga0e70857dbb81f8283271d646e5f99ccd">SocketTLS_request_key_update</a> (Socket_T socket, <span class="keywordtype">int</span> request_peer_update);</div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span> </div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"><a class="line" href="group__security.html#ga73b441cd53ec38946b9578b028346c5d"> 2349</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__security.html#ga73b441cd53ec38946b9578b028346c5d">SocketTLS_get_key_update_count</a> (Socket_T socket);</div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span> </div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span><span class="comment"> * Session Cache Optimization</span></div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span><span class="comment"> */</span></div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span> </div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"><a class="line" href="group__security.html#gaf0c6c0a454f2ce22995ebc1d7c0a059a"> 2372</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#gaf0c6c0a454f2ce22995ebc1d7c0a059a">SocketTLSContext_create_sharded_cache</a> (<a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx,</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>                                                   <span class="keywordtype">size_t</span> num_shards,</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>                                                   <span class="keywordtype">size_t</span> sessions_per_shard,</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span>                                                   <span class="keywordtype">long</span> timeout_seconds);</div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span> </div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"><a class="line" href="group__security.html#ga2704ab07ded459ba4f4ddc80434c1c8b"> 2387</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#ga2704ab07ded459ba4f4ddc80434c1c8b">SocketTLSContext_get_sharded_stats</a> (<a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx,</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>                                                <span class="keywordtype">size_t</span> *total_hits,</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>                                                <span class="keywordtype">size_t</span> *total_misses,</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>                                                <span class="keywordtype">size_t</span> *total_stores);</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span> </div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span><span class="comment"> * TLS Buffer Pool for High-Connection Scenarios</span></div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span><span class="comment"> *</span></div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span><span class="comment"> * Pre-allocated buffer pool for servers with thousands of concurrent TLS</span></div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span><span class="comment"> * connections. Reduces allocation overhead and memory fragmentation.</span></div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span><span class="comment"> */</span></div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span> </div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"><a class="line" href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264"> 2404</a></span><span class="keyword">typedef</span> <span class="keyword">struct </span>TLSBufferPool *<a class="code hl_typedef" href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264">TLSBufferPool_T</a>;</div>
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"> 2405</span> </div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"><a class="line" href="group__security.html#ga25bcad5bf0a2f665af35252c53ea2cac"> 2420</a></span><span class="keyword">extern</span> <a class="code hl_typedef" href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264">TLSBufferPool_T</a> <a class="code hl_function" href="group__security.html#ga25bcad5bf0a2f665af35252c53ea2cac">TLSBufferPool_new</a> (<span class="keywordtype">size_t</span> buffer_size, <span class="keywordtype">size_t</span> num_buffers,</div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span>                                          <a class="code hl_typedef" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> arena);</div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span> </div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"><a class="line" href="group__security.html#gad6d3b0c2f78bcb3036d0f9768f0b49ce"> 2432</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> *<a class="code hl_function" href="group__security.html#gad6d3b0c2f78bcb3036d0f9768f0b49ce">TLSBufferPool_acquire</a> (<a class="code hl_typedef" href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264">TLSBufferPool_T</a> pool);</div>
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"> 2433</span> </div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"><a class="line" href="group__security.html#gaa1a501e54dbdd4c6571ea6dfe812d7d2"> 2445</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#gaa1a501e54dbdd4c6571ea6dfe812d7d2">TLSBufferPool_release</a> (<a class="code hl_typedef" href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264">TLSBufferPool_T</a> pool, <span class="keywordtype">void</span> *buffer);</div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span> </div>
<div class="line"><a id="l02457" name="l02457"></a><span class="lineno"><a class="line" href="group__security.html#gaef2687535edbb23a7d323630f604a706"> 2457</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#gaef2687535edbb23a7d323630f604a706">TLSBufferPool_stats</a> (<a class="code hl_typedef" href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264">TLSBufferPool_T</a> pool, <span class="keywordtype">size_t</span> *total,</div>
<div class="line"><a id="l02458" name="l02458"></a><span class="lineno"> 2458</span>                                 <span class="keywordtype">size_t</span> *in_use, <span class="keywordtype">size_t</span> *available);</div>
<div class="line"><a id="l02459" name="l02459"></a><span class="lineno"> 2459</span> </div>
<div class="line"><a id="l02467" name="l02467"></a><span class="lineno"><a class="line" href="group__security.html#gaf826f5816d9f95a88393cd7f0eae1fa5"> 2467</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__security.html#gaf826f5816d9f95a88393cd7f0eae1fa5">TLSBufferPool_free</a> (<a class="code hl_typedef" href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264">TLSBufferPool_T</a> *pool);</div>
<div class="line"><a id="l02468" name="l02468"></a><span class="lineno"> 2468</span> </div>
<div class="line"><a id="l02469" name="l02469"></a><span class="lineno"> 2469</span><span class="preprocessor">#undef T</span></div>
<div class="line"><a id="l02470" name="l02470"></a><span class="lineno"> 2470</span> </div>
 <span class="comment">/* end of security group */</span><div class="line"><a id="l02472" name="l02472"></a><span class="lineno"> 2472</span> </div>
<div class="line"><a id="l02473" name="l02473"></a><span class="lineno"> 2473</span><span class="preprocessor">#endif </span><span class="comment">/* SOCKET_HAS_TLS */</span><span class="preprocessor"></span></div>
<div class="line"><a id="l02474" name="l02474"></a><span class="lineno"> 2474</span> </div>
<div class="line"><a id="l02475" name="l02475"></a><span class="lineno"> 2475</span><span class="preprocessor">#endif </span><span class="comment">/* SOCKETTLS_INCLUDED */</span><span class="preprocessor"></span></div>
<div class="ttc" id="aExcept_8h_html"><div class="ttname"><a href="Except_8h.html">Except.h</a></div><div class="ttdoc">Structured exception handling for C with TRY/EXCEPT/FINALLY blocks.</div></div>
<div class="ttc" id="aSocket_8h_html"><div class="ttname"><a href="Socket_8h.html">Socket.h</a></div><div class="ttdoc">High-level TCP/IP and Unix domain socket interface.</div></div>
<div class="ttc" id="agroup__foundation_html_gac1ed22b9df4eff7a3398cac608c090cc"><div class="ttname"><a href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a></div><div class="ttdeci">struct Arena_T * Arena_T</div><div class="ttdef"><b>Definition</b> <a href="Arena_8h_source.html#l00080">Arena.h:80</a></div></div>
<div class="ttc" id="agroup__foundation_html_structExcept__T"><div class="ttname"><a href="group__foundation.html#structExcept__T">Except_T</a></div><div class="ttdoc">Exception structure for structured error handling.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00216">Except.h:217</a></div></div>
<div class="ttc" id="agroup__security_html_a1549bb9bbc247c1e339f8e31f81b4d7e"><div class="ttname"><a href="group__security.html#a1549bb9bbc247c1e339f8e31f81b4d7e">SocketTLS_CertInfo::version</a></div><div class="ttdeci">int version</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01484">SocketTLS.h:1484</a></div></div>
<div class="ttc" id="agroup__security_html_a2c9adae17f794b220866dbae246a4cdc"><div class="ttname"><a href="group__security.html#a2c9adae17f794b220866dbae246a4cdc">SocketTLS_CertInfo::fingerprint</a></div><div class="ttdeci">char fingerprint[65]</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01486">SocketTLS.h:1486</a></div></div>
<div class="ttc" id="agroup__security_html_a4175505d25b3b8f61d21f6a24fb1511a"><div class="ttname"><a href="group__security.html#a4175505d25b3b8f61d21f6a24fb1511a">SocketTLS_CertInfo::not_after</a></div><div class="ttdeci">time_t not_after</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01483">SocketTLS.h:1483</a></div></div>
<div class="ttc" id="agroup__security_html_a71ea13a2841536a62bddb859d2a6e062"><div class="ttname"><a href="group__security.html#a71ea13a2841536a62bddb859d2a6e062">SocketTLS_CertInfo::serial</a></div><div class="ttdeci">char serial[64]</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01485">SocketTLS.h:1485</a></div></div>
<div class="ttc" id="agroup__security_html_a764ac9fb79e352bc67ee8414d43fa09f"><div class="ttname"><a href="group__security.html#a764ac9fb79e352bc67ee8414d43fa09f">SocketTLS_CertInfo::not_before</a></div><div class="ttdeci">time_t not_before</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01482">SocketTLS.h:1482</a></div></div>
<div class="ttc" id="agroup__security_html_a95120f912765f1882556759a008dfb63"><div class="ttname"><a href="group__security.html#a95120f912765f1882556759a008dfb63">SocketTLS_CertInfo::subject</a></div><div class="ttdeci">char subject[256]</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01480">SocketTLS.h:1480</a></div></div>
<div class="ttc" id="agroup__security_html_ae15a7a277b659924ef3de9abc7052605"><div class="ttname"><a href="group__security.html#ae15a7a277b659924ef3de9abc7052605">SocketTLS_CertInfo::issuer</a></div><div class="ttdeci">char issuer[256]</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01481">SocketTLS.h:1481</a></div></div>
<div class="ttc" id="agroup__security_html_ga036de463b3bea3d488e2b30692b1bb48"><div class="ttname"><a href="group__security.html#ga036de463b3bea3d488e2b30692b1bb48">SocketTLS_get_peer_cert_chain</a></div><div class="ttdeci">int SocketTLS_get_peer_cert_chain(Socket_T socket, X509 ***chain_out, int *chain_len)</div><div class="ttdoc">Get the full peer certificate chain.</div></div>
<div class="ttc" id="agroup__security_html_ga0528a24494f1c78b3eebefdba52916de"><div class="ttname"><a href="group__security.html#ga0528a24494f1c78b3eebefdba52916de">SocketTLS_get_cert_expiry</a></div><div class="ttdeci">time_t SocketTLS_get_cert_expiry(Socket_T socket)</div><div class="ttdoc">Get peer certificate expiration time.</div></div>
<div class="ttc" id="agroup__security_html_ga079fa7393dcf51155d5a6ecd7ddb58b8"><div class="ttname"><a href="group__security.html#ga079fa7393dcf51155d5a6ecd7ddb58b8">SocketTLS_get_cert_subject</a></div><div class="ttdeci">int SocketTLS_get_cert_subject(Socket_T socket, char *buf, size_t len)</div><div class="ttdoc">Get peer certificate subject string.</div></div>
<div class="ttc" id="agroup__security_html_ga0859f0a6e05840bdc037c3765e22b7b1"><div class="ttname"><a href="group__security.html#ga0859f0a6e05840bdc037c3765e22b7b1">SocketTLS_get_cipher</a></div><div class="ttdeci">const char * SocketTLS_get_cipher(Socket_T socket)</div><div class="ttdoc">Get negotiated cipher suite name.</div></div>
<div class="ttc" id="agroup__security_html_ga09bf446253c6bd2d11fbaf960760bd1d"><div class="ttname"><a href="group__security.html#ga09bf446253c6bd2d11fbaf960760bd1d">SocketTLS_write_early_data</a></div><div class="ttdeci">int SocketTLS_write_early_data(Socket_T socket, const void *buf, size_t len, size_t *written)</div><div class="ttdoc">Send early data during TLS 1.3 handshake (client)</div></div>
<div class="ttc" id="agroup__security_html_ga0acb682b8260ab1c60b918599864e2e5"><div class="ttname"><a href="group__security.html#ga0acb682b8260ab1c60b918599864e2e5">T</a></div><div class="ttdeci">#define T</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00358">SocketTLS.h:358</a></div></div>
<div class="ttc" id="agroup__security_html_ga0e70857dbb81f8283271d646e5f99ccd"><div class="ttname"><a href="group__security.html#ga0e70857dbb81f8283271d646e5f99ccd">SocketTLS_request_key_update</a></div><div class="ttdeci">int SocketTLS_request_key_update(Socket_T socket, int request_peer_update)</div><div class="ttdoc">Request TLS 1.3 key rotation.</div></div>
<div class="ttc" id="agroup__security_html_ga134fb43e30e16e0061eb633384c1cfa9"><div class="ttname"><a href="group__security.html#ga134fb43e30e16e0061eb633384c1cfa9">SocketTLS_session_restore</a></div><div class="ttdeci">int SocketTLS_session_restore(Socket_T socket, const unsigned char *buffer, size_t len)</div><div class="ttdoc">Import previously saved TLS session for resumption.</div></div>
<div class="ttc" id="agroup__security_html_ga14bb384b23f08c49d900d3a4a7a092d2"><div class="ttname"><a href="group__security.html#ga14bb384b23f08c49d900d3a4a7a092d2">SocketTLS_read_early_data</a></div><div class="ttdeci">int SocketTLS_read_early_data(Socket_T socket, void *buf, size_t len, size_t *readbytes)</div><div class="ttdoc">Receive early data during TLS 1.3 handshake (server)</div></div>
<div class="ttc" id="agroup__security_html_ga15d2c8f4eaea80114bbd2123da025e56"><div class="ttname"><a href="group__security.html#ga15d2c8f4eaea80114bbd2123da025e56">SocketTLS_set_hostname</a></div><div class="ttdeci">void SocketTLS_set_hostname(Socket_T socket, const char *hostname)</div><div class="ttdoc">Set SNI hostname for client TLS connections.</div></div>
<div class="ttc" id="agroup__security_html_ga1c71fc02141cd9e6da4fdf1c88dbbaf3"><div class="ttname"><a href="group__security.html#ga1c71fc02141cd9e6da4fdf1c88dbbaf3">SocketTLS_recv</a></div><div class="ttdeci">ssize_t SocketTLS_recv(Socket_T socket, void *buf, size_t len)</div><div class="ttdoc">Receive data from TLS-encrypted connection.</div></div>
<div class="ttc" id="agroup__security_html_ga2493a265fcd1f0e43f4cfea93605763c"><div class="ttname"><a href="group__security.html#ga2493a265fcd1f0e43f4cfea93605763c">SocketTLS_sendfile</a></div><div class="ttdeci">ssize_t SocketTLS_sendfile(Socket_T socket, int file_fd, off_t offset, size_t size)</div><div class="ttdoc">Send file data over TLS using zero-copy when kTLS TX is active.</div></div>
<div class="ttc" id="agroup__security_html_ga25bcad5bf0a2f665af35252c53ea2cac"><div class="ttname"><a href="group__security.html#ga25bcad5bf0a2f665af35252c53ea2cac">TLSBufferPool_new</a></div><div class="ttdeci">TLSBufferPool_T TLSBufferPool_new(size_t buffer_size, size_t num_buffers, Arena_T arena)</div><div class="ttdoc">Create a TLS buffer pool.</div></div>
<div class="ttc" id="agroup__security_html_ga2704ab07ded459ba4f4ddc80434c1c8b"><div class="ttname"><a href="group__security.html#ga2704ab07ded459ba4f4ddc80434c1c8b">SocketTLSContext_get_sharded_stats</a></div><div class="ttdeci">void SocketTLSContext_get_sharded_stats(SocketTLSContext_T ctx, size_t *total_hits, size_t *total_misses, size_t *total_stores)</div><div class="ttdoc">Get aggregate statistics from sharded session cache.</div></div>
<div class="ttc" id="agroup__security_html_ga2cd8dfa27f0caeb2838b97fc2be1dd02"><div class="ttname"><a href="group__security.html#ga2cd8dfa27f0caeb2838b97fc2be1dd02">SocketTLS_check_renegotiation</a></div><div class="ttdeci">int SocketTLS_check_renegotiation(Socket_T socket)</div><div class="ttdoc">Check for and process pending renegotiation.</div></div>
<div class="ttc" id="agroup__security_html_ga315ccceb9cb5b74d8b90f1439ce57344"><div class="ttname"><a href="group__security.html#ga315ccceb9cb5b74d8b90f1439ce57344">SocketTLS_is_session_reused</a></div><div class="ttdeci">int SocketTLS_is_session_reused(Socket_T socket)</div><div class="ttdoc">Check if TLS session was resumed.</div></div>
<div class="ttc" id="agroup__security_html_ga39a966c33421653c64f78261f24ee1f1"><div class="ttname"><a href="group__security.html#ga39a966c33421653c64f78261f24ee1f1">SocketTLS_get_verify_error_string</a></div><div class="ttdeci">const char * SocketTLS_get_verify_error_string(Socket_T socket, char *buf, size_t size)</div><div class="ttdoc">Get detailed verification error string.</div></div>
<div class="ttc" id="agroup__security_html_ga40e9a3973a946e6ce5d5f89c3f400c74"><div class="ttname"><a href="group__security.html#ga40e9a3973a946e6ce5d5f89c3f400c74">SocketTLS_handshake_loop_ex</a></div><div class="ttdeci">TLSHandshakeState SocketTLS_handshake_loop_ex(Socket_T socket, int timeout_ms, int poll_interval_ms)</div><div class="ttdoc">Complete handshake with timeout and configurable poll interval.</div></div>
<div class="ttc" id="agroup__security_html_ga439248f2ff7b87470520de0607569d06"><div class="ttname"><a href="group__security.html#ga439248f2ff7b87470520de0607569d06">SocketTLS_handshake_loop</a></div><div class="ttdeci">TLSHandshakeState SocketTLS_handshake_loop(Socket_T socket, int timeout_ms)</div><div class="ttdoc">Complete handshake with timeout (non-blocking)</div></div>
<div class="ttc" id="agroup__security_html_ga48079c3c69fe7d5ef8a38fa06b404565"><div class="ttname"><a href="group__security.html#ga48079c3c69fe7d5ef8a38fa06b404565">SocketTLSContext_disable_early_data</a></div><div class="ttdeci">void SocketTLSContext_disable_early_data(SocketTLSContext_T ctx)</div><div class="ttdoc">Disable TLS 1.3 0-RTT early data.</div></div>
<div class="ttc" id="agroup__security_html_ga4fd56e743762151aa449744a8d574164"><div class="ttname"><a href="group__security.html#ga4fd56e743762151aa449744a8d574164">SocketTLS_get_verify_result</a></div><div class="ttdeci">long SocketTLS_get_verify_result(Socket_T socket)</div><div class="ttdoc">Get peer certificate verification result.</div></div>
<div class="ttc" id="agroup__security_html_ga54a01327e253586278c0f740c2764010"><div class="ttname"><a href="group__security.html#ga54a01327e253586278c0f740c2764010">SocketTLS_handshake_auto</a></div><div class="ttdeci">TLSHandshakeState SocketTLS_handshake_auto(Socket_T socket)</div><div class="ttdoc">Complete handshake using socket's timeout config.</div></div>
<div class="ttc" id="agroup__security_html_ga56acd283757bb0af4f4d59d3c0f218ea"><div class="ttname"><a href="group__security.html#ga56acd283757bb0af4f4d59d3c0f218ea">SocketTLS_get_alpn_selected</a></div><div class="ttdeci">const char * SocketTLS_get_alpn_selected(Socket_T socket)</div><div class="ttdoc">Get the negotiated ALPN protocol.</div></div>
<div class="ttc" id="agroup__security_html_ga6473e0077c17107f043a90236052b752"><div class="ttname"><a href="group__security.html#ga6473e0077c17107f043a90236052b752">SocketTLS_get_renegotiation_count</a></div><div class="ttdeci">int SocketTLS_get_renegotiation_count(Socket_T socket)</div><div class="ttdoc">Get the number of renegotiations processed on this socket.</div></div>
<div class="ttc" id="agroup__security_html_ga69800cce36b9b5d42d4f12d9f80d8d02"><div class="ttname"><a href="group__security.html#ga69800cce36b9b5d42d4f12d9f80d8d02">SocketTLS_restore_tcp_defaults</a></div><div class="ttdeci">int SocketTLS_restore_tcp_defaults(Socket_T socket)</div><div class="ttdoc">Restore TCP settings after handshake for bulk transfers.</div></div>
<div class="ttc" id="agroup__security_html_ga71d422e71f229101bf77dbf163b87c34"><div class="ttname"><a href="group__security.html#ga71d422e71f229101bf77dbf163b87c34">SocketTLS_is_ktls_rx_active</a></div><div class="ttdeci">int SocketTLS_is_ktls_rx_active(Socket_T socket)</div><div class="ttdoc">Check if kTLS RX (receive) offload is active.</div></div>
<div class="ttc" id="agroup__security_html_ga71e0d481463feccca934f2fa3329f7d5"><div class="ttname"><a href="group__security.html#ga71e0d481463feccca934f2fa3329f7d5">SocketTLS_optimize_handshake</a></div><div class="ttdeci">int SocketTLS_optimize_handshake(Socket_T socket)</div><div class="ttdoc">Optimize TCP settings for faster TLS handshake.</div></div>
<div class="ttc" id="agroup__security_html_ga73b441cd53ec38946b9578b028346c5d"><div class="ttname"><a href="group__security.html#ga73b441cd53ec38946b9578b028346c5d">SocketTLS_get_key_update_count</a></div><div class="ttdeci">int SocketTLS_get_key_update_count(Socket_T socket)</div><div class="ttdoc">Get number of KeyUpdate operations performed.</div></div>
<div class="ttc" id="agroup__security_html_ga74a1bb762e089cf8333327270d355cd9"><div class="ttname"><a href="group__security.html#ga74a1bb762e089cf8333327270d355cd9">SocketTLS_disable</a></div><div class="ttdeci">int SocketTLS_disable(Socket_T socket)</div><div class="ttdoc">Disable TLS on a socket, reverting to plain TCP communication.</div></div>
<div class="ttc" id="agroup__security_html_ga82be75dd764021fb64cd6824768e2254"><div class="ttname"><a href="group__security.html#ga82be75dd764021fb64cd6824768e2254">SocketTLS_HandshakeFailed</a></div><div class="ttdeci">const Except_T SocketTLS_HandshakeFailed</div><div class="ttdoc">TLS handshake could not complete.</div></div>
<div class="ttc" id="agroup__security_html_ga880f640ae9470a406e16e8241a598bde"><div class="ttname"><a href="group__security.html#ga880f640ae9470a406e16e8241a598bde">SocketTLS_is_ktls_tx_active</a></div><div class="ttdeci">int SocketTLS_is_ktls_tx_active(Socket_T socket)</div><div class="ttdoc">Check if kTLS TX (transmit) offload is active.</div></div>
<div class="ttc" id="agroup__security_html_ga8a2bd7705b963e0fab06b8c8fe8a9b0f"><div class="ttname"><a href="group__security.html#ga8a2bd7705b963e0fab06b8c8fe8a9b0f">SocketTLS_ktls_available</a></div><div class="ttdeci">int SocketTLS_ktls_available(void)</div><div class="ttdoc">Check if kTLS support is available on this system.</div></div>
<div class="ttc" id="agroup__security_html_ga8ca0182ebb7a93df98871664989b949b"><div class="ttname"><a href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a></div><div class="ttdeci">char tls_error_buf[]</div><div class="ttdoc">Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.</div></div>
<div class="ttc" id="agroup__security_html_ga90cac20743ff408f66c4454bbc0e1288"><div class="ttname"><a href="group__security.html#ga90cac20743ff408f66c4454bbc0e1288">SocketTLS_shutdown_send</a></div><div class="ttdeci">int SocketTLS_shutdown_send(Socket_T socket)</div><div class="ttdoc">Send close_notify without waiting for peer response (half-close)</div></div>
<div class="ttc" id="agroup__security_html_ga986e153551070b7d855a82a8dfbdc655"><div class="ttname"><a href="group__security.html#ga986e153551070b7d855a82a8dfbdc655">SocketTLS_get_ocsp_next_update</a></div><div class="ttdeci">int SocketTLS_get_ocsp_next_update(Socket_T socket, time_t *next_update)</div><div class="ttdoc">Get the nextUpdate time from the OCSP response.</div></div>
<div class="ttc" id="agroup__security_html_ga9ef3eb8241b6fdc4c7c6d3342c6a08b2"><div class="ttname"><a href="group__security.html#ga9ef3eb8241b6fdc4c7c6d3342c6a08b2">SocketTLS_enable_ktls</a></div><div class="ttdeci">void SocketTLS_enable_ktls(Socket_T socket)</div><div class="ttdoc">Enable kTLS offload for a TLS-enabled socket.</div></div>
<div class="ttc" id="agroup__security_html_gaa1a501e54dbdd4c6571ea6dfe812d7d2"><div class="ttname"><a href="group__security.html#gaa1a501e54dbdd4c6571ea6dfe812d7d2">TLSBufferPool_release</a></div><div class="ttdeci">void TLSBufferPool_release(TLSBufferPool_T pool, void *buffer)</div><div class="ttdoc">Release a buffer back to the pool.</div></div>
<div class="ttc" id="agroup__security_html_gaa724dbe4115729ef621c0f1f74b5afd6"><div class="ttname"><a href="group__security.html#gaa724dbe4115729ef621c0f1f74b5afd6">SocketTLS_ShutdownFailed</a></div><div class="ttdeci">const Except_T SocketTLS_ShutdownFailed</div><div class="ttdoc">TLS graceful shutdown failure.</div></div>
<div class="ttc" id="agroup__security_html_gaaa422a6083ae2ec362780b294c95bf5f"><div class="ttname"><a href="group__security.html#gaaa422a6083ae2ec362780b294c95bf5f">SocketTLS_get_peer_cert_info</a></div><div class="ttdeci">int SocketTLS_get_peer_cert_info(Socket_T socket, SocketTLS_CertInfo *info)</div><div class="ttdoc">Get peer certificate details.</div></div>
<div class="ttc" id="agroup__security_html_gaaf47a9456a6b6d5d367b7fb160e48264"><div class="ttname"><a href="group__security.html#gaaf47a9456a6b6d5d367b7fb160e48264">TLSBufferPool_T</a></div><div class="ttdeci">struct TLSBufferPool * TLSBufferPool_T</div><div class="ttdoc">Opaque TLS buffer pool type.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l02404">SocketTLS.h:2404</a></div></div>
<div class="ttc" id="agroup__security_html_gab11506db6f41f31e9fc170b3d0e848f1"><div class="ttname"><a href="group__security.html#gab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a></div><div class="ttdeci">void SocketTLS_shutdown(Socket_T socket)</div><div class="ttdoc">Perform graceful TLS connection shutdown.</div></div>
<div class="ttc" id="agroup__security_html_gab62e7185c08eb9459341471f56f400c5"><div class="ttname"><a href="group__security.html#gab62e7185c08eb9459341471f56f400c5">SocketTLS_session_save</a></div><div class="ttdeci">int SocketTLS_session_save(Socket_T socket, unsigned char *buffer, size_t *len)</div><div class="ttdoc">Export TLS session for later resumption.</div></div>
<div class="ttc" id="agroup__security_html_gab9a8fb788aa1f0d21b5773bc43a48d6f"><div class="ttname"><a href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a></div><div class="ttdeci">void SocketTLS_enable(Socket_T socket, SocketTLSContext_T ctx)</div><div class="ttdoc">Enable TLS on a socket using the provided context.</div></div>
<div class="ttc" id="agroup__security_html_gabc011202dd4f2e080b6ea8eb0f24287e"><div class="ttname"><a href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a></div><div class="ttdeci">const Except_T SocketTLS_Failed</div><div class="ttdoc">General TLS operation failure.</div></div>
<div class="ttc" id="agroup__security_html_gabdb38e692dde58bbec4ab905eeb8b3aa"><div class="ttname"><a href="group__security.html#gabdb38e692dde58bbec4ab905eeb8b3aa">SocketTLS_send</a></div><div class="ttdeci">ssize_t SocketTLS_send(Socket_T socket, const void *buf, size_t len)</div><div class="ttdoc">Send data over TLS-encrypted connection.</div></div>
<div class="ttc" id="agroup__security_html_gabe406e483a861198db5bca58300f1728"><div class="ttname"><a href="group__security.html#gabe406e483a861198db5bca58300f1728">SocketTLS_VerifyFailed</a></div><div class="ttdeci">const Except_T SocketTLS_VerifyFailed</div><div class="ttdoc">Peer certificate verification failure.</div></div>
<div class="ttc" id="agroup__security_html_gac32c3958835b92ff683ae15f78448694"><div class="ttname"><a href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a></div><div class="ttdeci">TLSVerifyMode</div><div class="ttdoc">Peer certificate verification policies configurable for TLS contexts.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00662">SocketTLS.h:663</a></div></div>
<div class="ttc" id="agroup__security_html_gad092160c037d01929df1bb8d5b75b43c"><div class="ttname"><a href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a></div><div class="ttdeci">TLSHandshakeState</div><div class="ttdoc">TLS handshake progress states for non-blocking and event-driven operations.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00552">SocketTLS.h:553</a></div></div>
<div class="ttc" id="agroup__security_html_gad6d3b0c2f78bcb3036d0f9768f0b49ce"><div class="ttname"><a href="group__security.html#gad6d3b0c2f78bcb3036d0f9768f0b49ce">TLSBufferPool_acquire</a></div><div class="ttdeci">void * TLSBufferPool_acquire(TLSBufferPool_T pool)</div><div class="ttdoc">Acquire a buffer from the pool.</div></div>
<div class="ttc" id="agroup__security_html_gad97195716332983bae10a77f275740bd"><div class="ttname"><a href="group__security.html#gad97195716332983bae10a77f275740bd">SocketTLS_ProtocolError</a></div><div class="ttdeci">const Except_T SocketTLS_ProtocolError</div><div class="ttdoc">TLS protocol violation or internal state error.</div></div>
<div class="ttc" id="agroup__security_html_gae0eac9b1e7ec32b5c16b71ca3eda8aa7"><div class="ttname"><a href="group__security.html#gae0eac9b1e7ec32b5c16b71ca3eda8aa7">SocketTLSContext_enable_early_data</a></div><div class="ttdeci">void SocketTLSContext_enable_early_data(SocketTLSContext_T ctx, uint32_t max_early_data)</div><div class="ttdoc">Enable TLS 1.3 0-RTT early data on context.</div></div>
<div class="ttc" id="agroup__security_html_gae117c11e5036d03dac93b9634e1b7fad"><div class="ttname"><a href="group__security.html#gae117c11e5036d03dac93b9634e1b7fad">SocketTLS_get_early_data_status</a></div><div class="ttdeci">SocketTLS_EarlyDataStatus SocketTLS_get_early_data_status(Socket_T socket)</div><div class="ttdoc">Check early data status after handshake.</div></div>
<div class="ttc" id="agroup__security_html_gae3e3dd2318b86ecc13a06c313f904036"><div class="ttname"><a href="group__security.html#gae3e3dd2318b86ecc13a06c313f904036">SocketTLS_EarlyDataStatus</a></div><div class="ttdeci">SocketTLS_EarlyDataStatus</div><div class="ttdoc">Early data status codes for TLS 1.3 0-RTT.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l02126">SocketTLS.h:2127</a></div></div>
<div class="ttc" id="agroup__security_html_gaeaa77dd7852b535baf17b53ee2518454"><div class="ttname"><a href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a></div><div class="ttdeci">TLSHandshakeState SocketTLS_handshake(Socket_T socket)</div><div class="ttdoc">Perform non-blocking TLS handshake.</div></div>
<div class="ttc" id="agroup__security_html_gaee27dc7f30471a33200568801ee37900"><div class="ttname"><a href="group__security.html#gaee27dc7f30471a33200568801ee37900">SocketTLS_disable_renegotiation</a></div><div class="ttdeci">int SocketTLS_disable_renegotiation(Socket_T socket)</div><div class="ttdoc">Disable TLS renegotiation on socket.</div></div>
<div class="ttc" id="agroup__security_html_gaef0f67021658d05419f1da479be2957e"><div class="ttname"><a href="group__security.html#gaef0f67021658d05419f1da479be2957e">SocketTLS_get_version</a></div><div class="ttdeci">const char * SocketTLS_get_version(Socket_T socket)</div><div class="ttdoc">Get negotiated TLS protocol version.</div></div>
<div class="ttc" id="agroup__security_html_gaef2687535edbb23a7d323630f604a706"><div class="ttname"><a href="group__security.html#gaef2687535edbb23a7d323630f604a706">TLSBufferPool_stats</a></div><div class="ttdeci">void TLSBufferPool_stats(TLSBufferPool_T pool, size_t *total, size_t *in_use, size_t *available)</div><div class="ttdoc">Get pool statistics.</div></div>
<div class="ttc" id="agroup__security_html_gaf0c6c0a454f2ce22995ebc1d7c0a059a"><div class="ttname"><a href="group__security.html#gaf0c6c0a454f2ce22995ebc1d7c0a059a">SocketTLSContext_create_sharded_cache</a></div><div class="ttdeci">void SocketTLSContext_create_sharded_cache(SocketTLSContext_T ctx, size_t num_shards, size_t sessions_per_shard, long timeout_seconds)</div><div class="ttdoc">Create sharded session cache for multi-threaded servers.</div></div>
<div class="ttc" id="agroup__security_html_gaf80f10ed221220a75e520733953ed58c"><div class="ttname"><a href="group__security.html#gaf80f10ed221220a75e520733953ed58c">SocketTLS_get_ocsp_response_status</a></div><div class="ttdeci">int SocketTLS_get_ocsp_response_status(Socket_T socket)</div><div class="ttdoc">Get OCSP stapling status from server response.</div></div>
<div class="ttc" id="agroup__security_html_gaf826f5816d9f95a88393cd7f0eae1fa5"><div class="ttname"><a href="group__security.html#gaf826f5816d9f95a88393cd7f0eae1fa5">TLSBufferPool_free</a></div><div class="ttdeci">void TLSBufferPool_free(TLSBufferPool_T *pool)</div><div class="ttdoc">Destroy a buffer pool.</div></div>
<div class="ttc" id="agroup__security_html_ggac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f"><div class="ttname"><a href="group__security.html#ggac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f">TLS_VERIFY_NONE</a></div><div class="ttdeci">@ TLS_VERIFY_NONE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00665">SocketTLS.h:664</a></div></div>
<div class="ttc" id="agroup__security_html_ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d"><div class="ttname"><a href="group__security.html#ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">TLS_VERIFY_FAIL_IF_NO_PEER_CERT</a></div><div class="ttdeci">@ TLS_VERIFY_FAIL_IF_NO_PEER_CERT</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00668">SocketTLS.h:667</a></div></div>
<div class="ttc" id="agroup__security_html_ggac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183"><div class="ttname"><a href="group__security.html#ggac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183">TLS_VERIFY_CLIENT_ONCE</a></div><div class="ttdeci">@ TLS_VERIFY_CLIENT_ONCE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00671">SocketTLS.h:669</a></div></div>
<div class="ttc" id="agroup__security_html_ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe"><div class="ttname"><a href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a></div><div class="ttdeci">@ TLS_VERIFY_PEER</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00666">SocketTLS.h:666</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a">TLS_HANDSHAKE_IN_PROGRESS</a></div><div class="ttdeci">@ TLS_HANDSHAKE_IN_PROGRESS</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00555">SocketTLS.h:555</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a></div><div class="ttdeci">@ TLS_HANDSHAKE_WANT_READ</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00556">SocketTLS.h:556</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a></div><div class="ttdeci">@ TLS_HANDSHAKE_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00558">SocketTLS.h:558</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2">TLS_HANDSHAKE_ERROR</a></div><div class="ttdeci">@ TLS_HANDSHAKE_ERROR</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00560">SocketTLS.h:559</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a></div><div class="ttdeci">@ TLS_HANDSHAKE_WANT_WRITE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00557">SocketTLS.h:557</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2">TLS_HANDSHAKE_NOT_STARTED</a></div><div class="ttdeci">@ TLS_HANDSHAKE_NOT_STARTED</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00554">SocketTLS.h:554</a></div></div>
<div class="ttc" id="agroup__security_html_ggae3e3dd2318b86ecc13a06c313f904036a0cc57f9add21f7c9427934e61e371073"><div class="ttname"><a href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036a0cc57f9add21f7c9427934e61e371073">SOCKET_EARLY_DATA_NOT_SENT</a></div><div class="ttdeci">@ SOCKET_EARLY_DATA_NOT_SENT</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l02128">SocketTLS.h:2128</a></div></div>
<div class="ttc" id="agroup__security_html_ggae3e3dd2318b86ecc13a06c313f904036a75d8ab4ba515e850a849878edcad3ab6"><div class="ttname"><a href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036a75d8ab4ba515e850a849878edcad3ab6">SOCKET_EARLY_DATA_REJECTED</a></div><div class="ttdeci">@ SOCKET_EARLY_DATA_REJECTED</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l02131">SocketTLS.h:2130</a></div></div>
<div class="ttc" id="agroup__security_html_ggae3e3dd2318b86ecc13a06c313f904036add3155f3f8b945959b83617f25d1afa9"><div class="ttname"><a href="group__security.html#ggae3e3dd2318b86ecc13a06c313f904036add3155f3f8b945959b83617f25d1afa9">SOCKET_EARLY_DATA_ACCEPTED</a></div><div class="ttdeci">@ SOCKET_EARLY_DATA_ACCEPTED</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l02129">SocketTLS.h:2129</a></div></div>
<div class="ttc" id="agroup__security_html_structSocketTLSContext__T"><div class="ttname"><a href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a></div><div class="ttdoc">TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS-private_8h_source.html#l00619">SocketTLS-private.h:620</a></div></div>
<div class="ttc" id="agroup__security_html_structSocketTLS__CertInfo"><div class="ttname"><a href="group__security.html#structSocketTLS__CertInfo">SocketTLS_CertInfo</a></div><div class="ttdoc">Peer certificate information structure.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l01478">SocketTLS.h:1479</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- GitHub Corner - Waving Octocat -->
<a href="https://github.com/7etsuo/tetsuo-socket" class="github-corner" aria-label="View source on GitHub">
  <svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
    <path d="m0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
    <path d="m128.3,109.0 C113.8,99.7 119.0,89.4 119.0,89.4 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
    <path d="m115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path>
  </svg>
</a>
<style>
.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}
</style>
<!-- Custom footer for Tetsuo Pulse -->
<div id="nav-path" class="navpath">
  <ul>
    <li class="footer" style="text-align: center; width: 100%;">
       <a href="https://tetsuocorp.com" target="_blank" rel="noopener">Tetsuo Corp</a>
    </li>
  </ul>
</div>
</body>
</html>
