<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="High-performance, exception-driven socket toolkit for POSIX systems">
<meta name="keywords" content="socket, networking, C, POSIX, TCP, UDP, TLS, async, high-performance, library">
<meta name="author" content="Tetsuo Corporation">
<meta name="theme-color" content="#3b82f6">
<title>SocketTLS.h File Reference</title>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%233b82f6'/><stop offset='100%25' stop-color='%238b5cf6'/></linearGradient></defs><rect width='100' height='100' rx='20' fill='url(%23g)'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white' font-family='sans-serif' font-weight='bold'>S</text></svg>">
</head>
<body>
<div id="top">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Socket Library<span id="projectnumber">1.0.0</span></div>
   <div id="projectbrief">High-performance, exception-driven socket toolkit for POSIX systems</div>
  </td>
  <td style="text-align: right; padding: 20px; vertical-align: middle;">
    <div style="display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap; align-items: center;">
      <a href="index.html" class="quick-link">Home</a>
      <a href="annotated.html" class="quick-link">Structures</a>
      <a href="files.html" class="quick-link">Files</a>
      <a href="globals.html" class="quick-link">API</a>
    </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('SocketTLS_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">SocketTLS.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="Except_8h_source.html">core/Except.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Socket_8h_source.html">socket/Socket.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for SocketTLS.h:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SocketTLS_8h__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div><div class="textblock"><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="SocketTLS_8h__dep__incl.svg" width="100%" height="492"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="SocketTLS_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0acb682b8260ab1c60b918599864e2e5" id="r_a0acb682b8260ab1c60b918599864e2e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a0acb682b8260ab1c60b918599864e2e5">T</a>&#160;&#160;&#160;<a class="el" href="SocketTLS_8h.html#a63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td></tr>
<tr class="separator:a0acb682b8260ab1c60b918599864e2e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a63e73c93350813167a68162c5cb3d819" id="r_a63e73c93350813167a68162c5cb3d819"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="SocketTLS_8h.html#a63e73c93350813167a68162c5cb3d819">SocketTLS_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td></tr>
<tr class="separator:a63e73c93350813167a68162c5cb3d819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46f2ab9dacbb1af2d590f2974e21577" id="r_ac46f2ab9dacbb1af2d590f2974e21577"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a></td></tr>
<tr class="separator:ac46f2ab9dacbb1af2d590f2974e21577"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ad092160c037d01929df1bb8d5b75b43c" id="r_ad092160c037d01929df1bb8d5b75b43c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> { <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2">TLS_HANDSHAKE_NOT_STARTED</a> = 0
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a">TLS_HANDSHAKE_IN_PROGRESS</a> = 1
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a> = 2
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a> = 3
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a> = 4
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2">TLS_HANDSHAKE_ERROR</a> = 5
<br />
 }</td></tr>
<tr class="separator:ad092160c037d01929df1bb8d5b75b43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac32c3958835b92ff683ae15f78448694" id="r_ac32c3958835b92ff683ae15f78448694"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#ac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a> { <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f">TLS_VERIFY_NONE</a> = 0
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a> = 1
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">TLS_VERIFY_FAIL_IF_NO_PEER_CERT</a> = 2
, <br />
&#160;&#160;<a class="el" href="SocketTLS_8h.html#ac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183">TLS_VERIFY_CLIENT_ONCE</a> = 4
<br />
 }</td></tr>
<tr class="separator:ac32c3958835b92ff683ae15f78448694"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab9a8fb788aa1f0d21b5773bc43a48d6f" id="r_ab9a8fb788aa1f0d21b5773bc43a48d6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#ab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket, <a class="el" href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="separator:ab9a8fb788aa1f0d21b5773bc43a48d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d2c8f4eaea80114bbd2123da025e56" id="r_a15d2c8f4eaea80114bbd2123da025e56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a15d2c8f4eaea80114bbd2123da025e56">SocketTLS_set_hostname</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket, const char *hostname)</td></tr>
<tr class="separator:a15d2c8f4eaea80114bbd2123da025e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaa77dd7852b535baf17b53ee2518454" id="r_aeaa77dd7852b535baf17b53ee2518454"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:aeaa77dd7852b535baf17b53ee2518454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a439248f2ff7b87470520de0607569d06" id="r_a439248f2ff7b87470520de0607569d06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a439248f2ff7b87470520de0607569d06">SocketTLS_handshake_loop</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket, int timeout_ms)</td></tr>
<tr class="separator:a439248f2ff7b87470520de0607569d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54a01327e253586278c0f740c2764010" id="r_a54a01327e253586278c0f740c2764010"><td class="memItemLeft" align="right" valign="top"><a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a54a01327e253586278c0f740c2764010">SocketTLS_handshake_auto</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:a54a01327e253586278c0f740c2764010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11506db6f41f31e9fc170b3d0e848f1" id="r_ab11506db6f41f31e9fc170b3d0e848f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#ab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:ab11506db6f41f31e9fc170b3d0e848f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdb38e692dde58bbec4ab905eeb8b3aa" id="r_abdb38e692dde58bbec4ab905eeb8b3aa"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#abdb38e692dde58bbec4ab905eeb8b3aa">SocketTLS_send</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket, const void *buf, size_t len)</td></tr>
<tr class="separator:abdb38e692dde58bbec4ab905eeb8b3aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c71fc02141cd9e6da4fdf1c88dbbaf3" id="r_a1c71fc02141cd9e6da4fdf1c88dbbaf3"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a1c71fc02141cd9e6da4fdf1c88dbbaf3">SocketTLS_recv</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket, void *buf, size_t len)</td></tr>
<tr class="separator:a1c71fc02141cd9e6da4fdf1c88dbbaf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0859f0a6e05840bdc037c3765e22b7b1" id="r_a0859f0a6e05840bdc037c3765e22b7b1"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a0859f0a6e05840bdc037c3765e22b7b1">SocketTLS_get_cipher</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:a0859f0a6e05840bdc037c3765e22b7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef0f67021658d05419f1da479be2957e" id="r_aef0f67021658d05419f1da479be2957e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#aef0f67021658d05419f1da479be2957e">SocketTLS_get_version</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:aef0f67021658d05419f1da479be2957e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fd56e743762151aa449744a8d574164" id="r_a4fd56e743762151aa449744a8d574164"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a4fd56e743762151aa449744a8d574164">SocketTLS_get_verify_result</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:a4fd56e743762151aa449744a8d574164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39a966c33421653c64f78261f24ee1f1" id="r_a39a966c33421653c64f78261f24ee1f1"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a39a966c33421653c64f78261f24ee1f1">SocketTLS_get_verify_error_string</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket, char *buf, size_t size)</td></tr>
<tr class="separator:a39a966c33421653c64f78261f24ee1f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315ccceb9cb5b74d8b90f1439ce57344" id="r_a315ccceb9cb5b74d8b90f1439ce57344"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a315ccceb9cb5b74d8b90f1439ce57344">SocketTLS_is_session_reused</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:a315ccceb9cb5b74d8b90f1439ce57344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56acd283757bb0af4f4d59d3c0f218ea" id="r_a56acd283757bb0af4f4d59d3c0f218ea"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a56acd283757bb0af4f4d59d3c0f218ea">SocketTLS_get_alpn_selected</a> (<a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> socket)</td></tr>
<tr class="separator:a56acd283757bb0af4f4d59d3c0f218ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae74b3921236213de2e979bbd2039e452" id="r_ae74b3921236213de2e979bbd2039e452"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#ae74b3921236213de2e979bbd2039e452">tls_error_buf</a> []</td></tr>
<tr class="separator:ae74b3921236213de2e979bbd2039e452"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc011202dd4f2e080b6ea8eb0f24287e" id="r_abc011202dd4f2e080b6ea8eb0f24287e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#abc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a></td></tr>
<tr class="separator:abc011202dd4f2e080b6ea8eb0f24287e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82be75dd764021fb64cd6824768e2254" id="r_a82be75dd764021fb64cd6824768e2254"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#a82be75dd764021fb64cd6824768e2254">SocketTLS_HandshakeFailed</a></td></tr>
<tr class="separator:a82be75dd764021fb64cd6824768e2254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe406e483a861198db5bca58300f1728" id="r_abe406e483a861198db5bca58300f1728"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#abe406e483a861198db5bca58300f1728">SocketTLS_VerifyFailed</a></td></tr>
<tr class="separator:abe406e483a861198db5bca58300f1728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad97195716332983bae10a77f275740bd" id="r_ad97195716332983bae10a77f275740bd"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#ad97195716332983bae10a77f275740bd">SocketTLS_ProtocolError</a></td></tr>
<tr class="separator:ad97195716332983bae10a77f275740bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa724dbe4115729ef621c0f1f74b5afd6" id="r_aa724dbe4115729ef621c0f1f74b5afd6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html#aa724dbe4115729ef621c0f1f74b5afd6">SocketTLS_ShutdownFailed</a></td></tr>
<tr class="separator:aa724dbe4115729ef621c0f1f74b5afd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0acb682b8260ab1c60b918599864e2e5" name="a0acb682b8260ab1c60b918599864e2e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0acb682b8260ab1c60b918599864e2e5">&#9670;&#160;</a></span>T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T&#160;&#160;&#160;<a class="el" href="SocketTLS_8h.html#a63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00027">27</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a63e73c93350813167a68162c5cb3d819" name="a63e73c93350813167a68162c5cb3d819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63e73c93350813167a68162c5cb3d819">&#9670;&#160;</a></span>SocketTLS_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="SocketTLS_8h.html#a63e73c93350813167a68162c5cb3d819">SocketTLS_T</a>* <a class="el" href="SocketTLS_8h.html#a63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00028">28</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<a id="ac46f2ab9dacbb1af2d590f2974e21577" name="ac46f2ab9dacbb1af2d590f2974e21577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46f2ab9dacbb1af2d590f2974e21577">&#9670;&#160;</a></span>SocketTLSContext_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a>* <a class="el" href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00110">110</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ad092160c037d01929df1bb8d5b75b43c" name="ad092160c037d01929df1bb8d5b75b43c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad092160c037d01929df1bb8d5b75b43c">&#9670;&#160;</a></span>TLSHandshakeState</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2" name="ad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2"></a>TLS_HANDSHAKE_NOT_STARTED&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a" name="ad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a"></a>TLS_HANDSHAKE_IN_PROGRESS&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592" name="ad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592"></a>TLS_HANDSHAKE_WANT_READ&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac" name="ad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac"></a>TLS_HANDSHAKE_WANT_WRITE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce" name="ad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce"></a>TLS_HANDSHAKE_COMPLETE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2" name="ad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2"></a>TLS_HANDSHAKE_ERROR&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00090">90</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<a id="ac32c3958835b92ff683ae15f78448694" name="ac32c3958835b92ff683ae15f78448694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac32c3958835b92ff683ae15f78448694">&#9670;&#160;</a></span>TLSVerifyMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="SocketTLS_8h.html#ac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f" name="ac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f"></a>TLS_VERIFY_NONE&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe" name="ac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe"></a>TLS_VERIFY_PEER&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d" name="ac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d"></a>TLS_VERIFY_FAIL_IF_NO_PEER_CERT&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="ac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183" name="ac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183"></a>TLS_VERIFY_CLIENT_ONCE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00101">101</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ab9a8fb788aa1f0d21b5773bc43a48d6f" name="ab9a8fb788aa1f0d21b5773bc43a48d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9a8fb788aa1f0d21b5773bc43a48d6f">&#9670;&#160;</a></span>SocketTLS_enable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLS_enable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_enable - Enable TLS on a socket using the provided context @socket: The socket instance to enable TLS on @ctx: The TLS context to use for this connection</p>
<p>Enables TLS/SSL encryption on the specified socket. The socket must be connected before calling this function. Creates an SSL object from the context, associates it with the socket's file descriptor, sets client/server mode, and initializes TLS buffers and state.</p>
<p>Returns: void Raises: SocketTLS_Failed if TLS cannot be enabled (e.g., already enabled, invalid socket, context error) Thread-safe: No - modifies socket state directly</p>
<p>Usage note: Call after <a class="el" href="Socket_8h.html#ac14390090ee26136c1f7a816fc08406e">Socket_connect()</a> or <a class="el" href="Socket_8h.html#a32b67d95639513cd6a602f6175b48f15">Socket_accept()</a> but before any TLS I/O. The handshake must be performed separately using <a class="el" href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake()</a>. </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="a56acd283757bb0af4f4d59d3c0f218ea" name="a56acd283757bb0af4f4d59d3c0f218ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56acd283757bb0af4f4d59d3c0f218ea">&#9670;&#160;</a></span>SocketTLS_get_alpn_selected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_alpn_selected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_get_alpn_selected - Get the negotiated ALPN protocol @socket: Socket instance with completed handshake</p>
<p>Returns the ALPN protocol that was negotiated during the TLS handshake. This is useful for determining which application protocol to use (e.g., "h2", "http/1.1").</p>
<p>Returns: Negotiated protocol string, or NULL if none negotiated or unavailable Raises: None Thread-safe: Yes - reads immutable post-handshake state </p>

</div>
</div>
<a id="a0859f0a6e05840bdc037c3765e22b7b1" name="a0859f0a6e05840bdc037c3765e22b7b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0859f0a6e05840bdc037c3765e22b7b1">&#9670;&#160;</a></span>SocketTLS_get_cipher()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_cipher </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_get_cipher - Get negotiated cipher suite name @socket: The socket instance with completed handshake</p>
<p>Returns the name of the cipher suite negotiated during handshake (e.g., "TLS_AES_256_GCM_SHA384").</p>
<p>Returns: Const string with cipher name, or NULL if unavailable Raises: None Thread-safe: Yes - reads immutable post-handshake state </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="a39a966c33421653c64f78261f24ee1f1" name="a39a966c33421653c64f78261f24ee1f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39a966c33421653c64f78261f24ee1f1">&#9670;&#160;</a></span>SocketTLS_get_verify_error_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_verify_error_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_get_verify_error_string - Get detailed verification error string @socket: TLS socket @buf: Output buffer for error description @size: Buffer size (including null terminator)</p>
<p>Provides human-readable string for the last verification error (from CRL/OCSP/custom verify). Uses X509_verify_cert_error_string or OpenSSL ERR queue.</p>
<p>Returns: buf if error found, NULL if no error or invalid args Raises: None Thread-safe: No (ERR queue shared) Requires: tls_handshake_done </p>

</div>
</div>
<a id="a4fd56e743762151aa449744a8d574164" name="a4fd56e743762151aa449744a8d574164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fd56e743762151aa449744a8d574164">&#9670;&#160;</a></span>SocketTLS_get_verify_result()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long SocketTLS_get_verify_result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_get_verify_result - Get peer certificate verification result @socket: The socket instance with completed handshake</p>
<p>Returns OpenSSL's X509 verify result code. 0 (X509_V_OK) indicates successful verification. Non-zero codes detail failures (e.g., untrusted CA).</p>
<p>Returns: long verify result code (X509_V_OK = 0 on success) Raises: None (caller checks and may raise SocketTLS_VerifyFailed) Thread-safe: Yes (read-only post-handshake) Requires: tls_enabled and tls_handshake_done </p>

</div>
</div>
<a id="aef0f67021658d05419f1da479be2957e" name="aef0f67021658d05419f1da479be2957e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef0f67021658d05419f1da479be2957e">&#9670;&#160;</a></span>SocketTLS_get_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_version </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_get_version - Get negotiated TLS protocol version @socket: The socket instance with completed handshake</p>
<p>Returns the TLS protocol version string (e.g., "TLSv1.3").</p>
<p>Returns: Const string with version, or NULL if unavailable Raises: None Thread-safe: Yes </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="aeaa77dd7852b535baf17b53ee2518454" name="aeaa77dd7852b535baf17b53ee2518454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaa77dd7852b535baf17b53ee2518454">&#9670;&#160;</a></span>SocketTLS_handshake()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> SocketTLS_handshake </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_handshake - Perform non-blocking TLS handshake @socket: The socket instance with TLS enabled</p>
<p>Performs one step of the TLS handshake. For non-blocking sockets, this may return WANT_READ or WANT_WRITE indicating more data or writability is needed. Call repeatedly in a poll loop until TLS_HANDSHAKE_COMPLETE is returned.</p>
<p>Returns: TLSHandshakeState indicating progress (COMPLETE, WANT_READ, WANT_WRITE, ERROR) Raises: SocketTLS_HandshakeFailed on fatal handshake errors (e.g., protocol mismatch, cert verify fail) Thread-safe: No - modifies socket TLS state and SSL object</p>
<p>Note: Integrates with SocketPoll by checking tls_last_handshake_state for pending I/O. </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="a54a01327e253586278c0f740c2764010" name="a54a01327e253586278c0f740c2764010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54a01327e253586278c0f740c2764010">&#9670;&#160;</a></span>SocketTLS_handshake_auto()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> SocketTLS_handshake_auto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_handshake_auto - Complete handshake using socket's timeout config @socket: The socket instance with TLS enabled</p>
<p>Convenience function that performs a TLS handshake using the socket's configured operation_timeout_ms. If operation_timeout_ms is 0 or not set, uses SOCKET_DEFAULT_TLS_HANDSHAKE_TIMEOUT_MS (30 seconds).</p>
<p>This is the recommended function for production code as it automatically uses the socket's timeout configuration, ensuring consistent timeout behavior across the application.</p>
<p>Returns: TLSHandshakeState (COMPLETE on success, ERROR on failure/timeout) Raises: SocketTLS_HandshakeFailed on error or timeout Thread-safe: No </p>

</div>
</div>
<a id="a439248f2ff7b87470520de0607569d06" name="a439248f2ff7b87470520de0607569d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a439248f2ff7b87470520de0607569d06">&#9670;&#160;</a></span>SocketTLS_handshake_loop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="SocketTLS_8h.html#ad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> SocketTLS_handshake_loop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_handshake_loop - Complete handshake with timeout (non-blocking) @socket: The socket instance with TLS enabled @timeout_ms: Maximum time to wait for handshake completion (0 for non-blocking)</p>
<p>Convenience function to run the handshake loop until complete or timeout. Uses SocketPoll internally for non-blocking operation if timeout &gt; 0.</p>
<p>Returns: TLSHandshakeState (COMPLETE on success, ERROR on failure/timeout) Raises: SocketTLS_HandshakeFailed on error or timeout Thread-safe: No</p>
<p>Note: This is a higher-level helper; low-level code should use <a class="el" href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake()</a> directly. </p>

</div>
</div>
<a id="a315ccceb9cb5b74d8b90f1439ce57344" name="a315ccceb9cb5b74d8b90f1439ce57344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a315ccceb9cb5b74d8b90f1439ce57344">&#9670;&#160;</a></span>SocketTLS_is_session_reused()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLS_is_session_reused </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_is_session_reused - Check if TLS session was resumed @socket: The socket instance with completed handshake</p>
<p>Determines if the connection used a resumed session (faster handshake via session tickets/cache).</p>
<p>Returns: 1 if reused, 0 if full handshake, -1 if unavailable Raises: None Thread-safe: Yes </p>

</div>
</div>
<a id="a1c71fc02141cd9e6da4fdf1c88dbbaf3" name="a1c71fc02141cd9e6da4fdf1c88dbbaf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c71fc02141cd9e6da4fdf1c88dbbaf3">&#9670;&#160;</a></span>SocketTLS_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketTLS_recv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_recv - Receive data from TLS-encrypted connection @socket: The socket instance with completed TLS handshake @buf: Buffer to receive data into @len: Maximum number of bytes to receive</p>
<p>Receives data using SSL_read(). For non-blocking sockets, returns 0 and sets errno=EAGAIN if would block. Returns 0 and raises Socket_Closed on clean peer shutdown.</p>
<p>Returns: Number of bytes received, or 0 if would block or EOF Raises: SocketTLS_Failed on TLS errors, Socket_Closed on clean shutdown Thread-safe: No - modifies SSL buffers and state</p>
<p>Note: Application must handle partial reads by looping until desired amount received. </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="abdb38e692dde58bbec4ab905eeb8b3aa" name="abdb38e692dde58bbec4ab905eeb8b3aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdb38e692dde58bbec4ab905eeb8b3aa">&#9670;&#160;</a></span>SocketTLS_send()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketTLS_send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_send - Send data over TLS-encrypted connection @socket: The socket instance with completed TLS handshake @buf: Buffer containing data to send @len: Number of bytes to send from buf</p>
<p>Sends data using SSL_write(). For non-blocking sockets, returns 0 and sets errno=EAGAIN if the operation would block. Handshake must be complete before calling.</p>
<p>Returns: Number of bytes sent, or 0 if would block Raises: SocketTLS_Failed on TLS errors, Socket_Closed if connection closed Thread-safe: No - modifies SSL buffers and state</p>
<p>Note: Does not perform partial sends; application must loop if needed. </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="a15d2c8f4eaea80114bbd2123da025e56" name="a15d2c8f4eaea80114bbd2123da025e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15d2c8f4eaea80114bbd2123da025e56">&#9670;&#160;</a></span>SocketTLS_set_hostname()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLS_set_hostname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hostname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_set_hostname - Set SNI hostname for client TLS connections @socket: The socket instance @hostname: Null-terminated hostname string for SNI and verification</p>
<p>Sets the Server Name Indication (SNI) hostname for the TLS connection. This is required for virtual hosting on servers and enables hostname verification for clients. The hostname is validated and allocated in the socket's arena. Should be called after <a class="el" href="SocketTLS_8h.html#ab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable()</a> but before <a class="el" href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake()</a>.</p>
<p>Returns: void Raises: SocketTLS_Failed if TLS not enabled, invalid hostname, or OpenSSL error Thread-safe: No - modifies socket and SSL state </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="ab11506db6f41f31e9fc170b3d0e848f1" name="ab11506db6f41f31e9fc170b3d0e848f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11506db6f41f31e9fc170b3d0e848f1">&#9670;&#160;</a></span>SocketTLS_shutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLS_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_shutdown - Perform graceful TLS connection shutdown @socket: The socket instance with TLS enabled</p>
<p>Initiates a bidirectional TLS shutdown (close_notify alert). May need multiple calls for full shutdown in non-blocking mode. Call before Socket_close() to ensure proper TLS termination.</p>
<p>Returns: void Raises: SocketTLS_ShutdownFailed on error Thread-safe: No - modifies SSL object state </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="abc011202dd4f2e080b6ea8eb0f24287e" name="abc011202dd4f2e080b6ea8eb0f24287e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc011202dd4f2e080b6ea8eb0f24287e">&#9670;&#160;</a></span>SocketTLS_Failed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a> SocketTLS_Failed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_Failed - General TLS operation failure</p>
<p>Category: PROTOCOL Retryable: NO - Usually indicates configuration or setup error </p>

</div>
</div>
<a id="a82be75dd764021fb64cd6824768e2254" name="a82be75dd764021fb64cd6824768e2254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82be75dd764021fb64cd6824768e2254">&#9670;&#160;</a></span>SocketTLS_HandshakeFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a> SocketTLS_HandshakeFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_HandshakeFailed - TLS handshake could not complete</p>
<p>Category: PROTOCOL Retryable: NO - Protocol/version mismatch or server rejection</p>
<p>Raised when handshake fails due to:</p><ul>
<li><a class="el" href="namespace_3globalScope_4.html#protocolProtocol-p">Protocol</a> version mismatch</li>
<li>Cipher suite negotiation failure</li>
<li>Server rejection </li>
</ul>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="ad97195716332983bae10a77f275740bd" name="ad97195716332983bae10a77f275740bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad97195716332983bae10a77f275740bd">&#9670;&#160;</a></span>SocketTLS_ProtocolError</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a> SocketTLS_ProtocolError</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_ProtocolError - TLS protocol error</p>
<p>Category: PROTOCOL Retryable: NO - <a class="el" href="namespace_3globalScope_4.html#protocolProtocol-p">Protocol</a> violation by peer </p>

</div>
</div>
<a id="aa724dbe4115729ef621c0f1f74b5afd6" name="aa724dbe4115729ef621c0f1f74b5afd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa724dbe4115729ef621c0f1f74b5afd6">&#9670;&#160;</a></span>SocketTLS_ShutdownFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a> SocketTLS_ShutdownFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_ShutdownFailed - TLS shutdown failure</p>
<p>Category: PROTOCOL Retryable: NO - Connection already broken </p>

</div>
</div>
<a id="abe406e483a861198db5bca58300f1728" name="abe406e483a861198db5bca58300f1728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe406e483a861198db5bca58300f1728">&#9670;&#160;</a></span>SocketTLS_VerifyFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Except_8h.html#structExcept__T">Except_T</a> SocketTLS_VerifyFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SocketTLS_VerifyFailed - Certificate verification failure</p>
<p>Category: PROTOCOL Retryable: NO - Certificate won't change on retry</p>
<p>Raised when peer certificate fails verification:</p><ul>
<li>Expired certificate</li>
<li>Invalid signature</li>
<li>Hostname mismatch</li>
<li>Unknown CA </li>
</ul>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00128">main()</a>.</p>

</div>
</div>
<a id="ae74b3921236213de2e979bbd2039e452" name="ae74b3921236213de2e979bbd2039e452"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae74b3921236213de2e979bbd2039e452">&#9670;&#160;</a></span>tls_error_buf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char tls_error_buf[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p><a class="el" href="SocketTLS_8h.html">SocketTLS.h</a> - TLS/SSL Socket Integration (TLS1.3-Only by Default)</p>
<p>Features:</p><ul>
<li>TLS1.3-only (strict PFS, no legacy vulns)</li>
<li>Transparent I/O integration</li>
<li>Non-blocking handshake with poll</li>
<li>SNI + hostname verification</li>
<li>ALPN support </li>
</ul>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<footer class="footer">
  <div style="max-width: 960px; margin: 0 auto; padding: 40px 24px;">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 40px;">
      <!-- Brand -->
      <div style="flex: 1; min-width: 200px;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 6px;"></div>
          <span style="font-size: 1rem; font-weight: 600; color: #f7f9fa;">Socket Library</span>
        </div>
        <p style="color: #8b98a5; font-size: 0.8125rem; line-height: 1.6; margin: 0;">
          High-performance socket toolkit for POSIX systems with exception-based error handling and TLS 1.3 support.
        </p>
      </div>
      <!-- Links -->
      <div style="display: flex; gap: 48px; flex-wrap: wrap;">
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Documentation</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="index.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Getting Started</a></li>
            <li style="margin: 6px 0;"><a href="annotated.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Data Structures</a></li>
            <li style="margin: 6px 0;"><a href="globals.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">API Reference</a></li>
          </ul>
        </div>
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Resources</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="files.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Header Files</a></li>
            <li style="margin: 6px 0;"><a href="https://x.com/tetsuocorp" target="_blank" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Twitter/X</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Bottom -->
    <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #30363d; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
      <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 0.75rem; font-weight: 500; color: #10b981; background: rgba(16, 185, 129, 0.1); padding: 4px 8px; border-radius: 4px;">C11</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #3b82f6; background: rgba(59, 130, 246, 0.1); padding: 4px 8px; border-radius: 4px;">POSIX</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #8b5cf6; background: rgba(139, 92, 246, 0.1); padding: 4px 8px; border-radius: 4px;">TLS 1.3</span>
      </div>
      <div style="color: #6e7681; font-size: 0.75rem; display: flex; align-items: center; gap: 8px;">
        <span> 2025 Tetsuo Corporation</span>
        <span style="color: #30363d;"></span>
        <a href="https://opensource.org/licenses/MIT" target="_blank" style="color: #8b98a5; text-decoration: none;">MIT License</a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
