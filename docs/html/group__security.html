<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="High-performance, exception-driven socket toolkit for POSIX systems">
<meta name="keywords" content="socket, networking, C, POSIX, TCP, UDP, TLS, async, high-performance, library">
<meta name="author" content="Tetsuo Corporation">
<meta name="theme-color" content="#3b82f6">
<title>Security Modules</title>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%233b82f6'/><stop offset='100%25' stop-color='%238b5cf6'/></linearGradient></defs><rect width='100' height='100' rx='20' fill='url(%23g)'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white' font-family='sans-serif' font-weight='bold'>S</text></svg>">
</head>
<body>
<div id="top">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Socket Library<span id="projectnumber">1.0.0</span></div>
   <div id="projectbrief">High-performance, exception-driven socket toolkit for POSIX systems</div>
  </td>
  <td style="text-align: right; padding: 20px; vertical-align: middle;">
    <div style="display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap; align-items: center;">
      <a href="index.html" class="quick-link">Home</a>
      <a href="annotated.html" class="quick-link">Structures</a>
      <a href="files.html" class="quick-link">Files</a>
      <a href="globals.html" class="quick-link">API</a>
    </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__security.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">Security Modules</div></div>
</div><!--header-->
<div class="contents">

<p>Comprehensive security protections for network applications.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for Security Modules:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__security.svg" width="491" height="314"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="groups" name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__ip__tracker" id="r_group__ip__tracker"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__ip__tracker.html">IP Connection Tracking</a></td></tr>
<tr class="memdesc:group__ip__tracker"><td class="mdescLeft">&#160;</td><td class="mdescRight">Per-IP connection tracking for rate limiting and DoS protection. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__dtls" id="r_group__dtls"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls.html">Datagram TLS (DTLS) Module</a></td></tr>
<tr class="memdesc:group__dtls"><td class="mdescLeft">&#160;</td><td class="mdescRight">Secure datagram communication using DTLS over UDP sockets. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__dtls__config" id="r_group__dtls__config"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__config.html">DTLS Configuration Constants</a></td></tr>
<tr class="memdesc:group__dtls__config"><td class="mdescLeft">&#160;</td><td class="mdescRight">Secure default constants for DTLS protocol parameters, MTU management, cookie protection, timeouts, and DoS protection limits. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__dtls__context" id="r_group__dtls__context"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html">DTLS Context Management</a></td></tr>
<tr class="memdesc:group__dtls__context"><td class="mdescLeft">&#160;</td><td class="mdescRight">Secure DTLS context configuration and lifecycle management. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__tls__config" id="r_group__tls__config"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__config.html">TLS Configuration Constants</a></td></tr>
<tr class="memdesc:group__tls__config"><td class="mdescLeft">&#160;</td><td class="mdescRight">Secure default constants for TLS protocol versions, cipher suites, timeouts, buffers, and security limits. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__tls__context" id="r_group__tls__context"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__context.html">TLS Context Management</a></td></tr>
<tr class="memdesc:group__tls__context"><td class="mdescLeft">&#160;</td><td class="mdescRight">Secure TLS context configuration, certificate handling, and advanced features like OCSP stapling, pinning, and CT. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:SocketSYNProtect-private_8h" id="r_SocketSYNProtect-private_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketSYNProtect-private_8h.html">SocketSYNProtect-private.h</a></td></tr>
<tr class="memdesc:SocketSYNProtect-private_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal SYN flood protection implementation details for the <a class="el" href="group__security.html">Security Modules</a> group. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:SocketSYNProtect_8h" id="r_SocketSYNProtect_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketSYNProtect_8h.html">SocketSYNProtect.h</a></td></tr>
<tr class="memdesc:SocketSYNProtect_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">SYN flood protection using IP reputation and adaptive rate limiting. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:SocketDTLS-private_8h" id="r_SocketDTLS-private_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketDTLS-private_8h.html">SocketDTLS-private.h</a></td></tr>
<tr class="memdesc:SocketDTLS-private_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">DTLS internal shared definitions and helper functions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:SocketDTLSConfig_8h" id="r_SocketDTLSConfig_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketDTLSConfig_8h.html">SocketDTLSConfig.h</a></td></tr>
<tr class="memdesc:SocketDTLSConfig_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">DTLS configuration constants and secure defaults. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:SocketTLS-private_8h" id="r_SocketTLS-private_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS-private_8h.html">SocketTLS-private.h</a></td></tr>
<tr class="memdesc:SocketTLS-private_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal TLS module shared definitions, macros, and helper functions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:SocketTLS_8h" id="r_SocketTLS_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLS_8h.html">SocketTLS.h</a></td></tr>
<tr class="memdesc:SocketTLS_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">High-level TLS/SSL integration for secure Socket I/O with TLS 1.3 enforcement. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:SocketTLSConfig_8h" id="r_SocketTLSConfig_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketTLSConfig_8h.html">SocketTLSConfig.h</a></td></tr>
<tr class="memdesc:SocketTLSConfig_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS configuration constants, structure, and secure defaults. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structSocketSYN__IPEntry" id="r_structSocketSYN__IPEntry"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketSYN__IPEntry">SocketSYN_IPEntry</a></td></tr>
<tr class="memdesc:structSocketSYN__IPEntry"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal IP tracking entry for hash table and LRU management.  <a href="group__security.html#structSocketSYN__IPEntry">More...</a><br /></td></tr>
<tr class="separator:structSocketSYN__IPEntry"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketSYN__WhitelistEntry" id="r_structSocketSYN__WhitelistEntry"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketSYN__WhitelistEntry">SocketSYN_WhitelistEntry</a></td></tr>
<tr class="memdesc:structSocketSYN__WhitelistEntry"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for whitelist entries supporting single IPs and CIDR ranges.  <a href="group__security.html#structSocketSYN__WhitelistEntry">More...</a><br /></td></tr>
<tr class="separator:structSocketSYN__WhitelistEntry"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketSYN__BlacklistEntry" id="r_structSocketSYN__BlacklistEntry"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketSYN__BlacklistEntry">SocketSYN_BlacklistEntry</a></td></tr>
<tr class="memdesc:structSocketSYN__BlacklistEntry"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal structure for blacklisted IP addresses with expiry support.  <a href="group__security.html#structSocketSYN__BlacklistEntry">More...</a><br /></td></tr>
<tr class="separator:structSocketSYN__BlacklistEntry"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketSYNProtect__T" id="r_structSocketSYNProtect__T"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a></td></tr>
<tr class="memdesc:structSocketSYNProtect__T"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core internal structure for the SYN protection module.  <a href="group__security.html#structSocketSYNProtect__T">More...</a><br /></td></tr>
<tr class="separator:structSocketSYNProtect__T"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketSYN__IPState" id="r_structSocketSYN__IPState"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a></td></tr>
<tr class="memdesc:structSocketSYN__IPState"><td class="mdescLeft">&#160;</td><td class="mdescRight">Per-IP address tracking and reputation state.  <a href="group__security.html#structSocketSYN__IPState">More...</a><br /></td></tr>
<tr class="separator:structSocketSYN__IPState"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketSYNProtect__Config" id="r_structSocketSYNProtect__Config"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a></td></tr>
<tr class="memdesc:structSocketSYNProtect__Config"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration parameters for SYN flood protection.  <a href="group__security.html#structSocketSYNProtect__Config">More...</a><br /></td></tr>
<tr class="separator:structSocketSYNProtect__Config"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketSYNProtect__Stats" id="r_structSocketSYNProtect__Stats"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a></td></tr>
<tr class="memdesc:structSocketSYNProtect__Stats"><td class="mdescLeft">&#160;</td><td class="mdescRight">Statistics snapshot for SYN protection activity.  <a href="group__security.html#structSocketSYNProtect__Stats">More...</a><br /></td></tr>
<tr class="separator:structSocketSYNProtect__Stats"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structDTLSContextCookie" id="r_structDTLSContextCookie"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structDTLSContextCookie">DTLSContextCookie</a></td></tr>
<tr class="memdesc:structDTLSContextCookie"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cookie state structure for server-side DTLS cookie exchange.  <a href="group__security.html#structDTLSContextCookie">More...</a><br /></td></tr>
<tr class="separator:structDTLSContextCookie"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structDTLSContextALPN" id="r_structDTLSContextALPN"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structDTLSContextALPN">DTLSContextALPN</a></td></tr>
<tr class="memdesc:structDTLSContextALPN"><td class="mdescLeft">&#160;</td><td class="mdescRight">ALPN configuration structure for DTLS contexts.  <a href="group__security.html#structDTLSContextALPN">More...</a><br /></td></tr>
<tr class="separator:structDTLSContextALPN"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketDTLSContext__T" id="r_structSocketDTLSContext__T"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a></td></tr>
<tr class="memdesc:structSocketDTLSContext__T"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> - DTLS Context Structure.  <a href="group__security.html#structSocketDTLSContext__T">More...</a><br /></td></tr>
<tr class="separator:structSocketDTLSContext__T"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structTLSCertPin" id="r_structTLSCertPin"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structTLSCertPin">TLSCertPin</a></td></tr>
<tr class="memdesc:structTLSCertPin"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="group__security.html#structTLSCertPin" title="TLSCertPin - Single certificate pin entry (SPKI SHA256 hash)">TLSCertPin</a> - Single certificate pin entry (SPKI SHA256 hash)  <a href="group__security.html#structTLSCertPin">More...</a><br /></td></tr>
<tr class="separator:structTLSCertPin"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structTLSContextPinning" id="r_structTLSContextPinning"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structTLSContextPinning">TLSContextPinning</a></td></tr>
<tr class="memdesc:structTLSContextPinning"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="group__security.html#structTLSContextPinning" title="TLSContextPinning - Certificate pinning configuration.">TLSContextPinning</a> - Certificate pinning configuration.  <a href="group__security.html#structTLSContextPinning">More...</a><br /></td></tr>
<tr class="separator:structTLSContextPinning"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTLSContextSNICerts.html">TLSContextSNICerts</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Structure for managing SNI certificate mappings in TLS context.  <a href="structTLSContextSNICerts.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structTLSContextALPN" id="r_structTLSContextALPN"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structTLSContextALPN">TLSContextALPN</a></td></tr>
<tr class="memdesc:structTLSContextALPN"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration for ALPN protocol negotiation.  <a href="group__security.html#structTLSContextALPN">More...</a><br /></td></tr>
<tr class="separator:structTLSContextALPN"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketTLSContext__T" id="r_structSocketTLSContext__T"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a></td></tr>
<tr class="memdesc:structSocketTLSContext__T"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates, verification, ALPN, and session caching.  <a href="group__security.html#structSocketTLSContext__T">More...</a><br /></td></tr>
<tr class="separator:structSocketTLSContext__T"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:structSocketTLSConfig__T" id="r_structSocketTLSConfig__T"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a></td></tr>
<tr class="memdesc:structSocketTLSConfig__T"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS configuration parameters for customizing TLS protocol versions and other settings.  <a href="group__tls__config.html#structSocketTLSConfig__T">More...</a><br /></td></tr>
<tr class="separator:structSocketTLSConfig__T"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gae062b2bac82d2ca78edc6658135b25a4" id="r_gae062b2bac82d2ca78edc6658135b25a4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae062b2bac82d2ca78edc6658135b25a4">SOCKET_SYN_DEFAULT_WINDOW_MS</a>&#160;&#160;&#160;10000</td></tr>
<tr class="memdesc:gae062b2bac82d2ca78edc6658135b25a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sliding window duration for rate measurement.  <br /></td></tr>
<tr class="separator:gae062b2bac82d2ca78edc6658135b25a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8c43db9a86f5f49f85c535b7e01a9cd2" id="r_ga8c43db9a86f5f49f85c535b7e01a9cd2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8c43db9a86f5f49f85c535b7e01a9cd2">SOCKET_SYN_DEFAULT_MAX_PER_WINDOW</a>&#160;&#160;&#160;50</td></tr>
<tr class="memdesc:ga8c43db9a86f5f49f85c535b7e01a9cd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum connection attempts per IP per window.  <br /></td></tr>
<tr class="separator:ga8c43db9a86f5f49f85c535b7e01a9cd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf02ac0a68cee3923b135a1e423622f61" id="r_gaf02ac0a68cee3923b135a1e423622f61"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaf02ac0a68cee3923b135a1e423622f61">SOCKET_SYN_DEFAULT_GLOBAL_PER_SEC</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:gaf02ac0a68cee3923b135a1e423622f61"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global connection rate limit.  <br /></td></tr>
<tr class="separator:gaf02ac0a68cee3923b135a1e423622f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae0b03e45dca47aec6f4203011b1161f3" id="r_gae0b03e45dca47aec6f4203011b1161f3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae0b03e45dca47aec6f4203011b1161f3">SOCKET_SYN_DEFAULT_MIN_SUCCESS_RATIO</a>&#160;&#160;&#160;0.3f</td></tr>
<tr class="memdesc:gae0b03e45dca47aec6f4203011b1161f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minimum success/attempt ratio before IP becomes suspect.  <br /></td></tr>
<tr class="separator:gae0b03e45dca47aec6f4203011b1161f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae5bbd0b37027680dfa2c0c58773fef6" id="r_gaae5bbd0b37027680dfa2c0c58773fef6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaae5bbd0b37027680dfa2c0c58773fef6">SOCKET_SYN_DEFAULT_THROTTLE_DELAY_MS</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:gaae5bbd0b37027680dfa2c0c58773fef6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Artificial delay for throttled connections.  <br /></td></tr>
<tr class="separator:gaae5bbd0b37027680dfa2c0c58773fef6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaff44ca76156e6010520f4d231fbf7109" id="r_gaff44ca76156e6010520f4d231fbf7109"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaff44ca76156e6010520f4d231fbf7109">SOCKET_SYN_DEFAULT_BLOCK_DURATION_MS</a>&#160;&#160;&#160;60000</td></tr>
<tr class="memdesc:gaff44ca76156e6010520f4d231fbf7109"><td class="mdescLeft">&#160;</td><td class="mdescRight">Block duration for misbehaving IPs.  <br /></td></tr>
<tr class="separator:gaff44ca76156e6010520f4d231fbf7109"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7883d7f2995a8046776d818de6dbaa2e" id="r_ga7883d7f2995a8046776d818de6dbaa2e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga7883d7f2995a8046776d818de6dbaa2e">SOCKET_SYN_DEFAULT_DEFER_SEC</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:ga7883d7f2995a8046776d818de6dbaa2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">TCP_DEFER_ACCEPT timeout for challenged connections.  <br /></td></tr>
<tr class="separator:ga7883d7f2995a8046776d818de6dbaa2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a91a7da051b6462f126bc329f1e5cda" id="r_ga8a91a7da051b6462f126bc329f1e5cda"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8a91a7da051b6462f126bc329f1e5cda">SOCKET_SYN_DEFAULT_SCORE_THROTTLE</a>&#160;&#160;&#160;0.7f</td></tr>
<tr class="memdesc:ga8a91a7da051b6462f126bc329f1e5cda"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score threshold below which connections are throttled.  <br /></td></tr>
<tr class="separator:ga8a91a7da051b6462f126bc329f1e5cda"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67a51dcadef9eb934f3342e9e02f6fd5" id="r_ga67a51dcadef9eb934f3342e9e02f6fd5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga67a51dcadef9eb934f3342e9e02f6fd5">SOCKET_SYN_DEFAULT_SCORE_CHALLENGE</a>&#160;&#160;&#160;0.4f</td></tr>
<tr class="memdesc:ga67a51dcadef9eb934f3342e9e02f6fd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score threshold below which connections are challenged.  <br /></td></tr>
<tr class="separator:ga67a51dcadef9eb934f3342e9e02f6fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9608aa5a6bbbe4cbc60c9442d094cfd0" id="r_ga9608aa5a6bbbe4cbc60c9442d094cfd0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9608aa5a6bbbe4cbc60c9442d094cfd0">SOCKET_SYN_DEFAULT_SCORE_BLOCK</a>&#160;&#160;&#160;0.2f</td></tr>
<tr class="memdesc:ga9608aa5a6bbbe4cbc60c9442d094cfd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score threshold below which connections are blocked.  <br /></td></tr>
<tr class="separator:ga9608aa5a6bbbe4cbc60c9442d094cfd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b8d879d7477b5a59170487f2ef38cd0" id="r_ga8b8d879d7477b5a59170487f2ef38cd0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8b8d879d7477b5a59170487f2ef38cd0">SOCKET_SYN_DEFAULT_SCORE_DECAY</a>&#160;&#160;&#160;0.01f</td></tr>
<tr class="memdesc:ga8b8d879d7477b5a59170487f2ef38cd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score recovery rate per second.  <br /></td></tr>
<tr class="separator:ga8b8d879d7477b5a59170487f2ef38cd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4122f191a253666fdb691929b3cd4173" id="r_ga4122f191a253666fdb691929b3cd4173"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4122f191a253666fdb691929b3cd4173">SOCKET_SYN_DEFAULT_PENALTY_ATTEMPT</a>&#160;&#160;&#160;0.02f</td></tr>
<tr class="memdesc:ga4122f191a253666fdb691929b3cd4173"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score penalty per new connection attempt.  <br /></td></tr>
<tr class="separator:ga4122f191a253666fdb691929b3cd4173"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f01c6ca60bf199d42dde59f0159074c" id="r_ga4f01c6ca60bf199d42dde59f0159074c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4f01c6ca60bf199d42dde59f0159074c">SOCKET_SYN_DEFAULT_PENALTY_FAILURE</a>&#160;&#160;&#160;0.05f</td></tr>
<tr class="memdesc:ga4f01c6ca60bf199d42dde59f0159074c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score penalty per connection failure.  <br /></td></tr>
<tr class="separator:ga4f01c6ca60bf199d42dde59f0159074c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a0acbe7229a03abfe70205717d511c4" id="r_ga9a0acbe7229a03abfe70205717d511c4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9a0acbe7229a03abfe70205717d511c4">SOCKET_SYN_DEFAULT_REWARD_SUCCESS</a>&#160;&#160;&#160;0.05f</td></tr>
<tr class="memdesc:ga9a0acbe7229a03abfe70205717d511c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score reward per successful connection.  <br /></td></tr>
<tr class="separator:ga9a0acbe7229a03abfe70205717d511c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga842d1a441b3a55a43f2066087ff6ff59" id="r_ga842d1a441b3a55a43f2066087ff6ff59"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga842d1a441b3a55a43f2066087ff6ff59">SOCKET_SYN_DEFAULT_MAX_TRACKED_IPS</a>&#160;&#160;&#160;100000</td></tr>
<tr class="memdesc:ga842d1a441b3a55a43f2066087ff6ff59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum unique IPs to track.  <br /></td></tr>
<tr class="separator:ga842d1a441b3a55a43f2066087ff6ff59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1a28d9573c05725ca3abb96239b83ee" id="r_gac1a28d9573c05725ca3abb96239b83ee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac1a28d9573c05725ca3abb96239b83ee">SOCKET_SYN_DEFAULT_MAX_WHITELIST</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:gac1a28d9573c05725ca3abb96239b83ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum whitelist entries.  <br /></td></tr>
<tr class="separator:gac1a28d9573c05725ca3abb96239b83ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac82e2e73ae29b0b0e8699d8b81bb29c3" id="r_gac82e2e73ae29b0b0e8699d8b81bb29c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac82e2e73ae29b0b0e8699d8b81bb29c3">SOCKET_SYN_DEFAULT_MAX_BLACKLIST</a>&#160;&#160;&#160;10000</td></tr>
<tr class="memdesc:gac82e2e73ae29b0b0e8699d8b81bb29c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum blacklist entries.  <br /></td></tr>
<tr class="separator:gac82e2e73ae29b0b0e8699d8b81bb29c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab0908a428243a18d0260754d417e023a" id="r_gab0908a428243a18d0260754d417e023a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab0908a428243a18d0260754d417e023a">SOCKET_SYN_TRUSTED_SCORE_THRESHOLD</a>&#160;&#160;&#160;0.9f</td></tr>
<tr class="memdesc:gab0908a428243a18d0260754d417e023a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Score threshold at or above which IP is considered trusted.  <br /></td></tr>
<tr class="separator:gab0908a428243a18d0260754d417e023a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga812e1a3066fafa145324e13ec013cb47" id="r_ga812e1a3066fafa145324e13ec013cb47"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga812e1a3066fafa145324e13ec013cb47">SOCKET_IPV6_ADDR_BYTES</a>&#160;&#160;&#160;16</td></tr>
<tr class="memdesc:ga812e1a3066fafa145324e13ec013cb47"><td class="mdescLeft">&#160;</td><td class="mdescRight">IPv6 address size in bytes.  <br /></td></tr>
<tr class="separator:ga812e1a3066fafa145324e13ec013cb47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1b769b5903588b4e6cbd40864a30d8e" id="r_gae1b769b5903588b4e6cbd40864a30d8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae1b769b5903588b4e6cbd40864a30d8e">SOCKET_IPV4_ADDR_BYTES</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:gae1b769b5903588b4e6cbd40864a30d8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">IPv4 address size in bytes.  <br /></td></tr>
<tr class="separator:gae1b769b5903588b4e6cbd40864a30d8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c869f123d7c29c39cfe7d1dedd998a0" id="r_ga0c869f123d7c29c39cfe7d1dedd998a0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0c869f123d7c29c39cfe7d1dedd998a0">SOCKET_BITS_PER_BYTE</a>&#160;&#160;&#160;8</td></tr>
<tr class="memdesc:ga0c869f123d7c29c39cfe7d1dedd998a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bits per byte.  <br /></td></tr>
<tr class="separator:ga0c869f123d7c29c39cfe7d1dedd998a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga25080e819a36fcf9aede01a6e7298ea4" id="r_ga25080e819a36fcf9aede01a6e7298ea4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga25080e819a36fcf9aede01a6e7298ea4">IOV_MAX</a>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:ga25080e819a36fcf9aede01a6e7298ea4"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS/SSL support flag.  <br /></td></tr>
<tr class="separator:ga25080e819a36fcf9aede01a6e7298ea4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab97bd3e7337b376f6be804f25d4d9c6d" id="r_gab97bd3e7337b376f6be804f25d4d9c6d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab97bd3e7337b376f6be804f25d4d9c6d">SOCKET_HAS_TCP_DEFER_ACCEPT</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:gab97bd3e7337b376f6be804f25d4d9c6d"><td class="mdescLeft">&#160;</td><td class="mdescRight">TCP_DEFER_ACCEPT option for SYN flood protection.  <br /></td></tr>
<tr class="separator:gab97bd3e7337b376f6be804f25d4d9c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga219b0a63c1ee02ecb27a9c932da08a51" id="r_ga219b0a63c1ee02ecb27a9c932da08a51"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga219b0a63c1ee02ecb27a9c932da08a51">SOCKET_HAS_SO_ACCEPTFILTER</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:ga219b0a63c1ee02ecb27a9c932da08a51"><td class="mdescLeft">&#160;</td><td class="mdescRight">SO_ACCEPTFILTER support flag.  <br /></td></tr>
<tr class="separator:ga219b0a63c1ee02ecb27a9c932da08a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0acb682b8260ab1c60b918599864e2e5" id="r_ga0acb682b8260ab1c60b918599864e2e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0acb682b8260ab1c60b918599864e2e5">T</a>&#160;&#160;&#160;<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a></td></tr>
<tr class="memdesc:ga0acb682b8260ab1c60b918599864e2e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque type for IP connection tracker instance.  <br /></td></tr>
<tr class="separator:ga0acb682b8260ab1c60b918599864e2e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3714b05d28ef69f2bc3b95b17abde741" id="r_ga3714b05d28ef69f2bc3b95b17abde741"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga3714b05d28ef69f2bc3b95b17abde741">SOCKET_SYN_IP_HASH_SIZE</a>&#160;&#160;&#160;4093</td></tr>
<tr class="memdesc:ga3714b05d28ef69f2bc3b95b17abde741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default hash table size for IP state tracking entries.  <br /></td></tr>
<tr class="separator:ga3714b05d28ef69f2bc3b95b17abde741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e75c0e89d959bd3fa395f8307c1ba65" id="r_ga2e75c0e89d959bd3fa395f8307c1ba65"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga2e75c0e89d959bd3fa395f8307c1ba65">SOCKET_SYN_LIST_HASH_SIZE</a>&#160;&#160;&#160;509</td></tr>
<tr class="memdesc:ga2e75c0e89d959bd3fa395f8307c1ba65"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default hash table size for whitelist and blacklist entries.  <br /></td></tr>
<tr class="separator:ga2e75c0e89d959bd3fa395f8307c1ba65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae82758ef1761626baf114a11955520e1" id="r_gae82758ef1761626baf114a11955520e1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae82758ef1761626baf114a11955520e1">SOCKET_SYN_INITIAL_SCORE</a>&#160;&#160;&#160;0.8f</td></tr>
<tr class="memdesc:gae82758ef1761626baf114a11955520e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial reputation score for newly encountered IP addresses.  <br /></td></tr>
<tr class="separator:gae82758ef1761626baf114a11955520e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94b45dbd0567c33d239bcfe0b8de2391" id="r_ga94b45dbd0567c33d239bcfe0b8de2391"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga94b45dbd0567c33d239bcfe0b8de2391">SOCKET_SYN_TRUSTED_SCORE</a>&#160;&#160;&#160;1.0f</td></tr>
<tr class="memdesc:ga94b45dbd0567c33d239bcfe0b8de2391"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reputation score assigned to whitelisted or fully trusted IPs.  <br /></td></tr>
<tr class="separator:ga94b45dbd0567c33d239bcfe0b8de2391"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89596d086483db6027b30bdd41bb04dd" id="r_ga89596d086483db6027b30bdd41bb04dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga89596d086483db6027b30bdd41bb04dd">SOCKET_SYN_MAX_CIDR_ENTRIES</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:ga89596d086483db6027b30bdd41bb04dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of whitelist entries (CIDR ranges or single IPs).  <br /></td></tr>
<tr class="separator:ga89596d086483db6027b30bdd41bb04dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0acb682b8260ab1c60b918599864e2e5" id="r_ga0acb682b8260ab1c60b918599864e2e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0acb682b8260ab1c60b918599864e2e5">T</a>&#160;&#160;&#160;<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a></td></tr>
<tr class="separator:ga0acb682b8260ab1c60b918599864e2e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1cfa464ec20b460ebee063b82b6100bf" id="r_ga1cfa464ec20b460ebee063b82b6100bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a>(exception)&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (SocketDTLS, exception)</td></tr>
<tr class="memdesc:ga1cfa464ec20b460ebee063b82b6100bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raise a SocketDTLS module exception with automatically populated error details.  <br /></td></tr>
<tr class="separator:ga1cfa464ec20b460ebee063b82b6100bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafbc899f00128359bdc6d2f9d02e8944" id="r_gaafbc899f00128359bdc6d2f9d02e8944"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944">RAISE_DTLS_ERROR_MSG</a>(exception,  msg)</td></tr>
<tr class="memdesc:gaafbc899f00128359bdc6d2f9d02e8944"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raise a SocketDTLS exception with formatted error message and arguments.  <br /></td></tr>
<tr class="separator:gaafbc899f00128359bdc6d2f9d02e8944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga04c1b681fb568ffc8c89a37bcdcbcf80" id="r_ga04c1b681fb568ffc8c89a37bcdcbcf80"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga04c1b681fb568ffc8c89a37bcdcbcf80">REQUIRE_DTLS_ENABLED</a>(socket,  exception)</td></tr>
<tr class="memdesc:ga04c1b681fb568ffc8c89a37bcdcbcf80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate that DTLS is enabled on a socket, raising exception if not.  <br /></td></tr>
<tr class="separator:ga04c1b681fb568ffc8c89a37bcdcbcf80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacca68f6e3be556e42dcd9ab54da96ded" id="r_gacca68f6e3be556e42dcd9ab54da96ded"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded">DTLS_ERROR_MSG</a>(msg)&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (msg)</td></tr>
<tr class="memdesc:gacca68f6e3be556e42dcd9ab54da96ded"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format a simple static error message into the thread-local error buffer.  <br /></td></tr>
<tr class="separator:gacca68f6e3be556e42dcd9ab54da96ded"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e97bd0cd12ea34b564755e1a377d02f" id="r_ga4e97bd0cd12ea34b564755e1a377d02f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f">DTLS_ERROR_FMT</a>(fmt, ...)&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#adf114e63024eabf6e40f1ed7f89c79b8">SOCKET_ERROR_FMT</a> (fmt, ##__VA_ARGS__)</td></tr>
<tr class="memdesc:ga4e97bd0cd12ea34b564755e1a377d02f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format error message with printf-style arguments into thread-local buffer.  <br /></td></tr>
<tr class="separator:ga4e97bd0cd12ea34b564755e1a377d02f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga223a7b4bdc35b2cd8c8828e3fd709414" id="r_ga223a7b4bdc35b2cd8c8828e3fd709414"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga223a7b4bdc35b2cd8c8828e3fd709414">VALIDATE_DTLS_IO_READY</a>(socket,  exception)</td></tr>
<tr class="memdesc:ga223a7b4bdc35b2cd8c8828e3fd709414"><td class="mdescLeft">&#160;</td><td class="mdescRight">Comprehensive validation macro for DTLS socket readiness before I/O operations.  <br /></td></tr>
<tr class="separator:ga223a7b4bdc35b2cd8c8828e3fd709414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fae8ada292cad16870182392605c800" id="r_ga4fae8ada292cad16870182392605c800"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4fae8ada292cad16870182392605c800">RAISE_DTLS_CTX_ERROR</a>(exception)</td></tr>
<tr class="memdesc:ga4fae8ada292cad16870182392605c800"><td class="mdescLeft">&#160;</td><td class="mdescRight">RAISE_DTLS_CTX_ERROR - Raise context exception with current error buffer.  <br /></td></tr>
<tr class="separator:ga4fae8ada292cad16870182392605c800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac6bd008a794ad4ea28353a67d189fd7c" id="r_gac6bd008a794ad4ea28353a67d189fd7c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac6bd008a794ad4ea28353a67d189fd7c">RAISE_DTLS_CTX_ERROR_MSG</a>(exception,  msg)</td></tr>
<tr class="memdesc:gac6bd008a794ad4ea28353a67d189fd7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">RAISE_DTLS_CTX_ERROR_MSG - Raise context exception with formatted message.  <br /></td></tr>
<tr class="separator:gac6bd008a794ad4ea28353a67d189fd7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7d623f22e9e764aba13c6b053c1506f" id="r_gad7d623f22e9e764aba13c6b053c1506f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad7d623f22e9e764aba13c6b053c1506f">DTLS_UNUSED</a>(x)&#160;&#160;&#160;(void)(x)</td></tr>
<tr class="memdesc:gad7d623f22e9e764aba13c6b053c1506f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suppress unused parameter compiler warnings.  <br /></td></tr>
<tr class="separator:gad7d623f22e9e764aba13c6b053c1506f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaa5d5a165d617e880e0761f54333d859" id="r_gaaa5d5a165d617e880e0761f54333d859"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaaa5d5a165d617e880e0761f54333d859">RAISE_TLS_ERROR</a>(exception)&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (SocketTLS, exception)</td></tr>
<tr class="memdesc:gaaa5d5a165d617e880e0761f54333d859"><td class="mdescLeft">&#160;</td><td class="mdescRight">tls_error_buf - Thread-local TLS error message buffer (see <a class="el" href="SocketTLS_8h.html" title="High-level TLS/SSL integration for secure Socket I/O with TLS 1.3 enforcement.">SocketTLS.h</a> for details).  <br /></td></tr>
<tr class="separator:gaaa5d5a165d617e880e0761f54333d859"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa846eebc97332827b77e55db99ba9895" id="r_gaa846eebc97332827b77e55db99ba9895"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaa846eebc97332827b77e55db99ba9895">RAISE_TLS_ERROR_MSG</a>(exception,  fmt, ...)&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aa7d4ca3a984cb2df9849f6b501d65cc3">SOCKET_RAISE_MSG</a> (SocketTLS, exception, fmt, ##__VA_ARGS__)</td></tr>
<tr class="memdesc:gaa846eebc97332827b77e55db99ba9895"><td class="mdescLeft">&#160;</td><td class="mdescRight">RAISE_TLS_ERROR_MSG - Raise TLS exception with formatted message.  <br /></td></tr>
<tr class="separator:gaa846eebc97332827b77e55db99ba9895"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6bcf5ec61bfa6d15fb692b360e8ab2c7" id="r_ga6bcf5ec61bfa6d15fb692b360e8ab2c7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga6bcf5ec61bfa6d15fb692b360e8ab2c7">REQUIRE_TLS_ENABLED</a>(socket,  exception)</td></tr>
<tr class="memdesc:ga6bcf5ec61bfa6d15fb692b360e8ab2c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">REQUIRE_TLS_ENABLED - Validate TLS is enabled on socket.  <br /></td></tr>
<tr class="separator:ga6bcf5ec61bfa6d15fb692b360e8ab2c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga839d12558ca20b9a5fd8fa25fa7db99a" id="r_ga839d12558ca20b9a5fd8fa25fa7db99a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga839d12558ca20b9a5fd8fa25fa7db99a">TLS_ERROR_MSG</a>(msg)&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (&quot;%s&quot;, msg)</td></tr>
<tr class="memdesc:ga839d12558ca20b9a5fd8fa25fa7db99a"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS_ERROR_MSG - Format simple error message.  <br /></td></tr>
<tr class="separator:ga839d12558ca20b9a5fd8fa25fa7db99a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab9caf93eecdc58f0e12ae64ebe268290" id="r_gab9caf93eecdc58f0e12ae64ebe268290"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab9caf93eecdc58f0e12ae64ebe268290">TLS_ERROR_FMT</a>(fmt, ...)&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (fmt, __VA_ARGS__)</td></tr>
<tr class="memdesc:gab9caf93eecdc58f0e12ae64ebe268290"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS_ERROR_FMT - Format error message with arguments.  <br /></td></tr>
<tr class="separator:gab9caf93eecdc58f0e12ae64ebe268290"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d2d601289b5057ded1c7f81dd3212dc" id="r_ga0d2d601289b5057ded1c7f81dd3212dc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0d2d601289b5057ded1c7f81dd3212dc">VALIDATE_TLS_IO_READY</a>(socket,  exception)</td></tr>
<tr class="memdesc:ga0d2d601289b5057ded1c7f81dd3212dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">VALIDATE_TLS_IO_READY - Validate socket is ready for TLS I/O.  <br /></td></tr>
<tr class="separator:ga0d2d601289b5057ded1c7f81dd3212dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa514b917b04e794f8081ad2b4c4a3418" id="r_gaa514b917b04e794f8081ad2b4c4a3418"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaa514b917b04e794f8081ad2b4c4a3418">CRL_LOCK</a>(ctx)</td></tr>
<tr class="memdesc:gaa514b917b04e794f8081ad2b4c4a3418"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acquire lock on TLS context's CRL mutex.  <br /></td></tr>
<tr class="separator:gaa514b917b04e794f8081ad2b4c4a3418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga53ced6e38182130231a1ce309700ded4" id="r_ga53ced6e38182130231a1ce309700ded4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga53ced6e38182130231a1ce309700ded4">CRL_UNLOCK</a>(ctx)</td></tr>
<tr class="memdesc:ga53ced6e38182130231a1ce309700ded4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release lock on TLS context's CRL mutex.  <br /></td></tr>
<tr class="separator:ga53ced6e38182130231a1ce309700ded4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga179054cc1104e4de13a76ab914dae33b" id="r_ga179054cc1104e4de13a76ab914dae33b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga179054cc1104e4de13a76ab914dae33b">RAISE_CTX_ERROR</a>(exception)&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (SocketTLSContext, exception)</td></tr>
<tr class="memdesc:ga179054cc1104e4de13a76ab914dae33b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raise a SocketTLSContext module exception using current error state.  <br /></td></tr>
<tr class="separator:ga179054cc1104e4de13a76ab914dae33b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1239b3e52ccbd1cbfec9b485e6f83214" id="r_ga1239b3e52ccbd1cbfec9b485e6f83214"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1239b3e52ccbd1cbfec9b485e6f83214">RAISE_CTX_ERROR_MSG</a>(exception,  fmt, ...)&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aa7d4ca3a984cb2df9849f6b501d65cc3">SOCKET_RAISE_MSG</a> (SocketTLSContext, exception, fmt, ##__VA_ARGS__)</td></tr>
<tr class="memdesc:ga1239b3e52ccbd1cbfec9b485e6f83214"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raise a SocketTLSContext exception with formatted message.  <br /></td></tr>
<tr class="separator:ga1239b3e52ccbd1cbfec9b485e6f83214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20e5da948c90e67bb0a186f7a58416fc" id="r_ga20e5da948c90e67bb0a186f7a58416fc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga20e5da948c90e67bb0a186f7a58416fc">RAISE_CTX_ERROR_FMT</a>(exception,  fmt, ...)&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aa7d4ca3a984cb2df9849f6b501d65cc3">SOCKET_RAISE_MSG</a> (SocketTLSContext, exception, fmt, __VA_ARGS__)</td></tr>
<tr class="memdesc:ga20e5da948c90e67bb0a186f7a58416fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raise SocketTLSContext exception with variadic formatted message.  <br /></td></tr>
<tr class="separator:ga20e5da948c90e67bb0a186f7a58416fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ff1ea56cca8070de8806165d1b107ea" id="r_ga7ff1ea56cca8070de8806165d1b107ea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga7ff1ea56cca8070de8806165d1b107ea">TLS_UNUSED</a>(x)&#160;&#160;&#160;(void)(x)</td></tr>
<tr class="memdesc:ga7ff1ea56cca8070de8806165d1b107ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suppress compiler warnings for intentionally unused parameters.  <br /></td></tr>
<tr class="separator:ga7ff1ea56cca8070de8806165d1b107ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0acb682b8260ab1c60b918599864e2e5" id="r_ga0acb682b8260ab1c60b918599864e2e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0acb682b8260ab1c60b918599864e2e5">T</a>&#160;&#160;&#160;<a class="el" href="group__security.html#ga63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td></tr>
<tr class="separator:ga0acb682b8260ab1c60b918599864e2e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga63e73c93350813167a68162c5cb3d819" id="r_ga63e73c93350813167a68162c5cb3d819"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="group__security.html#ga63e73c93350813167a68162c5cb3d819">SocketTLS_T</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td></tr>
<tr class="separator:ga63e73c93350813167a68162c5cb3d819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9a12208531822c8304c23dcbcb8ba97" id="r_gac9a12208531822c8304c23dcbcb8ba97"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac9a12208531822c8304c23dcbcb8ba97">SocketTLSVerifyCallback</a>) (int preverify_ok, X509_STORE_CTX *x509_ctx, <a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> tls_ctx, Socket_T socket, void *user_data)</td></tr>
<tr class="memdesc:gac9a12208531822c8304c23dcbcb8ba97"><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined certificate verification callback.  <br /></td></tr>
<tr class="separator:gac9a12208531822c8304c23dcbcb8ba97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga60686895b6fbdd1290a6f6176484bf5b" id="r_ga60686895b6fbdd1290a6f6176484bf5b"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga60686895b6fbdd1290a6f6176484bf5b">SocketTLSCrlCallback</a>) (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *path, int success, void *user_data)</td></tr>
<tr class="memdesc:ga60686895b6fbdd1290a6f6176484bf5b"><td class="mdescLeft">&#160;</td><td class="mdescRight">CRL refresh notification callback.  <br /></td></tr>
<tr class="separator:ga60686895b6fbdd1290a6f6176484bf5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1acd7a590114ffbf4307a6f5a3bab35c" id="r_ga1acd7a590114ffbf4307a6f5a3bab35c"><td class="memItemLeft" align="right" valign="top">typedef OCSP_RESPONSE *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1acd7a590114ffbf4307a6f5a3bab35c">SocketTLSOcspGenCallback</a>) (SSL *ssl, void *arg)</td></tr>
<tr class="memdesc:ga1acd7a590114ffbf4307a6f5a3bab35c"><td class="mdescLeft">&#160;</td><td class="mdescRight">OCSP response generation callback for dynamic stapling on server-side TLS handshakes.  <br /></td></tr>
<tr class="separator:ga1acd7a590114ffbf4307a6f5a3bab35c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c2914ee879d575869932c3a3aed4863" id="r_ga5c2914ee879d575869932c3a3aed4863"><td class="memItemLeft" align="right" valign="top">typedef X509 *(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga5c2914ee879d575869932c3a3aed4863">SocketTLSCertLookupCallback</a>) (X509_STORE_CTX *store_ctx, X509_NAME *name, void *user_data)</td></tr>
<tr class="memdesc:ga5c2914ee879d575869932c3a3aed4863"><td class="mdescLeft">&#160;</td><td class="mdescRight">Custom certificate lookup function.  <br /></td></tr>
<tr class="separator:ga5c2914ee879d575869932c3a3aed4863"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:gaca8f2a71ab649ccd408fd3fdb3b693b9" id="r_gaca8f2a71ab649ccd408fd3fdb3b693b9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> { <br />
&#160;&#160;<a class="el" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9ab7af7c3605f188d109f9528dd72a7af8">SYN_ACTION_ALLOW</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9a57b3e54beba358c83e8a91f2136d61d9">SYN_ACTION_THROTTLE</a>
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9a47e6cde53adccac1b4948afbc22b16d1">SYN_ACTION_CHALLENGE</a>
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa">SYN_ACTION_BLOCK</a>
<br />
 }</td></tr>
<tr class="memdesc:gaca8f2a71ab649ccd408fd3fdb3b693b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protection response actions for SYN connection attempts.  <a href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">More...</a><br /></td></tr>
<tr class="separator:gaca8f2a71ab649ccd408fd3fdb3b693b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7b655dd229bc52cb32ec3cc1674d423" id="r_gad7b655dd229bc52cb32ec3cc1674d423"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad7b655dd229bc52cb32ec3cc1674d423">SocketSYN_Reputation</a> { <br />
&#160;&#160;<a class="el" href="group__security.html#ggad7b655dd229bc52cb32ec3cc1674d423a3c7fc4e1a973261af722ef5a72067c34">SYN_REP_TRUSTED</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad7b655dd229bc52cb32ec3cc1674d423a3af21cd252d430b04f39badf787d06a2">SYN_REP_NEUTRAL</a>
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad7b655dd229bc52cb32ec3cc1674d423ac0634349dad12cd7a8d2a74b9b7cf1be">SYN_REP_SUSPECT</a>
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad7b655dd229bc52cb32ec3cc1674d423a5f79b45826a9103f4f8346e74286ad9d">SYN_REP_HOSTILE</a>
<br />
 }</td></tr>
<tr class="memdesc:gad7b655dd229bc52cb32ec3cc1674d423"><td class="mdescLeft">&#160;</td><td class="mdescRight">IP reputation levels based on behavior history.  <a href="group__security.html#gad7b655dd229bc52cb32ec3cc1674d423">More...</a><br /></td></tr>
<tr class="separator:gad7b655dd229bc52cb32ec3cc1674d423"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e83c28a6ad188b97243c4b237ee075a" id="r_ga8e83c28a6ad188b97243c4b237ee075a"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> { <br />
&#160;&#160;<a class="el" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aac64c8906fdc9860f22cacc933593f01d">DTLS_HANDSHAKE_NOT_STARTED</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad8f8ad815c25bf8e696b02a71795f66d">DTLS_HANDSHAKE_IN_PROGRESS</a> = 1
, <br />
&#160;&#160;<a class="el" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9">DTLS_HANDSHAKE_WANT_READ</a> = 2
, <br />
&#160;&#160;<a class="el" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8">DTLS_HANDSHAKE_WANT_WRITE</a> = 3
, <br />
&#160;&#160;<a class="el" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78">DTLS_HANDSHAKE_COOKIE_EXCHANGE</a> = 4
, <br />
&#160;&#160;<a class="el" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5">DTLS_HANDSHAKE_COMPLETE</a> = 5
, <br />
&#160;&#160;<a class="el" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133">DTLS_HANDSHAKE_ERROR</a> = 6
<br />
 }</td></tr>
<tr class="memdesc:ga8e83c28a6ad188b97243c4b237ee075a"><td class="mdescLeft">&#160;</td><td class="mdescRight">DTLS handshake progress states.  <a href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">More...</a><br /></td></tr>
<tr class="separator:ga8e83c28a6ad188b97243c4b237ee075a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad092160c037d01929df1bb8d5b75b43c" id="r_gad092160c037d01929df1bb8d5b75b43c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> { <br />
&#160;&#160;<a class="el" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2">TLS_HANDSHAKE_NOT_STARTED</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a">TLS_HANDSHAKE_IN_PROGRESS</a> = 1
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a> = 2
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a> = 3
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a> = 4
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2">TLS_HANDSHAKE_ERROR</a> = 5
<br />
 }</td></tr>
<tr class="memdesc:gad092160c037d01929df1bb8d5b75b43c"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS handshake progress states for non-blocking and event-driven operations.  <a href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">More...</a><br /></td></tr>
<tr class="separator:gad092160c037d01929df1bb8d5b75b43c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac32c3958835b92ff683ae15f78448694" id="r_gac32c3958835b92ff683ae15f78448694"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a> { <br />
&#160;&#160;<a class="el" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f">TLS_VERIFY_NONE</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a> = 1
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">TLS_VERIFY_FAIL_IF_NO_PEER_CERT</a> = 2
, <br />
&#160;&#160;<a class="el" href="group__security.html#ggac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183">TLS_VERIFY_CLIENT_ONCE</a> = 4
<br />
 }</td></tr>
<tr class="memdesc:gac32c3958835b92ff683ae15f78448694"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peer certificate verification policies configurable for TLS contexts.  <a href="group__security.html#gac32c3958835b92ff683ae15f78448694">More...</a><br /></td></tr>
<tr class="separator:gac32c3958835b92ff683ae15f78448694"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4d930163393a67950a5378e540c0e939" id="r_ga4d930163393a67950a5378e540c0e939"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4d930163393a67950a5378e540c0e939">CTValidationMode</a> { <br />
&#160;&#160;<a class="el" href="group__security.html#gga4d930163393a67950a5378e540c0e939aea499abb40ae318f0fd2b596ce6cbaa8">CT_VALIDATION_PERMISSIVE</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__security.html#gga4d930163393a67950a5378e540c0e939a102a7857300a9c88684ed50efe69d3ab">CT_VALIDATION_STRICT</a> = 1
<br />
 }</td></tr>
<tr class="memdesc:ga4d930163393a67950a5378e540c0e939"><td class="mdescLeft">&#160;</td><td class="mdescRight">Certificate Transparency validation mode enumeration.  <a href="group__security.html#ga4d930163393a67950a5378e540c0e939">More...</a><br /></td></tr>
<tr class="separator:ga4d930163393a67950a5378e540c0e939"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab87cad57ddf1ed19226cf8535456bbde" id="r_gab87cad57ddf1ed19226cf8535456bbde"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde">SocketIPTracker_new</a> (<a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> arena, int max_per_ip)</td></tr>
<tr class="memdesc:gab87cad57ddf1ed19226cf8535456bbde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create and initialize a new IP connection tracker instance.  <br /></td></tr>
<tr class="separator:gab87cad57ddf1ed19226cf8535456bbde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1a9850f5f3c08335dd18e2a8dbfaed39" id="r_ga1a9850f5f3c08335dd18e2a8dbfaed39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39">SocketIPTracker_free</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> *tracker)</td></tr>
<tr class="memdesc:ga1a9850f5f3c08335dd18e2a8dbfaed39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispose of IP tracker instance and release resources.  <br /></td></tr>
<tr class="separator:ga1a9850f5f3c08335dd18e2a8dbfaed39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga796a06e82e58c6fea3deaf767101dea3" id="r_ga796a06e82e58c6fea3deaf767101dea3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3">SocketIPTracker_track</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker, const char *ip)</td></tr>
<tr class="memdesc:ga796a06e82e58c6fea3deaf767101dea3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Increment connection count for specified IP; enforce limit if set.  <br /></td></tr>
<tr class="separator:ga796a06e82e58c6fea3deaf767101dea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga340ee75715f9dd3a6446dc3ec2c528dc" id="r_ga340ee75715f9dd3a6446dc3ec2c528dc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga340ee75715f9dd3a6446dc3ec2c528dc">SocketIPTracker_release</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker, const char *ip)</td></tr>
<tr class="memdesc:ga340ee75715f9dd3a6446dc3ec2c528dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Decrement connection count for IP; auto-remove if zero.  <br /></td></tr>
<tr class="separator:ga340ee75715f9dd3a6446dc3ec2c528dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga01a74a09256ae28c23c79244f6b832c0" id="r_ga01a74a09256ae28c23c79244f6b832c0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga01a74a09256ae28c23c79244f6b832c0">SocketIPTracker_count</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker, const char *ip)</td></tr>
<tr class="memdesc:ga01a74a09256ae28c23c79244f6b832c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current connection count for an IP address.  <br /></td></tr>
<tr class="separator:ga01a74a09256ae28c23c79244f6b832c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ae1930faa05574038978e46612e5385" id="r_ga3ae1930faa05574038978e46612e5385"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga3ae1930faa05574038978e46612e5385">SocketIPTracker_setmax</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker, int max_per_ip)</td></tr>
<tr class="memdesc:ga3ae1930faa05574038978e46612e5385"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum connections per IP address.  <br /></td></tr>
<tr class="separator:ga3ae1930faa05574038978e46612e5385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2633ef22c045d2a4ab7f260b508bd5fc" id="r_ga2633ef22c045d2a4ab7f260b508bd5fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga2633ef22c045d2a4ab7f260b508bd5fc">SocketIPTracker_getmax</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker)</td></tr>
<tr class="memdesc:ga2633ef22c045d2a4ab7f260b508bd5fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get maximum connections per IP address.  <br /></td></tr>
<tr class="separator:ga2633ef22c045d2a4ab7f260b508bd5fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f416e973e3f32b1c9cf2a2b620214f4" id="r_ga9f416e973e3f32b1c9cf2a2b620214f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9f416e973e3f32b1c9cf2a2b620214f4">SocketIPTracker_setmaxunique</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker, size_t max_unique)</td></tr>
<tr class="memdesc:ga9f416e973e3f32b1c9cf2a2b620214f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum unique IPs to track.  <br /></td></tr>
<tr class="separator:ga9f416e973e3f32b1c9cf2a2b620214f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e4510d8147198039726bd8250b95afb" id="r_ga0e4510d8147198039726bd8250b95afb"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0e4510d8147198039726bd8250b95afb">SocketIPTracker_getmaxunique</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker)</td></tr>
<tr class="memdesc:ga0e4510d8147198039726bd8250b95afb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get maximum unique IPs limit.  <br /></td></tr>
<tr class="separator:ga0e4510d8147198039726bd8250b95afb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3e69b52a3b64cbba1b17711c9961095f" id="r_ga3e69b52a3b64cbba1b17711c9961095f"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga3e69b52a3b64cbba1b17711c9961095f">SocketIPTracker_total</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker)</td></tr>
<tr class="memdesc:ga3e69b52a3b64cbba1b17711c9961095f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get total tracked connections across all IPs.  <br /></td></tr>
<tr class="separator:ga3e69b52a3b64cbba1b17711c9961095f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad8639fe1f640949b820cd1496a67ca56" id="r_gad8639fe1f640949b820cd1496a67ca56"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad8639fe1f640949b820cd1496a67ca56">SocketIPTracker_unique_ips</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker)</td></tr>
<tr class="memdesc:gad8639fe1f640949b820cd1496a67ca56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of unique IPs being tracked.  <br /></td></tr>
<tr class="separator:gad8639fe1f640949b820cd1496a67ca56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47055e396eb7fa4f633bb19ec7720620" id="r_ga47055e396eb7fa4f633bb19ec7720620"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga47055e396eb7fa4f633bb19ec7720620">SocketIPTracker_clear</a> (<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker)</td></tr>
<tr class="memdesc:ga47055e396eb7fa4f633bb19ec7720620"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all tracked connections.  <br /></td></tr>
<tr class="separator:ga47055e396eb7fa4f633bb19ec7720620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga93f5774d64aab235b0af3908cf5fa15a" id="r_ga93f5774d64aab235b0af3908cf5fa15a"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga93f5774d64aab235b0af3908cf5fa15a">synprotect_hash_ip</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip, unsigned table_size)</td></tr>
<tr class="memdesc:ga93f5774d64aab235b0af3908cf5fa15a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute hash index for an IP address using instance-specific seed.  <br /></td></tr>
<tr class="separator:ga93f5774d64aab235b0af3908cf5fa15a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacf287a7019c5ff677321e8b5fa390cf2" id="r_gacf287a7019c5ff677321e8b5fa390cf2"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gacf287a7019c5ff677321e8b5fa390cf2">synprotect_clamp_score</a> (float score)</td></tr>
<tr class="memdesc:gacf287a7019c5ff677321e8b5fa390cf2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clamp reputation score to valid range [0.0f, 1.0f].  <br /></td></tr>
<tr class="separator:gacf287a7019c5ff677321e8b5fa390cf2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10a168a8c7d6d98660b8371b9b886fa8" id="r_ga10a168a8c7d6d98660b8371b9b886fa8"><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga10a168a8c7d6d98660b8371b9b886fa8">synprotect_min</a> (int64_t a, int64_t b)</td></tr>
<tr class="memdesc:ga10a168a8c7d6d98660b8371b9b886fa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the minimum of two int64_t values.  <br /></td></tr>
<tr class="separator:ga10a168a8c7d6d98660b8371b9b886fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86342ee431726d93daa749ed5eae611a" id="r_ga86342ee431726d93daa749ed5eae611a"><td class="memItemLeft" align="right" valign="top">static int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga86342ee431726d93daa749ed5eae611a">synprotect_max</a> (int64_t a, int64_t b)</td></tr>
<tr class="memdesc:ga86342ee431726d93daa749ed5eae611a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the maximum of two int64_t values.  <br /></td></tr>
<tr class="separator:ga86342ee431726d93daa749ed5eae611a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f5d6f2ac8cbd366d57c1e8e55983143" id="r_ga5f5d6f2ac8cbd366d57c1e8e55983143"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a> (<a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> arena, const <a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> *config)</td></tr>
<tr class="memdesc:ga5f5d6f2ac8cbd366d57c1e8e55983143"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new instance of SYN protection.  <br /></td></tr>
<tr class="separator:ga5f5d6f2ac8cbd366d57c1e8e55983143"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f5cc1e61a0b44b8b1b330ae54382511" id="r_ga9f5cc1e61a0b44b8b1b330ae54382511"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511">SocketSYNProtect_free</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> *protect)</td></tr>
<tr class="memdesc:ga9f5cc1e61a0b44b8b1b330ae54382511"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispose of a SYN protection instance and release all resources.  <br /></td></tr>
<tr class="separator:ga9f5cc1e61a0b44b8b1b330ae54382511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade1b436117d4a0854881ac52ce43f115" id="r_gade1b436117d4a0854881ac52ce43f115"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a> (<a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> *config)</td></tr>
<tr class="memdesc:gade1b436117d4a0854881ac52ce43f115"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize configuration structure with safe defaults.  <br /></td></tr>
<tr class="separator:gade1b436117d4a0854881ac52ce43f115"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga59e979862677789482cb5f297f544001" id="r_ga59e979862677789482cb5f297f544001"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga59e979862677789482cb5f297f544001">SocketSYNProtect_configure</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const <a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> *config)</td></tr>
<tr class="memdesc:ga59e979862677789482cb5f297f544001"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update protection configuration during runtime.  <br /></td></tr>
<tr class="separator:ga59e979862677789482cb5f297f544001"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga45b12919783a7ba4426db4134fda1a5f" id="r_ga45b12919783a7ba4426db4134fda1a5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *client_ip, <a class="el" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a> *state_out)</td></tr>
<tr class="memdesc:ga45b12919783a7ba4426db4134fda1a5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluate client IP and determine protection action.  <br /></td></tr>
<tr class="separator:ga45b12919783a7ba4426db4134fda1a5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga979954abc96c529d1205d432fc13c661" id="r_ga979954abc96c529d1205d432fc13c661"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *client_ip)</td></tr>
<tr class="memdesc:ga979954abc96c529d1205d432fc13c661"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report successful connection completion for IP reputation update.  <br /></td></tr>
<tr class="separator:ga979954abc96c529d1205d432fc13c661"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga573fee7bcaf625b171053b87159af53e" id="r_ga573fee7bcaf625b171053b87159af53e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga573fee7bcaf625b171053b87159af53e">SocketSYNProtect_report_failure</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *client_ip, int error_code)</td></tr>
<tr class="memdesc:ga573fee7bcaf625b171053b87159af53e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Report connection failure for IP reputation update.  <br /></td></tr>
<tr class="separator:ga573fee7bcaf625b171053b87159af53e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a601f0c4520ae271b27a49c5bd19108" id="r_ga2a601f0c4520ae271b27a49c5bd19108"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip)</td></tr>
<tr class="memdesc:ga2a601f0c4520ae271b27a49c5bd19108"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an IP address to the whitelist.  <br /></td></tr>
<tr class="separator:ga2a601f0c4520ae271b27a49c5bd19108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67fef0b3b6d93c87648e8b0caa1c4bc0" id="r_ga67fef0b3b6d93c87648e8b0caa1c4bc0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *cidr)</td></tr>
<tr class="memdesc:ga67fef0b3b6d93c87648e8b0caa1c4bc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a CIDR range to the whitelist.  <br /></td></tr>
<tr class="separator:ga67fef0b3b6d93c87648e8b0caa1c4bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa2b5e921cf7b0b24e270870f0ddc92be" id="r_gaa2b5e921cf7b0b24e270870f0ddc92be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaa2b5e921cf7b0b24e270870f0ddc92be">SocketSYNProtect_whitelist_remove</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip)</td></tr>
<tr class="memdesc:gaa2b5e921cf7b0b24e270870f0ddc92be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an IP address from the whitelist.  <br /></td></tr>
<tr class="separator:gaa2b5e921cf7b0b24e270870f0ddc92be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5036b24b808b28a69de280c9ce0727fc" id="r_ga5036b24b808b28a69de280c9ce0727fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc">SocketSYNProtect_whitelist_contains</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip)</td></tr>
<tr class="memdesc:ga5036b24b808b28a69de280c9ce0727fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an IP address is whitelisted.  <br /></td></tr>
<tr class="separator:ga5036b24b808b28a69de280c9ce0727fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50962d47d9b56957714f313e2051e1bf" id="r_ga50962d47d9b56957714f313e2051e1bf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga50962d47d9b56957714f313e2051e1bf">SocketSYNProtect_whitelist_clear</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect)</td></tr>
<tr class="memdesc:ga50962d47d9b56957714f313e2051e1bf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all whitelist entries.  <br /></td></tr>
<tr class="separator:ga50962d47d9b56957714f313e2051e1bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga02eca11c24cc41b3f1fafdcbcae6e485" id="r_ga02eca11c24cc41b3f1fafdcbcae6e485"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip, int duration_ms)</td></tr>
<tr class="memdesc:ga02eca11c24cc41b3f1fafdcbcae6e485"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an IP address to the blacklist.  <br /></td></tr>
<tr class="separator:ga02eca11c24cc41b3f1fafdcbcae6e485"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e67e158bb567ffb7620738ba28b16f8" id="r_ga4e67e158bb567ffb7620738ba28b16f8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4e67e158bb567ffb7620738ba28b16f8">SocketSYNProtect_blacklist_remove</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip)</td></tr>
<tr class="memdesc:ga4e67e158bb567ffb7620738ba28b16f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove an IP address from the blacklist.  <br /></td></tr>
<tr class="separator:ga4e67e158bb567ffb7620738ba28b16f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88d4fb38017492beca3f130d311dadd5" id="r_ga88d4fb38017492beca3f130d311dadd5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga88d4fb38017492beca3f130d311dadd5">SocketSYNProtect_blacklist_contains</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip)</td></tr>
<tr class="memdesc:ga88d4fb38017492beca3f130d311dadd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if an IP address is currently blacklisted.  <br /></td></tr>
<tr class="separator:ga88d4fb38017492beca3f130d311dadd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9519e23838092f497693c4a488789f1b" id="r_ga9519e23838092f497693c4a488789f1b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9519e23838092f497693c4a488789f1b">SocketSYNProtect_blacklist_clear</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect)</td></tr>
<tr class="memdesc:ga9519e23838092f497693c4a488789f1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all blacklist entries.  <br /></td></tr>
<tr class="separator:ga9519e23838092f497693c4a488789f1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga36629010083cc94526b37d57cc40bbce" id="r_ga36629010083cc94526b37d57cc40bbce"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga36629010083cc94526b37d57cc40bbce">SocketSYNProtect_get_ip_state</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, const char *ip, <a class="el" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a> *state)</td></tr>
<tr class="memdesc:ga36629010083cc94526b37d57cc40bbce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the current state and reputation metrics for a specific IP address.  <br /></td></tr>
<tr class="separator:ga36629010083cc94526b37d57cc40bbce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga602057379b47f0e3dbf46b6efd70a09a" id="r_ga602057379b47f0e3dbf46b6efd70a09a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a">SocketSYNProtect_stats</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, <a class="el" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a> *stats)</td></tr>
<tr class="memdesc:ga602057379b47f0e3dbf46b6efd70a09a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve aggregate statistics snapshot for the SYN protection module.  <br /></td></tr>
<tr class="separator:ga602057379b47f0e3dbf46b6efd70a09a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga59f2d1168a808c2c2d0584b031d96422" id="r_ga59f2d1168a808c2c2d0584b031d96422"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga59f2d1168a808c2c2d0584b031d96422">SocketSYNProtect_stats_reset</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect)</td></tr>
<tr class="memdesc:ga59f2d1168a808c2c2d0584b031d96422"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset all resettable statistics counters to zero.  <br /></td></tr>
<tr class="separator:ga59f2d1168a808c2c2d0584b031d96422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6be6d5871d5869421280eb62f3492ca3" id="r_ga6be6d5871d5869421280eb62f3492ca3"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga6be6d5871d5869421280eb62f3492ca3">SocketSYNProtect_action_name</a> (<a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> action)</td></tr>
<tr class="memdesc:ga6be6d5871d5869421280eb62f3492ca3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert SYN action enum to human-readable string.  <br /></td></tr>
<tr class="separator:ga6be6d5871d5869421280eb62f3492ca3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaaf2b0ff9a3054e262ba32b395c2abe50" id="r_gaaf2b0ff9a3054e262ba32b395c2abe50"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaaf2b0ff9a3054e262ba32b395c2abe50">SocketSYNProtect_reputation_name</a> (<a class="el" href="group__security.html#gad7b655dd229bc52cb32ec3cc1674d423">SocketSYN_Reputation</a> rep)</td></tr>
<tr class="memdesc:gaaf2b0ff9a3054e262ba32b395c2abe50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert reputation enum to human-readable string.  <br /></td></tr>
<tr class="separator:gaaf2b0ff9a3054e262ba32b395c2abe50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89041cde278498408febb062da3dd23b" id="r_ga89041cde278498408febb062da3dd23b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b">SocketSYNProtect_cleanup</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect)</td></tr>
<tr class="memdesc:ga89041cde278498408febb062da3dd23b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform periodic cleanup of expired and stale protection state.  <br /></td></tr>
<tr class="separator:ga89041cde278498408febb062da3dd23b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae797fcaf42654cdba172ab72a327a8b1" id="r_gae797fcaf42654cdba172ab72a327a8b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae797fcaf42654cdba172ab72a327a8b1">SocketSYNProtect_clear_all</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect)</td></tr>
<tr class="memdesc:gae797fcaf42654cdba172ab72a327a8b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all tracked IP states without affecting lists or stats.  <br /></td></tr>
<tr class="separator:gae797fcaf42654cdba172ab72a327a8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga01aa18277f6346e8803de9f705573528" id="r_ga01aa18277f6346e8803de9f705573528"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga01aa18277f6346e8803de9f705573528">SocketSYNProtect_reset</a> (<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect)</td></tr>
<tr class="memdesc:ga01aa18277f6346e8803de9f705573528"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform full reset of the SYN protection instance to initial state.  <br /></td></tr>
<tr class="separator:ga01aa18277f6346e8803de9f705573528"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d5647f2b71d9cd5c60e6a1c385854dd" id="r_ga8d5647f2b71d9cd5c60e6a1c385854dd"><td class="memItemLeft" align="right" valign="top">static SSL *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd">dtls_socket_get_ssl</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga8d5647f2b71d9cd5c60e6a1c385854dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the SSL object pointer associated with a DTLS-enabled socket.  <br /></td></tr>
<tr class="separator:ga8d5647f2b71d9cd5c60e6a1c385854dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaff7268760d38bc90af34fdbf313ecbb5" id="r_gaff7268760d38bc90af34fdbf313ecbb5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaff7268760d38bc90af34fdbf313ecbb5">dtls_handle_ssl_error</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, SSL *ssl, int ssl_result)</td></tr>
<tr class="memdesc:gaff7268760d38bc90af34fdbf313ecbb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map OpenSSL error codes to DTLS handshake states for non-blocking I/O.  <br /></td></tr>
<tr class="separator:gaff7268760d38bc90af34fdbf313ecbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga52868028efe42ac286ffdcad2e5f8a51" id="r_ga52868028efe42ac286ffdcad2e5f8a51"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51">dtls_format_openssl_error</a> (const char *context)</td></tr>
<tr class="memdesc:ga52868028efe42ac286ffdcad2e5f8a51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format and log the current OpenSSL error queue into thread-local error buffer.  <br /></td></tr>
<tr class="separator:ga52868028efe42ac286ffdcad2e5f8a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga43a9d75df4015935d50b33c528342d80" id="r_ga43a9d75df4015935d50b33c528342d80"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga43a9d75df4015935d50b33c528342d80">dtls_validate_file_path</a> (const char *path)</td></tr>
<tr class="memdesc:ga43a9d75df4015935d50b33c528342d80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform security validation on file path strings for cert/key/CA loading.  <br /></td></tr>
<tr class="separator:ga43a9d75df4015935d50b33c528342d80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae37473787004b0ea65d2ee0b51702f44" id="r_gae37473787004b0ea65d2ee0b51702f44"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae37473787004b0ea65d2ee0b51702f44">dtls_cookie_generate_cb</a> (SSL *ssl, unsigned char *cookie, unsigned int *cookie_len)</td></tr>
<tr class="memdesc:gae37473787004b0ea65d2ee0b51702f44"><td class="mdescLeft">&#160;</td><td class="mdescRight">OpenSSL callback for generating DTLS anti-DoS cookies during server handshake.  <br /></td></tr>
<tr class="separator:gae37473787004b0ea65d2ee0b51702f44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae23a324083d5bf71680d6fc525477a7a" id="r_gae23a324083d5bf71680d6fc525477a7a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae23a324083d5bf71680d6fc525477a7a">dtls_context_get_from_ssl</a> (const SSL *ssl)</td></tr>
<tr class="memdesc:gae23a324083d5bf71680d6fc525477a7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">dtls_context_get_from_ssl - Get SocketDTLSContext from SSL object  <br /></td></tr>
<tr class="separator:gae23a324083d5bf71680d6fc525477a7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad2f26460b23a711e0fa74605371cf127" id="r_gad2f26460b23a711e0fa74605371cf127"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, <a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gad2f26460b23a711e0fa74605371cf127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable DTLS encryption on a datagram socket.  <br /></td></tr>
<tr class="separator:gad2f26460b23a711e0fa74605371cf127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf742a2fb837173f6fd8d347e5bc1d1d3" id="r_gaf742a2fb837173f6fd8d347e5bc1d1d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaf742a2fb837173f6fd8d347e5bc1d1d3">SocketDTLS_set_peer</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, const char *host, int port)</td></tr>
<tr class="memdesc:gaf742a2fb837173f6fd8d347e5bc1d1d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the peer address for a DTLS connection.  <br /></td></tr>
<tr class="separator:gaf742a2fb837173f6fd8d347e5bc1d1d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf3857e3cea92190f4c6eca7a8418be3" id="r_gabf3857e3cea92190f4c6eca7a8418be3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3">SocketDTLS_set_hostname</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, const char *hostname)</td></tr>
<tr class="memdesc:gabf3857e3cea92190f4c6eca7a8418be3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set SNI hostname for client DTLS connections.  <br /></td></tr>
<tr class="separator:gabf3857e3cea92190f4c6eca7a8418be3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga804d5dd4b27255e3c9c28c58a2914a18" id="r_ga804d5dd4b27255e3c9c28c58a2914a18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga804d5dd4b27255e3c9c28c58a2914a18">SocketDTLS_set_mtu</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, size_t mtu)</td></tr>
<tr class="memdesc:ga804d5dd4b27255e3c9c28c58a2914a18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set per-connection MTU for DTLS record sizing.  <br /></td></tr>
<tr class="separator:ga804d5dd4b27255e3c9c28c58a2914a18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga17e8bd79af2c5a20b5dbb9e8dff6f84c" id="r_ga17e8bd79af2c5a20b5dbb9e8dff6f84c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga17e8bd79af2c5a20b5dbb9e8dff6f84c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform one step of the non-blocking DTLS handshake.  <br /></td></tr>
<tr class="separator:ga17e8bd79af2c5a20b5dbb9e8dff6f84c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga095bfc830b421398fbecacb1ac3d6755" id="r_ga095bfc830b421398fbecacb1ac3d6755"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755">SocketDTLS_handshake_loop</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, int timeout_ms)</td></tr>
<tr class="memdesc:ga095bfc830b421398fbecacb1ac3d6755"><td class="mdescLeft">&#160;</td><td class="mdescRight">Blocking DTLS handshake with configurable timeout.  <br /></td></tr>
<tr class="separator:ga095bfc830b421398fbecacb1ac3d6755"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0e2af3b3ad31869d659162ea06cf667b" id="r_ga0e2af3b3ad31869d659162ea06cf667b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0e2af3b3ad31869d659162ea06cf667b">SocketDTLS_listen</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga0e2af3b3ad31869d659162ea06cf667b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Server-side initial DTLS handshake receive.  <br /></td></tr>
<tr class="separator:ga0e2af3b3ad31869d659162ea06cf667b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9fe6acb926cc7fbc8c4f0239834b5460" id="r_ga9fe6acb926cc7fbc8c4f0239834b5460"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460">SocketDTLS_send</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, const void *buf, size_t len)</td></tr>
<tr class="memdesc:ga9fe6acb926cc7fbc8c4f0239834b5460"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send application data over established DTLS connection.  <br /></td></tr>
<tr class="separator:ga9fe6acb926cc7fbc8c4f0239834b5460"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4fc033d5799456ce6d1b1417228c7e1" id="r_gac4fc033d5799456ce6d1b1417228c7e1"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac4fc033d5799456ce6d1b1417228c7e1">SocketDTLS_recv</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, void *buf, size_t len)</td></tr>
<tr class="memdesc:gac4fc033d5799456ce6d1b1417228c7e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive application data from established DTLS connection.  <br /></td></tr>
<tr class="separator:gac4fc033d5799456ce6d1b1417228c7e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4e060f6143e7c9896452a6e0654041e5" id="r_ga4e060f6143e7c9896452a6e0654041e5"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4e060f6143e7c9896452a6e0654041e5">SocketDTLS_sendto</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, const void *buf, size_t len, const char *host, int port)</td></tr>
<tr class="memdesc:ga4e060f6143e7c9896452a6e0654041e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send DTLS datagram to specific address.  <br /></td></tr>
<tr class="separator:ga4e060f6143e7c9896452a6e0654041e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac974bd84fcd68c06870530c11908170f" id="r_gac974bd84fcd68c06870530c11908170f"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac974bd84fcd68c06870530c11908170f">SocketDTLS_recvfrom</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, void *buf, size_t len, char *host, size_t host_len, int *port)</td></tr>
<tr class="memdesc:gac974bd84fcd68c06870530c11908170f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive DTLS datagram with sender address.  <br /></td></tr>
<tr class="separator:gac974bd84fcd68c06870530c11908170f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga12039ba9c9513fbf9df6e02f997d09ab" id="r_ga12039ba9c9513fbf9df6e02f997d09ab"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga12039ba9c9513fbf9df6e02f997d09ab">SocketDTLS_get_cipher</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga12039ba9c9513fbf9df6e02f997d09ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get name of negotiated cipher suite.  <br /></td></tr>
<tr class="separator:ga12039ba9c9513fbf9df6e02f997d09ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4651d3701fdc086051bc90cecb79b11e" id="r_ga4651d3701fdc086051bc90cecb79b11e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4651d3701fdc086051bc90cecb79b11e">SocketDTLS_get_version</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga4651d3701fdc086051bc90cecb79b11e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get negotiated DTLS protocol version.  <br /></td></tr>
<tr class="separator:ga4651d3701fdc086051bc90cecb79b11e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad0e45780e041b9ddb58956d9f0fb20d1" id="r_gad0e45780e041b9ddb58956d9f0fb20d1"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad0e45780e041b9ddb58956d9f0fb20d1">SocketDTLS_get_verify_result</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:gad0e45780e041b9ddb58956d9f0fb20d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get peer certificate verification result.  <br /></td></tr>
<tr class="separator:gad0e45780e041b9ddb58956d9f0fb20d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeeca3aaa5a1e0f7fbb22b16a465421fd" id="r_gaeeca3aaa5a1e0f7fbb22b16a465421fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaeeca3aaa5a1e0f7fbb22b16a465421fd">SocketDTLS_is_session_reused</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:gaeeca3aaa5a1e0f7fbb22b16a465421fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if DTLS session was resumed.  <br /></td></tr>
<tr class="separator:gaeeca3aaa5a1e0f7fbb22b16a465421fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae91ad38ad7d4a00961f342e3366d7097" id="r_gae91ad38ad7d4a00961f342e3366d7097"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae91ad38ad7d4a00961f342e3366d7097">SocketDTLS_get_alpn_selected</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:gae91ad38ad7d4a00961f342e3366d7097"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the negotiated ALPN protocol.  <br /></td></tr>
<tr class="separator:gae91ad38ad7d4a00961f342e3366d7097"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7752aae6c38da47f187f8d766b4ae12e" id="r_ga7752aae6c38da47f187f8d766b4ae12e"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga7752aae6c38da47f187f8d766b4ae12e">SocketDTLS_get_mtu</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga7752aae6c38da47f187f8d766b4ae12e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current effective MTU.  <br /></td></tr>
<tr class="separator:ga7752aae6c38da47f187f8d766b4ae12e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab42fd91bb31edaf15149d75920446a0a" id="r_gab42fd91bb31edaf15149d75920446a0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab42fd91bb31edaf15149d75920446a0a">SocketDTLS_shutdown</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:gab42fd91bb31edaf15149d75920446a0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiate graceful DTLS connection shutdown.  <br /></td></tr>
<tr class="separator:gab42fd91bb31edaf15149d75920446a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaad0b27539517934a510df081364e08ab" id="r_gaad0b27539517934a510df081364e08ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaad0b27539517934a510df081364e08ab">SocketDTLS_is_shutdown</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:gaad0b27539517934a510df081364e08ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if DTLS shutdown completed.  <br /></td></tr>
<tr class="separator:gaad0b27539517934a510df081364e08ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga861c0da7896b4275fb38ee2d0ac73af1" id="r_ga861c0da7896b4275fb38ee2d0ac73af1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga861c0da7896b4275fb38ee2d0ac73af1">SocketDTLS_is_enabled</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga861c0da7896b4275fb38ee2d0ac73af1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if DTLS is enabled on socket.  <br /></td></tr>
<tr class="separator:ga861c0da7896b4275fb38ee2d0ac73af1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae702a60aae194a098bdc6af32549f1ae" id="r_gae702a60aae194a098bdc6af32549f1ae"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae702a60aae194a098bdc6af32549f1ae">SocketDTLS_is_handshake_done</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:gae702a60aae194a098bdc6af32549f1ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if DTLS handshake is complete.  <br /></td></tr>
<tr class="separator:gae702a60aae194a098bdc6af32549f1ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42abbf654fe23dd417b2115dc00590db" id="r_ga42abbf654fe23dd417b2115dc00590db"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga42abbf654fe23dd417b2115dc00590db">SocketDTLS_get_last_state</a> (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket)</td></tr>
<tr class="memdesc:ga42abbf654fe23dd417b2115dc00590db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get last handshake state.  <br /></td></tr>
<tr class="separator:ga42abbf654fe23dd417b2115dc00590db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac08c4201eb8ac29014cead5bf4a17adb" id="r_gac08c4201eb8ac29014cead5bf4a17adb"><td class="memItemLeft" align="right" valign="top">static SSL *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac08c4201eb8ac29014cead5bf4a17adb">tls_socket_get_ssl</a> (Socket_T socket)</td></tr>
<tr class="memdesc:gac08c4201eb8ac29014cead5bf4a17adb"><td class="mdescLeft">&#160;</td><td class="mdescRight">tls_socket_get_ssl - Get SSL* from socket  <br /></td></tr>
<tr class="separator:gac08c4201eb8ac29014cead5bf4a17adb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e8705fd2d3c92c43e4b8105d38f3854" id="r_ga6e8705fd2d3c92c43e4b8105d38f3854"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga6e8705fd2d3c92c43e4b8105d38f3854">tls_handle_ssl_error</a> (Socket_T socket, SSL *ssl, int ssl_result)</td></tr>
<tr class="memdesc:ga6e8705fd2d3c92c43e4b8105d38f3854"><td class="mdescLeft">&#160;</td><td class="mdescRight">tls_handle_ssl_error - Map OpenSSL errors to TLSHandshakeState  <br /></td></tr>
<tr class="separator:ga6e8705fd2d3c92c43e4b8105d38f3854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga603f6b5acb264e31bf6a0f71d5b48be5" id="r_ga603f6b5acb264e31bf6a0f71d5b48be5"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga603f6b5acb264e31bf6a0f71d5b48be5">tls_format_openssl_error</a> (const char *context)</td></tr>
<tr class="memdesc:ga603f6b5acb264e31bf6a0f71d5b48be5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format OpenSSL error into the thread-local error buffer.  <br /></td></tr>
<tr class="separator:ga603f6b5acb264e31bf6a0f71d5b48be5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab904e51ebbeabc985c3988fc0980776e" id="r_gab904e51ebbeabc985c3988fc0980776e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab904e51ebbeabc985c3988fc0980776e">tls_get_alpn_ex_idx</a> (void)</td></tr>
<tr class="memdesc:gab904e51ebbeabc985c3988fc0980776e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate file path for certificates, keys, or CAs against security threats.  <br /></td></tr>
<tr class="separator:gab904e51ebbeabc985c3988fc0980776e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5521981e692a3cdd4176000e2282398f" id="r_ga5521981e692a3cdd4176000e2282398f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga5521981e692a3cdd4176000e2282398f">tls_cleanup_alpn_temp</a> (SSL *ssl)</td></tr>
<tr class="memdesc:ga5521981e692a3cdd4176000e2282398f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clean up temporary ALPN protocol buffer from SSL ex_data.  <br /></td></tr>
<tr class="separator:ga5521981e692a3cdd4176000e2282398f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabf9cbcc9cfbd30df1d1252ccaf34b8d0" id="r_gabf9cbcc9cfbd30df1d1252ccaf34b8d0"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gabf9cbcc9cfbd30df1d1252ccaf34b8d0">tls_secure_free_pkey</a> (EVP_PKEY *pkey)</td></tr>
<tr class="memdesc:gabf9cbcc9cfbd30df1d1252ccaf34b8d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Securely free EVP_PKEY with key material zeroization.  <br /></td></tr>
<tr class="separator:gabf9cbcc9cfbd30df1d1252ccaf34b8d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaebeabc646fbd6961894512930a822ca9" id="r_gaebeabc646fbd6961894512930a822ca9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaebeabc646fbd6961894512930a822ca9">tls_validate_hostname</a> (const char *hostname)</td></tr>
<tr class="memdesc:gaebeabc646fbd6961894512930a822ca9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Validate SNI hostname against RFC-compliant format rules.  <br /></td></tr>
<tr class="separator:gaebeabc646fbd6961894512930a822ca9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88ff84e8a0b38713099d838de6404163" id="r_ga88ff84e8a0b38713099d838de6404163"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga88ff84e8a0b38713099d838de6404163">ctx_raise_openssl_error</a> (const char *context)</td></tr>
<tr class="memdesc:ga88ff84e8a0b38713099d838de6404163"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raise a SocketTLSContext exception from an OpenSSL error.  <br /></td></tr>
<tr class="separator:ga88ff84e8a0b38713099d838de6404163"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac1dcd2082d3c29e557a920685766c44c" id="r_gac1dcd2082d3c29e557a920685766c44c"><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac1dcd2082d3c29e557a920685766c44c">ctx_arena_strdup</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *str, const char *error_msg)</td></tr>
<tr class="memdesc:gac1dcd2082d3c29e557a920685766c44c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Duplicate a string into the TLS context's arena.  <br /></td></tr>
<tr class="separator:gac1dcd2082d3c29e557a920685766c44c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9acf6c44e3887d6570aa5a3750a2b802" id="r_ga9acf6c44e3887d6570aa5a3750a2b802"><td class="memItemLeft" align="right" valign="top">static void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9acf6c44e3887d6570aa5a3750a2b802">ctx_arena_alloc</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, size_t size, const char *error_msg)</td></tr>
<tr class="memdesc:ga9acf6c44e3887d6570aa5a3750a2b802"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate memory from the TLS context's arena with exception handling.  <br /></td></tr>
<tr class="separator:ga9acf6c44e3887d6570aa5a3750a2b802"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaafa8d212678f77cf8c99a4e4914b6d97" id="r_gaafa8d212678f77cf8c99a4e4914b6d97"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaafa8d212678f77cf8c99a4e4914b6d97">tls_context_get_from_ssl</a> (const SSL *ssl)</td></tr>
<tr class="memdesc:gaafa8d212678f77cf8c99a4e4914b6d97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> associated with an SSL object.  <br /></td></tr>
<tr class="separator:gaafa8d212678f77cf8c99a4e4914b6d97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacc208c7e1bc1f93a93e8db60903527fa" id="r_gacc208c7e1bc1f93a93e8db60903527fa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gacc208c7e1bc1f93a93e8db60903527fa">tls_context_get_from_ssl_ctx</a> (SSL_CTX *ssl_ctx)</td></tr>
<tr class="memdesc:gacc208c7e1bc1f93a93e8db60903527fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> associated with an SSL_CTX object.  <br /></td></tr>
<tr class="separator:gacc208c7e1bc1f93a93e8db60903527fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e43ba6d103cbc8f43b748cf2ddf4b9a" id="r_ga1e43ba6d103cbc8f43b748cf2ddf4b9a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1e43ba6d103cbc8f43b748cf2ddf4b9a">ctx_alloc_and_init</a> (const SSL_METHOD *method, int is_server)</td></tr>
<tr class="memdesc:ga1e43ba6d103cbc8f43b748cf2ddf4b9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate and initialize a new <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a>.  <br /></td></tr>
<tr class="separator:ga1e43ba6d103cbc8f43b748cf2ddf4b9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga726c939b0e3e55893537751d2ea87dd8" id="r_ga726c939b0e3e55893537751d2ea87dd8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga726c939b0e3e55893537751d2ea87dd8">tls_pinning_init</a> (<a class="el" href="group__security.html#structTLSContextPinning">TLSContextPinning</a> *pinning)</td></tr>
<tr class="memdesc:ga726c939b0e3e55893537751d2ea87dd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize TLS certificate pinning configuration.  <br /></td></tr>
<tr class="separator:ga726c939b0e3e55893537751d2ea87dd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga828d1176538dad4796620257b2e9a4cb" id="r_ga828d1176538dad4796620257b2e9a4cb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga828d1176538dad4796620257b2e9a4cb">tls_pinning_extract_spki_hash</a> (const X509 *cert, unsigned char *out_hash)</td></tr>
<tr class="memdesc:ga828d1176538dad4796620257b2e9a4cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute SPKI SHA256 hash from X509 certificate for pinning verification.  <br /></td></tr>
<tr class="separator:ga828d1176538dad4796620257b2e9a4cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5757cbf91f1a33f9da5ceedd6e7c19a9" id="r_ga5757cbf91f1a33f9da5ceedd6e7c19a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga5757cbf91f1a33f9da5ceedd6e7c19a9">tls_pinning_check_chain</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const STACK_OF(X509) *chain)</td></tr>
<tr class="memdesc:ga5757cbf91f1a33f9da5ceedd6e7c19a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify if any certificate in the chain matches a configured pin.  <br /></td></tr>
<tr class="separator:ga5757cbf91f1a33f9da5ceedd6e7c19a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5de766a20624317123f664a08d5ca13d" id="r_ga5de766a20624317123f664a08d5ca13d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga5de766a20624317123f664a08d5ca13d">tls_pinning_find</a> (const <a class="el" href="group__security.html#structTLSCertPin">TLSCertPin</a> *pins, size_t count, const unsigned char *hash)</td></tr>
<tr class="memdesc:ga5de766a20624317123f664a08d5ca13d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform constant-time search for a hash in pinning array.  <br /></td></tr>
<tr class="separator:ga5de766a20624317123f664a08d5ca13d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab9a8fb788aa1f0d21b5773bc43a48d6f" id="r_gab9a8fb788aa1f0d21b5773bc43a48d6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a> (Socket_T socket, <a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gab9a8fb788aa1f0d21b5773bc43a48d6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable TLS on a socket using the provided context.  <br /></td></tr>
<tr class="separator:gab9a8fb788aa1f0d21b5773bc43a48d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga15d2c8f4eaea80114bbd2123da025e56" id="r_ga15d2c8f4eaea80114bbd2123da025e56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga15d2c8f4eaea80114bbd2123da025e56">SocketTLS_set_hostname</a> (Socket_T socket, const char *hostname)</td></tr>
<tr class="memdesc:ga15d2c8f4eaea80114bbd2123da025e56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set SNI hostname for client TLS connections.  <br /></td></tr>
<tr class="separator:ga15d2c8f4eaea80114bbd2123da025e56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeaa77dd7852b535baf17b53ee2518454" id="r_gaeaa77dd7852b535baf17b53ee2518454"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a> (Socket_T socket)</td></tr>
<tr class="memdesc:gaeaa77dd7852b535baf17b53ee2518454"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform non-blocking TLS handshake.  <br /></td></tr>
<tr class="separator:gaeaa77dd7852b535baf17b53ee2518454"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga439248f2ff7b87470520de0607569d06" id="r_ga439248f2ff7b87470520de0607569d06"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga439248f2ff7b87470520de0607569d06">SocketTLS_handshake_loop</a> (Socket_T socket, int timeout_ms)</td></tr>
<tr class="memdesc:ga439248f2ff7b87470520de0607569d06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Complete handshake with timeout (non-blocking)  <br /></td></tr>
<tr class="separator:ga439248f2ff7b87470520de0607569d06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga54a01327e253586278c0f740c2764010" id="r_ga54a01327e253586278c0f740c2764010"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga54a01327e253586278c0f740c2764010">SocketTLS_handshake_auto</a> (Socket_T socket)</td></tr>
<tr class="memdesc:ga54a01327e253586278c0f740c2764010"><td class="mdescLeft">&#160;</td><td class="mdescRight">Complete handshake using socket's timeout config.  <br /></td></tr>
<tr class="separator:ga54a01327e253586278c0f740c2764010"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab11506db6f41f31e9fc170b3d0e848f1" id="r_gab11506db6f41f31e9fc170b3d0e848f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a> (Socket_T socket)</td></tr>
<tr class="memdesc:gab11506db6f41f31e9fc170b3d0e848f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Perform graceful TLS connection shutdown.  <br /></td></tr>
<tr class="separator:gab11506db6f41f31e9fc170b3d0e848f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabdb38e692dde58bbec4ab905eeb8b3aa" id="r_gabdb38e692dde58bbec4ab905eeb8b3aa"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gabdb38e692dde58bbec4ab905eeb8b3aa">SocketTLS_send</a> (Socket_T socket, const void *buf, size_t len)</td></tr>
<tr class="memdesc:gabdb38e692dde58bbec4ab905eeb8b3aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data over TLS-encrypted connection.  <br /></td></tr>
<tr class="separator:gabdb38e692dde58bbec4ab905eeb8b3aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1c71fc02141cd9e6da4fdf1c88dbbaf3" id="r_ga1c71fc02141cd9e6da4fdf1c88dbbaf3"><td class="memItemLeft" align="right" valign="top">ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1c71fc02141cd9e6da4fdf1c88dbbaf3">SocketTLS_recv</a> (Socket_T socket, void *buf, size_t len)</td></tr>
<tr class="memdesc:ga1c71fc02141cd9e6da4fdf1c88dbbaf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Receive data from TLS-encrypted connection.  <br /></td></tr>
<tr class="separator:ga1c71fc02141cd9e6da4fdf1c88dbbaf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0859f0a6e05840bdc037c3765e22b7b1" id="r_ga0859f0a6e05840bdc037c3765e22b7b1"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0859f0a6e05840bdc037c3765e22b7b1">SocketTLS_get_cipher</a> (Socket_T socket)</td></tr>
<tr class="memdesc:ga0859f0a6e05840bdc037c3765e22b7b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get negotiated cipher suite name.  <br /></td></tr>
<tr class="separator:ga0859f0a6e05840bdc037c3765e22b7b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef0f67021658d05419f1da479be2957e" id="r_gaef0f67021658d05419f1da479be2957e"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaef0f67021658d05419f1da479be2957e">SocketTLS_get_version</a> (Socket_T socket)</td></tr>
<tr class="memdesc:gaef0f67021658d05419f1da479be2957e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get negotiated TLS protocol version.  <br /></td></tr>
<tr class="separator:gaef0f67021658d05419f1da479be2957e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fd56e743762151aa449744a8d574164" id="r_ga4fd56e743762151aa449744a8d574164"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4fd56e743762151aa449744a8d574164">SocketTLS_get_verify_result</a> (Socket_T socket)</td></tr>
<tr class="memdesc:ga4fd56e743762151aa449744a8d574164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get peer certificate verification result.  <br /></td></tr>
<tr class="separator:ga4fd56e743762151aa449744a8d574164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39a966c33421653c64f78261f24ee1f1" id="r_ga39a966c33421653c64f78261f24ee1f1"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga39a966c33421653c64f78261f24ee1f1">SocketTLS_get_verify_error_string</a> (Socket_T socket, char *buf, size_t size)</td></tr>
<tr class="memdesc:ga39a966c33421653c64f78261f24ee1f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get detailed verification error string.  <br /></td></tr>
<tr class="separator:ga39a966c33421653c64f78261f24ee1f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga315ccceb9cb5b74d8b90f1439ce57344" id="r_ga315ccceb9cb5b74d8b90f1439ce57344"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga315ccceb9cb5b74d8b90f1439ce57344">SocketTLS_is_session_reused</a> (Socket_T socket)</td></tr>
<tr class="memdesc:ga315ccceb9cb5b74d8b90f1439ce57344"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if TLS session was resumed.  <br /></td></tr>
<tr class="separator:ga315ccceb9cb5b74d8b90f1439ce57344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga56acd283757bb0af4f4d59d3c0f218ea" id="r_ga56acd283757bb0af4f4d59d3c0f218ea"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga56acd283757bb0af4f4d59d3c0f218ea">SocketTLS_get_alpn_selected</a> (Socket_T socket)</td></tr>
<tr class="memdesc:ga56acd283757bb0af4f4d59d3c0f218ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the negotiated ALPN protocol.  <br /></td></tr>
<tr class="separator:ga56acd283757bb0af4f4d59d3c0f218ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga122ad62f86b4477f7be54d55b769d58b" id="r_ga122ad62f86b4477f7be54d55b769d58b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b">SocketTLS_config_defaults</a> (<a class="el" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a> *config)</td></tr>
<tr class="memdesc:ga122ad62f86b4477f7be54d55b769d58b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the TLS configuration with secure library defaults.  <br /></td></tr>
<tr class="separator:ga122ad62f86b4477f7be54d55b769d58b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga79a403f2f54f21c90a92e9cb73e24cbc" id="r_ga79a403f2f54f21c90a92e9cb73e24cbc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc">SocketTLSContext_new_server</a> (const char *cert_file, const char *key_file, const char *ca_file)</td></tr>
<tr class="memdesc:ga79a403f2f54f21c90a92e9cb73e24cbc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create server TLS context with cert/key.  <br /></td></tr>
<tr class="separator:ga79a403f2f54f21c90a92e9cb73e24cbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7fe51da14439d768bdf72f4ed8fbb022" id="r_ga7fe51da14439d768bdf72f4ed8fbb022"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a> (const char *ca_file)</td></tr>
<tr class="memdesc:ga7fe51da14439d768bdf72f4ed8fbb022"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create client TLS context.  <br /></td></tr>
<tr class="separator:ga7fe51da14439d768bdf72f4ed8fbb022"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69b7880fa99df9a39b4db5259a9e1234" id="r_ga69b7880fa99df9a39b4db5259a9e1234"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234">SocketTLSContext_new</a> (const <a class="el" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a> *config)</td></tr>
<tr class="memdesc:ga69b7880fa99df9a39b4db5259a9e1234"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create client TLS context with custom config.  <br /></td></tr>
<tr class="separator:ga69b7880fa99df9a39b4db5259a9e1234"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e2af3e4421c3c20c7dbc4b99cfb4211" id="r_ga1e2af3e4421c3c20c7dbc4b99cfb4211"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1e2af3e4421c3c20c7dbc4b99cfb4211">SocketTLSContext_load_certificate</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *cert_file, const char *key_file)</td></tr>
<tr class="memdesc:ga1e2af3e4421c3c20c7dbc4b99cfb4211"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load server certificate and private key.  <br /></td></tr>
<tr class="separator:ga1e2af3e4421c3c20c7dbc4b99cfb4211"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92be47dab18fc79c409fc8b450e7aa0d" id="r_ga92be47dab18fc79c409fc8b450e7aa0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga92be47dab18fc79c409fc8b450e7aa0d">SocketTLSContext_add_certificate</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *hostname, const char *cert_file, const char *key_file)</td></tr>
<tr class="memdesc:ga92be47dab18fc79c409fc8b450e7aa0d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add certificate mapping for SNI virtual hosting.  <br /></td></tr>
<tr class="separator:ga92be47dab18fc79c409fc8b450e7aa0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4de1881e05f041a3d5016cba7d5a045" id="r_gac4de1881e05f041a3d5016cba7d5a045"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045">SocketTLSContext_load_ca</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *ca_file)</td></tr>
<tr class="memdesc:gac4de1881e05f041a3d5016cba7d5a045"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load trusted CA certificates.  <br /></td></tr>
<tr class="separator:gac4de1881e05f041a3d5016cba7d5a045"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga71084c00bec22f65b90301188868b759" id="r_ga71084c00bec22f65b90301188868b759"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga71084c00bec22f65b90301188868b759">SocketTLSContext_set_verify_mode</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, <a class="el" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a> mode)</td></tr>
<tr class="memdesc:ga71084c00bec22f65b90301188868b759"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set certificate verification policy.  <br /></td></tr>
<tr class="separator:ga71084c00bec22f65b90301188868b759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea7ca3e656e9b58706fafc3232147203" id="r_gaea7ca3e656e9b58706fafc3232147203"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaea7ca3e656e9b58706fafc3232147203">SocketTLSContext_free</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> *ctx_p)</td></tr>
<tr class="memdesc:gaea7ca3e656e9b58706fafc3232147203"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispose of TLS context and resources.  <br /></td></tr>
<tr class="separator:gaea7ca3e656e9b58706fafc3232147203"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2712efd6f1918aa87a3120547c0cf64d" id="r_ga2712efd6f1918aa87a3120547c0cf64d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga2712efd6f1918aa87a3120547c0cf64d">SocketTLSContext_set_verify_callback</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, <a class="el" href="group__security.html#gac9a12208531822c8304c23dcbcb8ba97">SocketTLSVerifyCallback</a> callback, void *user_data)</td></tr>
<tr class="memdesc:ga2712efd6f1918aa87a3120547c0cf64d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register custom verification callback.  <br /></td></tr>
<tr class="separator:ga2712efd6f1918aa87a3120547c0cf64d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8bf03223d7c3b3cd28f8d03fe082d15e" id="r_ga8bf03223d7c3b3cd28f8d03fe082d15e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8bf03223d7c3b3cd28f8d03fe082d15e">SocketTLSContext_load_crl</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *crl_path)</td></tr>
<tr class="memdesc:ga8bf03223d7c3b3cd28f8d03fe082d15e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load CRL file or directory into verification store.  <br /></td></tr>
<tr class="separator:ga8bf03223d7c3b3cd28f8d03fe082d15e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9ea9577387ebc9edb186a6c491c67ab4" id="r_ga9ea9577387ebc9edb186a6c491c67ab4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9ea9577387ebc9edb186a6c491c67ab4">SocketTLSContext_refresh_crl</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *crl_path)</td></tr>
<tr class="memdesc:ga9ea9577387ebc9edb186a6c491c67ab4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refresh a specific CRL (re-load).  <br /></td></tr>
<tr class="separator:ga9ea9577387ebc9edb186a6c491c67ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac5ba25c0153bc63b6087cff6304f4938" id="r_gac5ba25c0153bc63b6087cff6304f4938"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac5ba25c0153bc63b6087cff6304f4938">SocketTLSContext_reload_crl</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *crl_path)</td></tr>
<tr class="memdesc:gac5ba25c0153bc63b6087cff6304f4938"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reload CRL from path (alias for refresh_crl).  <br /></td></tr>
<tr class="separator:gac5ba25c0153bc63b6087cff6304f4938"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac049c86b0b5edba0a7bcb73ca2e1e2eb" id="r_gac049c86b0b5edba0a7bcb73ca2e1e2eb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac049c86b0b5edba0a7bcb73ca2e1e2eb">SocketTLSContext_set_crl_auto_refresh</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *crl_path, long interval_seconds, <a class="el" href="group__security.html#ga60686895b6fbdd1290a6f6176484bf5b">SocketTLSCrlCallback</a> callback, void *user_data)</td></tr>
<tr class="memdesc:gac049c86b0b5edba0a7bcb73ca2e1e2eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable automatic CRL refresh.  <br /></td></tr>
<tr class="separator:gac049c86b0b5edba0a7bcb73ca2e1e2eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4bee293124b9d83681f9471f0519689" id="r_gab4bee293124b9d83681f9471f0519689"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab4bee293124b9d83681f9471f0519689">SocketTLSContext_cancel_crl_auto_refresh</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gab4bee293124b9d83681f9471f0519689"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disable automatic CRL refresh.  <br /></td></tr>
<tr class="separator:gab4bee293124b9d83681f9471f0519689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga516c739f9ab7a0a5968279aba78a250c" id="r_ga516c739f9ab7a0a5968279aba78a250c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga516c739f9ab7a0a5968279aba78a250c">SocketTLSContext_crl_check_refresh</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga516c739f9ab7a0a5968279aba78a250c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check and perform CRL refresh if due.  <br /></td></tr>
<tr class="separator:ga516c739f9ab7a0a5968279aba78a250c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e822bd45ec2dad56c13d541dcd0c23d" id="r_ga1e822bd45ec2dad56c13d541dcd0c23d"><td class="memItemLeft" align="right" valign="top">long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1e822bd45ec2dad56c13d541dcd0c23d">SocketTLSContext_crl_next_refresh_ms</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga1e822bd45ec2dad56c13d541dcd0c23d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get milliseconds until next refresh.  <br /></td></tr>
<tr class="separator:ga1e822bd45ec2dad56c13d541dcd0c23d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacad0c368922de598277e4237779504b7" id="r_gacad0c368922de598277e4237779504b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gacad0c368922de598277e4237779504b7">SocketTLSContext_set_ocsp_response</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const unsigned char *response, size_t len)</td></tr>
<tr class="memdesc:gacad0c368922de598277e4237779504b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set static OCSP response for stapling.(server)  <br /></td></tr>
<tr class="separator:gacad0c368922de598277e4237779504b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0b49040701aa37f11720d9539c046347" id="r_ga0b49040701aa37f11720d9539c046347"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0b49040701aa37f11720d9539c046347">SocketTLSContext_set_ocsp_gen_callback</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, <a class="el" href="group__security.html#ga1acd7a590114ffbf4307a6f5a3bab35c">SocketTLSOcspGenCallback</a> cb, void *arg)</td></tr>
<tr class="memdesc:ga0b49040701aa37f11720d9539c046347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register dynamic OCSP response generator.  <br /></td></tr>
<tr class="separator:ga0b49040701aa37f11720d9539c046347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1a1b2392cfa8dd68e636bbef9df443f" id="r_gae1a1b2392cfa8dd68e636bbef9df443f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae1a1b2392cfa8dd68e636bbef9df443f">SocketTLS_get_ocsp_status</a> (Socket_T socket)</td></tr>
<tr class="memdesc:gae1a1b2392cfa8dd68e636bbef9df443f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get OCSP status after handshake (client).  <br /></td></tr>
<tr class="separator:gae1a1b2392cfa8dd68e636bbef9df443f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga414fb627189037256afd8c4e015b74d1" id="r_ga414fb627189037256afd8c4e015b74d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga414fb627189037256afd8c4e015b74d1">SocketTLSContext_enable_ocsp_stapling</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga414fb627189037256afd8c4e015b74d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable OCSP stapling request (client).  <br /></td></tr>
<tr class="separator:ga414fb627189037256afd8c4e015b74d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f214a19238ce8cd567d6ad6efa806c9" id="r_ga7f214a19238ce8cd567d6ad6efa806c9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga7f214a19238ce8cd567d6ad6efa806c9">SocketTLSContext_ocsp_stapling_enabled</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga7f214a19238ce8cd567d6ad6efa806c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if OCSP stapling is enabled.  <br /></td></tr>
<tr class="separator:ga7f214a19238ce8cd567d6ad6efa806c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1d9ff9d7e15f5a798d316ddf6ec6d53" id="r_gae1d9ff9d7e15f5a798d316ddf6ec6d53"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae1d9ff9d7e15f5a798d316ddf6ec6d53">SocketTLSContext_set_cert_lookup_callback</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, <a class="el" href="group__security.html#ga5c2914ee879d575869932c3a3aed4863">SocketTLSCertLookupCallback</a> callback, void *user_data)</td></tr>
<tr class="memdesc:gae1d9ff9d7e15f5a798d316ddf6ec6d53"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register custom cert lookup.  <br /></td></tr>
<tr class="separator:gae1d9ff9d7e15f5a798d316ddf6ec6d53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa7703e1d2c80b49601af8237e81729ef" id="r_gaa7703e1d2c80b49601af8237e81729ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaa7703e1d2c80b49601af8237e81729ef">SocketTLSContext_set_min_protocol</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, int version)</td></tr>
<tr class="memdesc:gaa7703e1d2c80b49601af8237e81729ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set minimum supported TLS version.  <br /></td></tr>
<tr class="separator:gaa7703e1d2c80b49601af8237e81729ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad094c4db92c9979bcde108166193abee" id="r_gad094c4db92c9979bcde108166193abee"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad094c4db92c9979bcde108166193abee">SocketTLSContext_set_max_protocol</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, int version)</td></tr>
<tr class="memdesc:gad094c4db92c9979bcde108166193abee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum supported TLS version.  <br /></td></tr>
<tr class="separator:gad094c4db92c9979bcde108166193abee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2e731151980c8c30a7fbb18da74ddffa" id="r_ga2e731151980c8c30a7fbb18da74ddffa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga2e731151980c8c30a7fbb18da74ddffa">SocketTLSContext_set_cipher_list</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *ciphers)</td></tr>
<tr class="memdesc:ga2e731151980c8c30a7fbb18da74ddffa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set allowed cipher suites.  <br /></td></tr>
<tr class="separator:ga2e731151980c8c30a7fbb18da74ddffa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fcc29a81cf5c643ee9a56deb46b9ec8" id="r_ga4fcc29a81cf5c643ee9a56deb46b9ec8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4fcc29a81cf5c643ee9a56deb46b9ec8">SocketTLSContext_set_alpn_protos</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char **protos, size_t count)</td></tr>
<tr class="memdesc:ga4fcc29a81cf5c643ee9a56deb46b9ec8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advertise ALPN protocols.  <br /></td></tr>
<tr class="separator:ga4fcc29a81cf5c643ee9a56deb46b9ec8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab7c088402bdf132a710551ebe2268ed0" id="r_gab7c088402bdf132a710551ebe2268ed0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab7c088402bdf132a710551ebe2268ed0">SocketTLSContext_set_alpn_callback</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, <a class="el" href="group__tls__context.html#gaa53566f8d54960bb2d44516a50f67c70">SocketTLSAlpnCallback</a> callback, void *user_data)</td></tr>
<tr class="memdesc:gab7c088402bdf132a710551ebe2268ed0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set custom ALPN protocol selection callback.  <br /></td></tr>
<tr class="separator:gab7c088402bdf132a710551ebe2268ed0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f0a68e802e789df40eaa28cb641a422" id="r_ga6f0a68e802e789df40eaa28cb641a422"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga6f0a68e802e789df40eaa28cb641a422">SocketTLSContext_enable_session_cache</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, size_t max_sessions, long timeout_seconds)</td></tr>
<tr class="memdesc:ga6f0a68e802e789df40eaa28cb641a422"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable session caching.infrastructure.  <br /></td></tr>
<tr class="separator:ga6f0a68e802e789df40eaa28cb641a422"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga51fa29a23c87a8f2a9c7b71b6731fb50" id="r_ga51fa29a23c87a8f2a9c7b71b6731fb50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga51fa29a23c87a8f2a9c7b71b6731fb50">SocketTLSContext_set_session_cache_size</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, size_t size)</td></tr>
<tr class="memdesc:ga51fa29a23c87a8f2a9c7b71b6731fb50"><td class="mdescLeft">&#160;</td><td class="mdescRight">Limit cached sessions.  <br /></td></tr>
<tr class="separator:ga51fa29a23c87a8f2a9c7b71b6731fb50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2093721c235cb8ebc83e90606abdcb33" id="r_ga2093721c235cb8ebc83e90606abdcb33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga2093721c235cb8ebc83e90606abdcb33">SocketTLSContext_get_cache_stats</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, size_t *hits, size_t *misses, size_t *stores)</td></tr>
<tr class="memdesc:ga2093721c235cb8ebc83e90606abdcb33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get session cache statistics.  <br /></td></tr>
<tr class="separator:ga2093721c235cb8ebc83e90606abdcb33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7d40e475eec529625a3d6ba74d23f4a" id="r_gae7d40e475eec529625a3d6ba74d23f4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae7d40e475eec529625a3d6ba74d23f4a">SocketTLSContext_enable_session_tickets</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const unsigned char *key, size_t key_len)</td></tr>
<tr class="memdesc:gae7d40e475eec529625a3d6ba74d23f4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable stateless session.resumption using tickets.  <br /></td></tr>
<tr class="separator:gae7d40e475eec529625a3d6ba74d23f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga34caeef50e78017625d2eb62142a7e45" id="r_ga34caeef50e78017625d2eb62142a7e45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga34caeef50e78017625d2eb62142a7e45">SocketTLSContext_add_pin</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const unsigned char *sha256_hash)</td></tr>
<tr class="memdesc:ga34caeef50e78017625d2eb62142a7e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add SPKI SHA256 pin (binary format).  <br /></td></tr>
<tr class="separator:ga34caeef50e78017625d2eb62142a7e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafd50881da0db97098204ff6fa920bb26" id="r_gafd50881da0db97098204ff6fa920bb26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gafd50881da0db97098204ff6fa920bb26">SocketTLSContext_add_pin_hex</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *hex_hash)</td></tr>
<tr class="memdesc:gafd50881da0db97098204ff6fa920bb26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add SPKI SHA256 pin (hex string).  <br /></td></tr>
<tr class="separator:gafd50881da0db97098204ff6fa920bb26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa535f69cf93b2f0dec403e71336b0682" id="r_gaa535f69cf93b2f0dec403e71336b0682"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaa535f69cf93b2f0dec403e71336b0682">SocketTLSContext_add_pin_from_cert</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *cert_file)</td></tr>
<tr class="memdesc:gaa535f69cf93b2f0dec403e71336b0682"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract and add pin from certificate.  <br /></td></tr>
<tr class="separator:gaa535f69cf93b2f0dec403e71336b0682"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacf5982c65823fa0eedc34d8d933710a9" id="r_gacf5982c65823fa0eedc34d8d933710a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gacf5982c65823fa0eedc34d8d933710a9">SocketTLSContext_add_pin_from_x509</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const X509 *cert)</td></tr>
<tr class="memdesc:gacf5982c65823fa0eedc34d8d933710a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add pin from X509 certificate object.  <br /></td></tr>
<tr class="separator:gacf5982c65823fa0eedc34d8d933710a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae201aacce977d32ab0187dd8b97d6c9a" id="r_gae201aacce977d32ab0187dd8b97d6c9a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae201aacce977d32ab0187dd8b97d6c9a">SocketTLSContext_clear_pins</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gae201aacce977d32ab0187dd8b97d6c9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all certificate pins.  <br /></td></tr>
<tr class="separator:gae201aacce977d32ab0187dd8b97d6c9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a972b0da962c5515936444b6921182d" id="r_ga8a972b0da962c5515936444b6921182d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8a972b0da962c5515936444b6921182d">SocketTLSContext_set_pin_enforcement</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, int enforce)</td></tr>
<tr class="memdesc:ga8a972b0da962c5515936444b6921182d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set pin enforcement mode.  <br /></td></tr>
<tr class="separator:ga8a972b0da962c5515936444b6921182d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d03fb564c11628d54e76a1c177b8494" id="r_ga9d03fb564c11628d54e76a1c177b8494"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9d03fb564c11628d54e76a1c177b8494">SocketTLSContext_get_pin_enforcement</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga9d03fb564c11628d54e76a1c177b8494"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current enforcement mode.  <br /></td></tr>
<tr class="separator:ga9d03fb564c11628d54e76a1c177b8494"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaec2e531425cc03bff359517f60aa474c" id="r_gaec2e531425cc03bff359517f60aa474c"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaec2e531425cc03bff359517f60aa474c">SocketTLSContext_get_pin_count</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gaec2e531425cc03bff359517f60aa474c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get number of configured pins.  <br /></td></tr>
<tr class="separator:gaec2e531425cc03bff359517f60aa474c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaea37c149f7babbf14c28caf0ffef97cf" id="r_gaea37c149f7babbf14c28caf0ffef97cf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaea37c149f7babbf14c28caf0ffef97cf">SocketTLSContext_has_pins</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gaea37c149f7babbf14c28caf0ffef97cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if any pins are configured.  <br /></td></tr>
<tr class="separator:gaea37c149f7babbf14c28caf0ffef97cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac051204c676250b114e00af223055686" id="r_gac051204c676250b114e00af223055686"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac051204c676250b114e00af223055686">SocketTLSContext_verify_pin</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const unsigned char *sha256_hash)</td></tr>
<tr class="memdesc:gac051204c676250b114e00af223055686"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if hash matches any pin.  <br /></td></tr>
<tr class="separator:gac051204c676250b114e00af223055686"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae69fbca6dae1712eb7abd1f1b268926b" id="r_gae69fbca6dae1712eb7abd1f1b268926b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae69fbca6dae1712eb7abd1f1b268926b">SocketTLSContext_verify_cert_pin</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const X509 *cert)</td></tr>
<tr class="memdesc:gae69fbca6dae1712eb7abd1f1b268926b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if certificate matches any pin.  <br /></td></tr>
<tr class="separator:gae69fbca6dae1712eb7abd1f1b268926b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf27bede9402c6c8c7541143e019c635f" id="r_gaf27bede9402c6c8c7541143e019c635f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaf27bede9402c6c8c7541143e019c635f">SocketTLSContext_enable_ct</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, <a class="el" href="group__security.html#ga4d930163393a67950a5378e540c0e939">CTValidationMode</a> mode)</td></tr>
<tr class="memdesc:gaf27bede9402c6c8c7541143e019c635f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable Certificate Transparency verification.  <br /></td></tr>
<tr class="separator:gaf27bede9402c6c8c7541143e019c635f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b70029e86352f55e3710673ba30c23f" id="r_ga3b70029e86352f55e3710673ba30c23f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga3b70029e86352f55e3710673ba30c23f">SocketTLSContext_ct_enabled</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga3b70029e86352f55e3710673ba30c23f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if CT verification is enabled.  <br /></td></tr>
<tr class="separator:ga3b70029e86352f55e3710673ba30c23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf18e867664012c78a758c5454f62c367" id="r_gaf18e867664012c78a758c5454f62c367"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#ga4d930163393a67950a5378e540c0e939">CTValidationMode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaf18e867664012c78a758c5454f62c367">SocketTLSContext_get_ct_mode</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gaf18e867664012c78a758c5454f62c367"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get current CT validation mode.  <br /></td></tr>
<tr class="separator:gaf18e867664012c78a758c5454f62c367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada967caf61c070399281b088b35ed78a" id="r_gada967caf61c070399281b088b35ed78a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gada967caf61c070399281b088b35ed78a">SocketTLSContext_set_ctlog_list_file</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *log_file)</td></tr>
<tr class="memdesc:gada967caf61c070399281b088b35ed78a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load custom CT log list.  <br /></td></tr>
<tr class="separator:gada967caf61c070399281b088b35ed78a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6e8aae1b6b1182d3f83b8673fdbbe945" id="r_ga6e8aae1b6b1182d3f83b8673fdbbe945"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga6e8aae1b6b1182d3f83b8673fdbbe945">SocketTLSContext_get_ssl_ctx</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga6e8aae1b6b1182d3f83b8673fdbbe945"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get underlying OpenSSL SSL_CTX*.  <br /></td></tr>
<tr class="separator:ga6e8aae1b6b1182d3f83b8673fdbbe945"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga39bd71708494c1c833d3064c3a70f8ad" id="r_ga39bd71708494c1c833d3064c3a70f8ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga39bd71708494c1c833d3064c3a70f8ad">SocketTLSContext_is_server</a> (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga39bd71708494c1c833d3064c3a70f8ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if context is server-mode.  <br /></td></tr>
<tr class="separator:ga39bd71708494c1c833d3064c3a70f8ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ga4692098ecf52e6929c8763f0fa9fe222" id="r_ga4692098ecf52e6929c8763f0fa9fe222"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4692098ecf52e6929c8763f0fa9fe222">SocketIPTracker_Failed</a></td></tr>
<tr class="memdesc:ga4692098ecf52e6929c8763f0fa9fe222"><td class="mdescLeft">&#160;</td><td class="mdescRight">Base exception for IP tracker module failures.  <br /></td></tr>
<tr class="separator:ga4692098ecf52e6929c8763f0fa9fe222"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacfbf054296946c43e621dcf10b9295a9" id="r_gacfbf054296946c43e621dcf10b9295a9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gacfbf054296946c43e621dcf10b9295a9">SocketSYNProtect_Failed</a></td></tr>
<tr class="memdesc:gacfbf054296946c43e621dcf10b9295a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">General SYN protection operation failure.  <br /></td></tr>
<tr class="separator:gacfbf054296946c43e621dcf10b9295a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga083605c4d8e6ea5658b72883f8e41be9" id="r_ga083605c4d8e6ea5658b72883f8e41be9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a></td></tr>
<tr class="memdesc:ga083605c4d8e6ea5658b72883f8e41be9"><td class="mdescLeft">&#160;</td><td class="mdescRight">General DTLS operation failure.  <br /></td></tr>
<tr class="separator:ga083605c4d8e6ea5658b72883f8e41be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadffbcee0cdd3e2ea80a6a03a73755085" id="r_gadffbcee0cdd3e2ea80a6a03a73755085"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gadffbcee0cdd3e2ea80a6a03a73755085">SocketDTLS_HandshakeFailed</a></td></tr>
<tr class="memdesc:gadffbcee0cdd3e2ea80a6a03a73755085"><td class="mdescLeft">&#160;</td><td class="mdescRight">DTLS handshake failure.  <br /></td></tr>
<tr class="separator:gadffbcee0cdd3e2ea80a6a03a73755085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf1324e42b633182c01b0157ebfba0e9e" id="r_gaf1324e42b633182c01b0157ebfba0e9e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaf1324e42b633182c01b0157ebfba0e9e">SocketDTLS_VerifyFailed</a></td></tr>
<tr class="memdesc:gaf1324e42b633182c01b0157ebfba0e9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Certificate verification failure.  <br /></td></tr>
<tr class="separator:gaf1324e42b633182c01b0157ebfba0e9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga69b6e30fa30bd7fe0a621d807796d73f" id="r_ga69b6e30fa30bd7fe0a621d807796d73f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga69b6e30fa30bd7fe0a621d807796d73f">SocketDTLS_CookieFailed</a></td></tr>
<tr class="memdesc:ga69b6e30fa30bd7fe0a621d807796d73f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cookie exchange failure.  <br /></td></tr>
<tr class="separator:ga69b6e30fa30bd7fe0a621d807796d73f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a2543bc8c6671e774391f4861d4fa5d" id="r_ga9a2543bc8c6671e774391f4861d4fa5d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga9a2543bc8c6671e774391f4861d4fa5d">SocketDTLS_TimeoutExpired</a></td></tr>
<tr class="memdesc:ga9a2543bc8c6671e774391f4861d4fa5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handshake timeout expired.  <br /></td></tr>
<tr class="separator:ga9a2543bc8c6671e774391f4861d4fa5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28d15a7e6fc136b5d542236ef27f0be6" id="r_ga28d15a7e6fc136b5d542236ef27f0be6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga28d15a7e6fc136b5d542236ef27f0be6">SocketDTLS_ShutdownFailed</a></td></tr>
<tr class="memdesc:ga28d15a7e6fc136b5d542236ef27f0be6"><td class="mdescLeft">&#160;</td><td class="mdescRight">DTLS shutdown failure.  <br /></td></tr>
<tr class="separator:ga28d15a7e6fc136b5d542236ef27f0be6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf6dd40cb19f09e9fffb7f30594372db2" id="r_gaf6dd40cb19f09e9fffb7f30594372db2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaf6dd40cb19f09e9fffb7f30594372db2">tls_context_exdata_idx</a></td></tr>
<tr class="memdesc:gaf6dd40cb19f09e9fffb7f30594372db2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global ex_data index for storing <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> in SSL_CTX.  <br /></td></tr>
<tr class="separator:gaf6dd40cb19f09e9fffb7f30594372db2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8ca0182ebb7a93df98871664989b949b" id="r_ga8ca0182ebb7a93df98871664989b949b"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a> []</td></tr>
<tr class="memdesc:ga8ca0182ebb7a93df98871664989b949b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.  <br /></td></tr>
<tr class="separator:ga8ca0182ebb7a93df98871664989b949b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc011202dd4f2e080b6ea8eb0f24287e" id="r_gabc011202dd4f2e080b6ea8eb0f24287e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a></td></tr>
<tr class="memdesc:gabc011202dd4f2e080b6ea8eb0f24287e"><td class="mdescLeft">&#160;</td><td class="mdescRight">General TLS operation failure.  <br /></td></tr>
<tr class="separator:gabc011202dd4f2e080b6ea8eb0f24287e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82be75dd764021fb64cd6824768e2254" id="r_ga82be75dd764021fb64cd6824768e2254"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga82be75dd764021fb64cd6824768e2254">SocketTLS_HandshakeFailed</a></td></tr>
<tr class="memdesc:ga82be75dd764021fb64cd6824768e2254"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS handshake could not complete.  <br /></td></tr>
<tr class="separator:ga82be75dd764021fb64cd6824768e2254"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe406e483a861198db5bca58300f1728" id="r_gabe406e483a861198db5bca58300f1728"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gabe406e483a861198db5bca58300f1728">SocketTLS_VerifyFailed</a></td></tr>
<tr class="memdesc:gabe406e483a861198db5bca58300f1728"><td class="mdescLeft">&#160;</td><td class="mdescRight">Peer certificate verification failure.  <br /></td></tr>
<tr class="separator:gabe406e483a861198db5bca58300f1728"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad97195716332983bae10a77f275740bd" id="r_gad97195716332983bae10a77f275740bd"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gad97195716332983bae10a77f275740bd">SocketTLS_ProtocolError</a></td></tr>
<tr class="memdesc:gad97195716332983bae10a77f275740bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS protocol violation or internal state error.  <br /></td></tr>
<tr class="separator:gad97195716332983bae10a77f275740bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa724dbe4115729ef621c0f1f74b5afd6" id="r_gaa724dbe4115729ef621c0f1f74b5afd6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gaa724dbe4115729ef621c0f1f74b5afd6">SocketTLS_ShutdownFailed</a></td></tr>
<tr class="memdesc:gaa724dbe4115729ef621c0f1f74b5afd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">TLS graceful shutdown failure.  <br /></td></tr>
<tr class="separator:gaa724dbe4115729ef621c0f1f74b5afd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga445003fff70029dd096df971801be0e4" id="r_ga445003fff70029dd096df971801be0e4"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga445003fff70029dd096df971801be0e4">SocketTLS_PinVerifyFailed</a></td></tr>
<tr class="memdesc:ga445003fff70029dd096df971801be0e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exception raised when certificate pin verification fails during TLS handshake or manual check.  <br /></td></tr>
<tr class="separator:ga445003fff70029dd096df971801be0e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1189362a5c97fc90222e06232de1bdfe" id="r_ga1189362a5c97fc90222e06232de1bdfe"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">SocketDgram_T::dtls_ctx</a></td></tr>
<tr class="separator:ga1189362a5c97fc90222e06232de1bdfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga539711122c1eb94e27ac1d1f98581e4f" id="r_ga539711122c1eb94e27ac1d1f98581e4f"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">SocketDgram_T::dtls_ssl</a></td></tr>
<tr class="separator:ga539711122c1eb94e27ac1d1f98581e4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b5dc596873a18adc6003b2595394223" id="r_ga8b5dc596873a18adc6003b2595394223"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga8b5dc596873a18adc6003b2595394223">SocketDgram_T::dtls_enabled</a></td></tr>
<tr class="separator:ga8b5dc596873a18adc6003b2595394223"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a3d07842374d449a9fa61fab416edc8" id="r_ga5a3d07842374d449a9fa61fab416edc8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga5a3d07842374d449a9fa61fab416edc8">SocketDgram_T::dtls_handshake_done</a></td></tr>
<tr class="separator:ga5a3d07842374d449a9fa61fab416edc8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga701871c2fa48e90c055fc70524d65b04" id="r_ga701871c2fa48e90c055fc70524d65b04"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga701871c2fa48e90c055fc70524d65b04">SocketDgram_T::dtls_shutdown_done</a></td></tr>
<tr class="separator:ga701871c2fa48e90c055fc70524d65b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b8a6cfd63b8f12340dec5f778111c90" id="r_ga3b8a6cfd63b8f12340dec5f778111c90"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga3b8a6cfd63b8f12340dec5f778111c90">SocketDgram_T::dtls_last_handshake_state</a></td></tr>
<tr class="separator:ga3b8a6cfd63b8f12340dec5f778111c90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4c14b4e6c07e5f1ff646987622a611a" id="r_gab4c14b4e6c07e5f1ff646987622a611a"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gab4c14b4e6c07e5f1ff646987622a611a">SocketDgram_T::dtls_mtu</a></td></tr>
<tr class="separator:gab4c14b4e6c07e5f1ff646987622a611a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fdda17cd54e1f2365c69210a28b7c7c" id="r_ga4fdda17cd54e1f2365c69210a28b7c7c"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga4fdda17cd54e1f2365c69210a28b7c7c">SocketDgram_T::dtls_sni_hostname</a></td></tr>
<tr class="separator:ga4fdda17cd54e1f2365c69210a28b7c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0430ae66a05abe2f9a50e79656d05b84" id="r_ga0430ae66a05abe2f9a50e79656d05b84"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga0430ae66a05abe2f9a50e79656d05b84">SocketDgram_T::dtls_peer_host</a></td></tr>
<tr class="separator:ga0430ae66a05abe2f9a50e79656d05b84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga560ea9583d1317b5992f825e4f9367e2" id="r_ga560ea9583d1317b5992f825e4f9367e2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga560ea9583d1317b5992f825e4f9367e2">SocketDgram_T::dtls_peer_port</a></td></tr>
<tr class="separator:ga560ea9583d1317b5992f825e4f9367e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga62d63165a3c926aaf21241ac798e0fe3" id="r_ga62d63165a3c926aaf21241ac798e0fe3"><td class="memItemLeft" align="right" valign="top">struct addrinfo *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga62d63165a3c926aaf21241ac798e0fe3">SocketDgram_T::dtls_peer_res</a></td></tr>
<tr class="separator:ga62d63165a3c926aaf21241ac798e0fe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga40b959d65731e8a1462d8e6ef01d4a75" id="r_ga40b959d65731e8a1462d8e6ef01d4a75"><td class="memItemLeft" align="right" valign="top">int64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga40b959d65731e8a1462d8e6ef01d4a75">SocketDgram_T::dtls_peer_cache_ts</a></td></tr>
<tr class="separator:ga40b959d65731e8a1462d8e6ef01d4a75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac9279985541f6f5feae01827ec148bd5" id="r_gac9279985541f6f5feae01827ec148bd5"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gac9279985541f6f5feae01827ec148bd5">SocketDgram_T::dtls_rbio</a></td></tr>
<tr class="separator:gac9279985541f6f5feae01827ec148bd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga36e474764992051d21d2f5bbc2fcf4b2" id="r_ga36e474764992051d21d2f5bbc2fcf4b2"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga36e474764992051d21d2f5bbc2fcf4b2">SocketDgram_T::dtls_wbio</a></td></tr>
<tr class="separator:ga36e474764992051d21d2f5bbc2fcf4b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga627026386fc506cec37e59271659a1cb" id="r_ga627026386fc506cec37e59271659a1cb"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#ga627026386fc506cec37e59271659a1cb">SocketDgram_T::dtls_read_buf</a></td></tr>
<tr class="separator:ga627026386fc506cec37e59271659a1cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabc75afb656bc9e46f3953b6fc0feb8c4" id="r_gabc75afb656bc9e46f3953b6fc0feb8c4"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gabc75afb656bc9e46f3953b6fc0feb8c4">SocketDgram_T::dtls_write_buf</a></td></tr>
<tr class="separator:gabc75afb656bc9e46f3953b6fc0feb8c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae8075af8c029579e8f939ac57d7a5699" id="r_gae8075af8c029579e8f939ac57d7a5699"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gae8075af8c029579e8f939ac57d7a5699">SocketDgram_T::dtls_read_buf_len</a></td></tr>
<tr class="separator:gae8075af8c029579e8f939ac57d7a5699"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb96f6937a0f3c07e23f5073629f6bb4" id="r_gacb96f6937a0f3c07e23f5073629f6bb4"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__security.html#gacb96f6937a0f3c07e23f5073629f6bb4">SocketDgram_T::dtls_write_buf_len</a></td></tr>
<tr class="separator:gacb96f6937a0f3c07e23f5073629f6bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Comprehensive security protections for network applications. </p>
<p>Comprehensive security protections for network applications with TLS 1.3 hardening and DDoS mitigation.</p>
<p>The Security group provides layered protection against network attacks and abuse patterns. Key components include SYN flood protection, IP filtering, and adaptive rate limiting mechanisms.</p>
<h2><a class="anchor" id="autotoc_md155"></a>
Architecture Overview</h2>
<div class="fragment"><div class="line"></div>
<div class="line">                    Application Layer                      </div>
<div class="line">  HTTP Servers, TCP Services, <a class="code hl_struct" href="group__connection__mgmt.html#structConnection">Connection</a> Pools, etc.       </div>
<div class="line"></div>
<div class="line">                       Uses                                </div>
<div class="line"></div>
<div class="line">                 Security Layer                            </div>
<div class="line">  SYN Protection, TLS, IP Filtering, Rate Limiting         </div>
<div class="line">     </div>
<div class="line">              SocketSYNProtect                           </div>
<div class="line">          </div>
<div class="line">     IP Reputation Engine                              </div>
<div class="line">      Rate limiting per IP                            </div>
<div class="line">      Success/failure tracking                        </div>
<div class="line">      Adaptive scoring                                </div>
<div class="line">          </div>
<div class="line">                                                         </div>
<div class="line">          </div>
<div class="line">     Protection Actions                                </div>
<div class="line">      ALLOW: Normal processing                        </div>
<div class="line">      THROTTLE: Accept with delay                     </div>
<div class="line">      CHALLENGE: TCP_DEFER_ACCEPT                     </div>
<div class="line">      BLOCK: Immediate rejection                      </div>
<div class="line">          </div>
<div class="line">     </div>
<div class="line"></div>
<div class="line">                       Uses                                </div>
<div class="line"></div>
<div class="line">              Foundation Layer                             </div>
<div class="line">  Arena, Except, SocketConfig, SocketUtil, SocketTimer     </div>
<div class="line"></div>
<div class="ttc" id="agroup__connection__mgmt_html_structConnection"><div class="ttname"><a href="group__connection__mgmt.html#structConnection">Connection</a></div><div class="ttdoc">Internal structure representing a pooled connection slot.</div><div class="ttdef"><b>Definition</b> <a href="SocketPool-private_8h_source.html#l00268">SocketPool-private.h:269</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md156"></a>
Module Relationships</h2>
<ul>
<li><b>Depends on</b>: Foundation modules (Arena, Except, SocketConfig)</li>
<li><b>Used by</b>: SocketPool for integrated protection</li>
<li><b>Integrates with</b>: SocketTimer for cleanup scheduling</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html">Core Foundation Modules</a> for base infrastructure </dd>
<dd>
<a class="el" href="group__connection__mgmt.html">Connection Management Modules</a> for connection lifecycle management</dd></dl>
<p>The Security modules provide production-grade defenses against common threats including man-in-the-middle attacks, SYN floods, and IP-based abuse. Key focus areas: strict TLS configuration, certificate validation, adaptive rate limiting, and connection filtering. Designed for seamless integration with Socket core without performance penalties.</p>
<h2><a class="anchor" id="autotoc_md537"></a>
Architecture Overview</h2>
<div class="fragment"><div class="line"></div>
<div class="line">                    Application Layer                      </div>
<div class="line">  SocketPool, <a class="code hl_struct" href="group__http.html#structSocketHTTPClient">SocketHTTPClient</a>, <a class="code hl_struct" href="group__http.html#structSocketHTTPServer">SocketHTTPServer</a>, Custom   </div>
<div class="line">  Services, etc.                                           </div>
<div class="line"></div>
<div class="line">               Uses / Integrates</div>
<div class="line"></div>
<div class="line">                 Security Layer                            </div>
<div class="line">          </div>
<div class="line">   SocketTLS    SocketSYN      SocketDTLS           </div>
<div class="line">  /DTLS       Protect       /IPTracker            </div>
<div class="line">          </div>
<div class="line">                                                        </div>
<div class="line">   TLS Crypto   SYN         UDP/DTLS     Rate Limits    </div>
<div class="line"></div>
<div class="line">                                        </div>
<div class="line"></div>
<div class="line">              Foundation + Core I/O Layer                  </div>
<div class="line">  Arena, Except, Socket, SocketConfig, SocketUtil          </div>
<div class="line"></div>
<div class="ttc" id="agroup__http_html_structSocketHTTPClient"><div class="ttname"><a href="group__http.html#structSocketHTTPClient">SocketHTTPClient</a></div><div class="ttdoc">Main HTTP client instance managing configuration, pool, auth, and state.</div><div class="ttdef"><b>Definition</b> <a href="SocketHTTPClient-private_8h_source.html#l00195">SocketHTTPClient-private.h:196</a></div></div>
<div class="ttc" id="agroup__http_html_structSocketHTTPServer"><div class="ttname"><a href="group__http.html#structSocketHTTPServer">SocketHTTPServer</a></div><div class="ttdoc">Internal implementation of the SocketHTTPServer opaque type.</div><div class="ttdef"><b>Definition</b> <a href="SocketHTTPServer-private_8h_source.html#l00235">SocketHTTPServer-private.h:236</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md538"></a>
Module Relationships</h2>
<ul>
<li><b>Depends on</b>: <a class="el" href="group__foundation.html">Core Foundation Modules</a> (memory, exceptions, config), <a class="el" href="group__core__io.html">Core I/O Modules</a> (Socket primitives)</li>
<li><b>Used by</b>: <a class="el" href="group__connection__mgmt.html">Connection Management Modules</a> (protected pools), <a class="el" href="group__http.html">HTTP Modules</a> (secure HTTP/2), <a class="el" href="group__async__io.html">Async I/O Modules</a> (non-blocking TLS)</li>
<li><b>Integrates with</b>: <a class="el" href="group__event__system.html">Event System Modules</a> (poll during handshake), <a class="el" href="group__utilities.html">Utilities</a> (timers, rate limits)</li>
</ul>
<h2><a class="anchor" id="autotoc_md539"></a>
Protection Mechanisms</h2>
<h3><a class="anchor" id="autotoc_md540"></a>
TLS/SSL Encryption</h3>
<ul>
<li>TLS 1.3 exclusive: PFS, secure ciphers, anti-downgrade</li>
<li>Client/server auth, SNI, ALPN, session resumption</li>
<li>Non-blocking handshake + secure I/O wrappers</li>
</ul>
<h3><a class="anchor" id="autotoc_md541"></a>
SYN Flood &amp; DDoS Defense</h3>
<ul>
<li>Adaptive black/whitelisting with reputation scoring</li>
<li>Sliding window rate limiting per IP</li>
<li>Challenge-response cookies for UDP/DTLS</li>
</ul>
<h3><a class="anchor" id="autotoc_md542"></a>
IP &amp; Traffic Control</h3>
<ul>
<li>Per-IP connection limits and tracking</li>
<li>Geoblocking, anomaly detection</li>
<li>Integration with SocketPool for server protection</li>
</ul>
<h2><a class="anchor" id="autotoc_md543"></a>
Security Philosophy</h2>
<ul>
<li><b>Secure by Default</b>: No weak configs; TLS 1.3 only, verify peers</li>
<li><b>Minimal Attack Surface</b>: No global state, thread-local errors</li>
<li><b>Performance Oriented</b>: Zero-copy where possible, async-friendly</li>
<li><b>Auditable</b>: Detailed logging, metrics, error categorization</li>
</ul>
<h2><a class="anchor" id="autotoc_md544"></a>
Configuration Best Practices</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Aspect   </th><th class="markdownTableHeadNone">Recommendation   </th><th class="markdownTableHeadNone">Rationale    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TLS Version   </td><td class="markdownTableBodyNone">TLS 1.3 only   </td><td class="markdownTableBodyNone">Eliminates legacy vulns    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Cipher Suites   </td><td class="markdownTableBodyNone">Modern PFS   </td><td class="markdownTableBodyNone">Forward secrecy    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Verify Mode   </td><td class="markdownTableBodyNone">TLS_VERIFY_PEER   </td><td class="markdownTableBodyNone">Prevent MITM    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">CA Store   </td><td class="markdownTableBodyNone">System + custom   </td><td class="markdownTableBodyNone">Trust chain validation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Session Cache   </td><td class="markdownTableBodyNone">Enabled with tickets   </td><td class="markdownTableBodyNone">Performance without security loss   </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>Disable only for testing; production requires full verification </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Requires OpenSSL/LibreSSL; enabled via -DENABLE_TLS=ON in CMake</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html">Foundation Modules</a> for base infrastructure </dd>
<dd>
<a class="el" href="group__core__io.html">Core I/O Modules</a> for sockets secured by TLS </dd>
<dd>
<a class="el" href="group__http.html">HTTP Modules</a> for TLS-secured protocols </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> for hardening guide </dd>
<dd>
docs/TLS-CONFIG.md for detailed TLS setup </dd>
<dd>
docs/SYN-PROTECT.md for DDoS protection details </dd></dl>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structSocketSYN__IPEntry" id="structSocketSYN__IPEntry"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketSYN__IPEntry">&#9670;&#160;</a></span>SocketSYN_IPEntry</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketSYN_IPEntry</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Internal IP tracking entry for hash table and LRU management. </p>
<p>Not part of public API; used for efficient IP state storage.</p>
<p>Combines public <a class="el" href="group__security.html#structSocketSYN__IPState" title="Per-IP address tracking and reputation state.">SocketSYN_IPState</a> with private linking fields for hash chaining and least-recently-used eviction policy.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYN__IPState" title="Per-IP address tracking and reputation state.">SocketSYN_IPState</a> for the public-facing <a class="el" href="group__security.html#af882bfdddf22be13d67e6a4140479521">state</a> fields. </dd>
<dd>
<a class="el" href="group__security.html#ad510a10bf5b3f26894d4d91351cc6cf8">SocketSYNProtect_T::ip_table</a> for the containing hash table. </dd>
<dd>
<a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b" title="Perform periodic cleanup of expired and stale protection state.">SocketSYNProtect_cleanup()</a> for eviction during maintenance. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00138">138</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>
</div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketSYN_IPEntry:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structSocketSYN__IPEntry__coll__graph.svg" width="243" height="143"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a89eb9afd247e736743ee90e99d62d8c5" name="a89eb9afd247e736743ee90e99d62d8c5"></a>struct <a class="el" href="group__security.html#structSocketSYN__IPEntry">SocketSYN_IPEntry</a> *</td>
<td class="fieldname">
hash_next</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa0407a11365fa3ee52c7c6dfd4e1feab" name="aa0407a11365fa3ee52c7c6dfd4e1feab"></a>struct <a class="el" href="group__security.html#structSocketSYN__IPEntry">SocketSYN_IPEntry</a> *</td>
<td class="fieldname">
lru_next</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1c94cc50fd14ab524c775100f8ee3eea" name="a1c94cc50fd14ab524c775100f8ee3eea"></a>struct <a class="el" href="group__security.html#structSocketSYN__IPEntry">SocketSYN_IPEntry</a> *</td>
<td class="fieldname">
lru_prev</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af882bfdddf22be13d67e6a4140479521" name="af882bfdddf22be13d67e6a4140479521"></a><a class="el" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a></td>
<td class="fieldname">
state</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structSocketSYN__WhitelistEntry" id="structSocketSYN__WhitelistEntry"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketSYN__WhitelistEntry">&#9670;&#160;</a></span>SocketSYN_WhitelistEntry</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketSYN_WhitelistEntry</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Structure for whitelist entries supporting single IPs and CIDR ranges. </p>
<p>Chained list in hash table for fast lookups.</p>
<p>Stores parsed address for efficient prefix matching on IPv4/IPv6 CIDR ranges. CIDR entries are not expanded to individual IPs; uses prefix length for matching.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0" title="Add a CIDR range to the whitelist.">SocketSYNProtect_whitelist_add_cidr()</a> for adding CIDR notations. </dd>
<dd>
<a class="el" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108" title="Add an IP address to the whitelist.">SocketSYNProtect_whitelist_add()</a> for single IPs. </dd>
<dd>
<a class="el" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc" title="Check if an IP address is whitelisted.">SocketSYNProtect_whitelist_contains()</a> for query. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00170">170</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>
</div><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketSYN_WhitelistEntry:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structSocketSYN__WhitelistEntry__coll__graph.svg" width="244" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="af5fba695c3809c752e76975b456fa198" name="af5fba695c3809c752e76975b456fa198"></a>uint8_t</td>
<td class="fieldname">
addr_bytes[16]</td>
<td class="fielddoc">
<p>Parsed address bytes (IPv6 max) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a11d04a6290bdd215b762de9b66b287fb" name="a11d04a6290bdd215b762de9b66b287fb"></a>int</td>
<td class="fieldname">
addr_family</td>
<td class="fielddoc">
<p>AF_INET or AF_INET6 </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a14151e2533ade1a3e3b03eb39fa31f40" name="a14151e2533ade1a3e3b03eb39fa31f40"></a>char</td>
<td class="fieldname">
ip[64]</td>
<td class="fielddoc">
<p>IP or network address </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a7934163fc1470293349750803a22c6b4" name="a7934163fc1470293349750803a22c6b4"></a>int</td>
<td class="fieldname">
is_cidr</td>
<td class="fielddoc">
<p>1 if CIDR range, 0 if single IP </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a928ee55787cda89dc8241101a6bfa7a7" name="a928ee55787cda89dc8241101a6bfa7a7"></a>struct <a class="el" href="group__security.html#structSocketSYN__WhitelistEntry">SocketSYN_WhitelistEntry</a> *</td>
<td class="fieldname">
next</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aff241001ec52e4f035ce92982762bfae" name="aff241001ec52e4f035ce92982762bfae"></a>uint8_t</td>
<td class="fieldname">
prefix_len</td>
<td class="fielddoc">
<p>CIDR prefix length (0-128) </p>
</td></tr>
</table>

</div>
</div>
<a name="structSocketSYN__BlacklistEntry" id="structSocketSYN__BlacklistEntry"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketSYN__BlacklistEntry">&#9670;&#160;</a></span>SocketSYN_BlacklistEntry</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketSYN_BlacklistEntry</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Internal structure for blacklisted IP addresses with expiry support. </p>
<p>Chained in hash table; entries auto-expire via cleanup().</p>
<p>Stores IP string and absolute expiry timestamp; permanent if 0.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485" title="Add an IP address to the blacklist.">SocketSYNProtect_blacklist_add()</a> for adding with duration. </dd>
<dd>
<a class="el" href="group__security.html#ga88d4fb38017492beca3f130d311dadd5" title="Check if an IP address is currently blacklisted.">SocketSYNProtect_blacklist_contains()</a> for checking active status. </dd>
<dd>
<a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b" title="Perform periodic cleanup of expired and stale protection state.">SocketSYNProtect_cleanup()</a> for removing expired entries. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00196">196</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>
</div><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketSYN_BlacklistEntry:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structSocketSYN__BlacklistEntry__coll__graph.svg" width="243" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="afb1b74a668b1f3010740c2aa4275b161" name="afb1b74a668b1f3010740c2aa4275b161"></a>int64_t</td>
<td class="fieldname">
expires_ms</td>
<td class="fielddoc">
<p>Expiry timestamp (0 = permanent) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a66674f54cd2ca9d0d08dba940c041801" name="a66674f54cd2ca9d0d08dba940c041801"></a>char</td>
<td class="fieldname">
ip[64]</td>
<td class="fielddoc">
<p>IP address </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae5a72a5e1a87aeb9be1773c4099b9926" name="ae5a72a5e1a87aeb9be1773c4099b9926"></a>struct <a class="el" href="group__security.html#structSocketSYN__BlacklistEntry">SocketSYN_BlacklistEntry</a> *</td>
<td class="fieldname">
next</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structSocketSYNProtect__T" id="structSocketSYNProtect__T"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketSYNProtect__T">&#9670;&#160;</a></span>SocketSYNProtect_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketSYNProtect_T</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Core internal structure for the SYN protection module. </p>
<p>Opaque type exposed as <a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> in public header.</p>
<p>Aggregates configuration, tracking tables, lists, rate limiters, and atomic stats. Thread-safe via pthread mutex for modifications; atomics for concurrent stat reads.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143" title="Create a new instance of SYN protection.">SocketSYNProtect_new()</a> for creation and initialization. </dd>
<dd>
<a class="el" href="group__security.html#structSocketSYNProtect__Config" title="Configuration parameters for SYN flood protection.">SocketSYNProtect_Config</a> for tunable parameters. </dd>
<dd>
<a class="el" href="group__security.html#structSocketSYNProtect__Stats" title="Statistics snapshot for SYN protection activity.">SocketSYNProtect_Stats</a> for observable metrics. </dd>
<dd>
<a class="el" href="group__utilities.html#structSocketRateLimit__T" title="Internal structure implementing the token bucket rate limiter.">SocketRateLimit_T</a> for global rate limiting integration. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Conditional - mutex guards most fields; stats readable</dt><dd>lock-free. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00224">224</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>
</div><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketSYNProtect_T:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structSocketSYNProtect__T__coll__graph.svg" width="100%" height="584"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a1b4608934e33c166847aadb6b3b300ff" name="a1b4608934e33c166847aadb6b3b300ff"></a><a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a></td>
<td class="fieldname">
arena</td>
<td class="fielddoc">
<p>Arena for allocations (NULL = malloc) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a76e029e48debf27beb8eb46839812460" name="a76e029e48debf27beb8eb46839812460"></a>size_t</td>
<td class="fieldname">
blacklist_count</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a9a7f15f3a9242acca61b40feaa735d9e" name="a9a7f15f3a9242acca61b40feaa735d9e"></a><a class="el" href="group__security.html#structSocketSYN__BlacklistEntry">SocketSYN_BlacklistEntry</a> **</td>
<td class="fieldname">
blacklist_table</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="af88652450be6613f044b426aade9b45d" name="af88652450be6613f044b426aade9b45d"></a><a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a></td>
<td class="fieldname">
config</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a16dc128385532751d8cfc607f375c6a9" name="a16dc128385532751d8cfc607f375c6a9"></a><a class="el" href="group__utilities.html#structSocketRateLimit__T">SocketRateLimit_T</a></td>
<td class="fieldname">
global_limiter</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aca53166ea4260cce7127974828793cd4" name="aca53166ea4260cce7127974828793cd4"></a>unsigned</td>
<td class="fieldname">
hash_seed</td>
<td class="fielddoc">
<p>Random seed for hash functions (collision mitigation) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ac914f385e89bf69271a3b511b2876869" name="ac914f385e89bf69271a3b511b2876869"></a>int</td>
<td class="fieldname">
initialized</td>
<td class="fielddoc">
<p>1 if mutex initialized </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af7532535d45ad592cb063efe42c7f545" name="af7532535d45ad592cb063efe42c7f545"></a>size_t</td>
<td class="fieldname">
ip_entry_count</td>
<td class="fielddoc">
<p>Current entries </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad510a10bf5b3f26894d4d91351cc6cf8" name="ad510a10bf5b3f26894d4d91351cc6cf8"></a><a class="el" href="group__security.html#structSocketSYN__IPEntry">SocketSYN_IPEntry</a> **</td>
<td class="fieldname">
ip_table</td>
<td class="fielddoc">
<p>Hash table buckets </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad9f7e1412f8939f220a1a013f4c3c3ae" name="ad9f7e1412f8939f220a1a013f4c3c3ae"></a>size_t</td>
<td class="fieldname">
ip_table_size</td>
<td class="fielddoc">
<p>Number of buckets </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a49dca188d614c3e2a8ff64052b6149a9" name="a49dca188d614c3e2a8ff64052b6149a9"></a><a class="el" href="group__security.html#structSocketSYN__IPEntry">SocketSYN_IPEntry</a> *</td>
<td class="fieldname">
lru_head</td>
<td class="fielddoc">
<p>Most recently used </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a3d9b707a9091714a9958862c904fb8db" name="a3d9b707a9091714a9958862c904fb8db"></a><a class="el" href="group__security.html#structSocketSYN__IPEntry">SocketSYN_IPEntry</a> *</td>
<td class="fieldname">
lru_tail</td>
<td class="fielddoc">
<p>Least recently used </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad9b6ff60c42f2d8b0a55643dbaf94a29" name="ad9b6ff60c42f2d8b0a55643dbaf94a29"></a>pthread_mutex_t</td>
<td class="fieldname">
mutex</td>
<td class="fielddoc">
<p>Thread safety mutex </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2435ab1bf8f6d566cd438d1b0f45cce6" name="a2435ab1bf8f6d566cd438d1b0f45cce6"></a>int64_t</td>
<td class="fieldname">
start_time_ms</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a089be07acdf293fc014af76520d54ce4" name="a089be07acdf293fc014af76520d54ce4"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_allowed</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="add703132667908f679102beff0ec3fd6" name="add703132667908f679102beff0ec3fd6"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_attempts</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ac3e91fc6e07f92ec095d0337d5332887" name="ac3e91fc6e07f92ec095d0337d5332887"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_blacklisted</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae2a19f598a5b3163a97e148985d14590" name="ae2a19f598a5b3163a97e148985d14590"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_blocked</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a5a412ef3f6f21ffc8efa0b1d74a6df0b" name="a5a412ef3f6f21ffc8efa0b1d74a6df0b"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_challenged</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ab9beef6cc21010a2ee659e4d10c5696c" name="ab9beef6cc21010a2ee659e4d10c5696c"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_lru_evictions</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a7b30091dfcd7fc93bcd7769979b804aa" name="a7b30091dfcd7fc93bcd7769979b804aa"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_throttled</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ae7d7e3a01f2ab67327773cdd94d6224b" name="ae7d7e3a01f2ab67327773cdd94d6224b"></a>_Atomic uint64_t</td>
<td class="fieldname">
stat_whitelisted</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a1beb68e242ded87711d537eb0af833f3" name="a1beb68e242ded87711d537eb0af833f3"></a>int</td>
<td class="fieldname">
use_malloc</td>
<td class="fielddoc">
<p>1 if using malloc, 0 if arena </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a62aa5e759587de0ec3976c98dcdd2d8f" name="a62aa5e759587de0ec3976c98dcdd2d8f"></a>size_t</td>
<td class="fieldname">
whitelist_count</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="ada8dc27f63197debf3707785227a9f78" name="ada8dc27f63197debf3707785227a9f78"></a><a class="el" href="group__security.html#structSocketSYN__WhitelistEntry">SocketSYN_WhitelistEntry</a> **</td>
<td class="fieldname">
whitelist_table</td>
<td class="fielddoc">
</td></tr>
</table>

</div>
</div>
<a name="structSocketSYN__IPState" id="structSocketSYN__IPState"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketSYN__IPState">&#9670;&#160;</a></span>SocketSYN_IPState</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketSYN_IPState</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Per-IP address tracking and reputation state. </p>
<p>Opaque structure holding all metrics and state for a single tracked IP. Updated atomically for thread safety. Not for direct modification; use reporting functions to update state.</p>
<p>Fields:</p><ul>
<li>Timestamps use CLOCK_MONOTONIC for accuracy.</li>
<li>Counters are uint32_t to prevent overflow under DDoS.</li>
<li>Score is float [0.0,1.0] with decay over time.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga36629010083cc94526b37d57cc40bbce" title="Retrieve the current state and reputation metrics for a specific IP address.">SocketSYNProtect_get_ip_state()</a> to query state without modification. </dd>
<dd>
<a class="el" href="group__security.html#ga979954abc96c529d1205d432fc13c661" title="Report successful connection completion for IP reputation update.">SocketSYNProtect_report_success()</a> and report_failure() to update counters. </dd>
<dd>
<a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b" title="Perform periodic cleanup of expired and stale protection state.">SocketSYNProtect_cleanup()</a> for eviction of stale states. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect_8h_source.html#l00251">251</a> of file <a class="el" href="SocketSYNProtect_8h_source.html">SocketSYNProtect.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a6d2446089e798132b58c0333ba78cb3e" name="a6d2446089e798132b58c0333ba78cb3e"></a>uint32_t</td>
<td class="fieldname">
attempts_current</td>
<td class="fielddoc">
<p><a class="el" href="group__connection__mgmt.html#structConnection" title="Internal structure representing a pooled connection slot.">Connection</a> attempts in current sliding window. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a4cbf6f33a74f2df4daeacbff135931a8" name="a4cbf6f33a74f2df4daeacbff135931a8"></a>uint32_t</td>
<td class="fieldname">
attempts_previous</td>
<td class="fielddoc">
<p>Attempts from previous window (used for decay calculation). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae664aa07891130d5bb60edf6a1d72bf7" name="ae664aa07891130d5bb60edf6a1d72bf7"></a>int64_t</td>
<td class="fieldname">
block_until_ms</td>
<td class="fielddoc">
<p>Block expiration timestamp (0 = not blocked; CLOCK_MONOTONIC ms). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a77f8fbce111a5f7338f8cc8cb4a7bca9" name="a77f8fbce111a5f7338f8cc8cb4a7bca9"></a>uint32_t</td>
<td class="fieldname">
failures</td>
<td class="fielddoc">
<p>Cumulative failed or aborted connections. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a856b3a23c98e17f5c213a3d26a0a9590" name="a856b3a23c98e17f5c213a3d26a0a9590"></a>char</td>
<td class="fieldname">
ip[64]</td>
<td class="fielddoc">
<p>Null-terminated IP address string (IPv4/IPv6). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a7b49dd6e199c1e1e91b1eb71fc245509" name="a7b49dd6e199c1e1e91b1eb71fc245509"></a>int64_t</td>
<td class="fieldname">
last_attempt_ms</td>
<td class="fielddoc">
<p>Timestamp (ms) of most recent connection attempt. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a3f543090a343b51bdf4e7930e182366d" name="a3f543090a343b51bdf4e7930e182366d"></a><a class="el" href="group__security.html#gad7b655dd229bc52cb32ec3cc1674d423">SocketSYN_Reputation</a></td>
<td class="fieldname">
rep</td>
<td class="fielddoc">
<p>Current computed reputation level. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aaa43aaa7c28639d949e57ac1e14b2189" name="aaa43aaa7c28639d949e57ac1e14b2189"></a>float</td>
<td class="fieldname">
score</td>
<td class="fielddoc">
<p>Dynamic reputation score (0.0 = hostile, 1.0 = trusted). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="abe2bcfaef720a4a375fe1c67b92c37d6" name="abe2bcfaef720a4a375fe1c67b92c37d6"></a>uint32_t</td>
<td class="fieldname">
successes</td>
<td class="fielddoc">
<p>Cumulative successful handshakes/connections. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a346232b13c475cfaaa53eff914d4a0dd" name="a346232b13c475cfaaa53eff914d4a0dd"></a>int64_t</td>
<td class="fieldname">
window_start_ms</td>
<td class="fielddoc">
<p>Start timestamp (ms) of current rate window. </p>
</td></tr>
</table>

</div>
</div>
<a name="structSocketSYNProtect__Config" id="structSocketSYNProtect__Config"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketSYNProtect__Config">&#9670;&#160;</a></span>SocketSYNProtect_Config</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketSYNProtect_Config</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Configuration parameters for SYN flood protection. </p>
<p>Defines behavior for rate limiting, reputation scoring, response actions, and resource constraints. Use <a class="el" href="group__security.html#gade1b436117d4a0854881ac52ce43f115" title="Initialize configuration structure with safe defaults.">SocketSYNProtect_config_defaults()</a> to initialize. Timing values in ms (except challenge_defer_sec in seconds). Scores in [0.0f, 1.0f].</p>
<dl class="section warning"><dt>Warning</dt><dd>Invalid configs (e.g., zero/negative durations, scores out of range) may lead to undefined behavior or SocketSYNProtect_Failed exceptions.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gade1b436117d4a0854881ac52ce43f115" title="Initialize configuration structure with safe defaults.">SocketSYNProtect_config_defaults()</a> for safe initialization. </dd>
<dd>
<a class="el" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143" title="Create a new instance of SYN protection.">SocketSYNProtect_new()</a> consumes this config. </dd>
<dd>
<a class="el" href="group__security.html#ga59e979862677789482cb5f297f544001" title="Update protection configuration during runtime.">SocketSYNProtect_configure()</a> for dynamic reconfiguration. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect_8h_source.html#l00291">291</a> of file <a class="el" href="SocketSYNProtect_8h_source.html">SocketSYNProtect.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a58785babfc923ba70d9c8f0d5b7a44cf" name="a58785babfc923ba70d9c8f0d5b7a44cf"></a>int</td>
<td class="fieldname">
block_duration_ms</td>
<td class="fielddoc">
<p>Duration of automatic blocks. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a732b2bfe41c8d449ea5be9401f818eb3" name="a732b2bfe41c8d449ea5be9401f818eb3"></a>int</td>
<td class="fieldname">
challenge_defer_sec</td>
<td class="fielddoc">
<p>TCP_DEFER_ACCEPT timeout in seconds. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae8aea9e4cc570341d5cc8901f3cb814e" name="ae8aea9e4cc570341d5cc8901f3cb814e"></a>unsigned</td>
<td class="fieldname">
hash_seed</td>
<td class="fielddoc">
<p>Hash randomization seed (0 = auto-generate crypto random for collision resistance; affects synprotect_hash_ip). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5f9976be0331359859284315ebf66e1a" name="a5f9976be0331359859284315ebf66e1a"></a>int</td>
<td class="fieldname">
max_attempts_per_window</td>
<td class="fielddoc">
<p>Per-IP attempt limit per window. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a7429afc5fc724582c34ce06cb3d3f5fa" name="a7429afc5fc724582c34ce06cb3d3f5fa"></a>size_t</td>
<td class="fieldname">
max_blacklist</td>
<td class="fielddoc">
<p>Maximum blacklist entries. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a575daabf11edf0ee687ff8a547240c77" name="a575daabf11edf0ee687ff8a547240c77"></a>int</td>
<td class="fieldname">
max_global_per_second</td>
<td class="fielddoc">
<p>Global rate limit (all IPs). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2a865bdf6cf3990a6d2e100c96164d80" name="a2a865bdf6cf3990a6d2e100c96164d80"></a>size_t</td>
<td class="fieldname">
max_tracked_ips</td>
<td class="fielddoc">
<p>Maximum IPs to track (LRU eviction). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a0acad8adbb06f59ee96249bb1f5a417b" name="a0acad8adbb06f59ee96249bb1f5a417b"></a>size_t</td>
<td class="fieldname">
max_whitelist</td>
<td class="fielddoc">
<p>Maximum whitelist entries. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a906abceb1945a950293d0c050f6c376b" name="a906abceb1945a950293d0c050f6c376b"></a>float</td>
<td class="fieldname">
min_success_ratio</td>
<td class="fielddoc">
<p>Min success/attempt ratio before suspect. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab9ce44543382518e5ed2a7471dd67413" name="ab9ce44543382518e5ed2a7471dd67413"></a>float</td>
<td class="fieldname">
score_block</td>
<td class="fielddoc">
<p>Score below this triggers BLOCK. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5e02553a2f9e15f3d1c9f79d82529388" name="a5e02553a2f9e15f3d1c9f79d82529388"></a>float</td>
<td class="fieldname">
score_challenge</td>
<td class="fielddoc">
<p>Score below this triggers CHALLENGE. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad86ba3309adf0a1b6ee5ef26f7031281" name="ad86ba3309adf0a1b6ee5ef26f7031281"></a>float</td>
<td class="fieldname">
score_decay_per_sec</td>
<td class="fielddoc">
<p>Score recovery rate per second. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af65955bb61462c59140d05b5dabb1a94" name="af65955bb61462c59140d05b5dabb1a94"></a>float</td>
<td class="fieldname">
score_penalty_attempt</td>
<td class="fielddoc">
<p>Score penalty per new attempt. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae55192b1a0a6bf438bf424cd87f9572a" name="ae55192b1a0a6bf438bf424cd87f9572a"></a>float</td>
<td class="fieldname">
score_penalty_failure</td>
<td class="fielddoc">
<p>Score penalty per failure. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad6ecd5f04a5c197c4a740ee02611fdae" name="ad6ecd5f04a5c197c4a740ee02611fdae"></a>float</td>
<td class="fieldname">
score_reward_success</td>
<td class="fielddoc">
<p>Score reward per successful connection. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a1d688c73198839dedc956d3b8912f66d" name="a1d688c73198839dedc956d3b8912f66d"></a>float</td>
<td class="fieldname">
score_throttle</td>
<td class="fielddoc">
<p>Score below this triggers THROTTLE. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af8dd3acb9ac939027f76995bac4b2cf5" name="af8dd3acb9ac939027f76995bac4b2cf5"></a>int</td>
<td class="fieldname">
throttle_delay_ms</td>
<td class="fielddoc">
<p>Artificial delay for THROTTLE action. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a73ebdc5d7fdeb3217b8c0dfc99347bbb" name="a73ebdc5d7fdeb3217b8c0dfc99347bbb"></a>int</td>
<td class="fieldname">
window_duration_ms</td>
<td class="fielddoc">
<p>Sliding window size (default: 10000ms). </p>
</td></tr>
</table>

</div>
</div>
<a name="structSocketSYNProtect__Stats" id="structSocketSYNProtect__Stats"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketSYNProtect__Stats">&#9670;&#160;</a></span>SocketSYNProtect_Stats</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketSYNProtect_Stats</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Statistics snapshot for SYN protection activity. </p>
<p>Thread-safe atomic snapshot of counters and metrics. Does not include per-IP details or whitelist/blacklist contents for privacy.</p>
<dl class="section note"><dt>Note</dt><dd>Counters wrap around at UINT64_MAX; suitable for 100+ years of activity. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a" title="Retrieve aggregate statistics snapshot for the SYN protection module.">SocketSYNProtect_stats()</a> to populate this structure. </dd>
<dd>
<a class="el" href="group__security.html#ga59f2d1168a808c2c2d0584b031d96422" title="Reset all resettable statistics counters to zero.">SocketSYNProtect_stats_reset()</a> to zero counters (except uptime). </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect_8h_source.html#l00343">343</a> of file <a class="el" href="SocketSYNProtect_8h_source.html">SocketSYNProtect.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a62d7ed28eb018dac7c46b19f7447a420" name="a62d7ed28eb018dac7c46b19f7447a420"></a>uint64_t</td>
<td class="fieldname">
current_blocked_ips</td>
<td class="fielddoc">
<p>Currently blocked IPs. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5c6dc902b20931d955219b937f8ed2d6" name="a5c6dc902b20931d955219b937f8ed2d6"></a>uint64_t</td>
<td class="fieldname">
current_tracked_ips</td>
<td class="fielddoc">
<p>Currently tracked unique IPs. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a0e134430eac30ed54777c52221adec76" name="a0e134430eac30ed54777c52221adec76"></a>uint64_t</td>
<td class="fieldname">
lru_evictions</td>
<td class="fielddoc">
<p>Number of LRU evictions. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a158331134454296a07e713e4efe46ae1" name="a158331134454296a07e713e4efe46ae1"></a>uint64_t</td>
<td class="fieldname">
total_allowed</td>
<td class="fielddoc">
<p>Attempts allowed (SYN_ACTION_ALLOW). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a6e80ed205ec9330c6291d010863f810b" name="a6e80ed205ec9330c6291d010863f810b"></a>uint64_t</td>
<td class="fieldname">
total_attempts</td>
<td class="fielddoc">
<p>Total connection attempts checked. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a614ae093175b9319c4523296d16569d8" name="a614ae093175b9319c4523296d16569d8"></a>uint64_t</td>
<td class="fieldname">
total_blacklisted</td>
<td class="fielddoc">
<p>Attempts from blacklisted IPs. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a7c029f370305000dd71a42aaa52c393a" name="a7c029f370305000dd71a42aaa52c393a"></a>uint64_t</td>
<td class="fieldname">
total_blocked</td>
<td class="fielddoc">
<p>Attempts blocked. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a03ba7e002b3ac41d8aa5e9042cd99211" name="a03ba7e002b3ac41d8aa5e9042cd99211"></a>uint64_t</td>
<td class="fieldname">
total_challenged</td>
<td class="fielddoc">
<p>Attempts challenged (TCP_DEFER_ACCEPT). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a109c6d0a07655ac0ab5a48b5ba09c5ae" name="a109c6d0a07655ac0ab5a48b5ba09c5ae"></a>uint64_t</td>
<td class="fieldname">
total_throttled</td>
<td class="fielddoc">
<p>Attempts throttled. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5a571ad87a6efbfaa2c7521f8589fa80" name="a5a571ad87a6efbfaa2c7521f8589fa80"></a>uint64_t</td>
<td class="fieldname">
total_whitelisted</td>
<td class="fielddoc">
<p>Attempts from whitelisted IPs. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="addc5d09c4b26fa03979894a037830a03" name="addc5d09c4b26fa03979894a037830a03"></a>int64_t</td>
<td class="fieldname">
uptime_ms</td>
<td class="fielddoc">
<p>Time since initialization. </p>
</td></tr>
</table>

</div>
</div>
<a name="structDTLSContextCookie" id="structDTLSContextCookie"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structDTLSContextCookie">&#9670;&#160;</a></span>DTLSContextCookie</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct DTLSContextCookie</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Cookie state structure for server-side DTLS cookie exchange. </p>
<p>Manages HMAC secrets for generating and verifying stateless cookies during DTLS handshake to prevent DoS attacks (RFC 6347 Section 4.2.1). Supports secret rotation for replay protection and forward secrecy.</p>
<dl class="section user"><dt>Thread Safety\n Conditional - mutex protects secret updates; read access</dt><dd>thread-safe.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gae37473787004b0ea65d2ee0b51702f44" title="OpenSSL callback for generating DTLS anti-DoS cookies during server handshake.">dtls_cookie_generate_cb()</a> </dd>
<dd>
<a class="el" href="SocketDTLS-private_8h.html#aa177905ba40634829622c877b4f79976">dtls_cookie_verify_cb()</a> </dd>
<dd>
<a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> </dd>
<dd>
RFC 6347 for cookie exchange protocol. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00943">943</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a293318fc59356e9559991efa47f13551" name="a293318fc59356e9559991efa47f13551"></a>int</td>
<td class="fieldname">
cookie_enabled</td>
<td class="fielddoc">
<p>Cookie exchange enabled </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a632741e64f880149483b9ee56a2c002e" name="a632741e64f880149483b9ee56a2c002e"></a>unsigned char</td>
<td class="fieldname">
prev_secret[32]</td>
<td class="fielddoc">
<p>Previous secret for rotation </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a8e4a731394e6c978602ce6beb82cd3d6" name="a8e4a731394e6c978602ce6beb82cd3d6"></a>unsigned char</td>
<td class="fieldname">
secret[32]</td>
<td class="fielddoc">
<p>HMAC secret </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a672c4a1750d5ae80e58ba212134fe18e" name="a672c4a1750d5ae80e58ba212134fe18e"></a>pthread_mutex_t</td>
<td class="fieldname">
secret_mutex</td>
<td class="fielddoc">
<p>Protects secret rotation </p>
</td></tr>
</table>

</div>
</div>
<a name="structDTLSContextALPN" id="structDTLSContextALPN"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structDTLSContextALPN">&#9670;&#160;</a></span>DTLSContextALPN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct DTLSContextALPN</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>ALPN configuration structure for DTLS contexts. </p>
<p>Stores supported application protocols for negotiation during handshake (RFC 7301). Enables protocol selection for HTTP/2 over DTLS or other services.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga090ce55e808027fc886ea6e6232b5a01" title="Advertise ALPN protocols.">SocketDTLSContext_set_alpn_protos()</a> </dd>
<dd>
SSL_get0_alpn_selected() for retrieval </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00964">964</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ac8b3b7861796653d2d0acc7145565007" name="ac8b3b7861796653d2d0acc7145565007"></a>size_t</td>
<td class="fieldname">
count</td>
<td class="fielddoc">
<p>Number of protocols </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a1f10f5b7ab00a0a909981b58481463ec" name="a1f10f5b7ab00a0a909981b58481463ec"></a>const char **</td>
<td class="fieldname">
protocols</td>
<td class="fielddoc">
<p>Array of protocol strings </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aeec6a3e420d5a80ee123aad7d2c2eb69" name="aeec6a3e420d5a80ee123aad7d2c2eb69"></a>const char *</td>
<td class="fieldname">
selected</td>
<td class="fielddoc">
<p>Negotiated protocol (set by server, read by client) </p>
</td></tr>
</table>

</div>
</div>
<a name="structSocketDTLSContext__T" id="structSocketDTLSContext__T"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketDTLSContext__T">&#9670;&#160;</a></span>SocketDTLSContext_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketDTLSContext_T</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p><a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> - DTLS Context Structure. </p>
<p>Opaque handle for a DTLS security context.</p>
<p>Opaque DTLS context type.</p>
<p>Manages OpenSSL SSL_CTX for DTLS with secure defaults, certificates, cookie exchange, and session caching. Provides DTLS 1.2+ support with cookie-based DoS protection and session resumption for performance.</p>
<p>Thread safety: Contexts are not thread-safe for modification after creation. Share read-only after full setup, or use per-thread contexts. SSL objects created from context are per-connection and thread-safe.</p>
<p>Used for configuring certificates, keys, protocol versions, ciphers, and other DTLS parameters. See <a class="el" href="SocketDTLSContext_8h.html" title="DTLS context management with cookie protection and secure defaults.">SocketDTLSContext.h</a> for creation and configuration APIs.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a" title="Create a client-side DTLS context with optional CA for server verification.">SocketDTLSContext_new_client()</a> </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> </dd>
<dd>
<a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> to associate context with a socket.</dd></dl>
<p>Encapsulates an OpenSSL SSL_CTX configured for DTLS with secure defaults, including protocol version enforcement, cipher selection, certificate management, cookie generation for DoS mitigation, ALPN protocols, and session caching.</p>
<p>Lifecycle: Create via new_server() or new_client(), configure options, load certs/CA, then associate with UDP sockets using <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a>. Dispose with free() to release resources including arena allocations.</p>
<p>Threading: Thread-safe for creation and read-only access after full setup. Avoid concurrent modifications (e.g., set_verify_mode) without external locking.</p>
<dl class="section note"><dt>Note</dt><dd>All internal allocations use an embedded Arena_T for lifecycle management. </dd>
<dd>
Exceptions raised via SocketDTLS_Failed include detailed OpenSSL error info.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> to create server contexts. </dd>
<dd>
<a class="el" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a" title="Create a client-side DTLS context with optional CA for server verification.">SocketDTLSContext_new_client()</a> to create client contexts. </dd>
<dd>
<a class="el" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983" title="Dispose of a DTLS context, freeing all associated resources.">SocketDTLSContext_free()</a> for disposal. </dd>
<dd>
<a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> to apply context to a <a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T" title="Opaque type representing a datagram socket instance.">SocketDgram_T</a>. </dd>
<dd>
<a class="el" href="group__dtls__config.html">DTLS Configuration Constants</a> for related constants and limits. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00984">984</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>
</div><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketDTLSContext_T:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structSocketDTLSContext__T__coll__graph.svg" width="315" height="124"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a7666a1fdc57f021eef79ca1acb5e86f3" name="a7666a1fdc57f021eef79ca1acb5e86f3"></a><a class="el" href="group__security.html#structDTLSContextALPN">DTLSContextALPN</a></td>
<td class="fieldname">
alpn</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a54567bce07c83927f48c6f223d436900" name="a54567bce07c83927f48c6f223d436900"></a><a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a></td>
<td class="fieldname">
arena</td>
<td class="fielddoc">
<p>Arena for allocations </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a70d502aab282236eeb7355421e143f6d" name="a70d502aab282236eeb7355421e143f6d"></a>size_t</td>
<td class="fieldname">
cache_hits</td>
<td class="fielddoc">
<p>Session resumptions </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af440852f57a772abab3d4a41cae13bdf" name="af440852f57a772abab3d4a41cae13bdf"></a>size_t</td>
<td class="fieldname">
cache_misses</td>
<td class="fielddoc">
<p>Full handshakes </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a8817aca15ed7cd7d24215a5d253de80f" name="a8817aca15ed7cd7d24215a5d253de80f"></a>size_t</td>
<td class="fieldname">
cache_stores</td>
<td class="fielddoc">
<p>New sessions stored </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a0da8a0294f4100a8d3029f8deba3eb39" name="a0da8a0294f4100a8d3029f8deba3eb39"></a><a class="el" href="group__security.html#structDTLSContextCookie">DTLSContextCookie</a></td>
<td class="fieldname">
cookie</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a3df527ad096498b7a2673b64052b4b60" name="a3df527ad096498b7a2673b64052b4b60"></a>int</td>
<td class="fieldname">
initial_timeout_ms</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a0c6f4cef4f3e724e2a65a95799bc36ca" name="a0c6f4cef4f3e724e2a65a95799bc36ca"></a>int</td>
<td class="fieldname">
is_server</td>
<td class="fielddoc">
<p>1 for server, 0 for client </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a0ae4d26c54525697140fe086e4476684" name="a0ae4d26c54525697140fe086e4476684"></a>int</td>
<td class="fieldname">
max_timeout_ms</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a2cc45fd611b0c6e8acfc78871329e150" name="a2cc45fd611b0c6e8acfc78871329e150"></a>size_t</td>
<td class="fieldname">
mtu</td>
<td class="fielddoc">
<p>Configured MTU </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a87b847cac53cbb69905ee9042b41bf83" name="a87b847cac53cbb69905ee9042b41bf83"></a>int</td>
<td class="fieldname">
session_cache_enabled</td>
<td class="fielddoc">
<p>Session cache flag </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a28f69d3395e1ba207cc9e29525a30a56" name="a28f69d3395e1ba207cc9e29525a30a56"></a>size_t</td>
<td class="fieldname">
session_cache_size</td>
<td class="fielddoc">
<p>Session cache size </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae394cee948e068dc2eb172d957c08fc5" name="ae394cee948e068dc2eb172d957c08fc5"></a>SSL_CTX *</td>
<td class="fieldname">
ssl_ctx</td>
<td class="fielddoc">
<p>OpenSSL context </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a54ca83c3ef363085dd298018cc28ca05" name="a54ca83c3ef363085dd298018cc28ca05"></a>pthread_mutex_t</td>
<td class="fieldname">
stats_mutex</td>
<td class="fielddoc">
<p>Thread-safe stats update </p>
</td></tr>
</table>

</div>
</div>
<a name="structTLSCertPin" id="structTLSCertPin"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structTLSCertPin">&#9670;&#160;</a></span>TLSCertPin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct TLSCertPin</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p><a class="el" href="group__security.html#structTLSCertPin" title="TLSCertPin - Single certificate pin entry (SPKI SHA256 hash)">TLSCertPin</a> - Single certificate pin entry (SPKI SHA256 hash) </p>
<p>Stores a 32-byte SHA256 digest of the SubjectPublicKeyInfo (SPKI) DER encoding. SPKI pinning is OWASP-recommended as it survives certificate renewal when the same key is reused. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00640">640</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="ac73cd1510abb271ef1af3140c4d70316" name="ac73cd1510abb271ef1af3140c4d70316"></a>unsigned char</td>
<td class="fieldname">
hash[32]</td>
<td class="fielddoc">
<p>SHA256 digest of the SubjectPublicKeyInfo (SPKI) DER encoding (32 bytes). OWASP-recommended for pinning as it targets key material. </p>
</td></tr>
</table>

</div>
</div>
<a name="structTLSContextPinning" id="structTLSContextPinning"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structTLSContextPinning">&#9670;&#160;</a></span>TLSContextPinning</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct TLSContextPinning</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p><a class="el" href="group__security.html#structTLSContextPinning" title="TLSContextPinning - Certificate pinning configuration.">TLSContextPinning</a> - Certificate pinning configuration. </p>
<p>Maintains an array of SPKI SHA256 hashes with constant-time lookup. Uses linear scan with <a class="el" href="group__foundation.html#gae5f9b65e71620529159130c81b6d0dba" title="Perform constant-time comparison of two buffers.">SocketCrypto_secure_compare()</a> to prevent timing attacks. For typical deployments (1-5 pins), this is effectively O(1).</p>
<p>Thread safety: Thread-safe with internal mutex protecting configuration and verification. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00661">661</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>
</div><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Collaboration diagram for TLSContextPinning:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structTLSContextPinning__coll__graph.svg" width="146" height="124"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a8c03b3c95111691bffb24b53e768f455" name="a8c03b3c95111691bffb24b53e768f455"></a>size_t</td>
<td class="fieldname">
capacity</td>
<td class="fielddoc">
<p>Allocated capacity of the pins array. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a69993ad88f84592a194fded9c496181b" name="a69993ad88f84592a194fded9c496181b"></a>size_t</td>
<td class="fieldname">
count</td>
<td class="fielddoc">
<p>Number of pins in the array. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad8b29c125126126d494fd79fffd00aac" name="ad8b29c125126126d494fd79fffd00aac"></a>int</td>
<td class="fieldname">
enforce</td>
<td class="fielddoc">
<p>1 = fail on mismatch (strict), 0 = warn only (default: 1). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="acf7678eaad52c77fb0db5ce024e073c2" name="acf7678eaad52c77fb0db5ce024e073c2"></a>pthread_mutex_t</td>
<td class="fieldname">
lock</td>
<td class="fielddoc">
<p>Mutex protecting pinning configuration and verification for thread safety. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a825da77730d3f576bae94d1143e0ab4a" name="a825da77730d3f576bae94d1143e0ab4a"></a><a class="el" href="group__security.html#structTLSCertPin">TLSCertPin</a> *</td>
<td class="fieldname">
pins</td>
<td class="fielddoc">
<p>Array of SHA256 hashes (arena-allocated). </p>
</td></tr>
</table>

</div>
</div>
<a name="structTLSContextALPN" id="structTLSContextALPN"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structTLSContextALPN">&#9670;&#160;</a></span>TLSContextALPN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct TLSContextALPN</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Configuration for ALPN protocol negotiation. </p>
<p>Manages the list of supported ALPN protocols, selection callback, and storage for the negotiated protocol string. Used during TLS handshake for protocol negotiation with peers.</p>
<p>Protocols are null-terminated strings; callback allows custom selection logic. Thread-safe via context mutex for modifications.</p>
<dl class="section see"><dt>See also</dt><dd>SocketTLSContext_set_alpn_protocols() for configuring <a class="el" href="group__security.html#ab7beacc455149d562fb32276e6fa59e9">protocols</a>. </dd>
<dd>
<a class="el" href="group__security.html#gab7c088402bdf132a710551ebe2268ed0" title="Set custom ALPN protocol selection callback.">SocketTLSContext_set_alpn_callback()</a> for custom selection. </dd>
<dd>
<a class="el" href="group__security.html#gab904e51ebbeabc985c3988fc0980776e" title="Validate file path for certificates, keys, or CAs against security threats.">tls_get_alpn_ex_idx()</a> for safe buffer management in callbacks. </dd>
<dd>
SSL_set_alpn_protos() OpenSSL ALPN interface. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00718">718</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="afb62260f9adaa9115085fc71e7e7da47" name="afb62260f9adaa9115085fc71e7e7da47"></a><a class="el" href="group__tls__context.html#gaa53566f8d54960bb2d44516a50f67c70">SocketTLSAlpnCallback</a></td>
<td class="fieldname">
callback</td>
<td class="fielddoc">
<p>Custom ALPN selection callback (if set). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a43a9b74e3e291fba62125636545d2faf" name="a43a9b74e3e291fba62125636545d2faf"></a>void *</td>
<td class="fieldname">
callback_user_data</td>
<td class="fielddoc">
<p>Opaque user data passed to the callback. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab1dcea98c46d2d5ec61117eda96c5546" name="ab1dcea98c46d2d5ec61117eda96c5546"></a>size_t</td>
<td class="fieldname">
count</td>
<td class="fielddoc">
<p>Number of protocols in the array. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab7beacc455149d562fb32276e6fa59e9" name="ab7beacc455149d562fb32276e6fa59e9"></a>const char **</td>
<td class="fieldname">
protocols</td>
<td class="fielddoc">
<p>Array of supported ALPN protocol strings (null-terminated). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2c52dab93a2d0b9149b9919ec8e9816c" name="a2c52dab93a2d0b9149b9919ec8e9816c"></a>const char *</td>
<td class="fieldname">
selected</td>
<td class="fielddoc">
<p>Negotiated protocol string (for clients; set during handshake). </p>
</td></tr>
</table>

</div>
</div>
<a name="structSocketTLSContext__T" id="structSocketTLSContext__T"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketTLSContext__T">&#9670;&#160;</a></span>SocketTLSContext_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketTLSContext_T</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates, verification, ALPN, and session caching. </p>
<p>Opaque TLS context type for managing certificates, keys, and configuration.</p>
<p>Manages OpenSSL SSL_CTX with secure defaults, certificates, verification, ALPN, and session caching.</p>
<p>Handles OpenSSL SSL_CTX lifecycle, security policies, ALPN protocols, session caching, certificate pinning, CT validation, and more. Created via dedicated functions in <a class="el" href="SocketTLSContext_8h.html" title="TLS context management with secure defaults and certificate handling.">SocketTLSContext.h</a> and passed to <a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f" title="Enable TLS on a socket using the provided context.">SocketTLS_enable()</a> to secure sockets.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketTLSContext_8h.html" title="TLS context management with secure defaults and certificate handling.">SocketTLSContext.h</a> for complete API and creation functions like <a class="el" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022" title="Create client TLS context.">SocketTLSContext_new_client()</a>. </dd>
<dd>
<a class="el" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc" title="Create server TLS context with cert/key.">SocketTLSContext_new_server()</a> for server contexts. </dd>
<dd>
<a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f" title="Enable TLS on a socket using the provided context.">SocketTLS_enable()</a> to apply context to a socket. </dd>
<dd>
<a class="el" href="group__security.html">Security Modules</a> for related protection features. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00738">738</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>
</div><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketTLSContext_T:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="structSocketTLSContext__T__coll__graph.svg" width="468" height="212"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="af52ab6236f0311bd8e2bd6726ad10a92" name="af52ab6236f0311bd8e2bd6726ad10a92"></a><a class="el" href="group__security.html#structTLSContextALPN">TLSContextALPN</a></td>
<td class="fieldname">
alpn</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a29ae409c1494d964aa05f68119007e91" name="a29ae409c1494d964aa05f68119007e91"></a><a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a></td>
<td class="fieldname">
arena</td>
<td class="fielddoc">
<p>Memory arena for internal allocations. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad2d4382d3d897eef58feeb1bc5f0b180" name="ad2d4382d3d897eef58feeb1bc5f0b180"></a>size_t</td>
<td class="fieldname">
cache_hits</td>
<td class="fielddoc">
<p>Number of session resumptions (hits). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a6442d61b3e9bfe303c10206fbfc0df34" name="a6442d61b3e9bfe303c10206fbfc0df34"></a>size_t</td>
<td class="fieldname">
cache_misses</td>
<td class="fielddoc">
<p>Number of full handshakes due to cache misses. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad4a23660c48a4a85d74a3b1459a86255" name="ad4a23660c48a4a85d74a3b1459a86255"></a>size_t</td>
<td class="fieldname">
cache_stores</td>
<td class="fielddoc">
<p>Number of new sessions stored in cache. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aee78309674162f25f5e7420359968eb0" name="aee78309674162f25f5e7420359968eb0"></a>void *</td>
<td class="fieldname">
cert_lookup_callback</td>
<td class="fielddoc">
<p>SocketTLSCertLookupCallback (cast) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a3db93c60ba3f18b6b4ba41c4c075b7d7" name="a3db93c60ba3f18b6b4ba41c4c075b7d7"></a>void *</td>
<td class="fieldname">
cert_lookup_user_data</td>
<td class="fielddoc">
<p>User data for cert lookup callback </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ac54a81729d0eedc396241958c43a8e56" name="ac54a81729d0eedc396241958c43a8e56"></a>void *</td>
<td class="fieldname">
crl_callback</td>
<td class="fielddoc">
<p>SocketTLSCrlCallback (cast to avoid circular deps) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5cad93e6ffbc0d14c310f32fbca2c05d" name="a5cad93e6ffbc0d14c310f32fbca2c05d"></a>pthread_mutex_t</td>
<td class="fieldname">
crl_mutex</td>
<td class="fielddoc">
<p>Mutex protecting CRL refresh state and load operations </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a03718a771f261e56f9616923b228382e" name="a03718a771f261e56f9616923b228382e"></a>int64_t</td>
<td class="fieldname">
crl_next_refresh_ms</td>
<td class="fielddoc">
<p>Next scheduled refresh time in monotonic milliseconds </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a48247cd534b733e8c9f91c686ea5cba9" name="a48247cd534b733e8c9f91c686ea5cba9"></a>long</td>
<td class="fieldname">
crl_refresh_interval</td>
<td class="fielddoc">
<p>Refresh interval in seconds (0 = disabled) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a4299b3ea0e2ae7b6d40ccd4b17b89a14" name="a4299b3ea0e2ae7b6d40ccd4b17b89a14"></a>char *</td>
<td class="fieldname">
crl_refresh_path</td>
<td class="fielddoc">
<p>Path to CRL file for auto-refresh (arena-allocated) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a3b52c3506ec03ff5ac345cb7d8b9d1e9" name="a3b52c3506ec03ff5ac345cb7d8b9d1e9"></a>void *</td>
<td class="fieldname">
crl_user_data</td>
<td class="fielddoc">
<p>User data for CRL callback </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab87bf9d5ed41527c676d4ac45ef91893" name="ab87bf9d5ed41527c676d4ac45ef91893"></a>int</td>
<td class="fieldname">
ct_enabled</td>
<td class="fielddoc">
<p>1 if CT verification enabled </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af31752d842e0a6837ad1090c6df19980" name="af31752d842e0a6837ad1090c6df19980"></a><a class="el" href="group__security.html#ga4d930163393a67950a5378e540c0e939">CTValidationMode</a></td>
<td class="fieldname">
ct_mode</td>
<td class="fielddoc">
<p>CT validation mode (strict/permissive) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2753d5a1d012a8d8262d18aeef68c627" name="a2753d5a1d012a8d8262d18aeef68c627"></a>int</td>
<td class="fieldname">
is_server</td>
<td class="fielddoc">
<p>1 for server context, 0 for client context. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad00eb732fc9e503af47d836a3a4e6b17" name="ad00eb732fc9e503af47d836a3a4e6b17"></a>void *</td>
<td class="fieldname">
ocsp_gen_arg</td>
<td class="fielddoc">
<p>User argument passed to OCSP gen callback. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a8d222e0141ba4b99c2c2e28c91d3dbf6" name="a8d222e0141ba4b99c2c2e28c91d3dbf6"></a><a class="el" href="group__security.html#ga1acd7a590114ffbf4307a6f5a3bab35c">SocketTLSOcspGenCallback</a></td>
<td class="fieldname">
ocsp_gen_cb</td>
<td class="fielddoc">
<p>Dynamic OCSP response generation callback for stapling. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab9ec849aa0736e2f79850fad56a2d2ec" name="ab9ec849aa0736e2f79850fad56a2d2ec"></a>size_t</td>
<td class="fieldname">
ocsp_len</td>
<td class="fielddoc">
<p>Length of static OCSP response bytes. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a630aee611e49676a8d0b298c6826c59d" name="a630aee611e49676a8d0b298c6826c59d"></a>const unsigned char *</td>
<td class="fieldname">
ocsp_response</td>
<td class="fielddoc">
<p>Static OCSP response bytes for stapling (alternative to dynamic). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ac5716fd96d7766922f004cdcaa9e79a8" name="ac5716fd96d7766922f004cdcaa9e79a8"></a>int</td>
<td class="fieldname">
ocsp_stapling_enabled</td>
<td class="fielddoc">
<p>1 if client requests OCSP stapling </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af5dd311b657be470be563a68d04a2e38" name="af5dd311b657be470be563a68d04a2e38"></a><a class="el" href="group__security.html#structTLSContextPinning">TLSContextPinning</a></td>
<td class="fieldname">
pinning</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="a761192bed8daf5851a670a690c350262" name="a761192bed8daf5851a670a690c350262"></a>int</td>
<td class="fieldname">
session_cache_enabled</td>
<td class="fielddoc">
<p>Flag to enable session caching (default: 1). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aa6cbf08466731f8e3a82bc645f21a72e" name="aa6cbf08466731f8e3a82bc645f21a72e"></a>size_t</td>
<td class="fieldname">
session_cache_size</td>
<td class="fielddoc">
<p>Maximum number of sessions in cache (default: 1024). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a55e793ca3ad0ea33d1962e591489221a" name="a55e793ca3ad0ea33d1962e591489221a"></a><a class="el" href="structTLSContextSNICerts.html">TLSContextSNICerts</a></td>
<td class="fieldname">
sni_certs</td>
<td class="fielddoc">
</td></tr>
<tr><td class="fieldtype">
<a id="aa9294b0f0d755e7c611f4f458f884728" name="aa9294b0f0d755e7c611f4f458f884728"></a>SSL_CTX *</td>
<td class="fieldname">
ssl_ctx</td>
<td class="fielddoc">
<p>OpenSSL SSL_CTX object for TLS sessions. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5845dd9c28585431974bac36f1ec1d44" name="a5845dd9c28585431974bac36f1ec1d44"></a>pthread_mutex_t</td>
<td class="fieldname">
stats_mutex</td>
<td class="fielddoc">
<p>Mutex for thread-safe updates to cache statistics. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a61a0547f1de30e8a50bc9b478468cb18" name="a61a0547f1de30e8a50bc9b478468cb18"></a>unsigned char</td>
<td class="fieldname">
ticket_key[80]</td>
<td class="fielddoc">
<p>Session ticket encryption key (48 bytes). Used for stateless session resumption. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aca53a2feefacc328d6150b8c27a90236" name="aca53a2feefacc328d6150b8c27a90236"></a>int</td>
<td class="fieldname">
tickets_enabled</td>
<td class="fielddoc">
<p>1 if session tickets are enabled (servers by default). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a25474bff72a49776442a0b056b67f2f0" name="a25474bff72a49776442a0b056b67f2f0"></a><a class="el" href="group__security.html#gac9a12208531822c8304c23dcbcb8ba97">SocketTLSVerifyCallback</a></td>
<td class="fieldname">
verify_callback</td>
<td class="fielddoc">
<p>Custom X509 verify callback for peer certificate validation. </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a6628d4a97ceac6950f283b5fb9849123" name="a6628d4a97ceac6950f283b5fb9849123"></a><a class="el" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a></td>
<td class="fieldname">
verify_mode</td>
<td class="fielddoc">
<p>Stored verification mode (e.g., TLS_VERIFY_NONE, TLS_VERIFY_PEER). </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ab4c8abe2d58954aeef2d7fc681fb2430" name="ab4c8abe2d58954aeef2d7fc681fb2430"></a>void *</td>
<td class="fieldname">
verify_user_data</td>
<td class="fielddoc">
<p>Opaque user data passed to verify callback. </p>
</td></tr>
</table>

</div>
</div>
<a name="structSocketTLSConfig__T" id="structSocketTLSConfig__T"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketTLSConfig__T">&#9670;&#160;</a></span>SocketTLSConfig_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketTLSConfig_T</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>TLS configuration parameters for customizing TLS protocol versions and other settings. </p>
<p>This structure allows fine-grained control over TLS behavior, starting with protocol version limits. Additional fields for cipher suites, timeouts, certificate policies, etc., will be added in future releases. Always initialize with <a class="el" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b" title="Initialize the TLS configuration with secure library defaults.">SocketTLS_config_defaults()</a> before use to ensure secure defaults.</p>
<p>Fields are set to secure defaults by <a class="el" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b" title="Initialize the TLS configuration with secure library defaults.">SocketTLS_config_defaults()</a>, but can be overridden for custom policies. Use with <a class="el" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234" title="Create client TLS context with custom config.">SocketTLSContext_new()</a> for applying to new contexts.</p>
<dl class="section user"><dt>Thread Safety\n Yes - plain value struct; safe to read, copy, or assign between</dt><dd>threads.</dd></dl>
<h2><a class="anchor" id="autotoc_md568"></a>
Fields</h2>
<p>| Field | Type | Description | Default | |----------&mdash;|---&mdash;|-----------------------------------------------&mdash;|-------------------------------&mdash;| | min_version | int | Minimum supported TLS protocol version (OpenSSL constant like TLS1_3_VERSION) | SOCKET_TLS_MIN_VERSION | | max_version | int | Maximum supported TLS protocol version | SOCKET_TLS_MAX_VERSION |</p>
<h2><a class="anchor" id="autotoc_md569"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Secure defaults (recommended)</span></div>
<div class="line"><a class="code hl_struct" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a> config;</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b">SocketTLS_config_defaults</a>(&amp;config);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Optional customization (use cautiously)</span></div>
<div class="line"><span class="comment">// config.min_version = TLS1_2_VERSION; // Only if required for legacy</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234">SocketTLSContext_new</a>(&amp;config);</div>
<div class="line"><span class="comment">// ... use ctx to secure sockets ...</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gaea7ca3e656e9b58706fafc3232147203">SocketTLSContext_free</a>(&amp;ctx);</div>
<div class="ttc" id="agroup__security_html_ga122ad62f86b4477f7be54d55b769d58b"><div class="ttname"><a href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b">SocketTLS_config_defaults</a></div><div class="ttdeci">void SocketTLS_config_defaults(SocketTLSConfig_T *config)</div><div class="ttdoc">Initialize the TLS configuration with secure library defaults.</div></div>
<div class="ttc" id="agroup__security_html_ga69b7880fa99df9a39b4db5259a9e1234"><div class="ttname"><a href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234">SocketTLSContext_new</a></div><div class="ttdeci">SocketTLSContext_T SocketTLSContext_new(const SocketTLSConfig_T *config)</div><div class="ttdoc">Create client TLS context with custom config.</div></div>
<div class="ttc" id="agroup__security_html_gaea7ca3e656e9b58706fafc3232147203"><div class="ttname"><a href="group__security.html#gaea7ca3e656e9b58706fafc3232147203">SocketTLSContext_free</a></div><div class="ttdeci">void SocketTLSContext_free(SocketTLSContext_T *ctx_p)</div><div class="ttdoc">Dispose of TLS context and resources.</div></div>
<div class="ttc" id="agroup__security_html_structSocketTLSContext__T"><div class="ttname"><a href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a></div><div class="ttdoc">TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS-private_8h_source.html#l00738">SocketTLS-private.h:739</a></div></div>
<div class="ttc" id="agroup__tls__config_html_structSocketTLSConfig__T"><div class="ttname"><a href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a></div><div class="ttdoc">TLS configuration parameters for customizing TLS protocol versions and other settings.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLSConfig_8h_source.html#l00168">SocketTLSConfig.h:169</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Current API focuses on protocol versions; expansions planned for ciphers, timeouts, etc. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Lowering version limits exposes to known vulnerabilities; maintain TLS1.3 where possible. </dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - simple struct assignment</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b" title="Initialize the TLS configuration with secure library defaults.">SocketTLS_config_defaults()</a> for setting secure defaults. </dd>
<dd>
<a class="el" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234" title="Create client TLS context with custom config.">SocketTLSContext_new()</a> for context creation with this config. </dd>
<dd>
<a class="el" href="group__tls__config.html">TLS Configuration Constants</a> for constants used in defaults and overrides. </dd>
<dd>
<a class="el" href="group__security.html">Security Modules</a> for comprehensive TLS <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> features. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLSConfig_8h_source.html#l00168">168</a> of file <a class="el" href="SocketTLSConfig_8h_source.html">SocketTLSConfig.h</a>.</p>
</div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a5d3105c29493e11690b519dce33267a1" name="a5d3105c29493e11690b519dce33267a1"></a>int</td>
<td class="fieldname">
max_version</td>
<td class="fielddoc">
<p>Maximum supported TLS protocol version (e.g., TLS1_3_VERSION). Default value set by <a class="el" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b" title="Initialize the TLS configuration with secure library defaults.">SocketTLS_config_defaults()</a> to SOCKET_TLS_MAX_VERSION (TLS1_3_VERSION). </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__tls__config.html#ga1bb6850b2066656bb9ca5be7bc4e7a26" title="Maximum TLS protocol version - STRICT TLS 1.3 ONLY.">SOCKET_TLS_MAX_VERSION</a> </dd></dl>
</td></tr>
<tr><td class="fieldtype">
<a id="a670bdce01faa6f2ff73dc3ce67b14db5" name="a670bdce01faa6f2ff73dc3ce67b14db5"></a>int</td>
<td class="fieldname">
min_version</td>
<td class="fielddoc">
<p>Minimum supported TLS protocol version (e.g., TLS1_3_VERSION). Default value set by <a class="el" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b" title="Initialize the TLS configuration with secure library defaults.">SocketTLS_config_defaults()</a> to SOCKET_TLS_MIN_VERSION (TLS1_3_VERSION). </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__tls__config.html#ga3d1a24e799511be7b94d7cb83e30c826" title="Minimum TLS protocol version - STRICT TLS 1.3 ONLY.">SOCKET_TLS_MIN_VERSION</a> </dd></dl>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gaa514b917b04e794f8081ad2b4c4a3418" name="gaa514b917b04e794f8081ad2b4c4a3418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa514b917b04e794f8081ad2b4c4a3418">&#9670;&#160;</a></span>CRL_LOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_LOCK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ctx</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span>                                                                          \</div>
<div class="line">    {                                                                         \</div>
<div class="line">      <span class="keywordtype">int</span> err = pthread_mutex_lock (&amp;(ctx)-&gt;crl_mutex);                       \</div>
<div class="line">      if (err != 0)                                                           \</div>
<div class="line">        {                                                                     \</div>
<div class="line">          SOCKET_LOG_ERROR_MSG (<span class="stringliteral">&quot;CRL mutex lock failed: %d&quot;</span>, err);            \</div>
<div class="line">          RAISE_CTX_ERROR_MSG (<a class="code hl_variable" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a>, <span class="stringliteral">&quot;CRL mutex lock failed: %d&quot;</span>, \</div>
<div class="line">                               err);                                          \</div>
<div class="line">        }                                                                     \</div>
<div class="line">    }                                                                         \</div>
<div class="line">  while (0)</div>
<div class="ttc" id="agroup__security_html_gabc011202dd4f2e080b6ea8eb0f24287e"><div class="ttname"><a href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a></div><div class="ttdeci">const Except_T SocketTLS_Failed</div><div class="ttdoc">General TLS operation failure.</div></div>
</div><!-- fragment -->
<p>Acquire lock on TLS context's CRL mutex. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td><a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> instance.</td></tr>
  </table>
  </dd>
</dl>
<p>Thread-safe macro to lock the CRL refresh mutex. Logs error and raises SocketTLS_Failed if pthread_mutex_lock fails (e.g., deadlock or invalid mutex). Ensures exclusive access to CRL auto-refresh state and operations.</p>
<dl class="section warning"><dt>Warning</dt><dd>Not recursive; avoid calling from within locked sections. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga53ced6e38182130231a1ce309700ded4" title="Release lock on TLS context&#39;s CRL mutex.">CRL_UNLOCK(ctx)</a> to release the lock. </dd>
<dd>
pthread_mutex_lock() for POSIX mutex semantics. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - standard mutex locking.</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00824">824</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga53ced6e38182130231a1ce309700ded4" name="ga53ced6e38182130231a1ce309700ded4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga53ced6e38182130231a1ce309700ded4">&#9670;&#160;</a></span>CRL_UNLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRL_UNLOCK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ctx</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span>                                                                          \</div>
<div class="line">    {                                                                         \</div>
<div class="line">      <span class="keywordtype">int</span> err = pthread_mutex_unlock (&amp;(ctx)-&gt;crl_mutex);                     \</div>
<div class="line">      if (err != 0)                                                           \</div>
<div class="line">        {                                                                     \</div>
<div class="line">          SOCKET_LOG_ERROR_MSG (<span class="stringliteral">&quot;CRL mutex unlock failed: %d&quot;</span>, err);          \</div>
<div class="line">          RAISE_CTX_ERROR_MSG (<a class="code hl_variable" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a>,                              \</div>
<div class="line">                               <span class="stringliteral">&quot;CRL mutex unlock failed: %d&quot;</span>, err);           \</div>
<div class="line">        }                                                                     \</div>
<div class="line">    }                                                                         \</div>
<div class="line">  while (0)</div>
</div><!-- fragment -->
<p>Release lock on TLS context's CRL mutex. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td><a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> instance.</td></tr>
  </table>
  </dd>
</dl>
<p>Thread-safe macro to unlock the CRL refresh mutex. Logs error and raises SocketTLS_Failed if pthread_mutex_unlock fails (e.g., not locked by caller). Balances CRL_LOCK for exclusive access control.</p>
<dl class="section warning"><dt>Warning</dt><dd>Undefined behavior if mutex not locked by calling thread. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaa514b917b04e794f8081ad2b4c4a3418" title="Acquire lock on TLS context&#39;s CRL mutex.">CRL_LOCK(ctx)</a> to acquire the lock. </dd>
<dd>
pthread_mutex_unlock() for POSIX mutex release. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - standard mutex unlocking.</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00851">851</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga4e97bd0cd12ea34b564755e1a377d02f" name="ga4e97bd0cd12ea34b564755e1a377d02f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e97bd0cd12ea34b564755e1a377d02f">&#9670;&#160;</a></span>DTLS_ERROR_FMT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTLS_ERROR_FMT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#adf114e63024eabf6e40f1ed7f89c79b8">SOCKET_ERROR_FMT</a> (fmt, ##__VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Format error message with printf-style arguments into thread-local buffer. </p>
<p>Advanced formatting macro for DTLS errors, wrapping <a class="el" href="SocketUtil_8h.html#adf114e63024eabf6e40f1ed7f89c79b8" title="SOCKET_ERROR_FMT - Format error message with errno information.">SOCKET_ERROR_FMT()</a> to populate socket_error_buf with formatted message + optional errno details. Supports full printf specifiers (s, d, zu, etc.) for dynamic error reporting, e.g., including numeric codes, paths, or counts. Automatically appends system error description if errno is set post-system calls.</p>
<p>Use when static strings insufficient; provides flexibility for parameterized diagnostics while maintaining thread-safety and integration with exception raising.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fmt</td><td>printf-style format string (compile-time literal recommended) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">...</td><td>Variable arguments corresponding to format specifiers</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Expands to snprintf-like formatting into fixed-size buffer.</li>
<li>Includes errno suffix if non-zero (e.g., ": No such file (ENOENT)").</li>
<li>Truncates if output &gt; SOCKET_DTLS_ERROR_BUFSIZE; prefer concise formats.</li>
<li>For OpenSSL errors, prefer <a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51" title="Format and log the current OpenSSL error queue into thread-local error buffer.">dtls_format_openssl_error()</a> instead.</li>
<li>Safe with NULL pointers in s (prints "(null)"); validate args to avoid crashes.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - Thread-local buffer; formatting reentrant.</dt><dd></dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// Dynamic path errors</span></div>
<div class="line"><span class="keywordtype">size_t</span> len = strlen(provided_path);</div>
<div class="line"><span class="keywordflow">if</span> (len &gt; <a class="code hl_define" href="group__dtls__config.html#ga8c4f3d639af33633c811568f89124e6d">SOCKET_DTLS_MAX_PATH_LEN</a>) {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f">DTLS_ERROR_FMT</a>(<span class="stringliteral">&quot;Path too long: %zu bytes exceeds %d limit&quot;</span>, len,</div>
<div class="line">                   <a class="code hl_define" href="group__dtls__config.html#ga8c4f3d639af33633c811568f89124e6d">SOCKET_DTLS_MAX_PATH_LEN</a>);</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a>(SocketDTLSConfig_InvalidPath);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// System call failure</span></div>
<div class="line"><span class="keywordflow">if</span> (stat(file_path, &amp;st) &lt; 0) {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f">DTLS_ERROR_FMT</a>(<span class="stringliteral">&quot;stat() failed for %s: errno=%d&quot;</span>, file_path, errno);</div>
<div class="line">    <span class="comment">// Buffer: &quot;stat() failed for cert.pem: errno=2: No such file or</span></div>
<div class="line">directory<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">}</span></div>
<div class="ttc" id="agroup__dtls__config_html_ga8c4f3d639af33633c811568f89124e6d"><div class="ttname"><a href="group__dtls__config.html#ga8c4f3d639af33633c811568f89124e6d">SOCKET_DTLS_MAX_PATH_LEN</a></div><div class="ttdeci">#define SOCKET_DTLS_MAX_PATH_LEN</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLSConfig_8h_source.html#l00333">SocketDTLSConfig.h:333</a></div></div>
<div class="ttc" id="agroup__security_html_ga1cfa464ec20b460ebee063b82b6100bf"><div class="ttname"><a href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a></div><div class="ttdeci">#define RAISE_DTLS_ERROR(exception)</div><div class="ttdoc">Raise a SocketDTLS module exception with automatically populated error details.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00126">SocketDTLS-private.h:126</a></div></div>
<div class="ttc" id="agroup__security_html_ga4e97bd0cd12ea34b564755e1a377d02f"><div class="ttname"><a href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f">DTLS_ERROR_FMT</a></div><div class="ttdeci">#define DTLS_ERROR_FMT(fmt,...)</div><div class="ttdoc">Format error message with printf-style arguments into thread-local buffer.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00394">SocketDTLS-private.h:394</a></div></div>
</div><!-- fragment --><p>Specifier Support</p>
<p>Standard printf specifiers supported via vsnprintf():</p><ul>
<li>s: strings (handles NULL)</li>
<li>d/i: signed ints</li>
<li>u/zu: unsigned/size_t</li>
<li>x/X: hex</li>
<li>%%: literal %</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Format string vulnerabilities: Use trusted sources; untrusted input to fmt enables crashes/exploits.</li>
<li>Buffer overflow truncation silent; check strlen(Socket_GetLastError()) if critical.</li>
<li>Performance: Avoid in hot paths; formatting slower than static <a class="el" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded" title="Format a simple static error message into the thread-local error buffer.">DTLS_ERROR_MSG()</a>.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) - Formatting time proportional to output length.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded" title="Format a simple static error message into the thread-local error buffer.">DTLS_ERROR_MSG()</a> for static string variant (faster, no args) </dd>
<dd>
<a class="el" href="SocketUtil_8h.html#adf114e63024eabf6e40f1ed7f89c79b8" title="SOCKET_ERROR_FMT - Format error message with errno information.">SOCKET_ERROR_FMT()</a> base macro in <a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> </dd>
<dd>
<a class="el" href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944" title="Raise a SocketDTLS exception with formatted error message and arguments.">RAISE_DTLS_ERROR_MSG()</a> for format + raise in one step </dd>
<dd>
docs/ERROR_HANDLING.md#formatted-errors guidelines </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00394">394</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="gacca68f6e3be556e42dcd9ab54da96ded" name="gacca68f6e3be556e42dcd9ab54da96ded"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacca68f6e3be556e42dcd9ab54da96ded">&#9670;&#160;</a></span>DTLS_ERROR_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTLS_ERROR_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">msg</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (msg)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Format a simple static error message into the thread-local error buffer. </p>
<p>Thin wrapper over <a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb" title="SOCKET_ERROR_MSG - Format error message without errno.">SOCKET_ERROR_MSG()</a> for DTLS module consistency. Populates the per-thread socket_error_buf with the given message string, optionally appending strerror(errno) details if errno indicates a system error. Used before raising exceptions or logging to provide context without printf overhead.</p>
<p>Does not raise exceptions or perform I/O; purely for buffer preparation. Message should be compile-time literal for security and performance.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Compile-time constant string literal describing the error</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Automatically includes errno info if set (e.g., after failed open/read).</li>
<li>Thread-local buffer; concurrent threads unaffected.</li>
<li>Buffer size limited to SOCKET_DTLS_ERROR_BUFSIZE; long messages truncate.</li>
<li>Follow with <a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf" title="Raise a SocketDTLS module exception with automatically populated error details.">RAISE_DTLS_ERROR()</a> to attach to exception or logging macros.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - Thread-local buffer, no shared state.</dt><dd></dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (some_condition_fails) {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded">DTLS_ERROR_MSG</a>(<span class="stringliteral">&quot;DTLS configuration missing required field&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a>(SocketDTLSConfig_Failed);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With system error</span></div>
<div class="line"><span class="keywordflow">if</span> (bind(fd, addr, addrlen) &lt; 0) {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded">DTLS_ERROR_MSG</a>(<span class="stringliteral">&quot;Failed to bind DTLS socket&quot;</span>);</div>
<div class="line">    <span class="comment">// Buffer now contains &quot;Failed to bind DTLS socket: &lt;strerror(errno)&gt;&quot;</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_gacca68f6e3be556e42dcd9ab54da96ded"><div class="ttname"><a href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded">DTLS_ERROR_MSG</a></div><div class="ttdeci">#define DTLS_ERROR_MSG(msg)</div><div class="ttdoc">Format a simple static error message into the thread-local error buffer.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00321">SocketDTLS-private.h:321</a></div></div>
</div><!-- fragment --><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f" title="Format error message with printf-style arguments into thread-local buffer.">DTLS_ERROR_FMT()</a> for formatted messages with arguments </dd>
<dd>
<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb" title="SOCKET_ERROR_MSG - Format error message without errno.">SOCKET_ERROR_MSG()</a> underlying implementation </dd>
<dd>
<a class="el" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db" title="Socket_GetLastError - Retrieve the most recent formatted error message.">Socket_GetLastError()</a> to retrieve formatted buffer </dd>
<dd>
docs/ERROR_HANDLING.md for formatting best practices</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - String copy and potential strerror() call (bounded).</dt><dd></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Avoid format strings here; use <a class="el" href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f" title="Format error message with printf-style arguments into thread-local buffer.">DTLS_ERROR_FMT()</a> for s/d etc. Static strings only to prevent runtime format attacks. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00321">321</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="gad7d623f22e9e764aba13c6b053c1506f" name="gad7d623f22e9e764aba13c6b053c1506f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad7d623f22e9e764aba13c6b053c1506f">&#9670;&#160;</a></span>DTLS_UNUSED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DTLS_UNUSED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(void)(x)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Suppress unused parameter compiler warnings. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Variable or parameter marked as intentionally unused.</td></tr>
  </table>
  </dd>
</dl>
<p>Casts the parameter to void to inform the compiler that the variable is intentionally unused, suppressing -Wunused-parameter warnings. Commonly used in callback functions with fixed signatures or debug-only code paths.</p>
<dl class="section note"><dt>Note</dt><dd>Prefer removing unused parameters when possible; use this only when necessary due to API constraints. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - no side effects or shared state.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> for general utility macros. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l01113">1113</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="ga25080e819a36fcf9aede01a6e7298ea4" name="ga25080e819a36fcf9aede01a6e7298ea4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga25080e819a36fcf9aede01a6e7298ea4">&#9670;&#160;</a></span>IOV_MAX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IOV_MAX&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TLS/SSL support flag. </p>
<p>Enables TLS 1.3 (only, no legacy versions) and DTLS support using OpenSSL or LibreSSL. Includes client/server certificate management, session resumption, ALPN negotiation.</p>
<p>Set to 1 to enable TLS features, 0 to disable (default for minimal builds). Controlled by CMake -DENABLE_TLS=ON/OFF, auto-detects crypto library.</p>
<p>Security notes:</p><ul>
<li>TLS 1.3 only - no support for vulnerable protocols (SSLv*, TLS 1.0/1.1)</li>
<li>Hardened defaults: Secure ciphers, forward secrecy, no weak curves</li>
<li>Certificate validation with OCSP stapling support</li>
</ul>
<dl class="section see"><dt>See also</dt><dd>include/tls/ for TLS module headers. </dd>
<dd>
<a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f" title="Enable TLS on a socket using the provided context.">SocketTLS_enable()</a> to enable TLS on a socket. </dd>
<dd>
<a class="el" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234" title="Create client TLS context with custom config.">SocketTLSContext_new()</a> for context configuration. </dd>
<dd>
SocketDTLS_T for DTLS (UDP) support. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> for <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> hardening details.</dd></dl>
<p>Fallback definition for IOV_MAX if not provided by system headers.</p>
<p>Maximum number of I/O vectors supported for scatter/gather operations (readv/writev, sendmsg/recvmsg). This limit prevents excessive memory use in vectorized I/O operations and aligns with POSIX standards.</p>
<dl class="section see"><dt>See also</dt><dd>struct iovec (sys/uio.h) for I/O vector structure. </dd>
<dd>
<a class="el" href="group__core__io.html#gadb50371f84b2c796c4e57a34d41f180a" title="Scatter/gather send (writev wrapper).">Socket_sendv()</a>, <a class="el" href="group__core__io.html#gabb1c8e39587d4ea5e3ffe4b06dcaca0f" title="Scatter/gather receive (readv wrapper).">Socket_recvv()</a> for vectorized send/receive operations. </dd>
<dd>
<a class="el" href="SocketConfig_8h.html" title="Compile-time and runtime configuration constants, limits, and platform adaptations.">SocketConfig.h</a> for other configuration constants. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l01309">1309</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga179054cc1104e4de13a76ab914dae33b" name="ga179054cc1104e4de13a76ab914dae33b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga179054cc1104e4de13a76ab914dae33b">&#9670;&#160;</a></span>RAISE_CTX_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_CTX_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception</td><td>)</td>
          <td>&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (SocketTLSContext, exception)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raise a SocketTLSContext module exception using current error state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>Specific SocketTLSContext exception type (e.g., SocketTLSContext_Failed).</td></tr>
  </table>
  </dd>
</dl>
<p>Uses the thread-local error buffer (tls_error_buf) populated by prior error formatting macros like TLS_ERROR_MSG or tls_format_openssl_error. Creates a detailed exception copy via SOCKET_RAISE_MODULE_ERROR to avoid races in multi-threaded environments.</p>
<p>Intended for context-level operations where OpenSSL or allocation errors occur.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga1239b3e52ccbd1cbfec9b485e6f83214" title="Raise a SocketTLSContext exception with formatted message.">RAISE_CTX_ERROR_MSG()</a> for exceptions with custom formatted messages. </dd>
<dd>
SocketTLS_DetailedException for thread-local exception details. </dd>
<dd>
<a class="el" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b" title="Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.">tls_error_buf</a> for error message storage. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00888">888</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga20e5da948c90e67bb0a186f7a58416fc" name="ga20e5da948c90e67bb0a186f7a58416fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga20e5da948c90e67bb0a186f7a58416fc">&#9670;&#160;</a></span>RAISE_CTX_ERROR_FMT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_CTX_ERROR_FMT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aa7d4ca3a984cb2df9849f6b501d65cc3">SOCKET_RAISE_MSG</a> (SocketTLSContext, exception, fmt, __VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raise SocketTLSContext exception with variadic formatted message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>Specific exception type to raise. </td></tr>
    <tr><td class="paramname">fmt</td><td>printf-style format string. </td></tr>
    <tr><td class="paramname">...</td><td>Variable arguments for formatting.</td></tr>
  </table>
  </dd>
</dl>
<p>Similar to RAISE_CTX_ERROR_MSG but uses <b>VA_ARGS</b> for better handling of zero-argument cases in some compilers. Formats into tls_error_buf and raises.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLSContext</td><td>exception with formatted details. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga1239b3e52ccbd1cbfec9b485e6f83214" title="Raise a SocketTLSContext exception with formatted message.">RAISE_CTX_ERROR_MSG()</a> primary formatted exception macro. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00923">923</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga1239b3e52ccbd1cbfec9b485e6f83214" name="ga1239b3e52ccbd1cbfec9b485e6f83214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1239b3e52ccbd1cbfec9b485e6f83214">&#9670;&#160;</a></span>RAISE_CTX_ERROR_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_CTX_ERROR_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aa7d4ca3a984cb2df9849f6b501d65cc3">SOCKET_RAISE_MSG</a> (SocketTLSContext, exception, fmt, ##__VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raise a SocketTLSContext exception with formatted message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>Specific SocketTLSContext exception type. </td></tr>
    <tr><td class="paramname">fmt</td><td>printf-style format string for error message. </td></tr>
    <tr><td class="paramname">...</td><td>Arguments for format string.</td></tr>
  </table>
  </dd>
</dl>
<p>Formats the message into thread-local tls_error_buf using SOCKET_ERROR_MSG, then raises the exception with details via SOCKET_RAISE_MSG. Provides convenient error reporting for context operations.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLSContext</td><td>exception variant with formatted message. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga179054cc1104e4de13a76ab914dae33b" title="Raise a SocketTLSContext module exception using current error state.">RAISE_CTX_ERROR()</a> for using pre-formatted error buffer. </dd>
<dd>
<a class="el" href="SocketUtil_8h.html#aa7d4ca3a984cb2df9849f6b501d65cc3" title="SOCKET_RAISE_MSG - Format error message and raise exception in one step.">SOCKET_RAISE_MSG()</a> underlying macro implementation. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00906">906</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga4fae8ada292cad16870182392605c800" name="ga4fae8ada292cad16870182392605c800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fae8ada292cad16870182392605c800">&#9670;&#160;</a></span>RAISE_DTLS_CTX_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_DTLS_CTX_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span>                                                                          \</div>
<div class="line">    {                                                                         \</div>
<div class="line">      <a class="code hl_variable" href="SocketDTLS-private_8h.html#a5e90a2de709c54f02e2e53c99be7f2dd">SocketDTLSContext_DetailedException</a> = (exception);                      \</div>
<div class="line">      <a class="code hl_variable" href="SocketDTLS-private_8h.html#a5e90a2de709c54f02e2e53c99be7f2dd">SocketDTLSContext_DetailedException</a>.<a class="code hl_variable" href="group__foundation.html#a6a35b57fc58f0ba7cc0d4f939dd3f773">reason</a> = <a class="code hl_variable" href="SocketDTLS-private_8h.html#aab746d0e6a33c35bd9509aab8ac70dff">dtls_context_error_buf</a>;    \</div>
<div class="line">      RAISE (<a class="code hl_variable" href="SocketDTLS-private_8h.html#a5e90a2de709c54f02e2e53c99be7f2dd">SocketDTLSContext_DetailedException</a>);                            \</div>
<div class="line">    }                                                                         \</div>
<div class="line">  while (0)</div>
<div class="ttc" id="aSocketDTLS-private_8h_html_a5e90a2de709c54f02e2e53c99be7f2dd"><div class="ttname"><a href="SocketDTLS-private_8h.html#a5e90a2de709c54f02e2e53c99be7f2dd">SocketDTLSContext_DetailedException</a></div><div class="ttdeci">Except_T SocketDTLSContext_DetailedException</div></div>
<div class="ttc" id="aSocketDTLS-private_8h_html_aab746d0e6a33c35bd9509aab8ac70dff"><div class="ttname"><a href="SocketDTLS-private_8h.html#aab746d0e6a33c35bd9509aab8ac70dff">dtls_context_error_buf</a></div><div class="ttdeci">char dtls_context_error_buf[512]</div></div>
<div class="ttc" id="agroup__foundation_html_a6a35b57fc58f0ba7cc0d4f939dd3f773"><div class="ttname"><a href="group__foundation.html#a6a35b57fc58f0ba7cc0d4f939dd3f773">Except_T::reason</a></div><div class="ttdeci">const char * reason</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00219">Except.h:219</a></div></div>
</div><!-- fragment -->
<p>RAISE_DTLS_CTX_ERROR - Raise context exception with current error buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>Exception type to raise</td></tr>
  </table>
  </dd>
</dl>
<p>Creates thread-local copy of exception with reason from dtls_context_error_buf. Uses the detailed exception pattern to prevent race conditions when multiple threads raise the same exception type. </p>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l01060">1060</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="gac6bd008a794ad4ea28353a67d189fd7c" name="gac6bd008a794ad4ea28353a67d189fd7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac6bd008a794ad4ea28353a67d189fd7c">&#9670;&#160;</a></span>RAISE_DTLS_CTX_ERROR_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_DTLS_CTX_ERROR_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">msg&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span>                                                                          \</div>
<div class="line">    {                                                                         \</div>
<div class="line">      SOCKET_RAISE_MSG (SocketDTLSContext, exception, msg);                   \</div>
<div class="line">    }                                                                         \</div>
<div class="line">  while (0)</div>
</div><!-- fragment -->
<p>RAISE_DTLS_CTX_ERROR_MSG - Raise context exception with formatted message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>Exception type to raise </td></tr>
    <tr><td class="paramname">msg</td><td>Error message format string </td></tr>
    <tr><td class="paramname">...</td><td>Format arguments</td></tr>
  </table>
  </dd>
</dl>
<p>Raises DTLS context exception with formatted error message. Uses thread-local exception storage to prevent race conditions. </p>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l01080">1080</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="ga1cfa464ec20b460ebee063b82b6100bf" name="ga1cfa464ec20b460ebee063b82b6100bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1cfa464ec20b460ebee063b82b6100bf">&#9670;&#160;</a></span>RAISE_DTLS_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_DTLS_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception</td><td>)</td>
          <td>&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (SocketDTLS, exception)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raise a SocketDTLS module exception with automatically populated error details. </p>
<p>Specialized exception-raising macro for the DTLS module. It leverages the library's detailed exception pattern to attach a thread-local reason string (from socket_error_buf) to the exception before raising. This ensures multi-threaded safety by avoiding shared exception instances and provides rich diagnostics including OpenSSL errors when used with <a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51" title="Format and log the current OpenSSL error queue into thread-local error buffer.">dtls_format_openssl_error()</a>.</p>
<p>The macro expands to code that copies the base exception, sets its .reason field, and invokes <a class="el" href="group__foundation.html#ga45e87c4d7dee50346b15c7761b0b340a" title="Raise an exception with current file and line information.">RAISE()</a>. Requires prior population of socket_error_buf (e.g., via <a class="el" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded" title="Format a simple static error message into the thread-local error buffer.">DTLS_ERROR_MSG()</a> or <a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51" title="Format and log the current OpenSSL error queue into thread-local error buffer.">dtls_format_openssl_error()</a>) for meaningful details.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">exception</td><td>The SocketDTLS exception type to raise (e.g., SocketDTLS_Failed, SocketDTLS_HandshakeFailed). Must be a valid module exception.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Thread-local implementation prevents races; each thread gets its own exception copy.</li>
<li>socket_error_buf must be formatted before calling (use <a class="el" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded" title="Format a simple static error message into the thread-local error buffer.">DTLS_ERROR_MSG()</a> or similar).</li>
<li>If buffer empty, exception raises with empty reason (fallback to default message).</li>
<li>Defined only when SOCKET_HAS_TLS; otherwise expands harmlessly or errors at compile.</li>
<li>Part of internal error handling; public API uses higher-level exceptions via SocketDTLS_* funcs.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - Uses __thread or TLS storage for exception and buffer.</dt><dd>Safe in multi-threaded contexts without external synchronization.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// Simple failure with message</span></div>
<div class="line"><a class="code hl_define" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded">DTLS_ERROR_MSG</a>(<span class="stringliteral">&quot;Invalid certificate file: %s&quot;</span>, path);</div>
<div class="line"><a class="code hl_define" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a>(SocketDTLSConfig_InvalidCert);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// After OpenSSL failure</span></div>
<div class="line"><span class="keywordflow">if</span> (SSL_CTX_use_certificate_file(ctx, cert_file, SSL_FILETYPE_PEM) &lt;= 0) {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51">dtls_format_openssl_error</a>(<span class="stringliteral">&quot;Failed to load certificate&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a>(SocketDTLSConfig_InvalidCert);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// In TRY/EXCEPT blocks</span></div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <span class="comment">// DTLS operation that may fail</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Handler receives exception with .reason populated by RAISE_DTLS_ERROR</span></div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;DTLS error: %s\n&quot;</span>, Except_reason(Except_frame()));</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__foundation_html_gab5e72fc2bd41014c75e0ace4feabfe8e"><div class="ttname"><a href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a></div><div class="ttdeci">#define EXCEPT(e)</div><div class="ttdoc">Catch a specific exception type within a TRY block.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l01105">Except.h:1105</a></div></div>
<div class="ttc" id="agroup__foundation_html_gad2746371528bdf15c3910b7bf217dac0"><div class="ttname"><a href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a></div><div class="ttdeci">#define TRY</div><div class="ttdoc">Start a TRY/EXCEPT/FINALLY exception handling block.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00991">Except.h:991</a></div></div>
<div class="ttc" id="agroup__foundation_html_gae6628ac788ad213363b89dba9868420b"><div class="ttname"><a href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a></div><div class="ttdeci">#define END_TRY</div><div class="ttdoc">Complete a TRY/EXCEPT/FINALLY exception handling block.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l01439">Except.h:1439</a></div></div>
<div class="ttc" id="agroup__security_html_ga083605c4d8e6ea5658b72883f8e41be9"><div class="ttname"><a href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a></div><div class="ttdeci">const Except_T SocketDTLS_Failed</div><div class="ttdoc">General DTLS operation failure.</div></div>
<div class="ttc" id="agroup__security_html_ga52868028efe42ac286ffdcad2e5f8a51"><div class="ttname"><a href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51">dtls_format_openssl_error</a></div><div class="ttdeci">static void dtls_format_openssl_error(const char *context)</div><div class="ttdoc">Format and log the current OpenSSL error queue into thread-local error buffer.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00772">SocketDTLS-private.h:772</a></div></div>
</div><!-- fragment --><p>Related Macros</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro   </th><th class="markdownTableHeadNone">Purpose   </th><th class="markdownTableHeadNone">Pre-formats message?    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RAISE_DTLS_ERROR   </td><td class="markdownTableBodyNone">Raise with existing buffer   </td><td class="markdownTableBodyNone">No    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RAISE_DTLS_ERROR_MSG   </td><td class="markdownTableBodyNone">Raise + format simple msg   </td><td class="markdownTableBodyNone">Yes    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DTLS_ERROR_MSG   </td><td class="markdownTableBodyNone">Format only (no raise)   </td><td class="markdownTableBodyNone">Yes    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">DTLS_ERROR_FMT   </td><td class="markdownTableBodyNone">Format with args (no raise)   </td><td class="markdownTableBodyNone">Yes   </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>Always format error details before raising to avoid empty reasons. Unformatted raises still succeed but provide poor diagnostics.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Simple copy and raise; no allocations or loops.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944" title="Raise a SocketDTLS exception with formatted error message and arguments.">RAISE_DTLS_ERROR_MSG()</a> for convenient message formatting + raise </dd>
<dd>
<a class="el" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded" title="Format a simple static error message into the thread-local error buffer.">DTLS_ERROR_MSG()</a> and <a class="el" href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f" title="Format error message with printf-style arguments into thread-local buffer.">DTLS_ERROR_FMT()</a> for buffer population </dd>
<dd>
<a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51" title="Format and log the current OpenSSL error queue into thread-local error buffer.">dtls_format_openssl_error()</a> for OpenSSL-specific error handling </dd>
<dd>
<a class="el" href="Except_8h.html" title="Structured exception handling for C with TRY/EXCEPT/FINALLY blocks.">core/Except.h</a> for base exception handling framework </dd>
<dd>
SocketUtil.h::SOCKET_RAISE_MODULE_ERROR for generic module exception macro </dd>
<dd>
docs/ERROR_HANDLING.md for comprehensive exception patterns </dd>
<dd>
SocketDTLS_DetailedException thread-local instance definition </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00126">126</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="gaafbc899f00128359bdc6d2f9d02e8944" name="gaafbc899f00128359bdc6d2f9d02e8944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaafbc899f00128359bdc6d2f9d02e8944">&#9670;&#160;</a></span>RAISE_DTLS_ERROR_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_DTLS_ERROR_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">msg&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span>                                                                          \</div>
<div class="line">    {                                                                         \</div>
<div class="line">      SOCKET_ERROR_MSG (msg);                                                 \</div>
<div class="line">      RAISE_DTLS_ERROR (exception);                                           \</div>
<div class="line">    }                                                                         \</div>
<div class="line">  while (0)</div>
</div><!-- fragment -->
<p>Raise a SocketDTLS exception with formatted error message and arguments. </p>
<p>Convenience macro combining error message formatting and exception raising in one step. First populates the thread-local socket_error_buf using <a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb" title="SOCKET_ERROR_MSG - Format error message without errno.">SOCKET_ERROR_MSG()</a> with the provided format string and arguments (including errno if applicable), then invokes <a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf" title="Raise a SocketDTLS module exception with automatically populated error details.">RAISE_DTLS_ERROR()</a> to raise the exception with the formatted details attached. Ideal for quick error reporting in DTLS functions without separate formatting calls.</p>
<p>Supports printf-style formatting for rich diagnostics, e.g., including file paths, error codes, or numeric values. Automatically thread-safe via per-thread buffers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">exception</td><td>The SocketDTLS exception type (e.g., SocketDTLS_Failed) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">msg</td><td>Format string for the error message (printf-style) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">...</td><td>Variable arguments matching the format string (e.g., const char *path, int err)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Equivalent to: <a class="el" href="group__security.html#gacca68f6e3be556e42dcd9ab54da96ded" title="Format a simple static error message into the thread-local error buffer.">DTLS_ERROR_MSG(msg, ...)</a>; <a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf" title="Raise a SocketDTLS module exception with automatically populated error details.">RAISE_DTLS_ERROR(exception)</a>;</li>
<li>Appends errno details if available (via SOCKET_ERROR_MSG behavior).</li>
<li>Format string must be compile-time constant or literal for security (avoids format attacks).</li>
<li>Maximum buffer size SOCKET_DTLS_ERROR_BUFSIZE; truncation possible on overflow (rare).</li>
<li>Use for non-OpenSSL errors; pair with <a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51" title="Format and log the current OpenSSL error queue into thread-local error buffer.">dtls_format_openssl_error()</a> for SSL failures.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - All operations use thread-local storage for buffer and</dt><dd>exception. No synchronization needed.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// Format with string and int</span></div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group__security.html#ga43a9d75df4015935d50b33c528342d80">dtls_validate_file_path</a>(cert_path)) {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944">RAISE_DTLS_ERROR_MSG</a>(SocketDTLSConfig_InvalidCert,</div>
<div class="line">                         <span class="stringliteral">&quot;Invalid certificate path: &#39;%s&#39; (length %zu)&quot;</span>,</div>
<div class="line">                         cert_path, strlen(cert_path));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// With errno after system call</span></div>
<div class="line">FILE *f = fopen(key_path, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!f) {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944">RAISE_DTLS_ERROR_MSG</a>(SocketDTLSConfig_Failed,</div>
<div class="line">                         <span class="stringliteral">&quot;Failed to open private key file: %s&quot;</span>, key_path);</div>
<div class="line">    <span class="comment">// Exception includes strerror(errno) automatically</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga43a9d75df4015935d50b33c528342d80"><div class="ttname"><a href="group__security.html#ga43a9d75df4015935d50b33c528342d80">dtls_validate_file_path</a></div><div class="ttdeci">static int dtls_validate_file_path(const char *path)</div><div class="ttdoc">Perform security validation on file path strings for cert/key/CA loading.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00888">SocketDTLS-private.h:888</a></div></div>
<div class="ttc" id="agroup__security_html_gaafbc899f00128359bdc6d2f9d02e8944"><div class="ttname"><a href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944">RAISE_DTLS_ERROR_MSG</a></div><div class="ttdeci">#define RAISE_DTLS_ERROR_MSG(exception, msg)</div><div class="ttdoc">Raise a SocketDTLS exception with formatted error message and arguments.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00204">SocketDTLS-private.h:204</a></div></div>
</div><!-- fragment --><p>Formatting vs Other Macros</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Macro   </th><th class="markdownTableHeadNone">Formats Msg?   </th><th class="markdownTableHeadNone">Raises Exc?   </th><th class="markdownTableHeadNone">Includes errno?   </th><th class="markdownTableHeadNone">Best For    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">RAISE_DTLS_ERROR_MSG   </td><td class="markdownTableBodyNone">Yes (printf)   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">Quick errors with vars    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RAISE_DTLS_ERROR   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">After manual formatting    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">DTLS_ERROR_FMT   </td><td class="markdownTableBodyNone">Yes (printf)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">Log without raising    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">DTLS_ERROR_MSG   </td><td class="markdownTableBodyNone">Yes (simple)   </td><td class="markdownTableBodyNone">No   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">Basic messages   </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>Format strings with user input can enable attacks; validate/sanitize inputs. Excessive arguments may truncate; keep messages concise (&lt; SOCKET_DTLS_ERROR_BUFSIZE).</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) where n=formatted string length - snprintf time,</dt><dd>negligible.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga4e97bd0cd12ea34b564755e1a377d02f" title="Format error message with printf-style arguments into thread-local buffer.">DTLS_ERROR_FMT()</a> for formatting without raising </dd>
<dd>
<a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf" title="Raise a SocketDTLS module exception with automatically populated error details.">RAISE_DTLS_ERROR()</a> underlying raise mechanism </dd>
<dd>
<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb" title="SOCKET_ERROR_MSG - Format error message without errno.">SOCKET_ERROR_MSG()</a> base formatting macro in <a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> </dd>
<dd>
<a class="el" href="Except_8h.html" title="Structured exception handling for C with TRY/EXCEPT/FINALLY blocks.">core/Except.h</a> for exception handling TRY/EXCEPT patterns </dd>
<dd>
docs/ERROR_HANDLING.md#detailed-exceptions for best practices </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00204">204</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="gaaa5d5a165d617e880e0761f54333d859" name="gaaa5d5a165d617e880e0761f54333d859"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaa5d5a165d617e880e0761f54333d859">&#9670;&#160;</a></span>RAISE_TLS_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_TLS_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception</td><td>)</td>
          <td>&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (SocketTLS, exception)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>tls_error_buf - Thread-local TLS error message buffer (see <a class="el" href="SocketTLS_8h.html" title="High-level TLS/SSL integration for secure Socket I/O with TLS 1.3 enforcement.">SocketTLS.h</a> for details). </p>
<p>Declared in <a class="el" href="SocketTLS_8h.html" title="High-level TLS/SSL integration for secure Socket I/O with TLS 1.3 enforcement.">SocketTLS.h</a>. Used by all TLS macros for error reporting.</p>
<p>SocketTLS_DetailedException - Thread-local exception for TLS module errors.</p>
<p>Thread-local exception type for TLS module errors (declared in .c files via <a class="el" href="SocketUtil_8h.html#a9a80f14591d4cdb7347af54b5f66e766" title="SOCKET_DECLARE_MODULE_EXCEPTION - Declare thread-local exception.">SOCKET_DECLARE_MODULE_EXCEPTION(SocketTLS)</a>). Prevents race conditions in multi-threaded environments by providing per-thread exception storage populated with tls_error_buf details.</p>
<p>Used by RAISE_TLS_ERROR* macros for detailed reporting.</p>
<dl class="section note"><dt>Note</dt><dd>Not a global var; thread-local instance.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketUtil_8h.html#a9a80f14591d4cdb7347af54b5f66e766" title="SOCKET_DECLARE_MODULE_EXCEPTION - Declare thread-local exception.">SOCKET_DECLARE_MODULE_EXCEPTION()</a> in <a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">core/SocketUtil.h</a> for declaration pattern </dd>
<dd>
<a class="el" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b" title="Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.">tls_error_buf</a> for error message buffer </dd>
<dd>
<a class="el" href="Except_8h.html" title="Structured exception handling for C with TRY/EXCEPT/FINALLY blocks.">core/Except.h</a> for exception handling system</dd></dl>
<p>RAISE_TLS_ERROR - Raise TLS exception with detailed error message</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>Exception type to raise</td></tr>
  </table>
  </dd>
</dl>
<p>Creates thread-local copy of exception with reason from tls_error_buf. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00159">159</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="gaa846eebc97332827b77e55db99ba9895" name="gaa846eebc97332827b77e55db99ba9895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa846eebc97332827b77e55db99ba9895">&#9670;&#160;</a></span>RAISE_TLS_ERROR_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_TLS_ERROR_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;  <a class="el" href="SocketUtil_8h.html#aa7d4ca3a984cb2df9849f6b501d65cc3">SOCKET_RAISE_MSG</a> (SocketTLS, exception, fmt, ##__VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>RAISE_TLS_ERROR_MSG - Raise TLS exception with formatted message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">exception</td><td>Exception type to raise </td></tr>
    <tr><td class="paramname">fmt</td><td>Error message format string </td></tr>
    <tr><td class="paramname">...</td><td>Format arguments</td></tr>
  </table>
  </dd>
</dl>
<p>Raises TLS exception with formatted error message. Uses thread-local exception storage to prevent race conditions. The message is formatted into tls_error_buf and attached to the exception before raising. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00173">173</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga04c1b681fb568ffc8c89a37bcdcbcf80" name="ga04c1b681fb568ffc8c89a37bcdcbcf80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga04c1b681fb568ffc8c89a37bcdcbcf80">&#9670;&#160;</a></span>REQUIRE_DTLS_ENABLED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUIRE_DTLS_ENABLED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">socket, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span>                                                                          \</div>
<div class="line">    {                                                                         \</div>
<div class="line">      if (!(socket)-&gt;dtls_enabled)                                            \</div>
<div class="line">        RAISE_DTLS_ERROR_MSG (exception, <span class="stringliteral">&quot;DTLS not enabled on socket&quot;</span>);       \</div>
<div class="line">    }                                                                         \</div>
<div class="line">  while (0)</div>
</div><!-- fragment -->
<p>Validate that DTLS is enabled on a socket, raising exception if not. </p>
<p>Defensive programming macro used internally to enforce prerequisite that DTLS has been enabled on the socket before performing any DTLS-specific operations. Checks socket-&gt;dtls_enabled flag and raises the specified exception with a standardized message if false. Prevents subtle bugs from uninitialized sockets and clarifies error context for debugging.</p>
<p>Expands to an if-statement that performs the check and <a class="el" href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944" title="Raise a SocketDTLS exception with formatted error message and arguments.">RAISE_DTLS_ERROR_MSG()</a> on failure. No-op on success (continues execution).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The socket instance to validate (must not be NULL) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exception</td><td>The SocketDTLS exception type to raise on validation failure (e.g., SocketDTLS_Failed, SocketDTLS_InvalidState)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Assumes socket != NULL; add explicit NULL check if needed before this macro.</li>
<li>Message is fixed: "DTLS not enabled on socket" for consistency.</li>
<li>Placed early in functions requiring DTLS state to fail-fast with clear errors.</li>
<li>Complements <a class="el" href="group__security.html#ga223a7b4bdc35b2cd8c8828e3fd709414" title="Comprehensive validation macro for DTLS socket readiness before I/O operations.">VALIDATE_DTLS_IO_READY()</a> which adds more checks (handshake, SSL*).</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Conditional - Safe if socket access is synchronized externally.</dt><dd>The check is read-only, but exception raising uses thread-local storage.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="keyword">static</span> ssize_t</div>
<div class="line">dtls_internal_send(<a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, <span class="keyword">const</span> <span class="keywordtype">void</span> *buf, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga04c1b681fb568ffc8c89a37bcdcbcf80">REQUIRE_DTLS_ENABLED</a>(socket, SocketDTLS_InvalidState);</div>
<div class="line">    <span class="comment">// Now safe to access DTLS state</span></div>
<div class="line">    SSL *ssl = <a class="code hl_function" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd">dtls_socket_get_ssl</a>(socket);</div>
<div class="line">    <span class="comment">// Proceed with SSL_write(ssl, buf, len)</span></div>
<div class="line">}</div>
<div class="ttc" id="aSocketDgram-private_8h_html_structSocketDgram__T"><div class="ttname"><a href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a></div><div class="ttdoc">Opaque type representing a datagram socket instance.</div><div class="ttdef"><b>Definition</b> <a href="SocketDgram-private_8h_source.html#l00043">SocketDgram-private.h:44</a></div></div>
<div class="ttc" id="agroup__security_html_ga04c1b681fb568ffc8c89a37bcdcbcf80"><div class="ttname"><a href="group__security.html#ga04c1b681fb568ffc8c89a37bcdcbcf80">REQUIRE_DTLS_ENABLED</a></div><div class="ttdeci">#define REQUIRE_DTLS_ENABLED(socket, exception)</div><div class="ttdoc">Validate that DTLS is enabled on a socket, raising exception if not.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00264">SocketDTLS-private.h:264</a></div></div>
<div class="ttc" id="agroup__security_html_ga8d5647f2b71d9cd5c60e6a1c385854dd"><div class="ttname"><a href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd">dtls_socket_get_ssl</a></div><div class="ttdeci">static SSL * dtls_socket_get_ssl(SocketDgram_T socket)</div><div class="ttdoc">Retrieve the SSL object pointer associated with a DTLS-enabled socket.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00559">SocketDTLS-private.h:559</a></div></div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>Misuse (e.g., on non-DTLS sockets) always raises; use judiciously. For runtime-disable scenarios, check flag manually without raising.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Single flag check and potential exception raise.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga223a7b4bdc35b2cd8c8828e3fd709414" title="Comprehensive validation macro for DTLS socket readiness before I/O operations.">VALIDATE_DTLS_IO_READY()</a> for comprehensive I/O readiness validation </dd>
<dd>
<a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> public function to enable DTLS on sockets </dd>
<dd>
<a class="el" href="group__security.html#gaafbc899f00128359bdc6d2f9d02e8944" title="Raise a SocketDTLS exception with formatted error message and arguments.">RAISE_DTLS_ERROR_MSG()</a> underlying raise mechanism </dd>
<dd>
<a class="el" href="SocketDgram-private_8h.html" title="Internal implementation details for datagram (UDP) socket structure.">SocketDgram-private.h</a> for socket internal state (dtls_enabled flag) </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a>-validation for best practices </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00264">264</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="ga6bcf5ec61bfa6d15fb692b360e8ab2c7" name="ga6bcf5ec61bfa6d15fb692b360e8ab2c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6bcf5ec61bfa6d15fb692b360e8ab2c7">&#9670;&#160;</a></span>REQUIRE_TLS_ENABLED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define REQUIRE_TLS_ENABLED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">socket, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  <span class="keywordflow">do</span>                                                                          \</div>
<div class="line">    {                                                                         \</div>
<div class="line">      if (!(socket)-&gt;tls_enabled)                                             \</div>
<div class="line">        RAISE_TLS_ERROR_MSG (exception, <span class="stringliteral">&quot;TLS not enabled on socket&quot;</span>);         \</div>
<div class="line">    }                                                                         \</div>
<div class="line">  while (0)</div>
</div><!-- fragment -->
<p>REQUIRE_TLS_ENABLED - Validate TLS is enabled on socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>Socket to validate </td></tr>
    <tr><td class="paramname">exception</td><td>Exception to raise on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Validates that TLS has been enabled on the specified socket. Raises the provided exception with a descriptive message if TLS is not enabled. Used throughout TLS operations to ensure proper initialization order.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f" title="Enable TLS on a socket using the provided context.">SocketTLS_enable()</a> for enabling TLS on sockets </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00188">188</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga0c869f123d7c29c39cfe7d1dedd998a0" name="ga0c869f123d7c29c39cfe7d1dedd998a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c869f123d7c29c39cfe7d1dedd998a0">&#9670;&#160;</a></span>SOCKET_BITS_PER_BYTE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_BITS_PER_BYTE&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Bits per byte. </p>
<p>For CIDR prefix calculations. </p>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l01061">1061</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga219b0a63c1ee02ecb27a9c932da08a51" name="ga219b0a63c1ee02ecb27a9c932da08a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga219b0a63c1ee02ecb27a9c932da08a51">&#9670;&#160;</a></span>SOCKET_HAS_SO_ACCEPTFILTER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_HAS_SO_ACCEPTFILTER&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SO_ACCEPTFILTER support flag. </p>
<p>BSD/macOS equivalent of TCP_DEFER_ACCEPT. Used with struct accept_filter_arg and filter name "dataready".</p>
<dl class="section see"><dt>See also</dt><dd>SO_ACCEPTFILTER </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l02193">2193</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gab97bd3e7337b376f6be804f25d4d9c6d" name="gab97bd3e7337b376f6be804f25d4d9c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab97bd3e7337b376f6be804f25d4d9c6d">&#9670;&#160;</a></span>SOCKET_HAS_TCP_DEFER_ACCEPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_HAS_TCP_DEFER_ACCEPT&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TCP_DEFER_ACCEPT option for SYN flood protection. </p>
<p>Linux-specific option that delays accept() completion until client sends data. On BSD/macOS, use SO_ACCEPTFILTER instead.</p>
<dl class="section see"><dt>See also</dt><dd>TCP_DEFER_ACCEPT </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l02178">2178</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gae1b769b5903588b4e6cbd40864a30d8e" name="gae1b769b5903588b4e6cbd40864a30d8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae1b769b5903588b4e6cbd40864a30d8e">&#9670;&#160;</a></span>SOCKET_IPV4_ADDR_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_IPV4_ADDR_BYTES&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>IPv4 address size in bytes. </p>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l01050">1050</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga812e1a3066fafa145324e13ec013cb47" name="ga812e1a3066fafa145324e13ec013cb47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga812e1a3066fafa145324e13ec013cb47">&#9670;&#160;</a></span>SOCKET_IPV6_ADDR_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_IPV6_ADDR_BYTES&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>IPv6 address size in bytes. </p>
<p>Used for CIDR parsing. </p>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l01041">1041</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gaff44ca76156e6010520f4d231fbf7109" name="gaff44ca76156e6010520f4d231fbf7109"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaff44ca76156e6010520f4d231fbf7109">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_BLOCK_DURATION_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_BLOCK_DURATION_MS&#160;&#160;&#160;60000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Block duration for misbehaving IPs. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00904">904</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga7883d7f2995a8046776d818de6dbaa2e" name="ga7883d7f2995a8046776d818de6dbaa2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7883d7f2995a8046776d818de6dbaa2e">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_DEFER_SEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_DEFER_SEC&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TCP_DEFER_ACCEPT timeout for challenged connections. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00914">914</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gaf02ac0a68cee3923b135a1e423622f61" name="gaf02ac0a68cee3923b135a1e423622f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf02ac0a68cee3923b135a1e423622f61">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_GLOBAL_PER_SEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_GLOBAL_PER_SEC&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global connection rate limit. </p>
<p>All IPs, per second.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00874">874</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gac82e2e73ae29b0b0e8699d8b81bb29c3" name="gac82e2e73ae29b0b0e8699d8b81bb29c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac82e2e73ae29b0b0e8699d8b81bb29c3">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_MAX_BLACKLIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_MAX_BLACKLIST&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum blacklist entries. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l01018">1018</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga8c43db9a86f5f49f85c535b7e01a9cd2" name="ga8c43db9a86f5f49f85c535b7e01a9cd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8c43db9a86f5f49f85c535b7e01a9cd2">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_MAX_PER_WINDOW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_MAX_PER_WINDOW&#160;&#160;&#160;50</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum connection attempts per IP per window. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00862">862</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga842d1a441b3a55a43f2066087ff6ff59" name="ga842d1a441b3a55a43f2066087ff6ff59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga842d1a441b3a55a43f2066087ff6ff59">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_MAX_TRACKED_IPS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_MAX_TRACKED_IPS&#160;&#160;&#160;100000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum unique IPs to track. </p>
<p>LRU eviction when exceeded.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00998">998</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gac1a28d9573c05725ca3abb96239b83ee" name="gac1a28d9573c05725ca3abb96239b83ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1a28d9573c05725ca3abb96239b83ee">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_MAX_WHITELIST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_MAX_WHITELIST&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum whitelist entries. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l01008">1008</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gae0b03e45dca47aec6f4203011b1161f3" name="gae0b03e45dca47aec6f4203011b1161f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae0b03e45dca47aec6f4203011b1161f3">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_MIN_SUCCESS_RATIO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_MIN_SUCCESS_RATIO&#160;&#160;&#160;0.3f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minimum success/attempt ratio before IP becomes suspect. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00884">884</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga4122f191a253666fdb691929b3cd4173" name="ga4122f191a253666fdb691929b3cd4173"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4122f191a253666fdb691929b3cd4173">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_PENALTY_ATTEMPT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_PENALTY_ATTEMPT&#160;&#160;&#160;0.02f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score penalty per new connection attempt. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00966">966</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga4f01c6ca60bf199d42dde59f0159074c" name="ga4f01c6ca60bf199d42dde59f0159074c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f01c6ca60bf199d42dde59f0159074c">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_PENALTY_FAILURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_PENALTY_FAILURE&#160;&#160;&#160;0.05f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score penalty per connection failure. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00976">976</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga9a0acbe7229a03abfe70205717d511c4" name="ga9a0acbe7229a03abfe70205717d511c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a0acbe7229a03abfe70205717d511c4">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_REWARD_SUCCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_REWARD_SUCCESS&#160;&#160;&#160;0.05f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score reward per successful connection. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00986">986</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga9608aa5a6bbbe4cbc60c9442d094cfd0" name="ga9608aa5a6bbbe4cbc60c9442d094cfd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9608aa5a6bbbe4cbc60c9442d094cfd0">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_SCORE_BLOCK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_SCORE_BLOCK&#160;&#160;&#160;0.2f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score threshold below which connections are blocked. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00944">944</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga67a51dcadef9eb934f3342e9e02f6fd5" name="ga67a51dcadef9eb934f3342e9e02f6fd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67a51dcadef9eb934f3342e9e02f6fd5">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_SCORE_CHALLENGE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_SCORE_CHALLENGE&#160;&#160;&#160;0.4f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score threshold below which connections are challenged. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00934">934</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga8b8d879d7477b5a59170487f2ef38cd0" name="ga8b8d879d7477b5a59170487f2ef38cd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b8d879d7477b5a59170487f2ef38cd0">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_SCORE_DECAY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_SCORE_DECAY&#160;&#160;&#160;0.01f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score recovery rate per second. </p>
<p>Time-based decay.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00956">956</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga8a91a7da051b6462f126bc329f1e5cda" name="ga8a91a7da051b6462f126bc329f1e5cda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a91a7da051b6462f126bc329f1e5cda">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_SCORE_THROTTLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_SCORE_THROTTLE&#160;&#160;&#160;0.7f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score threshold below which connections are throttled. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00924">924</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gaae5bbd0b37027680dfa2c0c58773fef6" name="gaae5bbd0b37027680dfa2c0c58773fef6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae5bbd0b37027680dfa2c0c58773fef6">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_THROTTLE_DELAY_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_THROTTLE_DELAY_MS&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Artificial delay for throttled connections. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00894">894</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gae062b2bac82d2ca78edc6658135b25a4" name="gae062b2bac82d2ca78edc6658135b25a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae062b2bac82d2ca78edc6658135b25a4">&#9670;&#160;</a></span>SOCKET_SYN_DEFAULT_WINDOW_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_DEFAULT_WINDOW_MS&#160;&#160;&#160;10000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sliding window duration for rate measurement. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l00852">852</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="gae82758ef1761626baf114a11955520e1" name="gae82758ef1761626baf114a11955520e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae82758ef1761626baf114a11955520e1">&#9670;&#160;</a></span>SOCKET_SYN_INITIAL_SCORE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_INITIAL_SCORE&#160;&#160;&#160;0.8f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initial reputation score for newly encountered IP addresses. </p>
<p>Default value of 0.8f provides moderate trust ("benefit of the doubt") to unknown IPs before any behavior is observed.</p>
<dl class="section note"><dt>Note</dt><dd>Value must be in [0.0f, 1.0f]; clamped if necessary. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gacf287a7019c5ff677321e8b5fa390cf2" title="Clamp reputation score to valid range [0.0f, 1.0f].">synprotect_clamp_score()</a> for validation. </dd>
<dd>
<a class="el" href="group__security.html#ad510a10bf5b3f26894d4d91351cc6cf8">SocketSYNProtect_T::ip_table</a> entries initialization. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00085">85</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="ga3714b05d28ef69f2bc3b95b17abde741" name="ga3714b05d28ef69f2bc3b95b17abde741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3714b05d28ef69f2bc3b95b17abde741">&#9670;&#160;</a></span>SOCKET_SYN_IP_HASH_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_IP_HASH_SIZE&#160;&#160;&#160;4093</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default hash table size for IP state tracking entries. </p>
<p>Prime number (4093) chosen for optimal hash distribution, low collision rate, and efficient memory usage.</p>
<dl class="section note"><dt>Note</dt><dd>Can be overridden via preprocessor definition before including this header. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ad510a10bf5b3f26894d4d91351cc6cf8">SocketSYNProtect_T::ip_table</a> - The hash table using this size. </dd>
<dd>
<a class="el" href="group__security.html#ga93f5774d64aab235b0af3908cf5fa15a" title="Compute hash index for an IP address using instance-specific seed.">synprotect_hash_ip()</a> - The hashing function that uses this table size. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00053">53</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="ga2e75c0e89d959bd3fa395f8307c1ba65" name="ga2e75c0e89d959bd3fa395f8307c1ba65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2e75c0e89d959bd3fa395f8307c1ba65">&#9670;&#160;</a></span>SOCKET_SYN_LIST_HASH_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_LIST_HASH_SIZE&#160;&#160;&#160;509</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default hash table size for whitelist and blacklist entries. </p>
<p>Smaller prime number (509) suitable for lower-volume lists with fewer entries compared to main IP tracking table.</p>
<dl class="section note"><dt>Note</dt><dd>Override via preprocessor if needed for custom sizing. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ada8dc27f63197debf3707785227a9f78">SocketSYNProtect_T::whitelist_table</a> </dd>
<dd>
<a class="el" href="group__security.html#a9a7f15f3a9242acca61b40feaa735d9e">SocketSYNProtect_T::blacklist_table</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00069">69</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="ga89596d086483db6027b30bdd41bb04dd" name="ga89596d086483db6027b30bdd41bb04dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89596d086483db6027b30bdd41bb04dd">&#9670;&#160;</a></span>SOCKET_SYN_MAX_CIDR_ENTRIES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_MAX_CIDR_ENTRIES&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum number of whitelist entries (CIDR ranges or single IPs). </p>
<p>Limits memory and hash table chain lengths for efficient lookups.</p>
<dl class="section note"><dt>Note</dt><dd>Each CIDR entry stores network prefix and length; no expansion to individuals. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYN__WhitelistEntry" title="Structure for whitelist entries supporting single IPs and CIDR ranges.">SocketSYN_WhitelistEntry</a> for entry structure with prefix_len. </dd>
<dd>
<a class="el" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0" title="Add a CIDR range to the whitelist.">SocketSYNProtect_whitelist_add_cidr()</a> for adding CIDR notations. </dd>
<dd>
ip_matches_cidr() internal matching function. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00118">118</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="ga94b45dbd0567c33d239bcfe0b8de2391" name="ga94b45dbd0567c33d239bcfe0b8de2391"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga94b45dbd0567c33d239bcfe0b8de2391">&#9670;&#160;</a></span>SOCKET_SYN_TRUSTED_SCORE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_TRUSTED_SCORE&#160;&#160;&#160;1.0f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reputation score assigned to whitelisted or fully trusted IPs. </p>
<p>Maximum trust level (1.0f) which typically bypasses rate limits and challenges.</p>
<dl class="section note"><dt>Note</dt><dd>Clamped to [0.0f, 1.0f] range. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108" title="Add an IP address to the whitelist.">SocketSYNProtect_whitelist_add()</a> and related functions. </dd>
<dd>
<a class="el" href="group__security.html#gacf287a7019c5ff677321e8b5fa390cf2" title="Clamp reputation score to valid range [0.0f, 1.0f].">synprotect_clamp_score()</a> for clamping. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00101">101</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="gab0908a428243a18d0260754d417e023a" name="gab0908a428243a18d0260754d417e023a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab0908a428243a18d0260754d417e023a">&#9670;&#160;</a></span>SOCKET_SYN_TRUSTED_SCORE_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_SYN_TRUSTED_SCORE_THRESHOLD&#160;&#160;&#160;0.9f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Score threshold at or above which IP is considered trusted. </p>
<p>For reputation tracking.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> for SYN flood protection. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketConfig_8h_source.html#l01030">1030</a> of file <a class="el" href="SocketConfig_8h_source.html">SocketConfig.h</a>.</p>

</div>
</div>
<a id="ga0acb682b8260ab1c60b918599864e2e5" name="ga0acb682b8260ab1c60b918599864e2e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0acb682b8260ab1c60b918599864e2e5">&#9670;&#160;</a></span>T <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T&#160;&#160;&#160;<a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opaque type for IP connection tracker instance. </p>
<p>Manages concurrent connection counts per IP address using a thread-safe hash table. Enforces per-IP limits to mitigate DoS attacks from single sources. Supports IPv4 and IPv6 with automatic validation and efficient O(1) average operations. Configurable for memory usage and integrates with Arena allocator.</p>
<h2><a class="anchor" id="autotoc_md75"></a>
Key Characteristics</h2>
<ul>
<li><b>Opaque</b>: Internal struct hidden; use provided API only</li>
<li><b>Hash-based</b>: DJB2 algorithm with random seed for collision resistance</li>
<li><b>Limits</b>: Enforceable max per IP and total unique IPs to prevent abuse/OOM</li>
<li><b>Cleanup</b>: Auto-removes zero-count entries; manual clear() available</li>
</ul>
<h2><a class="anchor" id="autotoc_md76"></a>
Lifecycle</h2>
<ol type="1">
<li>Create: SocketIPTracker_new(arena, max_per_ip)</li>
<li>Configure: Optional setmax(), setmaxunique()</li>
<li>Use: track() on accept, release() on close, query count/total</li>
<li>Destroy: <a class="el" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39" title="Dispose of IP tracker instance and release resources.">SocketIPTracker_free()</a> or via <a class="el" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d" title="Dispose of an arena and all its allocations, freeing underlying memory chunks.">Arena_dispose()</a></li>
</ol>
<h2><a class="anchor" id="autotoc_md77"></a>
Thread Safety</h2>
<dl class="section user"><dt>Thread Safety\n Yes - All public functions acquire internal mutex.</dt><dd>Concurrent track/release/count from multiple threads safe without external sync. Avoid free() during active operations; prefer coordinated shutdown.</dd></dl>
<h2><a class="anchor" id="autotoc_md78"></a>
Edge Cases Handled</h2>
<ul>
<li>Invalid IPs (non IPv4/6): Rejected for track(), no-op others</li>
<li>Unlimited mode (max_per_ip &lt;=0): Always allows without checks</li>
<li>Alloc failures: Graceful fallback in unlimited mode</li>
<li>Count overflow: Logs error, rejects increment</li>
</ul>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>IP strings must be null-terminated, length &lt; SOCKET_IP_MAX_LEN</li>
<li>Uses SocketCrypto_random_bytes for hash seed; falls back to time/PID if unavailable</li>
<li>For load-balanced/proxied setups, extract real client IP from headers</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Hitting max_unique_ips silently rejects new IPs (log warned)</li>
<li>Long chains possible under hash attack, but salted seed mitigates</li>
<li>Arena users: free() only NULLs; actual cleanup on <a class="el" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d" title="Dispose of an arena and all its allocations, freeing underlying memory chunks.">Arena_dispose()</a></li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n Operations: O(1) average, O(unique_ips / buckets) worst chain</dt><dd>length</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde" title="Create and initialize a new IP connection tracker instance.">SocketIPTracker_new()</a> for instantiation </dd>
<dd>
<a class="el" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3" title="Increment connection count for specified IP; enforce limit if set.">SocketIPTracker_track()</a> primary usage entrypoint </dd>
<dd>
<a class="el" href="group__foundation.html">Core Foundation Modules</a> Required base modules </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> Production deployment guide </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketIPTracker_8h_source.html#l00209">209</a> of file <a class="el" href="SocketIPTracker_8h_source.html">SocketIPTracker.h</a>.</p>

</div>
</div>
<a id="ga0acb682b8260ab1c60b918599864e2e5" name="ga0acb682b8260ab1c60b918599864e2e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0acb682b8260ab1c60b918599864e2e5">&#9670;&#160;</a></span>T <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T&#160;&#160;&#160;<a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect_8h_source.html#l00150">150</a> of file <a class="el" href="SocketSYNProtect_8h_source.html">SocketSYNProtect.h</a>.</p>

</div>
</div>
<a id="ga0acb682b8260ab1c60b918599864e2e5" name="ga0acb682b8260ab1c60b918599864e2e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0acb682b8260ab1c60b918599864e2e5">&#9670;&#160;</a></span>T <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T&#160;&#160;&#160;<a class="el" href="group__security.html#ga63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00351">351</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<a id="gab9caf93eecdc58f0e12ae64ebe268290" name="gab9caf93eecdc58f0e12ae64ebe268290"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab9caf93eecdc58f0e12ae64ebe268290">&#9670;&#160;</a></span>TLS_ERROR_FMT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_ERROR_FMT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (fmt, __VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TLS_ERROR_FMT - Format error message with arguments. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fmt</td><td>Format string </td></tr>
    <tr><td class="paramname">...</td><td>Format arguments</td></tr>
  </table>
  </dd>
</dl>
<p>Formats an error message with arguments into the thread-local error buffer. Includes errno information when available for system call diagnostics. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00215">215</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga839d12558ca20b9a5fd8fa25fa7db99a" name="ga839d12558ca20b9a5fd8fa25fa7db99a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga839d12558ca20b9a5fd8fa25fa7db99a">&#9670;&#160;</a></span>TLS_ERROR_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_ERROR_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">msg</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (&quot;%s&quot;, msg)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TLS_ERROR_MSG - Format simple error message. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Message string</td></tr>
  </table>
  </dd>
</dl>
<p>Formats a simple error message into the thread-local error buffer. Used for consistent error reporting across TLS operations. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00204">204</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga7ff1ea56cca8070de8806165d1b107ea" name="ga7ff1ea56cca8070de8806165d1b107ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7ff1ea56cca8070de8806165d1b107ea">&#9670;&#160;</a></span>TLS_UNUSED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TLS_UNUSED</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(void)(x)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Suppress compiler warnings for intentionally unused parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>Parameter or variable that is intentionally unused (e.g., in asserts only).</td></tr>
  </table>
  </dd>
</dl>
<p>Casts the parameter to void to inform the compiler it is deliberately unused. Common in callback functions or when params are used conditionally.</p>
<dl class="section note"><dt>Note</dt><dd>Use (void)param; style for single use; macro for readability. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>socket_util_unused() if available in core utils. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00943">943</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="ga223a7b4bdc35b2cd8c8828e3fd709414" name="ga223a7b4bdc35b2cd8c8828e3fd709414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga223a7b4bdc35b2cd8c8828e3fd709414">&#9670;&#160;</a></span>VALIDATE_DTLS_IO_READY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VALIDATE_DTLS_IO_READY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">socket, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  ({                                                                          \</div>
<div class="line">    if (!(socket)-&gt;dtls_enabled)                                              \</div>
<div class="line">      {                                                                       \</div>
<div class="line">        DTLS_ERROR_MSG (<span class="stringliteral">&quot;DTLS not enabled on socket&quot;</span>);                        \</div>
<div class="line">        RAISE_DTLS_ERROR (exception);                                         \</div>
<div class="line">      }                                                                       \</div>
<div class="line">    if (!(socket)-&gt;dtls_handshake_done)                                       \</div>
<div class="line">      {                                                                       \</div>
<div class="line">        DTLS_ERROR_MSG (<span class="stringliteral">&quot;DTLS handshake not complete&quot;</span>);                       \</div>
<div class="line">        RAISE_DTLS_ERROR (exception);                                         \</div>
<div class="line">      }                                                                       \</div>
<div class="line">    SSL *_ssl = <a class="code hl_function" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd">dtls_socket_get_ssl</a> (socket);                                 \</div>
<div class="line">    if (!_ssl)                                                                \</div>
<div class="line">      {                                                                       \</div>
<div class="line">        DTLS_ERROR_MSG (<span class="stringliteral">&quot;SSL object not available&quot;</span>);                          \</div>
<div class="line">        RAISE_DTLS_ERROR (exception);                                         \</div>
<div class="line">      }                                                                       \</div>
<div class="line">    _ssl;                                                                     \</div>
<div class="line">  })</div>
</div><!-- fragment -->
<p>Comprehensive validation macro for DTLS socket readiness before I/O operations. </p>
<p>All-in-one validation macro ensuring a socket is fully prepared for DTLS encrypted I/O. Combines multiple checks into a single statement expression that either returns the SSL* pointer for immediate use or raises a detailed exception on any failure. Essential guard for public DTLS send/recv functions to prevent crashes or security issues from operating on uninitialized or incomplete DTLS state.</p>
<p>Checks in order:</p><ol type="1">
<li>socket-&gt;dtls_enabled == true</li>
<li>socket-&gt;dtls_handshake_done == true</li>
<li>ssl = dtls_socket_get_ssl(socket) != NULL</li>
</ol>
<p>On any failure, formats specific error message into thread-local buffer and raises the provided exception via <a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf" title="Raise a SocketDTLS module exception with automatically populated error details.">RAISE_DTLS_ERROR()</a>. Success returns the validated SSL*.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The DTLS socket to validate for I/O readiness </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">exception</td><td>Exception type to raise on validation failure (e.g., SocketDTLS_InvalidState)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SSL* pointer to validated SSL object (caller must not free)</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Macro expands to GCC statement expression ({ ... }) returning SSL* or raising.</li>
<li>Uses <a class="el" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd" title="Retrieve the SSL object pointer associated with a DTLS-enabled socket.">dtls_socket_get_ssl()</a> internally for SSL* retrieval and validation.</li>
<li>Error messages are specific: "DTLS not enabled...", "handshake not
complete", "SSL not available".</li>
<li>Intended for use right before SSL_read()/SSL_write() calls in DTLS wrappers.</li>
<li>Does not check socket validity (non-NULL); add if (socket) before if needed.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - Relies on thread-safe helpers (dtls_socket_get_ssl</dt><dd>read-only, exception raising thread-local). Safe concurrent use per-socket.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line">ssize_t</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460">SocketDTLS_send</a>(<a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, <span class="keyword">const</span> <span class="keywordtype">void</span> *buf, <span class="keywordtype">size_t</span> len) {</div>
<div class="line">    SSL *ssl = <a class="code hl_define" href="group__security.html#ga223a7b4bdc35b2cd8c8828e3fd709414">VALIDATE_DTLS_IO_READY</a>(socket, SocketDTLS_InvalidState);</div>
<div class="line">    <span class="comment">// ssl guaranteed valid; proceed to encrypted send</span></div>
<div class="line">    <span class="keywordflow">return</span> SSL_write(ssl, buf, len);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// In recv with different exception</span></div>
<div class="line"><span class="keywordtype">void</span> dtls_process_packet(<a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket, <span class="keyword">const</span> uint8_t *pkt, <span class="keywordtype">size_t</span></div>
<div class="line">pkt_len) { SSL *ssl = <a class="code hl_define" href="group__security.html#ga223a7b4bdc35b2cd8c8828e3fd709414">VALIDATE_DTLS_IO_READY</a>(socket, <a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>);</div>
<div class="line">    <span class="comment">// Safe to use ssl for decryption</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga223a7b4bdc35b2cd8c8828e3fd709414"><div class="ttname"><a href="group__security.html#ga223a7b4bdc35b2cd8c8828e3fd709414">VALIDATE_DTLS_IO_READY</a></div><div class="ttdeci">#define VALIDATE_DTLS_IO_READY(socket, exception)</div><div class="ttdoc">Comprehensive validation macro for DTLS socket readiness before I/O operations.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00472">SocketDTLS-private.h:472</a></div></div>
<div class="ttc" id="agroup__security_html_ga9fe6acb926cc7fbc8c4f0239834b5460"><div class="ttname"><a href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460">SocketDTLS_send</a></div><div class="ttdeci">ssize_t SocketDTLS_send(SocketDgram_T socket, const void *buf, size_t len)</div><div class="ttdoc">Send application data over established DTLS connection.</div></div>
</div><!-- fragment --><p>Validation Checklist</p>
<ul>
<li>[ ] DTLS enabled via <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a></li>
<li>[ ] Handshake completed (DTLS_HANDSHAKE_COMPLETE)</li>
<li>[ ] SSL* available and valid</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>Failure to use this macro before I/O can cause segfaults (null SSL*), protocol errors (incomplete handshake), or security leaks (plaintext on DTLS socket). Always validate in production code paths.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Sequential checks, no loops or dynamic ops.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga04c1b681fb568ffc8c89a37bcdcbcf80" title="Validate that DTLS is enabled on a socket, raising exception if not.">REQUIRE_DTLS_ENABLED()</a> for basic enablement check only </dd>
<dd>
<a class="el" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd" title="Retrieve the SSL object pointer associated with a DTLS-enabled socket.">dtls_socket_get_ssl()</a> underlying SSL* accessor </dd>
<dd>
<a class="el" href="group__security.html#gaff7268760d38bc90af34fdbf313ecbb5" title="Map OpenSSL error codes to DTLS handshake states for non-blocking I/O.">dtls_handle_ssl_error()</a> for handshake state management </dd>
<dd>
SocketDTLS.h::SocketDTLS_send for public API using this internally </dd>
<dd>
docs/TLS.md<a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a>-io-validation for <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> rationale </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00472">472</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

</div>
</div>
<a id="ga0d2d601289b5057ded1c7f81dd3212dc" name="ga0d2d601289b5057ded1c7f81dd3212dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0d2d601289b5057ded1c7f81dd3212dc">&#9670;&#160;</a></span>VALIDATE_TLS_IO_READY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VALIDATE_TLS_IO_READY</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">socket, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">exception&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">  ({                                                                          \</div>
<div class="line">    if (!(socket)-&gt;tls_enabled)                                               \</div>
<div class="line">      {                                                                       \</div>
<div class="line">        TLS_ERROR_MSG (<span class="stringliteral">&quot;TLS not enabled on socket&quot;</span>);                          \</div>
<div class="line">        RAISE_TLS_ERROR (exception);                                          \</div>
<div class="line">      }                                                                       \</div>
<div class="line">    if (!(socket)-&gt;tls_handshake_done)                                        \</div>
<div class="line">      {                                                                       \</div>
<div class="line">        TLS_ERROR_MSG (<span class="stringliteral">&quot;TLS handshake not complete&quot;</span>);                         \</div>
<div class="line">        RAISE_TLS_ERROR (exception);                                          \</div>
<div class="line">      }                                                                       \</div>
<div class="line">    SSL *_ssl = <a class="code hl_function" href="group__security.html#gac08c4201eb8ac29014cead5bf4a17adb">tls_socket_get_ssl</a> (socket);                                  \</div>
<div class="line">    if (!_ssl)                                                                \</div>
<div class="line">      {                                                                       \</div>
<div class="line">        TLS_ERROR_MSG (<span class="stringliteral">&quot;SSL object not available&quot;</span>);                           \</div>
<div class="line">        RAISE_TLS_ERROR (exception);                                          \</div>
<div class="line">      }                                                                       \</div>
<div class="line">    _ssl;                                                                     \</div>
<div class="line">  })</div>
<div class="ttc" id="agroup__security_html_gac08c4201eb8ac29014cead5bf4a17adb"><div class="ttname"><a href="group__security.html#gac08c4201eb8ac29014cead5bf4a17adb">tls_socket_get_ssl</a></div><div class="ttdeci">static SSL * tls_socket_get_ssl(Socket_T socket)</div><div class="ttdoc">tls_socket_get_ssl - Get SSL* from socket</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS-private_8h_source.html#l00273">SocketTLS-private.h:273</a></div></div>
</div><!-- fragment -->
<p>VALIDATE_TLS_IO_READY - Validate socket is ready for TLS I/O. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>Socket to validate </td></tr>
    <tr><td class="paramname">exception</td><td>Exception to raise on failure</td></tr>
  </table>
  </dd>
</dl>
<p>Performs comprehensive validation before TLS I/O operations:</p><ul>
<li>Checks that TLS is enabled on the socket</li>
<li>Verifies handshake is complete</li>
<li>Ensures SSL object is available</li>
</ul>
<p>Returns SSL* pointer on success for immediate use, raises exception on failure. Used by all TLS send/receive operations to ensure proper state.</p>
<dl class="section return"><dt>Returns</dt><dd>SSL* pointer for immediate use in TLS operations </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00233">233</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga63e73c93350813167a68162c5cb3d819" name="ga63e73c93350813167a68162c5cb3d819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga63e73c93350813167a68162c5cb3d819">&#9670;&#160;</a></span>SocketTLS_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="group__security.html#ga63e73c93350813167a68162c5cb3d819">SocketTLS_T</a>* <a class="el" href="group__security.html#ga63e73c93350813167a68162c5cb3d819">SocketTLS_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00352">352</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<a id="ga5c2914ee879d575869932c3a3aed4863" name="ga5c2914ee879d575869932c3a3aed4863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5c2914ee879d575869932c3a3aed4863">&#9670;&#160;</a></span>SocketTLSCertLookupCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef X509 *(* SocketTLSCertLookupCallback) (X509_STORE_CTX *store_ctx, X509_NAME *name, void *user_data)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Custom certificate lookup function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">store_ctx</td><td>OpenSSL store context for current verification </td></tr>
    <tr><td class="paramname">name</td><td>Subject name being looked up </td></tr>
    <tr><td class="paramname">user_data</td><td>User data from set_cert_lookup_callback</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>X509 certificate if found (caller takes ownership), NULL otherwise </dd></dl>
<dl class="section user"><dt>Thread Safety\n Must be thread-safe if context is shared</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLSContext_8h_source.html#l00747">747</a> of file <a class="el" href="SocketTLSContext_8h_source.html">SocketTLSContext.h</a>.</p>

</div>
</div>
<a id="ga60686895b6fbdd1290a6f6176484bf5b" name="ga60686895b6fbdd1290a6f6176484bf5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga60686895b6fbdd1290a6f6176484bf5b">&#9670;&#160;</a></span>SocketTLSCrlCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* SocketTLSCrlCallback) (<a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx, const char *path, int success, void *user_data)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CRL refresh notification callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context that was refreshed </td></tr>
    <tr><td class="paramname">path</td><td>Path to CRL file </td></tr>
    <tr><td class="paramname">success</td><td>1 if refresh succeeded, 0 if failed </td></tr>
    <tr><td class="paramname">user_data</td><td>User data from set_crl_auto_refresh</td></tr>
  </table>
  </dd>
</dl>
<p>Called after each refresh attempt. On failure, the old CRL remains in effect. Application should log failures and potentially alert. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLSContext_8h_source.html#l00529">529</a> of file <a class="el" href="SocketTLSContext_8h_source.html">SocketTLSContext.h</a>.</p>

</div>
</div>
<a id="ga1acd7a590114ffbf4307a6f5a3bab35c" name="ga1acd7a590114ffbf4307a6f5a3bab35c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1acd7a590114ffbf4307a6f5a3bab35c">&#9670;&#160;</a></span>SocketTLSOcspGenCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef OCSP_RESPONSE *(* SocketTLSOcspGenCallback) (SSL *ssl, void *arg)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>OCSP response generation callback for dynamic stapling on server-side TLS handshakes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl</td><td>OpenSSL SSL connection object during handshake. </td></tr>
    <tr><td class="paramname">arg</td><td>User-provided data from <a class="el" href="group__security.html#ga0b49040701aa37f11720d9539c046347" title="Register dynamic OCSP response generator.">SocketTLSContext_set_ocsp_gen_callback()</a>.</td></tr>
  </table>
  </dd>
</dl>
<p>This callback is invoked by OpenSSL during the TLS handshake when OCSP stapling is requested by the client (via status_request extension). It should generate and return a valid, DER-encoded OCSP response for the server's certificate, allowing the client to verify revocation status without additional round-trips.</p>
<p>Return a freshly allocated OCSP_RESPONSE* (OpenSSL takes ownership and frees it after use), or NULL on error (no stapling provided, client may fallback or fail based on policy).</p>
<p>Best practices:</p><ul>
<li>Use cached or freshly fetched OCSP from CA.</li>
<li>Ensure response is not expired (clients reject old responses).</li>
<li>Handle generation errors gracefully (log, return NULL).</li>
<li>For performance, pre-generate responses or use short-lived cache.</li>
<li>Support multiple certificates via SNI (check ssl-&gt;s3-&gt;tmp.cert or similar).</li>
</ul>
<p>Errors in generation do not abort handshake but may reduce security (no revocation check).</p>
<dl class="section return"><dt>Returns</dt><dd>OCSP_RESPONSE* (valid DER-encoded response, owned by OpenSSL) or NULL on failure. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td>- handle errors internally; use SocketLog for logging. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Conditional - must be reentrant/thread-safe if context shared</dt><dd>across threads.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga0b49040701aa37f11720d9539c046347" title="Register dynamic OCSP response generator.">SocketTLSContext_set_ocsp_gen_callback()</a> to register and enable this callback. </dd>
<dd>
<a class="el" href="group__security.html#gacad0c368922de598277e4237779504b7" title="Set static OCSP response for stapling.(server)">SocketTLSContext_set_ocsp_response()</a> for simpler static response configuration. </dd>
<dd>
<a class="el" href="group__security.html#gae1a1b2392cfa8dd68e636bbef9df443f" title="Get OCSP status after handshake (client).">SocketTLS_get_ocsp_status()</a> on client side to verify stapled response. </dd>
<dd>
<a class="el" href="group__security.html">Security Modules</a> for broader TLS <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> features including CRL and pinning. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#ocsp-stapling for setup and troubleshooting. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLSContext_8h_source.html#l00660">660</a> of file <a class="el" href="SocketTLSContext_8h_source.html">SocketTLSContext.h</a>.</p>

</div>
</div>
<a id="gac9a12208531822c8304c23dcbcb8ba97" name="gac9a12208531822c8304c23dcbcb8ba97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9a12208531822c8304c23dcbcb8ba97">&#9670;&#160;</a></span>SocketTLSVerifyCallback</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* SocketTLSVerifyCallback) (int preverify_ok, X509_STORE_CTX *x509_ctx, <a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> tls_ctx, Socket_T socket, void *user_data)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User-defined certificate verification callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">preverify_ok</td><td>OpenSSL pre-verification result (1=OK, 0=fail) </td></tr>
    <tr><td class="paramname">x509_ctx</td><td>OpenSSL certificate store context (access cert chain via X509_STORE_CTX_get_current_cert()) </td></tr>
    <tr><td class="paramname">tls_ctx</td><td>TLS context for shared configuration/data </td></tr>
    <tr><td class="paramname">socket</td><td>Associated socket for connection-specific info (e.g., hostname) </td></tr>
    <tr><td class="paramname">user_data</td><td>Opaque user data from SocketTLSContext_set_verify_callback</td></tr>
  </table>
  </dd>
</dl>
<p>Called during TLS verification to allow custom logic (e.g., pinning, policy checks). Return 1 to accept/continue verification, 0 to fail (aborts handshake). Can raise exceptions for detailed errors. </p>

<p class="definition">Definition at line <a class="el" href="SocketTLSContext_8h_source.html#l00400">400</a> of file <a class="el" href="SocketTLSContext_8h_source.html">SocketTLSContext.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga4d930163393a67950a5378e540c0e939" name="ga4d930163393a67950a5378e540c0e939"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4d930163393a67950a5378e540c0e939">&#9670;&#160;</a></span>CTValidationMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__security.html#ga4d930163393a67950a5378e540c0e939">CTValidationMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Certificate Transparency validation mode enumeration. </p>
<p>Controls how Certificate Transparency (RFC 6962) Signed Certificate Timestamps (SCTs) are validated during TLS handshake. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga4d930163393a67950a5378e540c0e939aea499abb40ae318f0fd2b596ce6cbaa8" name="gga4d930163393a67950a5378e540c0e939aea499abb40ae318f0fd2b596ce6cbaa8"></a>CT_VALIDATION_PERMISSIVE&#160;</td><td class="fielddoc"><p>Log missing SCTs but don't fail handshake </p>
</td></tr>
<tr><td class="fieldname"><a id="gga4d930163393a67950a5378e540c0e939a102a7857300a9c88684ed50efe69d3ab" name="gga4d930163393a67950a5378e540c0e939a102a7857300a9c88684ed50efe69d3ab"></a>CT_VALIDATION_STRICT&#160;</td><td class="fielddoc"><p>Require valid SCTs, fail handshake otherwise </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketTLSContext_8h_source.html#l01223">1223</a> of file <a class="el" href="SocketTLSContext_8h_source.html">SocketTLSContext.h</a>.</p>

</div>
</div>
<a id="ga8e83c28a6ad188b97243c4b237ee075a" name="ga8e83c28a6ad188b97243c4b237ee075a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8e83c28a6ad188b97243c4b237ee075a">&#9670;&#160;</a></span>DTLSHandshakeState</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>DTLS handshake progress states. </p>
<p>Enum values track the state of non-blocking DTLS handshakes for integration with event loops like SocketPoll. States DTLS_HANDSHAKE_WANT_READ and DTLS_HANDSHAKE_WANT_WRITE indicate the socket needs to be polled for the corresponding event before retrying the handshake.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c" title="Perform one step of the non-blocking DTLS handshake.">SocketDTLS_handshake()</a> </dd>
<dd>
<a class="el" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755" title="Blocking DTLS handshake with configurable timeout.">SocketDTLS_handshake_loop()</a> </dd>
<dd>
<a class="el" href="group__event__system.html">Event System Modules</a> for event loop integration. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga8e83c28a6ad188b97243c4b237ee075aac64c8906fdc9860f22cacc933593f01d" name="gga8e83c28a6ad188b97243c4b237ee075aac64c8906fdc9860f22cacc933593f01d"></a>DTLS_HANDSHAKE_NOT_STARTED&#160;</td><td class="fielddoc"><p>Handshake not yet initiated </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8e83c28a6ad188b97243c4b237ee075aad8f8ad815c25bf8e696b02a71795f66d" name="gga8e83c28a6ad188b97243c4b237ee075aad8f8ad815c25bf8e696b02a71795f66d"></a>DTLS_HANDSHAKE_IN_PROGRESS&#160;</td><td class="fielddoc"><p>Handshake in progress </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9" name="gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9"></a>DTLS_HANDSHAKE_WANT_READ&#160;</td><td class="fielddoc"><p>Need to read from socket </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8" name="gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8"></a>DTLS_HANDSHAKE_WANT_WRITE&#160;</td><td class="fielddoc"><p>Need to write to socket </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78" name="gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78"></a>DTLS_HANDSHAKE_COOKIE_EXCHANGE&#160;</td><td class="fielddoc"><p>Cookie exchange in progress </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5" name="gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5"></a>DTLS_HANDSHAKE_COMPLETE&#160;</td><td class="fielddoc"><p>Handshake completed successfully </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133" name="gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133"></a>DTLS_HANDSHAKE_ERROR&#160;</td><td class="fielddoc"><p>Handshake failed </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketDTLS_8h_source.html#l00199">199</a> of file <a class="el" href="SocketDTLS_8h_source.html">SocketDTLS.h</a>.</p>

</div>
</div>
<a id="gaca8f2a71ab649ccd408fd3fdb3b693b9" name="gaca8f2a71ab649ccd408fd3fdb3b693b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaca8f2a71ab649ccd408fd3fdb3b693b9">&#9670;&#160;</a></span>SocketSYN_Action</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Protection response actions for SYN connection attempts. </p>
<p>Enum values determine the handling strategy for incoming connections based on IP reputation, rate limiting, whitelist/blacklist status, and current load.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> returns the action for a given client IP. </dd>
<dd>
<a class="el" href="group__security.html#ga6be6d5871d5869421280eb62f3492ca3" title="Convert SYN action enum to human-readable string.">SocketSYNProtect_action_name()</a> for human-readable names. </dd>
<dd>
<a class="el" href="group__connection__mgmt.html#ga899c660b21bf96befd2b5ea9f6937988" title="Accept with full SYN flood protection.">SocketPool_accept_protected()</a> for integration with connection pools. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggaca8f2a71ab649ccd408fd3fdb3b693b9ab7af7c3605f188d109f9528dd72a7af8" name="ggaca8f2a71ab649ccd408fd3fdb3b693b9ab7af7c3605f188d109f9528dd72a7af8"></a>SYN_ACTION_ALLOW&#160;</td><td class="fielddoc"><p>Allow: Normal acceptance without restrictions. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaca8f2a71ab649ccd408fd3fdb3b693b9a57b3e54beba358c83e8a91f2136d61d9" name="ggaca8f2a71ab649ccd408fd3fdb3b693b9a57b3e54beba358c83e8a91f2136d61d9"></a>SYN_ACTION_THROTTLE&#160;</td><td class="fielddoc"><p>Throttle: Accept but introduce artificial delay to slow attacks. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaca8f2a71ab649ccd408fd3fdb3b693b9a47e6cde53adccac1b4948afbc22b16d1" name="ggaca8f2a71ab649ccd408fd3fdb3b693b9a47e6cde53adccac1b4948afbc22b16d1"></a>SYN_ACTION_CHALLENGE&#160;</td><td class="fielddoc"><p>Challenge: Apply TCP_DEFER_ACCEPT to require immediate data payload. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa" name="ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa"></a>SYN_ACTION_BLOCK&#160;</td><td class="fielddoc"><p>Block: Immediately reject the connection attempt. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect_8h_source.html#l00194">194</a> of file <a class="el" href="SocketSYNProtect_8h_source.html">SocketSYNProtect.h</a>.</p>

</div>
</div>
<a id="gad7b655dd229bc52cb32ec3cc1674d423" name="gad7b655dd229bc52cb32ec3cc1674d423"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad7b655dd229bc52cb32ec3cc1674d423">&#9670;&#160;</a></span>SocketSYN_Reputation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__security.html#gad7b655dd229bc52cb32ec3cc1674d423">SocketSYN_Reputation</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>IP reputation levels based on behavior history. </p>
<p>Reputation evolves dynamically based on connection success rates, attempt frequencies, and manual list status. Lower reputation triggers stricter actions.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> uses reputation to decide actions. </dd>
<dd>
<a class="el" href="group__security.html#gaaf2b0ff9a3054e262ba32b395c2abe50" title="Convert reputation enum to human-readable string.">SocketSYNProtect_reputation_name()</a> for string names. </dd>
<dd>
<a class="el" href="group__security.html#a3f543090a343b51bdf4e7930e182366d">SocketSYN_IPState::rep</a> for per-IP reputation storage. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggad7b655dd229bc52cb32ec3cc1674d423a3c7fc4e1a973261af722ef5a72067c34" name="ggad7b655dd229bc52cb32ec3cc1674d423a3c7fc4e1a973261af722ef5a72067c34"></a>SYN_REP_TRUSTED&#160;</td><td class="fielddoc"><p>Trusted: Whitelisted or consistently successful behavior. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad7b655dd229bc52cb32ec3cc1674d423a3af21cd252d430b04f39badf787d06a2" name="ggad7b655dd229bc52cb32ec3cc1674d423a3af21cd252d430b04f39badf787d06a2"></a>SYN_REP_NEUTRAL&#160;</td><td class="fielddoc"><p>Neutral: New or unknown IP with no suspicious activity. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad7b655dd229bc52cb32ec3cc1674d423ac0634349dad12cd7a8d2a74b9b7cf1be" name="ggad7b655dd229bc52cb32ec3cc1674d423ac0634349dad12cd7a8d2a74b9b7cf1be"></a>SYN_REP_SUSPECT&#160;</td><td class="fielddoc"><p>Suspect: Elevated attempt rates or low success ratio. </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad7b655dd229bc52cb32ec3cc1674d423a5f79b45826a9103f4f8346e74286ad9d" name="ggad7b655dd229bc52cb32ec3cc1674d423a5f79b45826a9103f4f8346e74286ad9d"></a>SYN_REP_HOSTILE&#160;</td><td class="fielddoc"><p>Hostile: Detected attack patterns, repeated failures, or blacklisted. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect_8h_source.html#l00216">216</a> of file <a class="el" href="SocketSYNProtect_8h_source.html">SocketSYNProtect.h</a>.</p>

</div>
</div>
<a id="gad092160c037d01929df1bb8d5b75b43c" name="gad092160c037d01929df1bb8d5b75b43c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad092160c037d01929df1bb8d5b75b43c">&#9670;&#160;</a></span>TLSHandshakeState</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>TLS handshake progress states for non-blocking and event-driven operations. </p>
<p>Enum values indicate the current phase and required action during the TLS handshake process. Used by <a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454" title="Perform non-blocking TLS handshake.">SocketTLS_handshake()</a> family to signal status in async environments. Facilitates correct polling: WANT_READ/WRITE states guide SocketPoll event masks. ERROR state triggers cleanup and exception raising. COMPLETE enables secure data transfer.</p>
<p>Directly corresponds to OpenSSL's internal handshake states and SSL_get_error() WANT_* codes. Typical sequence: NOT_STARTED  IN_PROGRESS  (WANT_* loops)  COMPLETE or ERROR.</p>
<h2><a class="anchor" id="autotoc_md555"></a>
State Table</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">State   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Recommended Action    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0   </td><td class="markdownTableBodyNone">NOT_STARTED   </td><td class="markdownTableBodyNone">No handshake initiated yet   </td><td class="markdownTableBodyNone">Invoke    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454" title="Perform non-blocking TLS handshake.">SocketTLS_handshake()</a> first time   </td><td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">1   </td><td class="markdownTableBodyNone">IN_PROGRESS   </td></tr>
</table>
<p>Handshake messages exchanging (crypto active) | Continue calling handshake in loop | | 2 | WANT_READ | Awaiting peer data (e.g., ServerHello, certs) | Poll for POLL_READ, then retry handshake | | 3 | WANT_WRITE | Ready to send data (e.g., ClientHello, keys) | Poll for POLL_WRITE, then retry handshake | | 4 | COMPLETE | Full auth + key exchange done; session secure | Transition to app I/O (send/recv TLS) | | 5 | ERROR | Irrecoverable failure (check tls_error_buf) | Raise exception, shutdown, close socket |</p>
<h2><a class="anchor" id="autotoc_md556"></a>
Async Event Loop Example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketPoll_8h.html">poll/SocketPoll.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketTLS_8h.html">tls/SocketTLS.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> handle_handshake(Socket_T sock, <a class="code hl_struct" href="group__poll__private.html#structSocketPoll__T">SocketPoll_T</a> poll, <span class="keywordtype">void</span></div>
<div class="line">*userdata) { <a class="code hl_enumeration" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a>(sock); <span class="keywordtype">unsigned</span></div>
<div class="line">events = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (state) {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a>:</div>
<div class="line">        <span class="comment">// Success: enable app events</span></div>
<div class="line">        <a class="code hl_function" href="group__event__system.html#ga3755cc4d5ed8838ce2261f0efd1d5d85">SocketPoll_mod</a>(poll, sock, <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a> | <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a> | <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a29422ea3bfa0fde21ed413e6f9d7b0d9">POLL_ERROR</a> |</div>
<div class="line">POLL_HUP, app_handler); <a class="code hl_define" href="SocketUtil_8h.html#a9fe70c7ab8b971af2971f3a102b82819">SOCKET_LOG_INFO_MSG</a>(<span class="stringliteral">&quot;TLS handshake complete for</span></div>
<div class="line"><span class="stringliteral">fd=%d&quot;</span>, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(sock)); <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2">TLS_HANDSHAKE_ERROR</a>:</div>
<div class="line">        <span class="comment">// Failure: log details, cleanup</span></div>
<div class="line">        <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;TLS handshake failed: %s&quot;</span>, <a class="code hl_variable" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a>);</div>
<div class="line">        <a class="code hl_function" href="group__security.html#gab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a>(sock);</div>
<div class="line">        Socket_close(sock);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a>:</div>
<div class="line">        events = <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a>:</div>
<div class="line">        events = <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>: <span class="comment">// IN_PROGRESS or NOT_STARTED</span></div>
<div class="line">        events = <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a> | <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a>; <span class="comment">// Continue monitoring</span></div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (events) {</div>
<div class="line">        <a class="code hl_function" href="group__event__system.html#ga3755cc4d5ed8838ce2261f0efd1d5d85">SocketPoll_mod</a>(poll, sock, events | <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a29422ea3bfa0fde21ed413e6f9d7b0d9">POLL_ERROR</a> | POLL_HUP,</div>
<div class="line">handle_handshake);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Usage: After SocketTLS_enable()</span></div>
<div class="line"><a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, sock, <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a> | <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a>, handle_handshake);</div>
<div class="ttc" id="aSocketPoll_8h_html"><div class="ttname"><a href="SocketPoll_8h.html">SocketPoll.h</a></div><div class="ttdoc">Cross-platform high-level interface for monitoring multiple sockets for I/O events.</div></div>
<div class="ttc" id="aSocketTLS_8h_html"><div class="ttname"><a href="SocketTLS_8h.html">SocketTLS.h</a></div><div class="ttdoc">High-level TLS/SSL integration for secure Socket I/O with TLS 1.3 enforcement.</div></div>
<div class="ttc" id="aSocketUtil_8h_html_a16642c35dec627aeb4976538671b1552"><div class="ttname"><a href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a></div><div class="ttdeci">#define SOCKET_LOG_ERROR_MSG(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00548">SocketUtil.h:548</a></div></div>
<div class="ttc" id="aSocketUtil_8h_html_a9fe70c7ab8b971af2971f3a102b82819"><div class="ttname"><a href="SocketUtil_8h.html#a9fe70c7ab8b971af2971f3a102b82819">SOCKET_LOG_INFO_MSG</a></div><div class="ttdeci">#define SOCKET_LOG_INFO_MSG(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00540">SocketUtil.h:540</a></div></div>
<div class="ttc" id="agroup__core__io_html_ga4d727948c677509eec04746585819877"><div class="ttname"><a href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a></div><div class="ttdeci">int Socket_fd(const Socket_T socket)</div><div class="ttdoc">Get underlying file descriptor.</div></div>
<div class="ttc" id="agroup__event__system_html_ga3755cc4d5ed8838ce2261f0efd1d5d85"><div class="ttname"><a href="group__event__system.html#ga3755cc4d5ed8838ce2261f0efd1d5d85">SocketPoll_mod</a></div><div class="ttdeci">void SocketPoll_mod(SocketPoll_T poll, Socket_T socket, unsigned events, void *data)</div><div class="ttdoc">Update event monitoring and/or user data for a registered socket.</div></div>
<div class="ttc" id="agroup__event__system_html_ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e"><div class="ttname"><a href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a></div><div class="ttdeci">void SocketPoll_add(SocketPoll_T poll, Socket_T socket, unsigned events, void *data)</div><div class="ttdoc">Register a socket for I/O event monitoring within the poll instance.</div></div>
<div class="ttc" id="agroup__event__system_html_gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8"><div class="ttname"><a href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a></div><div class="ttdeci">@ POLL_READ</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00181">SocketPoll.h:181</a></div></div>
<div class="ttc" id="agroup__event__system_html_gga9e8943c9cb47aba63dda4ad9083142b6a29422ea3bfa0fde21ed413e6f9d7b0d9"><div class="ttname"><a href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a29422ea3bfa0fde21ed413e6f9d7b0d9">POLL_ERROR</a></div><div class="ttdeci">@ POLL_ERROR</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00183">SocketPoll.h:183</a></div></div>
<div class="ttc" id="agroup__event__system_html_gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195"><div class="ttname"><a href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a></div><div class="ttdeci">@ POLL_WRITE</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00182">SocketPoll.h:182</a></div></div>
<div class="ttc" id="agroup__poll__private_html_structSocketPoll__T"><div class="ttname"><a href="group__poll__private.html#structSocketPoll__T">SocketPoll_T</a></div><div class="ttdoc">Opaque internal state structure for SocketPoll instance.</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll-private_8h_source.html#l00404">SocketPoll-private.h:405</a></div></div>
<div class="ttc" id="agroup__security_html_ga8ca0182ebb7a93df98871664989b949b"><div class="ttname"><a href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a></div><div class="ttdeci">char tls_error_buf[]</div><div class="ttdoc">Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.</div></div>
<div class="ttc" id="agroup__security_html_gab11506db6f41f31e9fc170b3d0e848f1"><div class="ttname"><a href="group__security.html#gab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a></div><div class="ttdeci">void SocketTLS_shutdown(Socket_T socket)</div><div class="ttdoc">Perform graceful TLS connection shutdown.</div></div>
<div class="ttc" id="agroup__security_html_gad092160c037d01929df1bb8d5b75b43c"><div class="ttname"><a href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a></div><div class="ttdeci">TLSHandshakeState</div><div class="ttdoc">TLS handshake progress states for non-blocking and event-driven operations.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00545">SocketTLS.h:546</a></div></div>
<div class="ttc" id="agroup__security_html_gaeaa77dd7852b535baf17b53ee2518454"><div class="ttname"><a href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a></div><div class="ttdeci">TLSHandshakeState SocketTLS_handshake(Socket_T socket)</div><div class="ttdoc">Perform non-blocking TLS handshake.</div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a></div><div class="ttdeci">@ TLS_HANDSHAKE_WANT_READ</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00549">SocketTLS.h:549</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a></div><div class="ttdeci">@ TLS_HANDSHAKE_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00551">SocketTLS.h:551</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2">TLS_HANDSHAKE_ERROR</a></div><div class="ttdeci">@ TLS_HANDSHAKE_ERROR</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00553">SocketTLS.h:552</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a></div><div class="ttdeci">@ TLS_HANDSHAKE_WANT_WRITE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00550">SocketTLS.h:550</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Loop until COMPLETE or ERROR; avoid busy-waiting by polling </dd>
<dd>
For blocking sockets, prefer <a class="el" href="group__security.html#ga54a01327e253586278c0f740c2764010" title="Complete handshake using socket&#39;s timeout config.">SocketTLS_handshake_auto()</a> wrapper </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Mismanaging WANT_* states causes hangs or infinite loops </dd>
<dd>
ERROR may leave partial keys; always shutdown + close immediately</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) per invocation; full handshake involves multiple crypto ops</dt><dd>(DH/ECDH, sig verify)</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454" title="Perform non-blocking TLS handshake.">SocketTLS_handshake()</a> - returns this enum per step </dd>
<dd>
<a class="el" href="group__security.html#ga439248f2ff7b87470520de0607569d06" title="Complete handshake with timeout (non-blocking)">SocketTLS_handshake_loop()</a> - automated loop with timeout </dd>
<dd>
<a class="el" href="group__security.html#ga54a01327e253586278c0f740c2764010" title="Complete handshake using socket&#39;s timeout config.">SocketTLS_handshake_auto()</a> - timeout from socket config </dd>
<dd>
<a class="el" href="group__event__system.html">Event System</a> for SocketPoll and async patterns </dd>
<dd>
<a class="el" href="group__event__system.html#ga3755cc4d5ed8838ce2261f0efd1d5d85" title="Update event monitoring and/or user data for a registered socket.">SocketPoll_mod()</a> - update events based on state </dd>
<dd>
<a class="el" href="ASYNC__IO_8md.html">docs/ASYNC_IO.md</a>#tls-handshake for advanced async TLS </dd>
<dd>
SSL_get_error() / SSL_state() in OpenSSL for low-level details </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2" name="ggad092160c037d01929df1bb8d5b75b43cae3a7df914ebdf339b8e7d711779670e2"></a>TLS_HANDSHAKE_NOT_STARTED&#160;</td><td class="fielddoc"><p>Initial state: handshake not initiated </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a" name="ggad092160c037d01929df1bb8d5b75b43ca445915a69a47e09546e8d5b275eedf2a"></a>TLS_HANDSHAKE_IN_PROGRESS&#160;</td><td class="fielddoc"><p>Active exchange of handshake messages </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592" name="ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592"></a>TLS_HANDSHAKE_WANT_READ&#160;</td><td class="fielddoc"><p>Blocked waiting for inbound TLS records </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac" name="ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac"></a>TLS_HANDSHAKE_WANT_WRITE&#160;</td><td class="fielddoc"><p>Blocked waiting to send TLS records </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce" name="ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce"></a>TLS_HANDSHAKE_COMPLETE&#160;</td><td class="fielddoc"><p>Successful completion; ready for app data </p>
</td></tr>
<tr><td class="fieldname"><a id="ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2" name="ggad092160c037d01929df1bb8d5b75b43caca78870a105a05fffb3d5d6ca022aff2"></a>TLS_HANDSHAKE_ERROR&#160;</td><td class="fielddoc"><p>Fatal error; abort connection </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00545">545</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<a id="gac32c3958835b92ff683ae15f78448694" name="gac32c3958835b92ff683ae15f78448694"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac32c3958835b92ff683ae15f78448694">&#9670;&#160;</a></span>TLSVerifyMode</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Peer certificate verification policies configurable for TLS contexts. </p>
<p>Specifies the level of certificate validation during TLS handshakes. Controls whether to request/require peer certs, perform chain validation against trusted CAs, and handle missing certs. Bit flags allow combinations (e.g., PEER | FAIL_IF_NO_PEER_CERT for mTLS). Defaults to PEER mode in client/server contexts for balanced security/performance. Directly maps to OpenSSL SSL_VERIFY_* constants for compatibility.</p>
<h2><a class="anchor" id="autotoc_md557"></a>
Mode Details &amp; Recommendations</h2>
<p>| Mode | Value | Requires Cert? | Validates Chain? | Fails No Cert? | Best For | |------------------------&mdash;|----&mdash;|-------------&mdash;|---------------&mdash;|-------------&mdash;|------------------------&mdash;| | TLS_VERIFY_NONE | 0x00 | No | No | No | Testing, internal proxies | | TLS_VERIFY_PEER | 0x01 | Yes (request) | Yes | No (warn) | Standard client/server | | TLS_VERIFY_FAIL_IF_NO_PEER_CERT | 0x02 | Yes (require) | Yes | Yes | Mutual TLS (mTLS) | | TLS_VERIFY_CLIENT_ONCE | 0x04 | Yes (once) | Yes (once) | Per config | Servers with resumption |</p>
<ul>
<li><b>NONE</b>: Bypasses all checks; vulnerable to MITM, spoofing - avoid in prod</li>
<li><b>PEER</b>: Requests cert, verifies if provided; allows anon for flexibility</li>
<li><b>FAIL_IF_NO_PEER_CERT</b>: Enforces cert provision; ideal for auth-heavy apps</li>
<li><b>CLIENT_ONCE</b>: Server opt - reuses prior verification on session resume (tickets)</li>
</ul>
<h2><a class="anchor" id="autotoc_md558"></a>
Server Configuration Example (mTLS)</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc">SocketTLSContext_new_server</a>(<span class="stringliteral">&quot;server.crt&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;server.key&quot;</span>, NULL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Require client certs with full validation</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga71084c00bec22f65b90301188868b759">SocketTLSContext_set_verify_mode</a>(ctx,</div>
<div class="line">    <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a> | <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">TLS_VERIFY_FAIL_IF_NO_PEER_CERT</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Load trusted client CAs</span></div>
<div class="line">SocketTLSContext_load_verify_locations(ctx, <span class="stringliteral">&quot;client-cas.pem&quot;</span>, NULL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Optional: depth limit (e.g., 2 for short chains)</span></div>
<div class="line">SocketTLSContext_set_verify_depth(ctx, 5);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Custom callback for revocation/pinning checks</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga2712efd6f1918aa87a3120547c0cf64d">SocketTLSContext_set_verify_callback</a>(ctx, verify_peer_cert, ctx);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Enable client cert request</span></div>
<div class="line">SocketTLSContext_set_client_ca_list(ctx, client_ca_list);</div>
<div class="ttc" id="agroup__security_html_ga2712efd6f1918aa87a3120547c0cf64d"><div class="ttname"><a href="group__security.html#ga2712efd6f1918aa87a3120547c0cf64d">SocketTLSContext_set_verify_callback</a></div><div class="ttdeci">void SocketTLSContext_set_verify_callback(SocketTLSContext_T ctx, SocketTLSVerifyCallback callback, void *user_data)</div><div class="ttdoc">Register custom verification callback.</div></div>
<div class="ttc" id="agroup__security_html_ga71084c00bec22f65b90301188868b759"><div class="ttname"><a href="group__security.html#ga71084c00bec22f65b90301188868b759">SocketTLSContext_set_verify_mode</a></div><div class="ttdeci">void SocketTLSContext_set_verify_mode(SocketTLSContext_T ctx, TLSVerifyMode mode)</div><div class="ttdoc">Set certificate verification policy.</div></div>
<div class="ttc" id="agroup__security_html_ga79a403f2f54f21c90a92e9cb73e24cbc"><div class="ttname"><a href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc">SocketTLSContext_new_server</a></div><div class="ttdeci">SocketTLSContext_T SocketTLSContext_new_server(const char *cert_file, const char *key_file, const char *ca_file)</div><div class="ttdoc">Create server TLS context with cert/key.</div></div>
<div class="ttc" id="agroup__security_html_ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d"><div class="ttname"><a href="group__security.html#ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">TLS_VERIFY_FAIL_IF_NO_PEER_CERT</a></div><div class="ttdeci">@ TLS_VERIFY_FAIL_IF_NO_PEER_CERT</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00661">SocketTLS.h:660</a></div></div>
<div class="ttc" id="agroup__security_html_ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe"><div class="ttname"><a href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a></div><div class="ttdeci">@ TLS_VERIFY_PEER</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00659">SocketTLS.h:659</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md559"></a>
Client Configuration Example</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a>(NULL); <span class="comment">// System CAs</span></div>
<div class="line"><span class="keywordflow">default</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Standard server verification</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga71084c00bec22f65b90301188868b759">SocketTLSContext_set_verify_mode</a>(ctx, <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Strict: fail if server provides no/ invalid cert</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga71084c00bec22f65b90301188868b759">SocketTLSContext_set_verify_mode</a>(ctx,</div>
<div class="line">    <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a> | <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d">TLS_VERIFY_FAIL_IF_NO_PEER_CERT</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Load additional CAs (e.g., enterprise)</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045">SocketTLSContext_load_ca</a>(ctx, <span class="stringliteral">&quot;/etc/ssl/custom-ca.pem&quot;</span>);</div>
<div class="ttc" id="agroup__security_html_ga7fe51da14439d768bdf72f4ed8fbb022"><div class="ttname"><a href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a></div><div class="ttdeci">SocketTLSContext_T SocketTLSContext_new_client(const char *ca_file)</div><div class="ttdoc">Create client TLS context.</div></div>
<div class="ttc" id="agroup__security_html_gac4de1881e05f041a3d5016cba7d5a045"><div class="ttname"><a href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045">SocketTLSContext_load_ca</a></div><div class="ttdeci">void SocketTLSContext_load_ca(SocketTLSContext_T ctx, const char *ca_file)</div><div class="ttdoc">Load trusted CA certificates.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md560"></a>
Advanced Considerations</h2>
<ul>
<li>Combine with SocketTLSContext_set_verify_depth() to limit chain length</li>
<li>Use custom verify callback for OCSP stapling, CRL checks, cert pinning</li>
<li>For session resumption, CLIENT_ONCE optimizes but requires secure tickets</li>
<li>Always log verification failures via tls_error_buf and <a class="el" href="group__security.html#ga4fd56e743762151aa449744a8d574164" title="Get peer certificate verification result.">SocketTLS_get_verify_result()</a></li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Default: TLS_VERIFY_PEER; override explicitly for custom policies </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>NONE exposes to active attacks; use TLS_VERIFY_PEER minimum in production </dd>
<dd>
FAIL_IF_NO_PEER_CERT breaks compat with non-cert peers (e.g., some CDNs) </dd>
<dd>
CLIENT_ONCE assumes secure resumption; vulnerable if tickets compromised</dd></dl>
<dl class="section user"><dt>Complexity\n O(chain length) for validation; cached in sessions</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga71084c00bec22f65b90301188868b759" title="Set certificate verification policy.">SocketTLSContext_set_verify_mode()</a> - set on context before enabling sockets </dd>
<dd>
<a class="el" href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045" title="Load trusted CA certificates.">SocketTLSContext_load_ca()</a> - populate trust store </dd>
<dd>
<a class="el" href="group__security.html#ga2712efd6f1918aa87a3120547c0cf64d" title="Register custom verification callback.">SocketTLSContext_set_verify_callback()</a> - hook for custom logic (e.g., hostname) </dd>
<dd>
SocketTLSContext_set_verify_depth() - chain validation limits </dd>
<dd>
<a class="el" href="group__security.html#gabe406e483a861198db5bca58300f1728" title="Peer certificate verification failure.">SocketTLS_VerifyFailed</a> - exception triggered on failures </dd>
<dd>
<a class="el" href="group__security.html#ga4fd56e743762151aa449744a8d574164" title="Get peer certificate verification result.">SocketTLS_get_verify_result()</a> - query result post-handshake </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#cert-validation for revocation, pinning guides </dd>
<dd>
X509_verify_cert() / SSL_CTX_set_verify() in OpenSSL docs </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="ggac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f" name="ggac32c3958835b92ff683ae15f78448694a0ada1cef646c3b57e9a793035dcc0a6f"></a>TLS_VERIFY_NONE&#160;</td><td class="fielddoc"><p>Disable all cert verification (INSECURE - testing only) </p>
</td></tr>
<tr><td class="fieldname"><a id="ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe" name="ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe"></a>TLS_VERIFY_PEER&#160;</td><td class="fielddoc"><p>Request and validate peer cert if provided </p>
</td></tr>
<tr><td class="fieldname"><a id="ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d" name="ggac32c3958835b92ff683ae15f78448694a29928ea4593855bb860f7a0bb8eb027d"></a>TLS_VERIFY_FAIL_IF_NO_PEER_CERT&#160;</td><td class="fielddoc"><p>Fail handshake if no peer cert presented </p>
</td></tr>
<tr><td class="fieldname"><a id="ggac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183" name="ggac32c3958835b92ff683ae15f78448694abbcde32e72faadf92044da1ccc76f183"></a>TLS_VERIFY_CLIENT_ONCE&#160;</td><td class="fielddoc"><p>Servers: verify client cert once per logical session </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketTLS_8h_source.html#l00655">655</a> of file <a class="el" href="SocketTLS_8h_source.html">SocketTLS.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga1e43ba6d103cbc8f43b748cf2ddf4b9a" name="ga1e43ba6d103cbc8f43b748cf2ddf4b9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e43ba6d103cbc8f43b748cf2ddf4b9a">&#9670;&#160;</a></span>ctx_alloc_and_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx_alloc_and_init </td>
          <td>(</td>
          <td class="paramtype">const SSL_METHOD *&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>is_server</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate and initialize a new <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">method</td><td>OpenSSL SSL_METHOD (e.g., TLS_server_method(), TLS_client_method()) </td></tr>
    <tr><td class="paramname">is_server</td><td>1 for server context, 0 for client context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> instance </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on allocation failure, OpenSSL errors, or invalid params</td></tr>
  </table>
  </dd>
</dl>
<p>Creates arena, sets up SSL_CTX with secure defaults, initializes internal state. Intended for internal use by SocketTLSContext_new*() functions.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc" title="Create server TLS context with cert/key.">SocketTLSContext_new_server()</a> for high-level server context creation </dd>
<dd>
<a class="el" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022" title="Create client TLS context.">SocketTLSContext_new_client()</a> for high-level client context creation </dd></dl>

</div>
</div>
<a id="ga9acf6c44e3887d6570aa5a3750a2b802" name="ga9acf6c44e3887d6570aa5a3750a2b802"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9acf6c44e3887d6570aa5a3750a2b802">&#9670;&#160;</a></span>ctx_arena_alloc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void * ctx_arena_alloc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>error_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Allocate memory from the TLS context's arena with exception handling. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context providing the memory arena. </td></tr>
    <tr><td class="paramname">size</td><td>Number of bytes to allocate. </td></tr>
    <tr><td class="paramname">error_msg</td><td>Context message for allocation failure exception. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to allocated memory block. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if Arena_alloc returns NULL.</td></tr>
  </table>
  </dd>
</dl>
<p>Allocates memory using the context's arena and raises an exception on failure with the specified error context. Centralizes allocation patterns in TLS code.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gac1dcd2082d3c29e557a920685766c44c" title="Duplicate a string into the TLS context&#39;s arena.">ctx_arena_strdup()</a> for string-specific allocation. </dd>
<dd>
<a class="el" href="group__foundation.html#gad93b1dd7d771cbed846dcc3c5c836917" title="Allocate raw memory block from the specified arena.">Arena_alloc()</a> underlying allocator with file/line tracking. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Conditional - safe if arena is thread-local or protected.</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l01016">1016</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketTLS-private_8h_source.html#l00741">SocketTLSContext_T::arena</a>, <a class="el" href="group__foundation.html#gad93b1dd7d771cbed846dcc3c5c836917">Arena_alloc()</a>, and <a class="el" href="group__security.html#ga88ff84e8a0b38713099d838de6404163">ctx_raise_openssl_error()</a>.</p>

</div>
</div>
<a id="gac1dcd2082d3c29e557a920685766c44c" name="gac1dcd2082d3c29e557a920685766c44c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac1dcd2082d3c29e557a920685766c44c">&#9670;&#160;</a></span>ctx_arena_strdup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static char * ctx_arena_strdup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>error_msg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Duplicate a string into the TLS context's arena. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context providing the memory arena. </td></tr>
    <tr><td class="paramname">str</td><td>Null-terminated C string to duplicate. </td></tr>
    <tr><td class="paramname">error_msg</td><td>Context message for allocation failure exception. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the duplicated string in the arena. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if Arena_alloc fails.</td></tr>
  </table>
  </dd>
</dl>
<p>Performs strlen + 1 allocation, copies the string, and handles allocation failure by raising an exception with the provided error context. Used to centralize arena-based string duplication in TLS context code.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga9acf6c44e3887d6570aa5a3750a2b802" title="Allocate memory from the TLS context&#39;s arena with exception handling.">ctx_arena_alloc()</a> for general-purpose allocation helper. </dd>
<dd>
<a class="el" href="group__foundation.html#gad93b1dd7d771cbed846dcc3c5c836917" title="Allocate raw memory block from the specified arena.">Arena_alloc()</a> underlying memory allocation. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Conditional - safe if arena is not concurrently modified.</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00985">985</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketTLS-private_8h_source.html#l00741">SocketTLSContext_T::arena</a>, <a class="el" href="group__foundation.html#gad93b1dd7d771cbed846dcc3c5c836917">Arena_alloc()</a>, and <a class="el" href="group__security.html#ga88ff84e8a0b38713099d838de6404163">ctx_raise_openssl_error()</a>.</p>

</div>
</div>
<a id="ga88ff84e8a0b38713099d838de6404163" name="ga88ff84e8a0b38713099d838de6404163"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga88ff84e8a0b38713099d838de6404163">&#9670;&#160;</a></span>ctx_raise_openssl_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ctx_raise_openssl_error </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Raise a SocketTLSContext exception from an OpenSSL error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>Descriptive context for the error (e.g., "SSL_CTX_new
failed").</td></tr>
  </table>
  </dd>
</dl>
<p>Formats the current OpenSSL error queue using tls_format_openssl_error and raises SocketTLSContext_Failed with the details in the thread-local exception. Clears the OpenSSL error queue after handling.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLSContext_Failed</td><td>Always raised with formatted OpenSSL error details. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga603f6b5acb264e31bf6a0f71d5b48be5" title="Format OpenSSL error into the thread-local error buffer.">tls_format_openssl_error()</a> for error message formatting. </dd>
<dd>
ERR_get_error() for accessing OpenSSL error queue. </dd></dl>

<p class="reference">Referenced by <a class="el" href="SocketTLS-private_8h_source.html#l01016">ctx_arena_alloc()</a>, and <a class="el" href="SocketTLS-private_8h_source.html#l00985">ctx_arena_strdup()</a>.</p>

</div>
</div>
<a id="gae23a324083d5bf71680d6fc525477a7a" name="gae23a324083d5bf71680d6fc525477a7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae23a324083d5bf71680d6fc525477a7a">&#9670;&#160;</a></span>dtls_context_get_from_ssl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> dtls_context_get_from_ssl </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>dtls_context_get_from_ssl - Get SocketDTLSContext from SSL object </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl</td><td>SSL object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Context pointer or NULL</dd></dl>
<p>Retrieves the SocketDTLSContext associated with an SSL object. Used internally by DTLS callbacks to access context-specific data. </p>

</div>
</div>
<a id="gae37473787004b0ea65d2ee0b51702f44" name="gae37473787004b0ea65d2ee0b51702f44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae37473787004b0ea65d2ee0b51702f44">&#9670;&#160;</a></span>dtls_cookie_generate_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int dtls_cookie_generate_cb </td>
          <td>(</td>
          <td class="paramtype">SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>cookie</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>cookie_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>OpenSSL callback for generating DTLS anti-DoS cookies during server handshake. </p>
<p>Implements the server-side cookie generation logic for DTLS cookie exchange protocol (RFC 6347 Section 4.2.1). Generates cryptographically secure, stateless cookies that bind to client IP/port, proving address ownership and mitigating resource exhaustion DoS attacks. Cookies force clients to demonstrate reachability before server allocates full handshake state.</p>
<p>Cookie computation: HMAC-SHA256(server_secret, peer_addr || peer_port || timestamp) truncated to SOCKET_DTLS_COOKIE_LEN (typically 32-64 bytes). Secret rotated periodically via context for forward secrecy and replay resistance. Timestamp ensures expiration.</p>
<p>This callback is registered with OpenSSL via SSL_CTX_set_cookie_generate_cb() and invoked automatically during ClientHello processing when cookies enabled.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ssl</td><td>Server SSL object in server context (DTLS role) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cookie</td><td>Buffer to write generated cookie bytes (size SOCKET_DTLS_COOKIE_LEN) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cookie_len</td><td>Set to actual bytes written (0-255 per OpenSSL spec)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on successful generation (cookie written, *cookie_len set); 0 on failure (e.g., RAND_bytes failure for nonce, HMAC error). On 0, OpenSSL aborts handshake.</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Server-only; clients ignore (OpenSSL calls only on server ctx with cookies).</li>
<li>Buffer cookie must be at least 255 bytes (OpenSSL max); uses exactly SOCKET_DTLS_COOKIE_LEN.</li>
<li>Fails silently if secret unavailable or crypto ops fail; logs via SocketLog if enabled.</li>
<li>Timestamp in cookie prevents replays beyond window; config via context timeouts.</li>
<li>Do not call directly; set via internal SocketDTLSContext setup.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Conditional - Accesses shared context cookie secret under mutex</dt><dd>lock. Safe for concurrent handshakes; internal locking prevents races on secret rotation.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// Internal setup in SocketDTLSContext_new_server() or enable_cookies()</span></div>
<div class="line">SSL_CTX_set_cookie_generate_cb(ctx, <a class="code hl_function" href="group__security.html#gae37473787004b0ea65d2ee0b51702f44">dtls_cookie_generate_cb</a>);</div>
<div class="line"><span class="comment">// Callback auto-invoked on ClientHello with cookies enabled</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Custom verification pairing</span></div>
<div class="line">SSL_CTX_set_cookie_verify_cb(ctx, <a class="code hl_function" href="SocketDTLS-private_8h.html#aa177905ba40634829622c877b4f79976">dtls_cookie_verify_cb</a>);</div>
<div class="ttc" id="aSocketDTLS-private_8h_html_aa177905ba40634829622c877b4f79976"><div class="ttname"><a href="SocketDTLS-private_8h.html#aa177905ba40634829622c877b4f79976">dtls_cookie_verify_cb</a></div><div class="ttdeci">int dtls_cookie_verify_cb(SSL *ssl, const unsigned char *cookie, unsigned int cookie_len)</div></div>
<div class="ttc" id="agroup__security_html_gae37473787004b0ea65d2ee0b51702f44"><div class="ttname"><a href="group__security.html#gae37473787004b0ea65d2ee0b51702f44">dtls_cookie_generate_cb</a></div><div class="ttdeci">int dtls_cookie_generate_cb(SSL *ssl, unsigned char *cookie, unsigned int *cookie_len)</div><div class="ttdoc">OpenSSL callback for generating DTLS anti-DoS cookies during server handshake.</div></div>
</div><!-- fragment --><p>Cookie Security Properties</p>
<ul>
<li><b>Stateless</b>: No per-client memory; scales to millions of SYNs</li>
<li><b>Unforgeable</b>: HMAC binds to secret unknown to attacker</li>
<li><b>Address-bound</b>: Proves client IP/port ownership via round-trip</li>
<li><b>Time-limited</b>: Timestamp expiration (configurable window)</li>
<li><b>Replay-resistant</b>: Secret rotation + timestamp</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Attack   </th><th class="markdownTableHeadNone">Mitigated?   </th><th class="markdownTableHeadNone">Mechanism    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SYN Flood   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">Stateless verification    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">IP Spoofing   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">Address binding in HMAC    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Replay   </td><td class="markdownTableBodyNone">Yes   </td><td class="markdownTableBodyNone">Timestamp + rotation    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">DoS Amplification   </td><td class="markdownTableBodyNone">Partial   </td><td class="markdownTableBodyNone">Limited cookie size   </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>Disable cookies in trusted networks to reduce latency (extra RTT). Ensure server secret strong (min 32 bytes random); rotate periodically. Monitor crypto failure rates (RAND_bytes/HMAC) for system resource issues.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Fixed HMAC computation, constant time crypto primitives.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketDTLS-private_8h.html#aa177905ba40634829622c877b4f79976">dtls_cookie_verify_cb()</a> paired verification callback </dd>
<dd>
<a class="el" href="SocketDTLS-private_8h.html#a0c2b10ddc94bfe7732fa86d17ae162da">dtls_generate_cookie_hmac()</a> low-level HMAC implementation </dd>
<dd>
<a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> public enable function </dd>
<dd>
SSL_CTX_set_cookie_generate_cb() OpenSSL registration </dd>
<dd>
docs/SYN-PROTECT.md for DoS protection integration </dd>
<dd>
RFC 6347#section-4.2.1 DTLS cookie exchange specification </dd>
<dd>
RFC 2104 HMAC algorithm used</dd></dl>
<p>OpenSSL callback for verifying client-provided DTLS cookies in server handshake.</p>
<p>Server-side verification of DTLS cookies sent by clients in response to HelloVerifyRequest (RFC 6347 Section 4.2.1). Recomputes expected cookie using current/previous server secrets and compares in constant time against provided cookie. Validates binding to client IP/port and checks timestamp for expiration. Supports secret rotation by trying active and previous secrets.</p>
<p>Constant-time HMAC comparison (via HMAC_CTX) prevents side-channel timing attacks that could reveal valid cookie patterns to attackers. On success, allows handshake progression; on failure, rejects with stateless error (no state allocated).</p>
<p>Registered via SSL_CTX_set_cookie_verify_cb(); invoked by OpenSSL on cookie receipt.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ssl</td><td>Server SSL object receiving the ClientHello with cookie </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cookie</td><td>Client-provided cookie bytes to verify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cookie_len</td><td>Length of cookie data (must match expected SOCKET_DTLS_COOKIE_LEN)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if cookie valid (matches recomputed value, current/prev secret, not expired, address bound); 0 if invalid (reject handshake, send new HelloVerifyRequest)</dd></dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Server-only callback; checks peer address via SSL_get_peer_addr() or equivalent.</li>
<li>Tries both current and previous secrets for rotation window tolerance.</li>
<li>Expiration based on timestamp in cookie vs current time (CLOCK_MONOTONIC).</li>
<li>On mismatch/expiry, client auto-retries with fresh cookie from generate_cb.</li>
<li>Logs verification stats/failures via SocketMetrics if enabled.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Conditional - Reads shared context secrets under mutex;</dt><dd>constant-time ops safe. Concurrent verifications protected by lock on secret access.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// Setup in context initialization</span></div>
<div class="line">SSL_CTX_set_cookie_verify_cb(ctx, <a class="code hl_function" href="SocketDTLS-private_8h.html#aa177905ba40634829622c877b4f79976">dtls_cookie_verify_cb</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Auto-called by OpenSSL:</span></div>
<div class="line"><span class="comment">// 1. Client sends ClientHello with cookie</span></div>
<div class="line"><span class="comment">// 2. OpenSSL calls this cb</span></div>
<div class="line"><span class="comment">// 3. On 1: Proceed to full handshake</span></div>
<div class="line"><span class="comment">//   On 0: Send HelloVerifyRequest + new cookie via generate_cb</span></div>
</div><!-- fragment --><p>Verification Steps</p>
<ol type="1">
<li>Extract addr/port/timestamp from cookie structure</li>
<li>Verify current peer addr matches embedded addr</li>
<li>Check timestamp not expired (context window)</li>
<li>Recompute HMAC with current secret; const-time compare</li>
<li>If fail, retry with previous secret</li>
<li>Success: return 1; fail: return 0</li>
</ol>
<dl class="section warning"><dt>Warning</dt><dd>Weak secrets or clock skew can weaken protection; use strong RAND_bytes(). Monitor reject rates for potential attacks or config issues. IPv6 support requires careful addr serialization in generate_cb.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Dual HMAC computations, constant-time compare regardless</dt><dd>of input.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gae37473787004b0ea65d2ee0b51702f44" title="OpenSSL callback for generating DTLS anti-DoS cookies during server handshake.">dtls_cookie_generate_cb()</a> paired generation callback </dd>
<dd>
<a class="el" href="SocketDTLS-private_8h.html#a0c2b10ddc94bfe7732fa86d17ae162da">dtls_generate_cookie_hmac()</a> core verification primitive </dd>
<dd>
<a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> to activate this mechanism </dd>
<dd>
SSL_CTX_set_cookie_verify_cb() OpenSSL setup </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a>-cookies for deployment guide </dd>
<dd>
RFC 6347#section-4.2.1 cookie verification protocol</dd></dl>
<p>Generate HMAC-SHA256 based DTLS cookie for address verification</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">secret</td><td>Server secret key for HMAC (SOCKET_DTLS_COOKIE_SECRET_LEN bytes) </td></tr>
    <tr><td class="paramname">peer_addr</td><td>Client socket address (struct sockaddr) </td></tr>
    <tr><td class="paramname">peer_len</td><td>Length of peer address structure </td></tr>
    <tr><td class="paramname">out_cookie</td><td>Output buffer for cookie (SOCKET_DTLS_COOKIE_LEN bytes) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure</dd></dl>
<p>Creates a cryptographically secure cookie using HMAC-SHA256: HMAC-SHA256(secret, client_addr || client_port || timestamp)</p>
<p>The cookie proves client address ownership and prevents spoofing attacks. Truncated to SOCKET_DTLS_COOKIE_LEN bytes for efficiency while maintaining security. Cookies have limited lifetime to prevent replay attacks.</p>
<p>Used internally by <a class="el" href="group__security.html#gae37473787004b0ea65d2ee0b51702f44" title="OpenSSL callback for generating DTLS anti-DoS cookies during server handshake.">dtls_cookie_generate_cb()</a> and exposed for testing. </p><dl class="section see"><dt>See also</dt><dd>RFC 6347 Section 4.2.1 for cookie exchange specification</dd></dl>
<p>Get SocketDTLSContext from SSL object.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl</td><td>SSL object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Context pointer or NULL dtls_cookie_generate_cb - OpenSSL cookie generation callback @ssl: SSL object @cookie: Output buffer for cookie @cookie_len: Output for cookie length</dd>
<dd>
1 on success, 0 on failure </dd></dl>

</div>
</div>
<a id="ga52868028efe42ac286ffdcad2e5f8a51" name="ga52868028efe42ac286ffdcad2e5f8a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga52868028efe42ac286ffdcad2e5f8a51">&#9670;&#160;</a></span>dtls_format_openssl_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void dtls_format_openssl_error </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Format and log the current OpenSSL error queue into thread-local error buffer. </p>
<p>Retrieves the top error from OpenSSL's error stack (ERR_get_error()), formats it into a human-readable string using ERR_error_string_n(), and stores it in the thread-local socket_error_buf with contextual information. Automatically clears the entire OpenSSL error queue via ERR_clear_error() to prevent error persistence across operations, which could lead to incorrect diagnostics or security leaks.</p>
<p>This helper is critical for consistent error reporting in DTLS operations, ensuring errors are captured immediately after failing SSL calls and integrated with the library's exception mechanism.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">context</td><td>Descriptive string providing operation context (e.g., "handshake failed") Prepended to the formatted error for better traceability. May be NULL, in which case a default message is used.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Uses thread-local socket_error_buf, making it safe for concurrent use across threads.</li>
<li>Clears ALL errors in the OpenSSL queue, not just the top one. This prevents error queue overflow and ensures fresh error reporting on next failure.</li>
<li>If no errors present (ERR_get_error() == 0), formats a generic "Unknown
error" message.</li>
<li>Integrates with <a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf" title="Raise a SocketDTLS module exception with automatically populated error details.">RAISE_DTLS_ERROR()</a> macros; call before raising exceptions for details.</li>
<li>Does not log or output; just formats into buffer for later use (e.g., in exception .reason).</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - Uses thread-local storage for buffer and operates on</dt><dd>OpenSSL's per-thread error queue (if compiled with thread support). No shared state modified.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// After a failing SSL operation</span></div>
<div class="line"><span class="keywordtype">int</span> ret = SSL_connect(ssl);</div>
<div class="line"><span class="keywordflow">if</span> (ret &lt;= 0) {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51">dtls_format_openssl_error</a>(<span class="stringliteral">&quot;DTLS client connect failed&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a>(<a class="code hl_variable" href="group__security.html#gadffbcee0cdd3e2ea80a6a03a73755085">SocketDTLS_HandshakeFailed</a>);</div>
<div class="line">    <span class="comment">// Exception now includes formatted OpenSSL error in .reason</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// In error handling after dtls_handle_ssl_error()</span></div>
<div class="line"><span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133">DTLS_HANDSHAKE_ERROR</a>) {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51">dtls_format_openssl_error</a>(<span class="stringliteral">&quot;Handshake error in do_handshake&quot;</span>);</div>
<div class="line">    <span class="comment">// Log or raise with details</span></div>
<div class="line">    <a class="code hl_enumvalue" href="group__foundation.html#ggadf209a9f107e88a5df277fcc3e2641d1a541aa883db8e38a0c52a2d7ccfb795b3">SOCKET_LOG_ERROR</a>(<span class="stringliteral">&quot;DTLS error: %s&quot;</span>, <a class="code hl_function" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a>());</div>
<div class="line">}</div>
<div class="ttc" id="agroup__foundation_html_gac71a25566cdc9e11eaecb16c966081db"><div class="ttname"><a href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a></div><div class="ttdeci">const char * Socket_GetLastError(void)</div><div class="ttdoc">Socket_GetLastError - Retrieve the most recent formatted error message.</div></div>
<div class="ttc" id="agroup__foundation_html_ggadf209a9f107e88a5df277fcc3e2641d1a541aa883db8e38a0c52a2d7ccfb795b3"><div class="ttname"><a href="group__foundation.html#ggadf209a9f107e88a5df277fcc3e2641d1a541aa883db8e38a0c52a2d7ccfb795b3">SOCKET_LOG_ERROR</a></div><div class="ttdeci">@ SOCKET_LOG_ERROR</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00056">SocketUtil.h:56</a></div></div>
<div class="ttc" id="agroup__security_html_gadffbcee0cdd3e2ea80a6a03a73755085"><div class="ttname"><a href="group__security.html#gadffbcee0cdd3e2ea80a6a03a73755085">SocketDTLS_HandshakeFailed</a></div><div class="ttdeci">const Except_T SocketDTLS_HandshakeFailed</div><div class="ttdoc">DTLS handshake failure.</div></div>
<div class="ttc" id="agroup__security_html_gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133"><div class="ttname"><a href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133">DTLS_HANDSHAKE_ERROR</a></div><div class="ttdeci">@ DTLS_HANDSHAKE_ERROR</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00208">SocketDTLS.h:207</a></div></div>
</div><!-- fragment --><p>Error Queue Management</p>
<ul>
<li><b>Before call</b>: OpenSSL error queue may contain multiple stacked errors from SSL ops.</li>
<li><b>During call</b>: Peeks top error, formats it, clears entire queue.</li>
<li><b>After call</b>: Queue empty, socket_error_buf populated with context + error string.</li>
</ul>
<dl class="section warning"><dt>Warning</dt><dd>Always call immediately after failing SSL calls to capture accurate errors, as subsequent SSL operations may overwrite or clear the queue. Failure to clear can lead to stale errors confusing diagnostics in multi-threaded or long-running apps.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) amortized - ERR_get_error() and formatting are constant</dt><dd>time; queue clear is O(queue depth) but depth bounded by OpenSSL limits (~16 errors).</dd></dl>
<dl class="section see"><dt>See also</dt><dd>ERR_get_error() - Underlying OpenSSL function for error retrieval </dd>
<dd>
ERR_error_string_n() - Formats error code to string </dd>
<dd>
ERR_clear_error() - Clears the error queue </dd>
<dd>
<a class="el" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db" title="Socket_GetLastError - Retrieve the most recent formatted error message.">Socket_GetLastError()</a> - Retrieves formatted error from thread-local buffer </dd>
<dd>
<a class="el" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf" title="Raise a SocketDTLS module exception with automatically populated error details.">RAISE_DTLS_ERROR()</a> - Use after formatting to raise detailed exception </dd>
<dd>
docs/ERROR_HANDLING.md for library-wide error patterns </dd>
<dd>
OpenSSL ERR documentation for error stack details </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00772">772</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketDTLSConfig_8h_source.html#l00308">SOCKET_DTLS_OPENSSL_ERRSTR_BUFSIZE</a>, and <a class="el" href="SocketUtil_8h_source.html#l01311">SOCKET_ERROR_MSG</a>.</p>

</div>
</div>
<a id="gaff7268760d38bc90af34fdbf313ecbb5" name="gaff7268760d38bc90af34fdbf313ecbb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaff7268760d38bc90af34fdbf313ecbb5">&#9670;&#160;</a></span>dtls_handle_ssl_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> dtls_handle_ssl_error </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ssl_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map OpenSSL error codes to DTLS handshake states for non-blocking I/O. </p>
<p>Handles the mapping between OpenSSL's error model and the library's DTLS state machine. This function is essential for event-driven DTLS handshakes, translating SSL_get_error() results into actionable states that drive polling behavior. It also updates the socket's handshake completion flag and sets errno appropriately for WANT_READ/WANT_WRITE cases.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The DTLS-enabled socket instance to update state on </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ssl</td><td>The SSL object on which the operation was performed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ssl_result</td><td>The return value from the SSL API call (e.g., SSL_do_handshake(), SSL_read())</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DTLSHandshakeState enum value indicating the next required action:<ul>
<li>DTLS_HANDSHAKE_COMPLETE: Success, handshake finished</li>
<li>DTLS_HANDSHAKE_WANT_READ: Poll for readability (errno set to EAGAIN)</li>
<li>DTLS_HANDSHAKE_WANT_WRITE: Poll for writability (errno set to EAGAIN)</li>
<li>DTLS_HANDSHAKE_ERROR: Fatal error occurred (errno or OpenSSL queue for details)</li>
<li>Other states unchanged</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is an internal helper called after every SSL operation during handshake. It does not clear OpenSSL error queue; caller may need to handle persistent errors. Updates socket-&gt;dtls_handshake_done = 1 only on SSL_ERROR_NONE.</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - modifies only per-socket state</dt><dd>(socket-&gt;dtls_handshake_done) and sets errno (thread-local). No shared resources or locks required.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// Typical usage in non-blocking DTLS handshake loop</span></div>
<div class="line">SSL *ssl = <a class="code hl_function" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd">dtls_socket_get_ssl</a>(socket);</div>
<div class="line"><span class="keywordflow">if</span> (!ssl) {</div>
<div class="line">    <span class="comment">// Handle invalid socket</span></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133">DTLS_HANDSHAKE_ERROR</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> ret = SSL_do_handshake(ssl);</div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#gaff7268760d38bc90af34fdbf313ecbb5">dtls_handle_ssl_error</a>(socket, ssl, ret);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">switch</span> (state) {</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5">DTLS_HANDSHAKE_COMPLETE</a>:</div>
<div class="line">      <a class="code hl_enumvalue" href="group__foundation.html#ggadf209a9f107e88a5df277fcc3e2641d1afcef44613645b3fd4a45bf5b4bfdbba7">SOCKET_LOG_DEBUG</a>(<span class="stringliteral">&quot;DTLS handshake completed&quot;</span>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9">DTLS_HANDSHAKE_WANT_READ</a>:</div>
<div class="line">      <span class="comment">// Add socket to read events in SocketPoll</span></div>
<div class="line">      <a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(socket), <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, userdata);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8">DTLS_HANDSHAKE_WANT_WRITE</a>:</div>
<div class="line">      <a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(socket), <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a>, userdata);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133">DTLS_HANDSHAKE_ERROR</a>:</div>
<div class="line">      <a class="code hl_function" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51">dtls_format_openssl_error</a>(<span class="stringliteral">&quot;DTLS handshake failed&quot;</span>);</div>
<div class="line">      <span class="comment">// Raise exception or close socket</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__foundation_html_ggadf209a9f107e88a5df277fcc3e2641d1afcef44613645b3fd4a45bf5b4bfdbba7"><div class="ttname"><a href="group__foundation.html#ggadf209a9f107e88a5df277fcc3e2641d1afcef44613645b3fd4a45bf5b4bfdbba7">SOCKET_LOG_DEBUG</a></div><div class="ttdeci">@ SOCKET_LOG_DEBUG</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00053">SocketUtil.h:53</a></div></div>
<div class="ttc" id="agroup__security_html_ga8e83c28a6ad188b97243c4b237ee075a"><div class="ttname"><a href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a></div><div class="ttdeci">DTLSHandshakeState</div><div class="ttdoc">DTLS handshake progress states.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00199">SocketDTLS.h:200</a></div></div>
<div class="ttc" id="agroup__security_html_gaff7268760d38bc90af34fdbf313ecbb5"><div class="ttname"><a href="group__security.html#gaff7268760d38bc90af34fdbf313ecbb5">dtls_handle_ssl_error</a></div><div class="ttdeci">static DTLSHandshakeState dtls_handle_ssl_error(SocketDgram_T socket, SSL *ssl, int ssl_result)</div><div class="ttdoc">Map OpenSSL error codes to DTLS handshake states for non-blocking I/O.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00663">SocketDTLS-private.h:663</a></div></div>
<div class="ttc" id="agroup__security_html_gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5"><div class="ttname"><a href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5">DTLS_HANDSHAKE_COMPLETE</a></div><div class="ttdeci">@ DTLS_HANDSHAKE_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00206">SocketDTLS.h:206</a></div></div>
<div class="ttc" id="agroup__security_html_gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9"><div class="ttname"><a href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9">DTLS_HANDSHAKE_WANT_READ</a></div><div class="ttdeci">@ DTLS_HANDSHAKE_WANT_READ</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00203">SocketDTLS.h:203</a></div></div>
<div class="ttc" id="agroup__security_html_gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8"><div class="ttname"><a href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8">DTLS_HANDSHAKE_WANT_WRITE</a></div><div class="ttdeci">@ DTLS_HANDSHAKE_WANT_WRITE</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00204">SocketDTLS.h:204</a></div></div>
</div><!-- fragment --><p>Error Mapping Details</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">SSL_get_error() Value   </th><th class="markdownTableHeadNone">Mapped State   </th><th class="markdownTableHeadNone">errno   </th><th class="markdownTableHeadNone">Notes    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SSL_ERROR_NONE   </td><td class="markdownTableBodyNone">COMPLETE   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone">Success    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SSL_ERROR_WANT_READ   </td><td class="markdownTableBodyNone">WANT_READ   </td><td class="markdownTableBodyNone">EAGAIN   </td><td class="markdownTableBodyNone">Continue polling    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SSL_ERROR_WANT_WRITE   </td><td class="markdownTableBodyNone">WANT_WRITE   </td><td class="markdownTableBodyNone">EAGAIN   </td><td class="markdownTableBodyNone">Continue polling    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SSL_ERROR_ZERO_RETURN   </td><td class="markdownTableBodyNone">ERROR   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone">Peer closed    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SSL_ERROR_WANT_CONNECT   </td><td class="markdownTableBodyNone">ERROR   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone">Unsupported in DTLS    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SSL_ERROR_WANT_ACCEPT   </td><td class="markdownTableBodyNone">ERROR   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone">Unsupported in DTLS    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SSL_ERROR_WANT_X509_METHOD   </td><td class="markdownTableBodyNone">ERROR   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone">Cert verify issue    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SSL_ERROR_SYSCALL   </td><td class="markdownTableBodyNone">ERROR   </td><td class="markdownTableBodyNone">Preserved   </td><td class="markdownTableBodyNone">System error    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SSL_ERROR_SSL   </td><td class="markdownTableBodyNone">ERROR   </td><td class="markdownTableBodyNone">None   </td><td class="markdownTableBodyNone">Protocol violation   </td></tr>
</table>
<dl class="section warning"><dt>Warning</dt><dd>In non-blocking mode, always pair SSL calls with this handler to avoid infinite loops or missed errors. Ignoring WANT_READ/WRITE leads to stalled handshakes.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Single switch statement on error code, constant time.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketDTLS_8h.html" title="Core DTLS API for secure UDP sockets.">SocketDTLS.h</a> for <a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a" title="DTLS handshake progress states.">DTLSHandshakeState</a> enum definition </dd>
<dd>
SSL_get_error() - Called internally to determine state </dd>
<dd>
<a class="el" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd" title="Retrieve the SSL object pointer associated with a DTLS-enabled socket.">dtls_socket_get_ssl()</a> - To obtain SSL* from socket </dd>
<dd>
<a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51" title="Format and log the current OpenSSL error queue into thread-local error buffer.">dtls_format_openssl_error()</a> - For formatting persistent errors </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a> for DTLS implementation details </dd>
<dd>
RFC 6347 Section 4 - DTLS Handshake Protocol </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00663">663</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketDTLS_8h_source.html#l00206">DTLS_HANDSHAKE_COMPLETE</a>, <a class="el" href="SocketDgram-private_8h_source.html#l00114">SocketDgram_T::dtls_handshake_done</a>, <a class="el" href="SocketDTLS_8h_source.html#l00207">DTLS_HANDSHAKE_ERROR</a>, <a class="el" href="SocketDTLS_8h_source.html#l00203">DTLS_HANDSHAKE_WANT_READ</a>, and <a class="el" href="SocketDTLS_8h_source.html#l00204">DTLS_HANDSHAKE_WANT_WRITE</a>.</p>

</div>
</div>
<a id="ga8d5647f2b71d9cd5c60e6a1c385854dd" name="ga8d5647f2b71d9cd5c60e6a1c385854dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d5647f2b71d9cd5c60e6a1c385854dd">&#9670;&#160;</a></span>dtls_socket_get_ssl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static SSL * dtls_socket_get_ssl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the SSL object pointer associated with a DTLS-enabled socket. </p>
<p>Provides safe access to the underlying OpenSSL SSL structure for DTLS operations. Performs validation checks before returning the pointer, ensuring DTLS is enabled and the SSL object exists. This helper is used extensively in DTLS I/O and handshake functions to avoid repeated null checks and enablement verifications.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The socket instance to query (may be NULL or non-DTLS)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SSL* pointer to the DTLS SSL context if available and valid; NULL otherwise. Returns NULL in cases:<ul>
<li>socket == NULL</li>
<li>!socket-&gt;dtls_enabled</li>
<li>socket-&gt;dtls_ssl == NULL</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is a read-only accessor; does not perform any I/O or state changes. No exceptions raised; simply returns NULL on invalid state. Callers should check return value before using SSL APIs. The returned SSL* remains owned by the socket; do not free it directly.</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - purely read-only access to socket fields. No locks or</dt><dd>modifications. Safe to call from any thread holding a reference to the socket.</dd></dl>
<p>Usage Example</p>
<div class="fragment"><div class="line"><span class="comment">// Safe SSL access for DTLS operations</span></div>
<div class="line">SSL *ssl = <a class="code hl_function" href="group__security.html#ga8d5647f2b71d9cd5c60e6a1c385854dd">dtls_socket_get_ssl</a>(dtls_socket);</div>
<div class="line"><span class="keywordflow">if</span> (ssl) {</div>
<div class="line">    <span class="comment">// Perform SSL operations, e.g., SSL_pending(ssl)</span></div>
<div class="line">    <span class="keywordtype">int</span> pending = SSL_pending(ssl);</div>
<div class="line">    <span class="comment">// Or use in error handling</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="group__security.html#ga1cfa464ec20b460ebee063b82b6100bf">RAISE_DTLS_ERROR</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>, <span class="stringliteral">&quot;No SSL context available&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Validation Performed</p>
<ul>
<li>Null pointer check on socket</li>
<li>Check socket-&gt;dtls_enabled flag</li>
<li>Check socket-&gt;dtls_ssl pointer validity</li>
</ul>
<dl class="section user"><dt>Complexity\n O(1) - Simple pointer and flag checks, no loops or allocations.</dt><dd></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Never assume returned SSL* is valid without checking; invalid access leads to crashes or security vulnerabilities. Always pair with if (ssl) { ... }</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga223a7b4bdc35b2cd8c8828e3fd709414" title="Comprehensive validation macro for DTLS socket readiness before I/O operations.">VALIDATE_DTLS_IO_READY()</a> macro which uses this helper plus additional checks </dd>
<dd>
<a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> to initialize DTLS on socket and create SSL* </dd>
<dd>
<a class="el" href="group__security.html#gaff7268760d38bc90af34fdbf313ecbb5" title="Map OpenSSL error codes to DTLS handshake states for non-blocking I/O.">dtls_handle_ssl_error()</a> for handling operations on the SSL* </dd>
<dd>
docs/TLS.md for DTLS socket lifecycle </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00559">559</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketDgram-private_8h_source.html#l00102">SocketDgram_T::dtls_enabled</a>, and <a class="el" href="SocketDgram-private_8h_source.html#l00090">SocketDgram_T::dtls_ssl</a>.</p>

</div>
</div>
<a id="ga43a9d75df4015935d50b33c528342d80" name="ga43a9d75df4015935d50b33c528342d80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga43a9d75df4015935d50b33c528342d80">&#9670;&#160;</a></span>dtls_validate_file_path()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int dtls_validate_file_path </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform security validation on file path strings for cert/key/CA loading. </p>
<p>String-based validation of file paths used in DTLS context configuration (certificates, keys, CA bundles). Designed to mitigate common path manipulation attacks like directory traversal, injection of control characters, and truncation exploits. Rejects obviously malicious or malformed paths before they reach OpenSSL file loading APIs, which may be vulnerable to such inputs.</p>
<p>Validation criteria (all must pass):</p><ul>
<li>Path non-NULL and non-empty</li>
<li>Length &lt;= SOCKET_DTLS_MAX_PATH_LEN (typically 4096)</li>
<li>No path traversal sequences: "../", "..\\", "/..", "\..", standalone ".."
- No control characters (ASCII &lt;32 or ==127, except '/' for paths)
- Implicitly rejects embedded NUL via strlen() limit

Note: This is syntactic validation only; does not access filesystem.
For full security, pair with OS-level checks (e.g., realpath(), access())
and run as low-privilege user. Relative paths accepted but prefer absolute
for predictability.

@param [in] path Null-terminated C string containing the file path to
validate

@return 1 if path passes all security checks (safe to use); 0 if rejected
(invalid/malicious)

@note
- Rejects relative paths with traversal but accepts clean relative paths
(e.g., "cert.pem").
- Case-sensitive matching for traversal sequences.
- Does not validate actual file existence, type, or permissions; use
stat()/access() separately.
- Configurable via SOCKET_DTLS_MAX_PATH_LEN; adjust for platform limits.
- In code, uses strstr() for traversal detection (simple but effective for
common attacks).

\par Thread Safety\n Yes - Pure string operations, no shared state or allocations.
Reentrant and safe from signal handlers.

 Usage Example

@code{.c} 
// In config loading
if (!dtls_validate_file_path(cert_path)) {
    RAISE_DTLS_ERROR_MSG(SocketDTLSConfig_InvalidCert, "Invalid cert path: s", cert_path);
}
// Safe to pass to SSL_CTX_use_certificate_file()
if (SSL_CTX_use_certificate_file(ctx, cert_path, SSL_FILETYPE_PEM) &lt;= 0) {
    dtls_format_openssl_error("Cert load failed");
    RAISE_DTLS_ERROR(SocketDTLSConfig_InvalidCert);
}

// Batch validation
const char *files[] = {cert_path, key_path, ca_path};
for (int i = 0; i &lt; 3; i++) {
    if (!dtls_validate_file_path(files[i])) {
        RAISE_DTLS_ERROR_MSG(SocketDTLSConfig_InvalidPath, "Invalid file path[d]: s", i, files[i]);
    }
}
@endcode

 Rejection Reasons Table

&lt;table class="markdownTable"&gt;
  &lt;tr class="markdownTableHead"&gt;    &lt;th class="markdownTableHeadNone"&gt; Condition   </li>
</ul>
<p>Reason   </p>
<p>Example Rejected Paths    </p>
<p>Empty/NULL   </p>
<p>Invalid length   </p>
<p>"", NULL, ""    </p>
<p>Too long   </p>
<p>Exceeds max   </p>
<p>String &gt;4096 chars    </p>
<p>Traversal   </p>
<p>Path escape attempt   </p>
<p>"../etc/passwd", "/../../",   </p>
<p>"..\..\windows" | | Control chars | Injection attempt | "cert\0malicious", paths with <br  />
 or \0 |</p>
<dl class="section warning"><dt>Warning</dt><dd>String validation alone insufficient against all attacks; combine with:<ul>
<li>Sandboxing/chroot for file access</li>
<li>Absolute paths from trusted sources</li>
<li>File permissions (644 for certs, 600 for keys)</li>
<li>Avoid user-controlled paths in production</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) where n=path length - strstr() and loop scans, linear time.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd>SocketDTLSContext_set_cert_file() public API using this validation </dd>
<dd>
<a class="el" href="group__security.html#ga52868028efe42ac286ffdcad2e5f8a51" title="Format and log the current OpenSSL error queue into thread-local error buffer.">dtls_format_openssl_error()</a> for handling OpenSSL load failures post-validation </dd>
<dd>
realpath(3) for canonicalizing paths (additional defense) </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#file-path-validation for rationale and extensions </dd>
<dd>
OpenSSL SSL_CTX_use_certificate_file() consumer of validated paths </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDTLS-private_8h_source.html#l00888">888</a> of file <a class="el" href="SocketDTLS-private_8h_source.html">SocketDTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketDTLSConfig_8h_source.html#l00333">SOCKET_DTLS_MAX_PATH_LEN</a>.</p>

</div>
</div>
<a id="gad2f26460b23a711e0fa74605371cf127" name="gad2f26460b23a711e0fa74605371cf127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad2f26460b23a711e0fa74605371cf127">&#9670;&#160;</a></span>SocketDTLS_enable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLS_enable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable DTLS encryption on a datagram socket. </p>
<p>Enables DTLS on the specified datagram socket using the provided context. The socket should be connected (clients) or bound (servers) prior to calling. Associates an SSL object with the socket and initializes DTLS-specific state. This function consumes the reference to the context; it will be freed when the socket is freed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The datagram socket instance (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The DTLS context to use for this connection (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>if enabling fails (e.g., already enabled, invalid socket or context).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - directly modifies socket internal state.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - single SSL object creation and initialization.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md500"></a>
Usage Example</h2>
<h3><a class="anchor" id="autotoc_md501"></a>
Client Setup</h3>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">  <a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line">  <a class="code hl_function" href="group__socket__dgram.html#gabcb18c16142d3b5ef49bee08a96e15fa">SocketDgram_connect</a>(socket, <span class="stringliteral">&quot;example.com&quot;</span>, 4433);  <span class="comment">// Connect to DTLS</span></div>
<div class="line">server</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a>(NULL);</div>
<div class="line">  <a class="code hl_function" href="group__dtls__context.html#ga167f13bc2d88dd59da040a6423cbb741">SocketDTLSContext_set_verify_mode</a>(ctx, SOCKET_DTLS_VERIFY_PEER);</div>
<div class="line">  <a class="code hl_function" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3">SocketDTLS_set_hostname</a>(socket, <span class="stringliteral">&quot;example.com&quot;</span>);  <span class="comment">// For SNI and</span></div>
<div class="line">verification</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(socket, ctx);  <span class="comment">// Enable DTLS, ctx now owned by socket</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Proceed to handshake...</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">  <span class="comment">// Handle error</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__dtls__context_html_ga167f13bc2d88dd59da040a6423cbb741"><div class="ttname"><a href="group__dtls__context.html#ga167f13bc2d88dd59da040a6423cbb741">SocketDTLSContext_set_verify_mode</a></div><div class="ttdeci">void SocketDTLSContext_set_verify_mode(SocketDTLSContext_T ctx, TLSVerifyMode mode)</div><div class="ttdoc">Set certificate verification policy.</div></div>
<div class="ttc" id="agroup__dtls__context_html_gafa2f96caa6d90a1fae0ce4f8fb52970a"><div class="ttname"><a href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a></div><div class="ttdeci">SocketDTLSContext_T SocketDTLSContext_new_client(const char *ca_file)</div><div class="ttdoc">Create a client-side DTLS context with optional CA for server verification.</div></div>
<div class="ttc" id="agroup__security_html_gabf3857e3cea92190f4c6eca7a8418be3"><div class="ttname"><a href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3">SocketDTLS_set_hostname</a></div><div class="ttdeci">void SocketDTLS_set_hostname(SocketDgram_T socket, const char *hostname)</div><div class="ttdoc">Set SNI hostname for client DTLS connections.</div></div>
<div class="ttc" id="agroup__security_html_gad2f26460b23a711e0fa74605371cf127"><div class="ttname"><a href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a></div><div class="ttdeci">void SocketDTLS_enable(SocketDgram_T socket, SocketDTLSContext_T ctx)</div><div class="ttdoc">Enable DTLS encryption on a datagram socket.</div></div>
<div class="ttc" id="agroup__security_html_structSocketDTLSContext__T"><div class="ttname"><a href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a></div><div class="ttdoc">SocketDTLSContext_T - DTLS Context Structure.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00984">SocketDTLS-private.h:985</a></div></div>
<div class="ttc" id="agroup__socket__dgram_html_gabcb18c16142d3b5ef49bee08a96e15fa"><div class="ttname"><a href="group__socket__dgram.html#gabcb18c16142d3b5ef49bee08a96e15fa">SocketDgram_connect</a></div><div class="ttdeci">void SocketDgram_connect(SocketDgram_T socket, const char *host, int port)</div><div class="ttdoc">Set default destination for socket.</div></div>
<div class="ttc" id="agroup__socket__dgram_html_gad6902c87ab5883f155dab2adfa950c52"><div class="ttname"><a href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a></div><div class="ttdeci">SocketDgram_T SocketDgram_new(int domain, int protocol)</div><div class="ttdoc">Create a new UDP/datagram socket with specified domain and protocol.</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md502"></a>
Server Setup</h3>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">  <a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line">  <a class="code hl_function" href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind</a>(socket, NULL, 4433);  <span class="comment">// Bind to port</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *cert = <span class="stringliteral">&quot;server.crt&quot;</span>, *key = <span class="stringliteral">&quot;server.key&quot;</span>;</div>
<div class="line">  <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(cert, key, NULL);</div>
<div class="line">  <a class="code hl_function" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a>(ctx);  <span class="comment">// Optional DoS protection</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(socket, ctx);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Now accept incoming handshakes via SocketDTLS_listen() or poll loop</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">  <span class="comment">// Handle error</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__dtls__context_html_ga0e99fc1644e610eb26324fb12cb96a57"><div class="ttname"><a href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a></div><div class="ttdeci">SocketDTLSContext_T SocketDTLSContext_new_server(const char *cert_file, const char *key_file, const char *ca_file)</div><div class="ttdoc">Create a server-side DTLS context with certificate and key loading.</div></div>
<div class="ttc" id="agroup__dtls__context_html_gabbffd63c9a5c7551ecaf8f89a4034eb4"><div class="ttname"><a href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a></div><div class="ttdeci">void SocketDTLSContext_enable_cookie_exchange(SocketDTLSContext_T ctx)</div><div class="ttdoc">Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.</div></div>
<div class="ttc" id="agroup__socket__dgram_html_ga0c81d9ef1d90e7ab34dd7286f13878ee"><div class="ttname"><a href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind</a></div><div class="ttdeci">void SocketDgram_bind(SocketDgram_T socket, const char *host, int port)</div><div class="ttdoc">Bind a datagram socket to a local IP address and port.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Call after <a class="el" href="group__socket__dgram.html#gabcb18c16142d3b5ef49bee08a96e15fa">SocketDgram_connect()</a> (client) or <a class="el" href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind()</a> (server), but before any DTLS I/O operations. Handshake is separate via <a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake()</a>. The context is now owned by the socket and will be cleaned up automatically.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Enabling DTLS on an already-enabled socket will raise SocketDTLS_Failed. Do not free the context after enabling; it's managed by the socket.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a" title="Create a client-side DTLS context with optional CA for server verification.">SocketDTLSContext_new_client()</a> </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> </dd>
<dd>
<a class="el" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983" title="Dispose of a DTLS context, freeing all associated resources.">SocketDTLSContext_free()</a> - not needed after enable </dd>
<dd>
<a class="el" href="group__core__io.html">Core I/O</a> for socket primitives. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> for TLS configuration guidelines. </dd>
<dd>
<a class="el" href="ASYNC__IO_8md.html">docs/ASYNC_IO.md</a> for non-blocking integration. </dd></dl>

</div>
</div>
<a id="gae91ad38ad7d4a00961f342e3366d7097" name="gae91ad38ad7d4a00961f342e3366d7097"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae91ad38ad7d4a00961f342e3366d7097">&#9670;&#160;</a></span>SocketDTLS_get_alpn_selected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketDTLS_get_alpn_selected </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the negotiated ALPN protocol. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>Datagram socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the ALPN protocol negotiated during handshake.</p>
<dl class="section return"><dt>Returns</dt><dd>Protocol string, or NULL if none negotiated </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - reads immutable post-handshake state</dt><dd></dd></dl>

</div>
</div>
<a id="ga12039ba9c9513fbf9df6e02f997d09ab" name="ga12039ba9c9513fbf9df6e02f997d09ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga12039ba9c9513fbf9df6e02f997d09ab">&#9670;&#160;</a></span>SocketDTLS_get_cipher()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketDTLS_get_cipher </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get name of negotiated cipher suite. </p>
<p>Returns human-readable name of the symmetric cipher suite agreed upon during handshake (e.g., "TLS_AES_256_GCM_SHA384" for DTLS 1.3). Post-handshake only.</p>
<p>Useful for logging, debugging, and security auditing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The datagram socket with completed handshake (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Const null-terminated string (do not free), or NULL pre-handshake/unavailable.</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - reads immutable negotiated parameters.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md520"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#gae702a60aae194a098bdc6af32549f1ae">SocketDTLS_is_handshake_done</a>(socket)) {</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *cipher = <a class="code hl_function" href="group__security.html#ga12039ba9c9513fbf9df6e02f997d09ab">SocketDTLS_get_cipher</a>(socket);</div>
<div class="line">  <span class="keywordflow">if</span> (cipher) {</div>
<div class="line">    <a class="code hl_define" href="SocketUtil_8h.html#a9fe70c7ab8b971af2971f3a102b82819">SOCKET_LOG_INFO_MSG</a>(<span class="stringliteral">&quot;DTLS cipher: %s&quot;</span>, cipher);</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Audit or select protocol features based on cipher strength</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga12039ba9c9513fbf9df6e02f997d09ab"><div class="ttname"><a href="group__security.html#ga12039ba9c9513fbf9df6e02f997d09ab">SocketDTLS_get_cipher</a></div><div class="ttdeci">const char * SocketDTLS_get_cipher(SocketDgram_T socket)</div><div class="ttdoc">Get name of negotiated cipher suite.</div></div>
<div class="ttc" id="agroup__security_html_gae702a60aae194a098bdc6af32549f1ae"><div class="ttname"><a href="group__security.html#gae702a60aae194a098bdc6af32549f1ae">SocketDTLS_is_handshake_done</a></div><div class="ttdeci">int SocketDTLS_is_handshake_done(SocketDgram_T socket)</div><div class="ttdoc">Check if DTLS handshake is complete.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>String owned by SSL library; valid until shutdown/free. Common values: AES-GCM for modern secure, ChaCha20-Poly for mobile efficiency. Check against SocketDTLSContext_set_ciphers() for configured suites.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga4651d3701fdc086051bc90cecb79b11e" title="Get negotiated DTLS protocol version.">SocketDTLS_get_version()</a> for protocol version </dd>
<dd>
SocketDTLSContext_set_ciphers() for configuration </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#ciphersuites for <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> recommendations. </dd></dl>

</div>
</div>
<a id="ga42abbf654fe23dd417b2115dc00590db" name="ga42abbf654fe23dd417b2115dc00590db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42abbf654fe23dd417b2115dc00590db">&#9670;&#160;</a></span>SocketDTLS_get_last_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> SocketDTLS_get_last_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get last handshake state. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Last DTLSHandshakeState value </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="ga7752aae6c38da47f187f8d766b4ae12e" name="ga7752aae6c38da47f187f8d766b4ae12e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7752aae6c38da47f187f8d766b4ae12e">&#9670;&#160;</a></span>SocketDTLS_get_mtu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SocketDTLS_get_mtu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current effective MTU. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the MTU being used for DTLS record sizing.</p>
<dl class="section return"><dt>Returns</dt><dd>MTU in bytes </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="gad0e45780e041b9ddb58956d9f0fb20d1" name="gad0e45780e041b9ddb58956d9f0fb20d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad0e45780e041b9ddb58956d9f0fb20d1">&#9670;&#160;</a></span>SocketDTLS_get_verify_result()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long SocketDTLS_get_verify_result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get peer certificate verification result. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Returns OpenSSL's X509 verify result code. 0 (X509_V_OK) indicates successful verification.</p>
<dl class="section return"><dt>Returns</dt><dd>long verify result code </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only post-handshake)</dt><dd></dd></dl>

</div>
</div>
<a id="ga4651d3701fdc086051bc90cecb79b11e" name="ga4651d3701fdc086051bc90cecb79b11e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4651d3701fdc086051bc90cecb79b11e">&#9670;&#160;</a></span>SocketDTLS_get_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketDTLS_get_version </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get negotiated DTLS protocol version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the DTLS protocol version string (e.g., "DTLSv1.2").</p>
<dl class="section return"><dt>Returns</dt><dd>Const string with version, or NULL if unavailable </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="ga17e8bd79af2c5a20b5dbb9e8dff6f84c" name="ga17e8bd79af2c5a20b5dbb9e8dff6f84c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">&#9670;&#160;</a></span>SocketDTLS_handshake()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> SocketDTLS_handshake </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform one step of the non-blocking DTLS handshake. </p>
<p>Advances the DTLS handshake state machine by processing incoming packets and sending handshake messages as needed. Designed for integration with event loops like SocketPoll. Returns intermediate states to allow polling the socket for required I/O before retrying.</p>
<p>Supports both client and server roles, including cookie exchange for DoS protection on servers. Call in a loop until DTLS_HANDSHAKE_COMPLETE or error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">socket</td><td>The datagram socket instance with DTLS enabled and peer set (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DTLSHandshakeState:<ul>
<li>DTLS_HANDSHAKE_COMPLETE: Success, ready for I/O</li>
<li>DTLS_HANDSHAKE_WANT_READ: Poll for POLL_READ and retry</li>
<li>DTLS_HANDSHAKE_WANT_WRITE: Poll for POLL_WRITE and retry</li>
<li>DTLS_HANDSHAKE_COOKIE_EXCHANGE: Server waiting for client cookie response</li>
<li>DTLS_HANDSHAKE_ERROR: Fatal error (check errno or SocketDTLS_get_verify_result)</li>
</ul>
</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_HandshakeFailed</td><td>on protocol errors, version mismatch, or crypto failures. </td></tr>
    <tr><td class="paramname">SocketDTLS_VerifyFailed</td><td>if certificate verification fails (clients). </td></tr>
    <tr><td class="paramname">SocketDTLS_CookieFailed</td><td>on server cookie generation/verification issues.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - advances shared SSL handshake state.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(n) where n is handshake message size - processes crypto</dt><dd>operations.</dd></dl>
<h2><a class="anchor" id="autotoc_md509"></a>
Usage Example: Event Loop Integration</h2>
<p>Non-blocking handshake with SocketPoll:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__poll__private.html#structSocketPoll__T">SocketPoll_T</a> poll = <a class="code hl_function" href="group__event__system.html#gac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a>(10);</div>
<div class="line"><a class="code hl_function" href="group__socket__dgram.html#ga1817a8561af1801a9baa7630bc277ce6">SocketDgram_setnonblocking</a>(socket, 1);  <span class="comment">// Ensure non-blocking</span></div>
<div class="line"><a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(socket), <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a> | <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a>, socket);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aac64c8906fdc9860f22cacc933593f01d">DTLS_HANDSHAKE_NOT_STARTED</a>;</div>
<div class="line"><span class="keywordflow">while</span> (state != <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5">DTLS_HANDSHAKE_COMPLETE</a> &amp;&amp; state != <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa929e6faa551a280db427a04ae5ced133">DTLS_HANDSHAKE_ERROR</a>) {</div>
<div class="line">  state = <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(socket);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (state) {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9">DTLS_HANDSHAKE_WANT_READ</a>:</div>
<div class="line">      <span class="comment">// Wait for incoming handshake messages</span></div>
<div class="line">      <a class="code hl_function" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, NULL, -1);  <span class="comment">// Or integrate with timeout</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8">DTLS_HANDSHAKE_WANT_WRITE</a>:</div>
<div class="line">      <span class="comment">// Send handshake messages (e.g., ServerHello)</span></div>
<div class="line">      <a class="code hl_function" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, NULL, -1);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78">DTLS_HANDSHAKE_COOKIE_EXCHANGE</a>:</div>
<div class="line">      <span class="comment">// Server: Cookie sent, wait for client echo (POLL_READ)</span></div>
<div class="line">      <a class="code hl_function" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, NULL, <a class="code hl_define" href="group__dtls__config.html#ga975d2fe81acd04965feb450aa7bf28c5">SOCKET_DTLS_COOKIE_LIFETIME_SEC</a> * 1000);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad8f8ad815c25bf8e696b02a71795f66d">DTLS_HANDSHAKE_IN_PROGRESS</a>:</div>
<div class="line">      <span class="comment">// Continue polling</span></div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5">DTLS_HANDSHAKE_COMPLETE</a>) {</div>
<div class="line">  <span class="comment">// Handshake done, start application I/O</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="comment">// Handle error, possibly retry or close</span></div>
<div class="line">}</div>
<div class="ttc" id="agroup__dtls__config_html_ga975d2fe81acd04965feb450aa7bf28c5"><div class="ttname"><a href="group__dtls__config.html#ga975d2fe81acd04965feb450aa7bf28c5">SOCKET_DTLS_COOKIE_LIFETIME_SEC</a></div><div class="ttdeci">#define SOCKET_DTLS_COOKIE_LIFETIME_SEC</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLSConfig_8h_source.html#l00236">SocketDTLSConfig.h:236</a></div></div>
<div class="ttc" id="agroup__event__system_html_gaa3d47365dd18329d50ee636284839738"><div class="ttname"><a href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a></div><div class="ttdeci">int SocketPoll_wait(SocketPoll_T poll, SocketEvent_T **events, int timeout)</div><div class="ttdoc">Block and wait for I/O events or timeout on registered sockets.</div></div>
<div class="ttc" id="agroup__event__system_html_gac1fbd1a09d564f7988b0e427e5707ca7"><div class="ttname"><a href="group__event__system.html#gac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a></div><div class="ttdeci">SocketPoll_T SocketPoll_new(int maxevents)</div><div class="ttdoc">Create a new event poll instance.</div></div>
<div class="ttc" id="agroup__security_html_ga17e8bd79af2c5a20b5dbb9e8dff6f84c"><div class="ttname"><a href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a></div><div class="ttdeci">DTLSHandshakeState SocketDTLS_handshake(SocketDgram_T socket)</div><div class="ttdoc">Perform one step of the non-blocking DTLS handshake.</div></div>
<div class="ttc" id="agroup__security_html_gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78"><div class="ttname"><a href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78">DTLS_HANDSHAKE_COOKIE_EXCHANGE</a></div><div class="ttdeci">@ DTLS_HANDSHAKE_COOKIE_EXCHANGE</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00205">SocketDTLS.h:205</a></div></div>
<div class="ttc" id="agroup__security_html_gga8e83c28a6ad188b97243c4b237ee075aac64c8906fdc9860f22cacc933593f01d"><div class="ttname"><a href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aac64c8906fdc9860f22cacc933593f01d">DTLS_HANDSHAKE_NOT_STARTED</a></div><div class="ttdeci">@ DTLS_HANDSHAKE_NOT_STARTED</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00201">SocketDTLS.h:201</a></div></div>
<div class="ttc" id="agroup__security_html_gga8e83c28a6ad188b97243c4b237ee075aad8f8ad815c25bf8e696b02a71795f66d"><div class="ttname"><a href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad8f8ad815c25bf8e696b02a71795f66d">DTLS_HANDSHAKE_IN_PROGRESS</a></div><div class="ttdeci">@ DTLS_HANDSHAKE_IN_PROGRESS</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS_8h_source.html#l00202">SocketDTLS.h:202</a></div></div>
<div class="ttc" id="agroup__socket__dgram_html_ga1817a8561af1801a9baa7630bc277ce6"><div class="ttname"><a href="group__socket__dgram.html#ga1817a8561af1801a9baa7630bc277ce6">SocketDgram_setnonblocking</a></div><div class="ttdeci">void SocketDgram_setnonblocking(SocketDgram_T socket)</div><div class="ttdoc">Enable non-blocking mode.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md510"></a>
Server Cookie Exchange</h2>
<p>With cookies enabled in context, initial calls return COOKIE_EXCHANGE until client responds:</p>
<div class="fragment"><div class="line"><a class="code hl_function" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a>(ctx);</div>
<div class="line"><span class="comment">// ... enable on socket ...</span></div>
<div class="line"> </div>
<div class="line">state = <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(socket);  <span class="comment">// May send HelloVerifyRequest</span></div>
<div class="line"><span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78">DTLS_HANDSHAKE_COOKIE_EXCHANGE</a>) {</div>
<div class="line">  <span class="comment">// Poll for client response with cookie</span></div>
<div class="line">  <span class="comment">// On receipt, next handshake() advances to full handshake</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>For servers, call <a class="el" href="group__security.html#ga0e2af3b3ad31869d659162ea06cf667b">SocketDTLS_listen()</a> first to receive ClientHello. Ensure socket is non-blocking for event integration. Timeouts handled via poll timeouts. Metrics: Increments SOCKET_CTR_DTLS_HANDSHAKES_TOTAL/Failed on completion/error.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Do not call during active I/O; handshake must complete before send/recv. Failed handshakes leave socket in error state; recreate for retry.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755" title="Blocking DTLS handshake with configurable timeout.">SocketDTLS_handshake_loop()</a> for blocking convenience wrapper </dd>
<dd>
<a class="el" href="group__security.html#ga0e2af3b3ad31869d659162ea06cf667b" title="Server-side initial DTLS handshake receive.">SocketDTLS_listen()</a> for server initial receive </dd>
<dd>
<a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a" title="DTLS handshake progress states.">DTLSHandshakeState</a> enum for all states </dd>
<dd>
<a class="el" href="group__event__system.html">Event System</a> for poll/timer integration </dd>
<dd>
<a class="el" href="ASYNC__IO_8md.html">docs/ASYNC_IO.md</a>#handshake-patterns for advanced patterns </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a>-handshake for <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> considerations. </dd></dl>

</div>
</div>
<a id="ga095bfc830b421398fbecacb1ac3d6755" name="ga095bfc830b421398fbecacb1ac3d6755"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga095bfc830b421398fbecacb1ac3d6755">&#9670;&#160;</a></span>SocketDTLS_handshake_loop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> SocketDTLS_handshake_loop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Blocking DTLS handshake with configurable timeout. </p>
<p>Convenience wrapper that repeatedly calls <a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake()</a> until completion, error, or timeout. Internally uses SocketPoll for waiting on socket events in non-blocking mode. Suitable for synchronous code paths.</p>
<p>Handles WANT_READ/WANT_WRITE states by polling with the remaining timeout. For timeout_ms=0, performs single non-blocking step (equivalent to handshake()).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">socket</td><td>The datagram socket instance with DTLS enabled (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">timeout_ms</td><td>Maximum milliseconds to wait (0=single step, -1=infinite).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DTLSHandshakeState: COMPLETE on success, ERROR on failure/timeout.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_HandshakeFailed</td><td>on protocol/crypto errors. </td></tr>
    <tr><td class="paramname">SocketDTLS_TimeoutExpired</td><td>if timeout reached without completion. </td></tr>
    <tr><td class="paramname">SocketDTLS_VerifyFailed</td><td>on certificate issues.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - performs blocking operations on socket state.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(h) where h is number of handshake round-trips; blocks up to</dt><dd>timeout_ms.</dd></dl>
<h2><a class="anchor" id="autotoc_md511"></a>
Usage Examples</h2>
<h3><a class="anchor" id="autotoc_md512"></a>
Synchronous Client Handshake</h3>
<div class="fragment"><div class="line"><span class="comment">// After enable, set_peer, set_hostname</span></div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">  <a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755">SocketDTLS_handshake_loop</a>(socket, 5000);  <span class="comment">// 5s</span></div>
<div class="line">timeout <span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5">DTLS_HANDSHAKE_COMPLETE</a>) { printf(<span class="stringliteral">&quot;DTLS handshake</span></div>
<div class="line"><span class="stringliteral">succeeded\n&quot;</span>);</div>
<div class="line">    <span class="comment">// Now safe to send/recv</span></div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// Handle timeout or error</span></div>
<div class="line">    <span class="keywordtype">long</span> verify = <a class="code hl_function" href="group__security.html#gad0e45780e041b9ddb58956d9f0fb20d1">SocketDTLS_get_verify_result</a>(socket);</div>
<div class="line">    <span class="keywordflow">if</span> (verify != X509_V_OK) {</div>
<div class="line">      <span class="comment">// Cert issue</span></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga9a2543bc8c6671e774391f4861d4fa5d">SocketDTLS_TimeoutExpired</a>) {</div>
<div class="line">  <span class="comment">// Specific timeout handling</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__security_html_ga095bfc830b421398fbecacb1ac3d6755"><div class="ttname"><a href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755">SocketDTLS_handshake_loop</a></div><div class="ttdeci">DTLSHandshakeState SocketDTLS_handshake_loop(SocketDgram_T socket, int timeout_ms)</div><div class="ttdoc">Blocking DTLS handshake with configurable timeout.</div></div>
<div class="ttc" id="agroup__security_html_ga9a2543bc8c6671e774391f4861d4fa5d"><div class="ttname"><a href="group__security.html#ga9a2543bc8c6671e774391f4861d4fa5d">SocketDTLS_TimeoutExpired</a></div><div class="ttdeci">const Except_T SocketDTLS_TimeoutExpired</div><div class="ttdoc">Handshake timeout expired.</div></div>
<div class="ttc" id="agroup__security_html_gad0e45780e041b9ddb58956d9f0fb20d1"><div class="ttname"><a href="group__security.html#gad0e45780e041b9ddb58956d9f0fb20d1">SocketDTLS_get_verify_result</a></div><div class="ttdeci">long SocketDTLS_get_verify_result(SocketDgram_T socket)</div><div class="ttdoc">Get peer certificate verification result.</div></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md513"></a>
Single Non-Blocking Step</h3>
<div class="fragment"><div class="line"><span class="comment">// In event loop, for finer control</span></div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755">SocketDTLS_handshake_loop</a>(socket, 0);</div>
<div class="line"><span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9">DTLS_HANDSHAKE_WANT_READ</a>) {</div>
<div class="line">  <span class="comment">// Schedule read event</span></div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md514"></a>
Server with Infinite Timeout</h3>
<div class="fragment"><div class="line"><span class="comment">// For servers where timeout not critical</span></div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755">SocketDTLS_handshake_loop</a>(socket, -1);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Uses internal temporary SocketPoll; does not interfere with external polls. Recommended timeout: 3000-10000ms for typical networks. Adjust based on RTT. On servers with cookies, includes wait for cookie round-trip. After success, check <a class="el" href="group__security.html#ga12039ba9c9513fbf9df6e02f997d09ab">SocketDTLS_get_cipher()</a> and version for negotiated params.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Blocks calling thread; avoid in hot event loops. Use plain handshake() for async. Infinite timeout (-1) risks hangs on network issues; prefer finite values.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c" title="Perform one step of the non-blocking DTLS handshake.">SocketDTLS_handshake()</a> for low-level non-blocking control </dd>
<dd>
<a class="el" href="group__foundation.html#ga264bfa9d1cf07aa22446a4df6c4936bf" title="Socket_get_monotonic_ms - Get current monotonic time in milliseconds.">Socket_get_monotonic_ms()</a> for custom timeouts </dd>
<dd>
<a class="el" href="group__event__system.html">Event System Modules</a> for full async patterns </dd>
<dd>
<a class="el" href="ASYNC__IO_8md.html">docs/ASYNC_IO.md</a>#blocking-vs-nonblocking for tradeoffs. </dd></dl>

</div>
</div>
<a id="ga861c0da7896b4275fb38ee2d0ac73af1" name="ga861c0da7896b4275fb38ee2d0ac73af1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga861c0da7896b4275fb38ee2d0ac73af1">&#9670;&#160;</a></span>SocketDTLS_is_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketDTLS_is_enabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if DTLS is enabled on socket. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if DTLS enabled, 0 if not </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="gae702a60aae194a098bdc6af32549f1ae" name="gae702a60aae194a098bdc6af32549f1ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae702a60aae194a098bdc6af32549f1ae">&#9670;&#160;</a></span>SocketDTLS_is_handshake_done()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketDTLS_is_handshake_done </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if DTLS handshake is complete. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if complete, 0 if not </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="gaeeca3aaa5a1e0f7fbb22b16a465421fd" name="gaeeca3aaa5a1e0f7fbb22b16a465421fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeeca3aaa5a1e0f7fbb22b16a465421fd">&#9670;&#160;</a></span>SocketDTLS_is_session_reused()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketDTLS_is_session_reused </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if DTLS session was resumed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Determines if the connection used a resumed session (faster 1-RTT handshake).</p>
<dl class="section return"><dt>Returns</dt><dd>1 if reused, 0 if full handshake, -1 if unavailable </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="gaad0b27539517934a510df081364e08ab" name="gaad0b27539517934a510df081364e08ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaad0b27539517934a510df081364e08ab">&#9670;&#160;</a></span>SocketDTLS_is_shutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketDTLS_is_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if DTLS shutdown completed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if shutdown complete, 0 if not </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="ga0e2af3b3ad31869d659162ea06cf667b" name="ga0e2af3b3ad31869d659162ea06cf667b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e2af3b3ad31869d659162ea06cf667b">&#9670;&#160;</a></span>SocketDTLS_listen()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> SocketDTLS_listen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Server-side initial DTLS handshake receive. </p>
<p>For DTLS servers, waits for and processes the initial ClientHello packet. Triggers cookie exchange if enabled in context for DoS protection. Non-blocking: returns WANT_READ if no data, or advances to cookie exchange/in progress.</p>
<p>Call in server event loop after binding and enabling DTLS on listening socket. Follow with <a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake()</a> to complete the handshake. Supports multi-client via per-peer state (set peer addr before continuing).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">socket</td><td>Bound datagram socket with DTLS enabled (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>DTLSHandshakeState:<ul>
<li>DTLS_HANDSHAKE_WANT_READ: No ClientHello received yet, poll again</li>
<li>DTLS_HANDSHAKE_COOKIE_EXCHANGE: Cookie sent, wait for client response</li>
<li>DTLS_HANDSHAKE_IN_PROGRESS: ClientHello processed, proceed to handshake()</li>
<li>Other states: Error or unexpected</li>
</ul>
</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on recv errors or invalid ClientHello. </td></tr>
    <tr><td class="paramname">SocketDTLS_CookieFailed</td><td>if cookie generation fails.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - receives into and updates socket SSL state.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(1) + crypto time for cookie if enabled.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md515"></a>
Usage Example: Server Event Loop</h2>
<p>Integrate with poll for accepting new connections:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> listen_sock = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line"><a class="code hl_function" href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind</a>(listen_sock, NULL, 4433);</div>
<div class="line"><a class="code hl_function" href="group__socket__dgram.html#ga1817a8561af1801a9baa7630bc277ce6">SocketDgram_setnonblocking</a>(listen_sock, 1);</div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(cert, key, NULL);</div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a>(ctx);  <span class="comment">// Optional DoS protection</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(listen_sock, ctx);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="group__poll__private.html#structSocketPoll__T">SocketPoll_T</a> poll = <a class="code hl_function" href="group__event__system.html#gac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a>(1);</div>
<div class="line"><a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(listen_sock), <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, listen_sock);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (server_running) {</div>
<div class="line">  <a class="code hl_struct" href="group__event__system.html#structSocketEvent__T">SocketEvent_T</a> events[1];</div>
<div class="line">  <span class="keywordtype">int</span> nfds = <a class="code hl_function" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, events, 1000);  <span class="comment">// 1s timeout</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (nfds &gt; 0 &amp;&amp; events[0].events &amp; <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>) {</div>
<div class="line">    <a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga0e2af3b3ad31869d659162ea06cf667b">SocketDTLS_listen</a>(listen_sock);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa206e6713dc03f89a32b4567221dedb78">DTLS_HANDSHAKE_COOKIE_EXCHANGE</a> ||</div>
<div class="line">        state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad8f8ad815c25bf8e696b02a71795f66d">DTLS_HANDSHAKE_IN_PROGRESS</a>) {</div>
<div class="line">      <span class="comment">// New client detected, create per-client socket or continue on this</span></div>
<div class="line">      <span class="comment">// Set peer addr if needed via recvfrom info</span></div>
<div class="line">      <span class="comment">// Then call SocketDTLS_handshake() in loop until complete</span></div>
<div class="line">      <a class="code hl_function" href="group__security.html#gaf742a2fb837173f6fd8d347e5bc1d1d3">SocketDTLS_set_peer</a>(listen_sock, client_ip, client_port);</div>
<div class="line">      <span class="comment">// ... complete handshake ...</span></div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__event__system_html_structSocketEvent__T"><div class="ttname"><a href="group__event__system.html#structSocketEvent__T">SocketEvent_T</a></div><div class="ttdoc">Event notification structure returned by polling operations.</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00205">SocketPoll.h:206</a></div></div>
<div class="ttc" id="agroup__security_html_ga0e2af3b3ad31869d659162ea06cf667b"><div class="ttname"><a href="group__security.html#ga0e2af3b3ad31869d659162ea06cf667b">SocketDTLS_listen</a></div><div class="ttdeci">DTLSHandshakeState SocketDTLS_listen(SocketDgram_T socket)</div><div class="ttdoc">Server-side initial DTLS handshake receive.</div></div>
<div class="ttc" id="agroup__security_html_gaf742a2fb837173f6fd8d347e5bc1d1d3"><div class="ttname"><a href="group__security.html#gaf742a2fb837173f6fd8d347e5bc1d1d3">SocketDTLS_set_peer</a></div><div class="ttdeci">void SocketDTLS_set_peer(SocketDgram_T socket, const char *host, int port)</div><div class="ttdoc">Set the peer address for a DTLS connection.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>For multi-client servers, typically fork per-client state or use connection pool. Call on listening socket or per-client socket. Integrates with SocketPool for management. Cookie exchange adds 1-RTT delay but protects against floods.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Listening socket must be non-blocking. Does not handle multiple simultaneous hellos; use select/poll. After listen, immediately follow with handshake loop for full completion.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> for DoS protection </dd>
<dd>
<a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c" title="Perform one step of the non-blocking DTLS handshake.">SocketDTLS_handshake()</a> to continue after listen </dd>
<dd>
<a class="el" href="group__socket__dgram.html#gada4b76edaec59a44eb5bc959e6948d3f" title="Receive datagram and get sender address.">SocketDgram_recvfrom()</a> for manual packet handling if needed </dd>
<dd>
<a class="el" href="group__connection__mgmt.html">Connection Management Modules</a> for pooling multiple DTLS connections </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#syn-protect equivalent for DTLS DoS </dd>
<dd>
<a class="el" href="ASYNC__IO_8md.html">docs/ASYNC_IO.md</a>#server-patterns for scalable servers. </dd></dl>

</div>
</div>
<a id="gac4fc033d5799456ce6d1b1417228c7e1" name="gac4fc033d5799456ce6d1b1417228c7e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4fc033d5799456ce6d1b1417228c7e1">&#9670;&#160;</a></span>SocketDTLS_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketDTLS_recv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Receive application data from established DTLS connection. </p>
<p>Decrypts and delivers one complete application message from the DTLS record layer. For non-blocking sockets, returns 0 on EAGAIN/no data or partial message. Requires completed handshake; checks for close_notify or errors.</p>
<p>Key property: Message-oriented - recv() delivers entire sent datagram (reassembled from fragments if needed) or blocks/partials. No stream merging like TCP/TLS. Handles out-of-order packets, duplicates, and losses via DTLS sequencing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The datagram socket with completed DTLS handshake (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buf</td><td>Buffer to receive decrypted plaintext data. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Maximum bytes to receive into buf (suggest &gt;= MTU for full messages).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes received (&gt;0 complete/partial message), 0 on EOF/close or would-block, -1 on error.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on decryption errors, bad records, or peer errors. </td></tr>
    <tr><td class="paramname">Socket_Closed</td><td>on clean remote shutdown (close_notify received).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - advances SSL receive buffers and sequence state.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(len) - symmetric decryption and integrity checks.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md518"></a>
Usage Example</h2>
<p>Basic receive after handshake:</p>
<div class="fragment"><div class="line"><span class="keywordtype">char</span> recv_buf[4096];  <span class="comment">// Larger than typical MTU</span></div>
<div class="line">ssize_t recvd = <a class="code hl_function" href="group__security.html#gac4fc033d5799456ce6d1b1417228c7e1">SocketDTLS_recv</a>(socket, recv_buf, <span class="keyword">sizeof</span>(recv_buf));</div>
<div class="line"><span class="keywordflow">if</span> (recvd &gt; 0) {</div>
<div class="line">  <span class="comment">// Process complete message of recvd bytes</span></div>
<div class="line">  <span class="comment">// Note: One logical app datagram, may be fragmented under DTLS</span></div>
<div class="line">} <span class="keywordflow">else</span> <span class="keywordflow">if</span> (recvd == 0 || errno == EAGAIN) {</div>
<div class="line">  <span class="comment">// No data or non-blocking wait needed (POLL_READ)</span></div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="comment">// Error or clean close</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#gaad0b27539517934a510df081364e08ab">SocketDTLS_is_shutdown</a>(socket)) {</div>
<div class="line">    <span class="comment">// Peer closed connection</span></div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_gaad0b27539517934a510df081364e08ab"><div class="ttname"><a href="group__security.html#gaad0b27539517934a510df081364e08ab">SocketDTLS_is_shutdown</a></div><div class="ttdeci">int SocketDTLS_is_shutdown(SocketDgram_T socket)</div><div class="ttdoc">Check if DTLS shutdown completed.</div></div>
<div class="ttc" id="agroup__security_html_gac4fc033d5799456ce6d1b1417228c7e1"><div class="ttname"><a href="group__security.html#gac4fc033d5799456ce6d1b1417228c7e1">SocketDTLS_recv</a></div><div class="ttdeci">ssize_t SocketDTLS_recv(SocketDgram_T socket, void *buf, size_t len)</div><div class="ttdoc">Receive application data from established DTLS connection.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md519"></a>
Non-Blocking Loop with Poll</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__poll__private.html#structSocketPoll__T">SocketPoll_T</a> poll = <a class="code hl_function" href="group__event__system.html#gac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a>(1);</div>
<div class="line"><a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(socket), <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, NULL);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (expected_messages) {</div>
<div class="line">  ssize_t recvd = <a class="code hl_function" href="group__security.html#gac4fc033d5799456ce6d1b1417228c7e1">SocketDTLS_recv</a>(socket, recv_buf, <span class="keyword">sizeof</span>(recv_buf));</div>
<div class="line">  <span class="keywordflow">if</span> (recvd &gt; 0) {</div>
<div class="line">    process_message(recv_buf, recvd);  <span class="comment">// Handle full datagram</span></div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno == EAGAIN) {</div>
<div class="line">    <a class="code hl_function" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, NULL, timeout_ms);  <span class="comment">// Wait for data</span></div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// Handle error/close</span></div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Buffer size should accommodate max expected message + margin; partial receives possible in non-blocking. Integrates with SocketPool for connection mgmt. App must handle message loss (no reliability). On close_notify (0 return, errno=0), initiate local shutdown. Metrics: Tracks recv bytes/errors.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Receiving before handshake raises error. Lost/partial messages require app retransmit. Buffer overflow truncates message; always check return vs requested len. For multi-peer, use recvfrom variant.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460" title="Send application data over established DTLS connection.">SocketDTLS_send()</a> - sending counterpart </dd>
<dd>
<a class="el" href="group__security.html#gac974bd84fcd68c06870530c11908170f" title="Receive DTLS datagram with sender address.">SocketDTLS_recvfrom()</a> for address info </dd>
<dd>
SocketBuf for buffering multiple messages </dd>
<dd>
<a class="el" href="group__event__system.html">Event System Modules</a> for poll integration </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a>-io for best practices on message sizes. </dd></dl>

</div>
</div>
<a id="gac974bd84fcd68c06870530c11908170f" name="gac974bd84fcd68c06870530c11908170f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac974bd84fcd68c06870530c11908170f">&#9670;&#160;</a></span>SocketDTLS_recvfrom()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketDTLS_recvfrom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>host_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Receive DTLS datagram with sender address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance with DTLS enabled </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer for received data </td></tr>
    <tr><td class="paramname">len</td><td>Buffer size </td></tr>
    <tr><td class="paramname">host</td><td>Output buffer for sender IP address (&gt;= 46 bytes for IPv6) </td></tr>
    <tr><td class="paramname">host_len</td><td>Size of host buffer </td></tr>
    <tr><td class="paramname">port</td><td>Output for sender port</td></tr>
  </table>
  </dd>
</dl>
<p>Receives DTLS datagram and provides sender address info.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes received, or 0 if would block </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="ga9fe6acb926cc7fbc8c4f0239834b5460" name="ga9fe6acb926cc7fbc8c4f0239834b5460"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9fe6acb926cc7fbc8c4f0239834b5460">&#9670;&#160;</a></span>SocketDTLS_send()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketDTLS_send </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send application data over established DTLS connection. </p>
<p>Encrypts and transmits data as a single DTLS application record. For non-blocking sockets, returns &lt; len on partial send or 0/-1 on EAGAIN/block. Requires completed handshake (<a class="el" href="group__security.html#gae702a60aae194a098bdc6af32549f1ae">SocketDTLS_is_handshake_done()</a> == 1). Automatically handles record layering, sequencing, and retransmission.</p>
<p>Critical: DTLS is datagram-oriented - each send() generates one logical message preserved at receiver (unlike stream-oriented TLS). Large payloads (&gt; MTU) are automatically fragmented and reassembled by DTLS.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The datagram socket with completed DTLS handshake (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Buffer containing plaintext data to send. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Number of bytes from buf to send (must respect MTU for efficiency).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes sent (may be partial), 0 on would-block (non-blocking), -1 on error.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on encryption errors, sequence anomalies, or peer close. </td></tr>
    <tr><td class="paramname">SocketDTLS_ShutdownFailed</td><td>if connection shutting down.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - updates SSL send buffers and sequence numbers.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(len) - symmetric encryption/decryption time.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md516"></a>
Usage Example</h2>
<p>Basic send after handshake:</p>
<div class="fragment"><div class="line"><span class="comment">// Assume handshake complete</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#gae702a60aae194a098bdc6af32549f1ae">SocketDTLS_is_handshake_done</a>(socket)) {</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *msg = <span class="stringliteral">&quot;Hello, secure DTLS world!&quot;</span>;</div>
<div class="line">  ssize_t sent = <a class="code hl_function" href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460">SocketDTLS_send</a>(socket, msg, strlen(msg));</div>
<div class="line">  <span class="keywordflow">if</span> (sent &gt; 0) {</div>
<div class="line">    <span class="comment">// Success, message sent as atomic datagram</span></div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sent == 0 || errno == EAGAIN) {</div>
<div class="line">    <span class="comment">// Non-blocking: retry after POLL_WRITE</span></div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// Error: check Socket_GetLastError()</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md517"></a>
Non-Blocking with Poll</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__poll__private.html#structSocketPoll__T">SocketPoll_T</a> poll = <a class="code hl_function" href="group__event__system.html#gac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a>(1);</div>
<div class="line"><a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(socket), <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a>, NULL);</div>
<div class="line"> </div>
<div class="line">ssize_t total_sent = 0;</div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *data = large_buffer;</div>
<div class="line"><span class="keywordtype">size_t</span> to_send = large_size;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (total_sent &lt; to_send) {</div>
<div class="line">  ssize_t sent = <a class="code hl_function" href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460">SocketDTLS_send</a>(socket, data + total_sent, to_send -</div>
<div class="line">total_sent); <span class="keywordflow">if</span> (sent &gt; 0) { total_sent += sent; } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (errno == EAGAIN)</div>
<div class="line">{ <a class="code hl_function" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, NULL, -1);  <span class="comment">// Wait for writability } else {</span></div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Respects socket Socket_set_timeout(); may raise Socket_Timeout. For efficiency, batch small messages or use SocketBuf for buffering. Sender must handle retransmission timeouts via app-level ACKs (DTLS only retransmits handshake). Metrics: Increments bytes sent counters.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Sending before handshake complete or after shutdown raises error. Large sends (&gt; MTU) fragment; receiver gets complete message or none (best-effort). No delivery guarantee - UDP semantics apply; use reliability on top if needed.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gac4fc033d5799456ce6d1b1417228c7e1" title="Receive application data from established DTLS connection.">SocketDTLS_recv()</a> - counterpart for receiving </dd>
<dd>
<a class="el" href="group__security.html#ga4e060f6143e7c9896452a6e0654041e5" title="Send DTLS datagram to specific address.">SocketDTLS_sendto()</a> for unconnected multi-peer sends </dd>
<dd>
<a class="el" href="group__socket__dgram.html#ga1817a8561af1801a9baa7630bc277ce6" title="Enable non-blocking mode.">SocketDgram_setnonblocking()</a> for async mode </dd>
<dd>
<a class="el" href="group__utilities.html">Utilities</a> for rate limiting large transfers </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a>-io for performance tuning. </dd></dl>

</div>
</div>
<a id="ga4e060f6143e7c9896452a6e0654041e5" name="ga4e060f6143e7c9896452a6e0654041e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e060f6143e7c9896452a6e0654041e5">&#9670;&#160;</a></span>SocketDTLS_sendto()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketDTLS_sendto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send DTLS datagram to specific address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The datagram socket instance with DTLS enabled </td></tr>
    <tr><td class="paramname">buf</td><td>Data to send </td></tr>
    <tr><td class="paramname">len</td><td>Length of data </td></tr>
    <tr><td class="paramname">host</td><td>Destination IP address or hostname </td></tr>
    <tr><td class="paramname">port</td><td>Destination port</td></tr>
  </table>
  </dd>
</dl>
<p>For unconnected DTLS sockets (e.g., server responding to multiple clients). Must have completed handshake with this peer.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes sent, or 0 if would block </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="gabf3857e3cea92190f4c6eca7a8418be3" name="gabf3857e3cea92190f4c6eca7a8418be3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabf3857e3cea92190f4c6eca7a8418be3">&#9670;&#160;</a></span>SocketDTLS_set_hostname()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLS_set_hostname </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hostname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set SNI hostname for client DTLS connections. </p>
<p>Sets the Server Name Indication (SNI) extension value and configures hostname verification for certificate validation. Essential for clients connecting to virtual hosts and ensuring correct certificate matching.</p>
<p>Call after <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable()</a> but before <a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake()</a>. Affects both SNI sent in ClientHello and post-handshake peer verification.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The datagram socket instance with DTLS enabled (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hostname</td><td>Null-terminated hostname string (e.g., "www.example.com").</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>if DTLS not enabled on socket, invalid hostname (too long, invalid chars), or SSL state error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies socket internal SSL configuration and hostname</dt><dd>state.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - string copy and SSL_set_tlsext_host_name() call.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md506"></a>
Usage Example</h2>
<p>Typically used in client setup after enabling DTLS:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line"><a class="code hl_function" href="group__socket__dgram.html#gabcb18c16142d3b5ef49bee08a96e15fa">SocketDgram_connect</a>(socket, <span class="stringliteral">&quot;example.com&quot;</span>, 4433);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a>(NULL);</div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#ga167f13bc2d88dd59da040a6423cbb741">SocketDTLSContext_set_verify_mode</a>(ctx, SOCKET_DTLS_VERIFY_PEER);  <span class="comment">// Enable</span></div>
<div class="line">verification <a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(socket, ctx);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set hostname for SNI and cert verification</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3">SocketDTLS_set_hostname</a>(socket, <span class="stringliteral">&quot;www.example.com&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Now perform handshake - will verify cert matches hostname</span></div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state;</div>
<div class="line"><span class="keywordflow">while</span> ((state = <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(socket)) == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9">DTLS_HANDSHAKE_WANT_READ</a> ||</div>
<div class="line">       state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8">DTLS_HANDSHAKE_WANT_WRITE</a>) {</div>
<div class="line">  <span class="comment">// Poll socket for events and retry</span></div>
<div class="line">}</div>
<div class="line"><span class="keywordflow">if</span> (state != <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aa11985350a6b101701d89412f26fdeba5">DTLS_HANDSHAKE_COMPLETE</a>) {</div>
<div class="line">  <span class="comment">// Handle failure, check SocketDTLS_get_verify_result(socket)</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Hostname must be valid domain name per RFC 1034/6066. IP addresses are not recommended for SNI. If peer verification fails due to hostname mismatch, <a class="el" href="group__security.html#gaf1324e42b633182c01b0157ebfba0e9e">SocketDTLS_VerifyFailed</a> is raised during handshake. For servers, this function has no effect (SNI is received, not sent).</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Without setting hostname and enabling peer verification, connections are vulnerable to MITM attacks. Always set for production clients accessing named services.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga167f13bc2d88dd59da040a6423cbb741" title="Set certificate verification policy.">SocketDTLSContext_set_verify_mode()</a> to control verification behavior </dd>
<dd>
<a class="el" href="group__security.html#gad0e45780e041b9ddb58956d9f0fb20d1" title="Get peer certificate verification result.">SocketDTLS_get_verify_result()</a> to check verification outcome </dd>
<dd>
<a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c" title="Perform one step of the non-blocking DTLS handshake.">SocketDTLS_handshake()</a> - must follow this call </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#certificate-verification for hardening guidelines. </dd></dl>

</div>
</div>
<a id="ga804d5dd4b27255e3c9c28c58a2914a18" name="ga804d5dd4b27255e3c9c28c58a2914a18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga804d5dd4b27255e3c9c28c58a2914a18">&#9670;&#160;</a></span>SocketDTLS_set_mtu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLS_set_mtu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mtu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set per-connection MTU for DTLS record sizing. </p>
<p>Overrides the global MTU setting from the DTLS context for this specific socket. Controls the maximum size of DTLS records to avoid IP fragmentation. Useful for path MTU discovery or network-specific optimizations.</p>
<p>Must be called after <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable()</a> but before handshake or I/O. Valid MTU range: typically 256-9000 bytes, enforced by SOCKET_DTLS_MIN_MTU and MAX.</p>
<h2><a class="anchor" id="autotoc_md507"></a>
Valid MTU Ranges</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Parameter   </th><th class="markdownTableHeadNone">Value   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Minimum   </td><td class="markdownTableBodyNone">256   </td><td class="markdownTableBodyNone">Smallest supported for embedded networks    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Default   </td><td class="markdownTableBodyNone">1500   </td><td class="markdownTableBodyNone">Standard Ethernet MTU (adjust for overhead)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Maximum   </td><td class="markdownTableBodyNone">9000   </td><td class="markdownTableBodyNone">Jumbo frames support   </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The datagram socket instance with DTLS enabled (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mtu</td><td>Maximum Transmission Unit in bytes (must be valid range).</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>if DTLS not enabled or mtu outside valid range.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - updates socket-specific DTLS bio and record parameters.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - simple parameter update.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md508"></a>
Usage Example</h2>
<p>Set custom MTU after enabling DTLS:</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a>(NULL);</div>
<div class="line"><a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(socket, ctx);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set MTU for low-bandwidth network (e.g., mobile)</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga804d5dd4b27255e3c9c28c58a2914a18">SocketDTLS_set_mtu</a>(socket, 576);  <span class="comment">// Conservative value avoiding</span></div>
<div class="line">fragmentation</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Verify setting</span></div>
<div class="line">assert(<a class="code hl_function" href="group__security.html#ga7752aae6c38da47f187f8d766b4ae12e">SocketDTLS_get_mtu</a>(socket) == 576);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Proceed with handshake and I/O - records will respect this MTU</span></div>
<div class="ttc" id="agroup__security_html_ga7752aae6c38da47f187f8d766b4ae12e"><div class="ttname"><a href="group__security.html#ga7752aae6c38da47f187f8d766b4ae12e">SocketDTLS_get_mtu</a></div><div class="ttdeci">size_t SocketDTLS_get_mtu(SocketDgram_T socket)</div><div class="ttdoc">Get current effective MTU.</div></div>
<div class="ttc" id="agroup__security_html_ga804d5dd4b27255e3c9c28c58a2914a18"><div class="ttname"><a href="group__security.html#ga804d5dd4b27255e3c9c28c58a2914a18">SocketDTLS_set_mtu</a></div><div class="ttdeci">void SocketDTLS_set_mtu(SocketDgram_T socket, size_t mtu)</div><div class="ttdoc">Set per-connection MTU for DTLS record sizing.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>DTLS adds ~50-100 bytes overhead (headers + auth); effective app payload is MTU minus overhead. Incorrect MTU may cause fragmentation or packet drops. Use path MTU discovery for optimal. Changing MTU mid-connection is supported but may trigger record re-segmentation.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Setting MTU too small wastes bandwidth on overhead; too large causes fragmentation. Test with network conditions or use default unless specific needs.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d" title="Configure the path MTU for DTLS record fragmentation and padding.">SocketDTLSContext_set_mtu()</a> - set global context MTU (before enable) </dd>
<dd>
<a class="el" href="group__security.html#ga7752aae6c38da47f187f8d766b4ae12e" title="Get current effective MTU.">SocketDTLS_get_mtu()</a> - query current effective MTU </dd>
<dd>
<a class="el" href="SocketDTLSConfig_8h.html" title="DTLS configuration constants and secure defaults.">SocketDTLSConfig.h</a> for compile-time MTU constants </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dtls.html" title="Secure datagram communication using DTLS over UDP sockets.">Datagram TLS (DTLS) Module</a>-mtu for fragmentation guidelines. </dd></dl>

</div>
</div>
<a id="gaf742a2fb837173f6fd8d347e5bc1d1d3" name="gaf742a2fb837173f6fd8d347e5bc1d1d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf742a2fb837173f6fd8d347e5bc1d1d3">&#9670;&#160;</a></span>SocketDTLS_set_peer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLS_set_peer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>host</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>port</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the peer address for a DTLS connection. </p>
<p>Configures the destination address for DTLS packets sent and received. For connected sockets, this overrides the connected peer address. Essential for unconnected server sockets handling multiple clients. Performs synchronous hostname resolution if host is not numeric IP.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">socket</td><td>The datagram socket instance with DTLS enabled (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">host</td><td>Peer hostname or IP address string (e.g., "192.0.2.1" or "example.com"). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">port</td><td>Peer port number (1-65535).</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on invalid address format, resolution failure, or if DTLS not enabled.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - updates socket internal peer address state.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(1) for IP addresses, O(n) for hostname resolution via</dt><dd>getaddrinfo().</dd></dl>
<h2><a class="anchor" id="autotoc_md503"></a>
Usage Example</h2>
<h3><a class="anchor" id="autotoc_md504"></a>
Client (Alternative to SocketDgram_connect)</h3>
<div class="fragment"><div class="line"><a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> socket = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a>(NULL);</div>
<div class="line"><a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(socket, ctx);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set peer explicitly (useful if not calling connect)</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gaf742a2fb837173f6fd8d347e5bc1d1d3">SocketDTLS_set_peer</a>(socket, <span class="stringliteral">&quot;dtls.example.com&quot;</span>, 4433);</div>
<div class="line"><a class="code hl_function" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3">SocketDTLS_set_hostname</a>(socket, <span class="stringliteral">&quot;dtls.example.com&quot;</span>);  <span class="comment">// SNI</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Now handshake...</span></div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(socket);</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md505"></a>
Server Handling Multiple Clients</h3>
<div class="fragment"><div class="line"><span class="comment">// Unconnected server socket bound to port</span></div>
<div class="line"><a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> server = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line"><a class="code hl_function" href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind</a>(server, NULL, 4433);</div>
<div class="line"><a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(server, server_ctx);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// When receiving from a client (in recvfrom callback)</span></div>
<div class="line"><span class="keywordtype">char</span> client_host[INET6_ADDRSTRLEN];</div>
<div class="line"><span class="keywordtype">int</span> client_port;</div>
<div class="line"><span class="comment">// ... recvfrom to get client_host and client_port ...</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set peer for response/handshake</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gaf742a2fb837173f6fd8d347e5bc1d1d3">SocketDTLS_set_peer</a>(server, client_host, client_port);</div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(server);  <span class="comment">// Or listen</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>For high-performance servers, consider async resolution with SocketDNS to avoid blocking in getaddrinfo(). Call this before each handshake or I/O for multi-client support. IPv6 addresses are supported; host buffer should accommodate INET6_ADDRSTRLEN.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Synchronous resolution may block; use SocketDNS for async alternative in event loops.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__socket__dgram.html#gabcb18c16142d3b5ef49bee08a96e15fa" title="Set default destination for socket.">SocketDgram_connect()</a> - preferred for clients to set peer implicitly </dd>
<dd>
<a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> - must be called before set_peer </dd>
<dd>
<a class="el" href="group__dns.html#gab988727825887d34e87d144d30c30c2f" title="Synchronous DNS resolution with optional timeout guarantee.">SocketDNS_resolve_sync()</a> for manual async-integrated resolution </dd>
<dd>
<a class="el" href="group__core__io.html">Core I/O</a> for datagram socket primitives. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a><a class="el" href="group__dns.html" title="Thread pool-based DNS resolution with guaranteed timeouts and SocketPoll integration.">Asynchronous DNS Resolution</a>-resolution for best practices. </dd></dl>

</div>
</div>
<a id="gab42fd91bb31edaf15149d75920446a0a" name="gab42fd91bb31edaf15149d75920446a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab42fd91bb31edaf15149d75920446a0a">&#9670;&#160;</a></span>SocketDTLS_shutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLS_shutdown </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initiate graceful DTLS connection shutdown. </p>
<p>Sends close_notify alert to peer and transitions to shutdown state. For non-blocking sockets, may return after sending alert; call repeatedly until <a class="el" href="group__security.html#gaad0b27539517934a510df081364e08ab">SocketDTLS_is_shutdown()</a> == 1. Always call before <a class="el" href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4">SocketDgram_free()</a>. Peer may continue sending data until alert processed; drain recv if needed.</p>
<p>Supports half-close (send shutdown without recv close).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">socket</td><td>The datagram socket with active DTLS connection (<a class="el" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_ShutdownFailed</td><td>if already shutting down, handshake incomplete, or send error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - sends alert and updates SSL shutdown state.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - sends fixed-size alert record.</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md521"></a>
Usage Example</h2>
<p>Graceful close after application logic:</p>
<div class="fragment"><div class="line"><span class="comment">// Signal intent to close</span></div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">  <a class="code hl_function" href="group__security.html#gab42fd91bb31edaf15149d75920446a0a">SocketDTLS_shutdown</a>(socket);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga28d15a7e6fc136b5d542236ef27f0be6">SocketDTLS_ShutdownFailed</a>) {</div>
<div class="line">  <span class="comment">// Log but continue (best-effort)</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Drain any remaining recv data (optional)</span></div>
<div class="line"><span class="keywordtype">char</span> buf[1024];</div>
<div class="line"><span class="keywordflow">while</span> (<a class="code hl_function" href="group__security.html#gac4fc033d5799456ce6d1b1417228c7e1">SocketDTLS_recv</a>(socket, buf, <span class="keyword">sizeof</span>(buf)) &gt; 0) {</div>
<div class="line">  <span class="comment">// Process lingering data</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Wait for shutdown complete in non-blocking</span></div>
<div class="line"><span class="keywordflow">while</span> (!<a class="code hl_function" href="group__security.html#gaad0b27539517934a510df081364e08ab">SocketDTLS_is_shutdown</a>(socket)) {</div>
<div class="line">  <a class="code hl_enumeration" href="group__security.html#ga8e83c28a6ad188b97243c4b237ee075a">DTLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(socket);  <span class="comment">// Processes</span></div>
<div class="line">peer close_notify <span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aaa17434dadb8cec2cfe51d9437f6fdbd9">DTLS_HANDSHAKE_WANT_READ</a> || state ==</div>
<div class="line"><a class="code hl_enumvalue" href="group__security.html#gga8e83c28a6ad188b97243c4b237ee075aad5e0e23bed76e7569444db7c50c38fc8">DTLS_HANDSHAKE_WANT_WRITE</a>) {</div>
<div class="line">    <span class="comment">// Poll and retry</span></div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4">SocketDgram_free</a>(&amp;socket);  <span class="comment">// Safe now</span></div>
<div class="ttc" id="agroup__security_html_ga28d15a7e6fc136b5d542236ef27f0be6"><div class="ttname"><a href="group__security.html#ga28d15a7e6fc136b5d542236ef27f0be6">SocketDTLS_ShutdownFailed</a></div><div class="ttdeci">const Except_T SocketDTLS_ShutdownFailed</div><div class="ttdoc">DTLS shutdown failure.</div></div>
<div class="ttc" id="agroup__security_html_gab42fd91bb31edaf15149d75920446a0a"><div class="ttname"><a href="group__security.html#gab42fd91bb31edaf15149d75920446a0a">SocketDTLS_shutdown</a></div><div class="ttdeci">void SocketDTLS_shutdown(SocketDgram_T socket)</div><div class="ttdoc">Initiate graceful DTLS connection shutdown.</div></div>
<div class="ttc" id="agroup__socket__dgram_html_ga020169c79640786afa4c36fd1dc965e4"><div class="ttname"><a href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4">SocketDgram_free</a></div><div class="ttdeci">void SocketDgram_free(SocketDgram_T *socket)</div><div class="ttdoc">Dispose of a datagram socket, closing the underlying file descriptor and freeing resources.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md522"></a>
Non-Blocking Shutdown Loop</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__poll__private.html#structSocketPoll__T">SocketPoll_T</a> poll = <a class="code hl_function" href="group__event__system.html#gac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a>(1);</div>
<div class="line"><a class="code hl_function" href="group__event__system.html#ga6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, <a class="code hl_function" href="group__core__io.html#ga4d727948c677509eec04746585819877">Socket_fd</a>(socket), <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a> | <a class="code hl_enumvalue" href="group__event__system.html#gga9e8943c9cb47aba63dda4ad9083142b6acd6f685ba9cebb83074be444222ae195">POLL_WRITE</a>, NULL);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__security.html#gab42fd91bb31edaf15149d75920446a0a">SocketDTLS_shutdown</a>(socket);</div>
<div class="line"><span class="keywordtype">int</span> attempts = 0;</div>
<div class="line"><span class="keywordflow">while</span> (!<a class="code hl_function" href="group__security.html#gaad0b27539517934a510df081364e08ab">SocketDTLS_is_shutdown</a>(socket) &amp;&amp; attempts++ &lt; 10) {</div>
<div class="line">  <a class="code hl_function" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, NULL, 100);  <span class="comment">// Short timeout</span></div>
<div class="line">  <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(socket);  <span class="comment">// Drive shutdown state</span></div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Unlike TLS, DTLS shutdown is best-effort due to UDP lossiness. No bidirectional close guarantee; peer may not receive alert. After shutdown, further send/recv raise errors. Metrics: Tracks shutdown events.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Abrupt <a class="el" href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4">SocketDgram_free()</a> without shutdown leaks state and skips alert. In pools, coordinate with <a class="el" href="group__connection__mgmt.html#ga24cd4e2f757497906a5aef89b133b068">SocketPool_drain()</a> for graceful.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaad0b27539517934a510df081364e08ab" title="Check if DTLS shutdown completed.">SocketDTLS_is_shutdown()</a> to check completion </dd>
<dd>
<a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c" title="Perform one step of the non-blocking DTLS handshake.">SocketDTLS_handshake()</a> to drive shutdown in non-blocking </dd>
<dd>
<a class="el" href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4" title="Dispose of a datagram socket, closing the underlying file descriptor and freeing resources.">SocketDgram_free()</a> - follow after shutdown </dd>
<dd>
<a class="el" href="group__connection__mgmt.html">Connection Management Modules</a> for pool-aware shutdown </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#graceful-shutdown for protocols. </dd></dl>

</div>
</div>
<a id="ga47055e396eb7fa4f633bb19ec7720620" name="ga47055e396eb7fa4f633bb19ec7720620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47055e396eb7fa4f633bb19ec7720620">&#9670;&#160;</a></span>SocketIPTracker_clear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketIPTracker_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clear all tracked connections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - uses internal mutex.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39" title="Dispose of IP tracker instance and release resources.">SocketIPTracker_free()</a> for complete cleanup.</dd></dl>
<p>Removes all entries from the tracker. Useful for testing or administrative reset. </p>

</div>
</div>
<a id="ga01a74a09256ae28c23c79244f6b832c0" name="ga01a74a09256ae28c23c79244f6b832c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga01a74a09256ae28c23c79244f6b832c0">&#9670;&#160;</a></span>SocketIPTracker_count()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketIPTracker_count </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current connection count for an IP address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance. </td></tr>
    <tr><td class="paramname">ip</td><td>IP address string (IPv4 or IPv6).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Current connection count (0 if not tracked). </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - uses internal mutex.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3" title="Increment connection count for specified IP; enforce limit if set.">SocketIPTracker_track()</a> for incrementing. </dd>
<dd>
<a class="el" href="group__security.html#ga340ee75715f9dd3a6446dc3ec2c528dc" title="Decrement connection count for IP; auto-remove if zero.">SocketIPTracker_release()</a> for decrementing. </dd></dl>

</div>
</div>
<a id="ga1a9850f5f3c08335dd18e2a8dbfaed39" name="ga1a9850f5f3c08335dd18e2a8dbfaed39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1a9850f5f3c08335dd18e2a8dbfaed39">&#9670;&#160;</a></span>SocketIPTracker_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketIPTracker_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> *&#160;</td>
          <td class="paramname"><em>tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dispose of IP tracker instance and release resources. </p>
<p>Cleans up internal state: destroys mutex, frees heap-allocated buckets/entries, and nullifies the pointer. For arena-allocated trackers, only nullifies pointer as actual memory freed collectively by <a class="el" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d" title="Dispose of an arena and all its allocations, freeing underlying memory chunks.">Arena_dispose()</a>.</p>
<p>Behavior details:</p><ul>
<li>Idempotent: Safe to call multiple times or on NULL/ already-freed</li>
<li>Thread-safe via mutex for destroy (but avoid concurrent ops during free)</li>
<li>Logs errors if mutex_destroy fails (rare)</li>
<li>Resets internal counters to 0 before cleanup</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">tracker</td><td>Pointer to tracker instance (set to NULL on success)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Partial - Acquires mutex internally, but concurrent</dt><dd>track/release during free may deadlock or corrupt. Coordinate shutdown before calling.</dd></dl>
<h2><a class="anchor" id="autotoc_md82"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Arena case: free() nulls, dispose arena for full cleanup</span></div>
<div class="line"><a class="code hl_typedef" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker = <a class="code hl_function" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde">SocketIPTracker_new</a>(arena, 10);</div>
<div class="line"><span class="comment">// ... use ...</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39">SocketIPTracker_free</a>(&amp;tracker); <span class="comment">// tracker = NULL</span></div>
<div class="line"><a class="code hl_function" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d">Arena_dispose</a>(&amp;arena); <span class="comment">// Frees tracker memory</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Heap case: free() releases everything</span></div>
<div class="line"><a class="code hl_typedef" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker = <a class="code hl_function" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde">SocketIPTracker_new</a>(NULL, 10);</div>
<div class="line"><span class="comment">// ... use ...</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39">SocketIPTracker_free</a>(&amp;tracker); <span class="comment">// All resources freed, tracker=NULL</span></div>
<div class="ttc" id="agroup__foundation_html_ga6842e66018614df08139e67826cf3e0d"><div class="ttname"><a href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d">Arena_dispose</a></div><div class="ttdeci">void Arena_dispose(Arena_T *ap)</div><div class="ttdoc">Dispose of an arena and all its allocations, freeing underlying memory chunks.</div></div>
<div class="ttc" id="agroup__ip__tracker_html_ga763b573474982e2761d5b7fbdf9155fc"><div class="ttname"><a href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a></div><div class="ttdeci">struct SocketIPTracker_T * SocketIPTracker_T</div><div class="ttdef"><b>Definition</b> <a href="SocketIPTracker_8h_source.html#l00210">SocketIPTracker.h:210</a></div></div>
<div class="ttc" id="agroup__security_html_ga1a9850f5f3c08335dd18e2a8dbfaed39"><div class="ttname"><a href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39">SocketIPTracker_free</a></div><div class="ttdeci">void SocketIPTracker_free(SocketIPTracker_T *tracker)</div><div class="ttdoc">Dispose of IP tracker instance and release resources.</div></div>
<div class="ttc" id="agroup__security_html_gab87cad57ddf1ed19226cf8535456bbde"><div class="ttname"><a href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde">SocketIPTracker_new</a></div><div class="ttdeci">SocketIPTracker_T SocketIPTracker_new(Arena_T arena, int max_per_ip)</div><div class="ttdoc">Create and initialize a new IP connection tracker instance.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md83"></a>
With Exception Safety</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">  <a class="code hl_typedef" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker = <a class="code hl_function" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde">SocketIPTracker_new</a>(arena, 10);</div>
<div class="line">  <span class="comment">// Operations...</span></div>
<div class="line">  <a class="code hl_define" href="group__foundation.html#ga6a0e6b80dd3d5ca395cf58151749f5e2">RETURN</a> tracker; <span class="comment">// Transfers ownership</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga4692098ecf52e6929c8763f0fa9fe222">SocketIPTracker_Failed</a>) {</div>
<div class="line">  <span class="comment">// No cleanup needed; exception unwinds</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> {</div>
<div class="line">  <a class="code hl_function" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39">SocketIPTracker_free</a>(&amp;tracker); <span class="comment">// Safe even if NULL</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__foundation_html_ga0e2a75478cd44f1666a6aca626c5c50b"><div class="ttname"><a href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a></div><div class="ttdeci">#define FINALLY</div><div class="ttdoc">Define cleanup code that executes regardless of exceptions.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l01326">Except.h:1326</a></div></div>
<div class="ttc" id="agroup__foundation_html_ga6a0e6b80dd3d5ca395cf58151749f5e2"><div class="ttname"><a href="group__foundation.html#ga6a0e6b80dd3d5ca395cf58151749f5e2">RETURN</a></div><div class="ttdeci">#define RETURN</div><div class="ttdoc">Return from function while cleaning up exception stack.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00824">Except.h:824</a></div></div>
<div class="ttc" id="agroup__security_html_ga4692098ecf52e6929c8763f0fa9fe222"><div class="ttname"><a href="group__security.html#ga4692098ecf52e6929c8763f0fa9fe222">SocketIPTracker_Failed</a></div><div class="ttdeci">const Except_T SocketIPTracker_Failed</div><div class="ttdoc">Base exception for IP tracker module failures.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><ul>
<li>Call after all operations complete; prefer in FINALLY block</li>
<li>For pools/servers, integrate with graceful drain sequences</li>
<li>No data loss: all tracked IPs cleared before free</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Concurrent modifications during free undefined; use <a class="el" href="group__security.html#ga47055e396eb7fa4f633bb19ec7720620" title="Clear all tracked connections.">SocketIPTracker_clear()</a> first if needed</li>
<li>Mutex destroy may fail if locked elsewhere (logs EPERM)</li>
<li>Arena users must dispose arena separately to avoid leaks</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n O(unique_ips) - Traverses and frees all bucket chains</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde" title="Create and initialize a new IP connection tracker instance.">SocketIPTracker_new()</a> Creation counterpart </dd>
<dd>
<a class="el" href="group__security.html#ga47055e396eb7fa4f633bb19ec7720620" title="Clear all tracked connections.">SocketIPTracker_clear()</a> Alternative for reset without destroy </dd>
<dd>
<a class="el" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d" title="Dispose of an arena and all its allocations, freeing underlying memory chunks.">Arena_dispose()</a> For arena-managed cleanup </dd>
<dd>
docs/SIGNALS.md Graceful shutdown integration </dd></dl>

</div>
</div>
<a id="ga2633ef22c045d2a4ab7f260b508bd5fc" name="ga2633ef22c045d2a4ab7f260b508bd5fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2633ef22c045d2a4ab7f260b508bd5fc">&#9670;&#160;</a></span>SocketIPTracker_getmax()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketIPTracker_getmax </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get maximum connections per IP address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Maximum connections per IP (0 = unlimited). </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga3ae1930faa05574038978e46612e5385" title="Set maximum connections per IP address.">SocketIPTracker_setmax()</a> to change the limit. </dd></dl>

</div>
</div>
<a id="ga0e4510d8147198039726bd8250b95afb" name="ga0e4510d8147198039726bd8250b95afb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e4510d8147198039726bd8250b95afb">&#9670;&#160;</a></span>SocketIPTracker_getmaxunique()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SocketIPTracker_getmaxunique </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get maximum unique IPs limit. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Current maximum unique IPs (0 = unlimited). </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga9f416e973e3f32b1c9cf2a2b620214f4" title="Set maximum unique IPs to track.">SocketIPTracker_setmaxunique()</a> to change the limit. </dd></dl>

</div>
</div>
<a id="gab87cad57ddf1ed19226cf8535456bbde" name="gab87cad57ddf1ed19226cf8535456bbde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab87cad57ddf1ed19226cf8535456bbde">&#9670;&#160;</a></span>SocketIPTracker_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> SocketIPTracker_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a>&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_per_ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create and initialize a new IP connection tracker instance. </p>
<p>Constructs a thread-safe hash table-based tracker for per-IP connection counting. Supports configurable limits, IPv4/IPv6 validation, and flexible memory management. Automatically generates a random hash seed for DoS resistance.</p>
<p>Detailed behavior:</p><ul>
<li>Clamps max_per_ip &lt; 0 to 0 (unlimited)</li>
<li>Initializes fixed-size hash table (SOCKET_IP_TRACKER_HASH_SIZE buckets)</li>
<li>Sets default max_unique_ips to SOCKET_MAX_CONNECTIONS for memory safety</li>
<li>Validates platform support (pthreads, arpa/inet.h)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arena</td><td>Arena_T for all internal allocations (NULL = use malloc/free) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_per_ip</td><td>Maximum allowed concurrent connections per IP (&gt;=0, 0=unlimited)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Validated tracker instance ready for use</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketIPTracker_Failed</td><td>Allocation or system call failures:<ul>
<li>Arena_alloc/malloc for struct or buckets array</li>
<li>pthread_mutex_init for internal locking</li>
<li>Rare arithmetic overflow in bucket sizing</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Single-threaded construction; instance safe for</dt><dd>multi-thread share</dd></dl>
<h2><a class="anchor" id="autotoc_md80"></a>
Basic Usage</h2>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> arena = <a class="code hl_function" href="group__foundation.html#ga6a6d6890eb6ed1248ae1a5f0c677c7a4">Arena_new</a>();</div>
<div class="line"><a class="code hl_typedef" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker;</div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">  tracker = <a class="code hl_function" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde">SocketIPTracker_new</a>(arena, 50); <span class="comment">// Limit 50 conns/IP</span></div>
<div class="line">  <a class="code hl_function" href="group__security.html#ga9f416e973e3f32b1c9cf2a2b620214f4">SocketIPTracker_setmaxunique</a>(tracker, 10000); <span class="comment">// Custom unique limit</span></div>
<div class="line">  <span class="comment">// Integrate with server loop...</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga4692098ecf52e6929c8763f0fa9fe222">SocketIPTracker_Failed</a>) {</div>
<div class="line">  <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;Failed to create IP tracker: %s&quot;</span>,</div>
<div class="line">Except_message(Exception));</div>
<div class="line">  <span class="comment">// Handle gracefully, e.g. fallback to no limiting</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="line"><span class="comment">// free/cleanup in FINALLY or after use</span></div>
<div class="ttc" id="agroup__foundation_html_ga6a6d6890eb6ed1248ae1a5f0c677c7a4"><div class="ttname"><a href="group__foundation.html#ga6a6d6890eb6ed1248ae1a5f0c677c7a4">Arena_new</a></div><div class="ttdeci">Arena_T Arena_new(void)</div><div class="ttdoc">Create a new memory arena with initial capacity and thread-safe protection.</div></div>
<div class="ttc" id="agroup__foundation_html_gac1ed22b9df4eff7a3398cac608c090cc"><div class="ttname"><a href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a></div><div class="ttdeci">struct Arena_T * Arena_T</div><div class="ttdef"><b>Definition</b> <a href="Arena_8h_source.html#l00080">Arena.h:80</a></div></div>
<div class="ttc" id="agroup__security_html_ga9f416e973e3f32b1c9cf2a2b620214f4"><div class="ttname"><a href="group__security.html#ga9f416e973e3f32b1c9cf2a2b620214f4">SocketIPTracker_setmaxunique</a></div><div class="ttdeci">void SocketIPTracker_setmaxunique(SocketIPTracker_T tracker, size_t max_unique)</div><div class="ttdoc">Set maximum unique IPs to track.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md81"></a>
Heap Allocation Example</h2>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a> tracker = <a class="code hl_function" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde">SocketIPTracker_new</a>(NULL, 100);</div>
<div class="line"><span class="keywordflow">if</span> (tracker) {</div>
<div class="line">  <span class="comment">// Use tracker</span></div>
<div class="line">  <a class="code hl_function" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39">SocketIPTracker_free</a>(&amp;tracker);</div>
<div class="line">} <span class="comment">// Auto-cleanup on exception via TRY if wrapped</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><ul>
<li>Arena usage recommended for batch resource management with other objects</li>
<li>Hash seed generated via SocketCrypto_random_bytes; logs fallback if crypto unavailable</li>
<li>Unlimited mode still tracks counts for monitoring but never rejects</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Ensure sufficient memory for expected unique_ips * sizeof(IPEntry) ~20 bytes/IP</li>
<li>On failure, partial allocations cleaned (heap freed, arena untouched)</li>
<li>Not movable: don't memcpy tracker instances</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Constant-time initialization independent of usage scale</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga1a9850f5f3c08335dd18e2a8dbfaed39" title="Dispose of IP tracker instance and release resources.">SocketIPTracker_free()</a> for destruction and resource release </dd>
<dd>
<a class="el" href="group__security.html#ga3ae1930faa05574038978e46612e5385" title="Set maximum connections per IP address.">SocketIPTracker_setmax()</a> runtime limit adjustment </dd>
<dd>
<a class="el" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3" title="Increment connection count for specified IP; enforce limit if set.">SocketIPTracker_track()</a> core tracking operation </dd>
<dd>
<a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> <a class="el" href="group__foundation.html">Core Foundation Modules</a> for memory management </dd>
<dd>
docs/ERROR_HANDLING.md Exception best practices </dd></dl>

</div>
</div>
<a id="ga340ee75715f9dd3a6446dc3ec2c528dc" name="ga340ee75715f9dd3a6446dc3ec2c528dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga340ee75715f9dd3a6446dc3ec2c528dc">&#9670;&#160;</a></span>SocketIPTracker_release()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketIPTracker_release </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Decrement connection count for IP; auto-remove if zero. </p>
<p>Balances <a class="el" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3" title="Increment connection count for specified IP; enforce limit if set.">SocketIPTracker_track()</a> by reducing count for a disconnecting client. Performs IP validation and efficient hash lookup. Removes entry from table when count hits 0 to conserve memory. No-op for untracked or invalid IPs.</p>
<p>Edge cases:</p><ul>
<li>Untracked IP: No-op, returns immediately</li>
<li>Invalid IP: Logs warning, no-op</li>
<li>Count underflow prevention: Ignores if already 0</li>
<li>Concurrent increments: Atomic update via mutex</li>
</ul>
<p>Updates total_conns and unique_ips atomically on removal.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tracker</td><td>Active tracker </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>IP string of disconnecting client</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Full mutex protection</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md86"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// On connection close/disconnect</span></div>
<div class="line"><span class="keywordtype">void</span> on_disconnect(Connection_T conn) {</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *ip = get_client_ip(conn); <span class="comment">// Extract from conn or socket</span></div>
<div class="line">  <a class="code hl_function" href="group__security.html#ga340ee75715f9dd3a6446dc3ec2c528dc">SocketIPTracker_release</a>(tracker, ip);</div>
<div class="line">  <span class="comment">// Optional: log if count now 0</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga01a74a09256ae28c23c79244f6b832c0">SocketIPTracker_count</a>(tracker, ip) == 0) {</div>
<div class="line">      <a class="code hl_define" href="SocketUtil_8h.html#a7853a630bcaead9d41536ccbfd598f6d">SOCKET_LOG_DEBUG_MSG</a>(<span class="stringliteral">&quot;IP %s fully disconnected&quot;</span>, ip);</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Proceed with cleanup</span></div>
<div class="line">}</div>
<div class="ttc" id="aSocketUtil_8h_html_a7853a630bcaead9d41536ccbfd598f6d"><div class="ttname"><a href="SocketUtil_8h.html#a7853a630bcaead9d41536ccbfd598f6d">SOCKET_LOG_DEBUG_MSG</a></div><div class="ttdeci">#define SOCKET_LOG_DEBUG_MSG(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00536">SocketUtil.h:536</a></div></div>
<div class="ttc" id="agroup__security_html_ga01a74a09256ae28c23c79244f6b832c0"><div class="ttname"><a href="group__security.html#ga01a74a09256ae28c23c79244f6b832c0">SocketIPTracker_count</a></div><div class="ttdeci">int SocketIPTracker_count(SocketIPTracker_T tracker, const char *ip)</div><div class="ttdoc">Get current connection count for an IP address.</div></div>
<div class="ttc" id="agroup__security_html_ga340ee75715f9dd3a6446dc3ec2c528dc"><div class="ttname"><a href="group__security.html#ga340ee75715f9dd3a6446dc3ec2c528dc">SocketIPTracker_release</a></div><div class="ttdeci">void SocketIPTracker_release(SocketIPTracker_T tracker, const char *ip)</div><div class="ttdoc">Decrement connection count for IP; auto-remove if zero.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md87"></a>
In Server Loop Context</h2>
<div class="fragment"><div class="line"><span class="comment">// Graceful close handling</span></div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">  <a class="code hl_function" href="group__core__io.html#ga559b1aaebbe5d0ca69ec99e15b1c7e68">Socket_shutdown</a>(conn_sock, SHUT_RDWR);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *ip = <a class="code hl_function" href="group__core__io.html#gab0957f43694d0728e70b23364a89623c">Socket_getpeeraddr</a>(conn_sock);</div>
<div class="line">  <a class="code hl_function" href="group__security.html#ga340ee75715f9dd3a6446dc3ec2c528dc">SocketIPTracker_release</a>(tracker, ip);</div>
<div class="line">  <a class="code hl_function" href="group__core__io.html#ga74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a>(&amp;conn_sock);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__core__io.html#ga2db3d742dcea3f39ad2eb37d4fb1e453">Socket_Closed</a>) {</div>
<div class="line">  <span class="comment">// Peer closed; still release IP count</span></div>
<div class="line">  <a class="code hl_function" href="group__security.html#ga340ee75715f9dd3a6446dc3ec2c528dc">SocketIPTracker_release</a>(tracker, ip);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__core__io_html_ga2db3d742dcea3f39ad2eb37d4fb1e453"><div class="ttname"><a href="group__core__io.html#ga2db3d742dcea3f39ad2eb37d4fb1e453">Socket_Closed</a></div><div class="ttdeci">const Except_T Socket_Closed</div><div class="ttdoc">Connection closed by peer exception.</div></div>
<div class="ttc" id="agroup__core__io_html_ga559b1aaebbe5d0ca69ec99e15b1c7e68"><div class="ttname"><a href="group__core__io.html#ga559b1aaebbe5d0ca69ec99e15b1c7e68">Socket_shutdown</a></div><div class="ttdeci">void Socket_shutdown(Socket_T socket, int how)</div><div class="ttdoc">Disable further sends and/or receives.</div></div>
<div class="ttc" id="agroup__core__io_html_ga74ad7a9bb8deaf499c59d90d6e411f37"><div class="ttname"><a href="group__core__io.html#ga74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a></div><div class="ttdeci">void Socket_free(Socket_T *socket)</div><div class="ttdoc">Dispose of a socket instance and close the underlying file descriptor.</div></div>
<div class="ttc" id="agroup__core__io_html_gab0957f43694d0728e70b23364a89623c"><div class="ttname"><a href="group__core__io.html#gab0957f43694d0728e70b23364a89623c">Socket_getpeeraddr</a></div><div class="ttdeci">const char * Socket_getpeeraddr(const Socket_T socket)</div><div class="ttdoc">Get peer IP address.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><ul>
<li>Always call on logical disconnect, even if socket error</li>
<li>Pairs with track() to maintain accurate counts</li>
<li>O(1) unlink using prev pointer tracking in impl</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Forgetting release leads to "ghost" counts and premature rejections</li>
<li>In pooled connections, ensure release on every reuse/timeout</li>
<li>Invalid IPs logged but not tracked to avoid DoS via bad data</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average - Symmetric to track(): hash + chain search</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3" title="Increment connection count for specified IP; enforce limit if set.">SocketIPTracker_track()</a> Increment counterpart </dd>
<dd>
<a class="el" href="group__security.html#ga47055e396eb7fa4f633bb19ec7720620" title="Clear all tracked connections.">SocketIPTracker_clear()</a> Bulk reset all counts </dd>
<dd>
<a class="el" href="group__connection__mgmt.html#ga930ce5b0eddb884de4c8514e4d6068c4" title="Release tracked IP when connection closes.">SocketPool_release_ip()</a> Pool variant </dd>
<dd>
docs/HTTP-REFACTOR.md <a class="el" href="group__connection__mgmt.html#structConnection" title="Internal structure representing a pooled connection slot.">Connection</a> lifecycle in HTTP servers </dd></dl>

</div>
</div>
<a id="ga3ae1930faa05574038978e46612e5385" name="ga3ae1930faa05574038978e46612e5385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ae1930faa05574038978e46612e5385">&#9670;&#160;</a></span>SocketIPTracker_setmax()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketIPTracker_setmax </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_per_ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set maximum connections per IP address. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance. </td></tr>
    <tr><td class="paramname">max_per_ip</td><td>New maximum (0 = unlimited).</td></tr>
  </table>
  </dd>
</dl>
<p>Note: Does not affect existing connections over the new limit. New connections will be rejected until count drops below limit.</p>
<dl class="section user"><dt>Thread Safety\n Yes - uses internal mutex.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga2633ef22c045d2a4ab7f260b508bd5fc" title="Get maximum connections per IP address.">SocketIPTracker_getmax()</a> to retrieve current limit. </dd>
<dd>
<a class="el" href="group__connection__mgmt.html#gaf8991c65cdec81d2a8db01a2f820a42b" title="Set maximum connections per IP.">SocketPool_setmaxperip()</a> for pool equivalent configuration. </dd></dl>

</div>
</div>
<a id="ga9f416e973e3f32b1c9cf2a2b620214f4" name="ga9f416e973e3f32b1c9cf2a2b620214f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f416e973e3f32b1c9cf2a2b620214f4">&#9670;&#160;</a></span>SocketIPTracker_setmaxunique()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketIPTracker_setmaxunique </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_unique</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set maximum unique IPs to track. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance. </td></tr>
    <tr><td class="paramname">max_unique</td><td>New maximum (0 = unlimited).</td></tr>
  </table>
  </dd>
</dl>
<p>Limits memory usage by rejecting new unique IPs when limit reached. Does not evict existing entries.</p>
<dl class="section user"><dt>Thread Safety\n Yes.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga0e4510d8147198039726bd8250b95afb" title="Get maximum unique IPs limit.">SocketIPTracker_getmaxunique()</a> to retrieve current limit. </dd></dl>

</div>
</div>
<a id="ga3e69b52a3b64cbba1b17711c9961095f" name="ga3e69b52a3b64cbba1b17711c9961095f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3e69b52a3b64cbba1b17711c9961095f">&#9670;&#160;</a></span>SocketIPTracker_total()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SocketIPTracker_total </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get total tracked connections across all IPs. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Total number of tracked connections across all IPs. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - uses internal mutex.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gad8639fe1f640949b820cd1496a67ca56" title="Get number of unique IPs being tracked.">SocketIPTracker_unique_ips()</a> for unique IP count. </dd></dl>

</div>
</div>
<a id="ga796a06e82e58c6fea3deaf767101dea3" name="ga796a06e82e58c6fea3deaf767101dea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga796a06e82e58c6fea3deaf767101dea3">&#9670;&#160;</a></span>SocketIPTracker_track()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketIPTracker_track </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Increment connection count for specified IP; enforce limit if set. </p>
<p>Core operation to track a new connection from a client IP. Performs IP validation, hash lookup, and conditional increment based on current limit. Creates new entry if IP not previously tracked.</p>
<p>Edge cases:</p><ul>
<li>Invalid format (non IPv4/6 or too long): Returns 0 (reject), logs warning</li>
<li>Unlimited mode: Always succeeds, increments count</li>
<li>Max unique reached: Rejects new unique IP (logs warning)</li>
<li>Alloc fail for new entry: Succeeds in unlimited, fails limited</li>
<li>NULL/empty ip: Returns 1, no tracking (safe default)</li>
</ul>
<p>Updates internal total_conns and unique_ips counters atomically.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tracker</td><td>Active tracker instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Null-terminated IP string (e.g. "192.0.2.1" or "[2001:db8::1]")</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if connection allowed and tracked, 0 if rejected (limit or error)</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - Mutex protects entire operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md84"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// In server accept loop</span></div>
<div class="line">Socket_T client_sock = <a class="code hl_function" href="group__core__io.html#ga32b67d95639513cd6a602f6175b48f15">Socket_accept</a>(server_sock);</div>
<div class="line"><span class="keywordflow">if</span> (client_sock) {</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *client_ip = <a class="code hl_function" href="group__core__io.html#gab0957f43694d0728e70b23364a89623c">Socket_getpeeraddr</a>(client_sock);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3">SocketIPTracker_track</a>(tracker, client_ip)) {</div>
<div class="line">      <span class="comment">// Proceed with connection setup</span></div>
<div class="line">      Connection_T conn = <a class="code hl_function" href="group__connection__mgmt.html#gac7720c7b7d679624fa95bdefe9a38494">SocketPool_add</a>(pool, client_sock);</div>
<div class="line">      <span class="comment">// Associate conn with IP if needed</span></div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="comment">// Reject: too many from this IP</span></div>
<div class="line">      <a class="code hl_define" href="SocketUtil_8h.html#ae560ccd4aef66d44e8ecbd256844059c">SOCKET_LOG_WARN_MSG</a>(<span class="stringliteral">&quot;Rejecting connection from %s: limit exceeded&quot;</span>,</div>
<div class="line">client_ip); <a class="code hl_function" href="group__core__io.html#ga74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a>(&amp;client_sock);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="aSocketUtil_8h_html_ae560ccd4aef66d44e8ecbd256844059c"><div class="ttname"><a href="SocketUtil_8h.html#ae560ccd4aef66d44e8ecbd256844059c">SOCKET_LOG_WARN_MSG</a></div><div class="ttdeci">#define SOCKET_LOG_WARN_MSG(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00544">SocketUtil.h:544</a></div></div>
<div class="ttc" id="agroup__connection__mgmt_html_gac7720c7b7d679624fa95bdefe9a38494"><div class="ttname"><a href="group__connection__mgmt.html#gac7720c7b7d679624fa95bdefe9a38494">SocketPool_add</a></div><div class="ttdeci">Connection_T SocketPool_add(SocketPool_T pool, Socket_T socket)</div><div class="ttdoc">Add a connected socket to the pool, creating a Connection_T wrapper.</div></div>
<div class="ttc" id="agroup__core__io_html_ga32b67d95639513cd6a602f6175b48f15"><div class="ttname"><a href="group__core__io.html#ga32b67d95639513cd6a602f6175b48f15">Socket_accept</a></div><div class="ttdeci">Socket_T Socket_accept(Socket_T socket)</div><div class="ttdoc">Accept incoming connection.</div></div>
<div class="ttc" id="agroup__security_html_ga796a06e82e58c6fea3deaf767101dea3"><div class="ttname"><a href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3">SocketIPTracker_track</a></div><div class="ttdeci">int SocketIPTracker_track(SocketIPTracker_T tracker, const char *ip)</div><div class="ttdoc">Increment connection count for specified IP; enforce limit if set.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md85"></a>
Advanced: With Metrics</h2>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga796a06e82e58c6fea3deaf767101dea3">SocketIPTracker_track</a>(tracker, ip)) {</div>
<div class="line">    <span class="keywordtype">size_t</span> total = <a class="code hl_function" href="group__security.html#ga3e69b52a3b64cbba1b17711c9961095f">SocketIPTracker_total</a>(tracker);</div>
<div class="line">    <span class="keywordtype">size_t</span> uniques = <a class="code hl_function" href="group__security.html#gad8639fe1f640949b820cd1496a67ca56">SocketIPTracker_unique_ips</a>(tracker);</div>
<div class="line">    <a class="code hl_define" href="SocketUtil_8h.html#a9fe70c7ab8b971af2971f3a102b82819">SOCKET_LOG_INFO_MSG</a>(<span class="stringliteral">&quot;New conn from %s; total=%zu, uniques=%zu&quot;</span>, ip,</div>
<div class="line">total, uniques); <a class="code hl_function" href="group__foundation.html#ga84618017b97e3f0eeb3c4814e939a7b4">SocketMetrics_increment</a>(CONNECTION_ACCEPTED, 1); } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_function" href="group__foundation.html#ga84618017b97e3f0eeb3c4814e939a7b4">SocketMetrics_increment</a>(CONNECTION_REJECTED_RATE_LIMIT, 1);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__foundation_html_ga84618017b97e3f0eeb3c4814e939a7b4"><div class="ttname"><a href="group__foundation.html#ga84618017b97e3f0eeb3c4814e939a7b4">SocketMetrics_increment</a></div><div class="ttdeci">void SocketMetrics_increment(SocketMetric metric, unsigned long value)</div><div class="ttdoc">SocketMetrics_increment - Increment a metric counter.</div></div>
<div class="ttc" id="agroup__security_html_ga3e69b52a3b64cbba1b17711c9961095f"><div class="ttname"><a href="group__security.html#ga3e69b52a3b64cbba1b17711c9961095f">SocketIPTracker_total</a></div><div class="ttdeci">size_t SocketIPTracker_total(SocketIPTracker_T tracker)</div><div class="ttdoc">Get total tracked connections across all IPs.</div></div>
<div class="ttc" id="agroup__security_html_gad8639fe1f640949b820cd1496a67ca56"><div class="ttname"><a href="group__security.html#gad8639fe1f640949b820cd1496a67ca56">SocketIPTracker_unique_ips</a></div><div class="ttdeci">size_t SocketIPTracker_unique_ips(SocketIPTracker_T tracker)</div><div class="ttdoc">Get number of unique IPs being tracked.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd><ul>
<li>Call on every accept/handshake completion, before full connection setup</li>
<li>IP must be canonical (no ports, resolved from getpeername or headers)</li>
<li>Performance: Fast hash lookup; chain traversal avg ~1</li>
</ul>
</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd><ul>
<li>Rejecting invalid IPs prevents spoofing but may block malformed proxies</li>
<li>Under high load, monitor for alloc failures in limited mode</li>
<li>Pair with SocketSYNProtect for layered SYN flood + conn limit defense</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average - Hash computation + chain search (short avg)</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(buckets load) worst - Linear chain if collisions</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga340ee75715f9dd3a6446dc3ec2c528dc" title="Decrement connection count for IP; auto-remove if zero.">SocketIPTracker_release()</a> Balance with disconnect </dd>
<dd>
<a class="el" href="group__security.html#ga01a74a09256ae28c23c79244f6b832c0" title="Get current connection count for an IP address.">SocketIPTracker_count()</a> Query current count for IP </dd>
<dd>
validate_ip_format() Internal check (IPv4/6 via inet_pton) </dd>
<dd>
<a class="el" href="group__connection__mgmt.html#ga9b0182834888e8b3136846f5fca1bc64" title="Manually track IP for per-IP limiting.">SocketPool_track_ip()</a> If using pool-managed tracking </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> Rate limiting strategies </dd></dl>

</div>
</div>
<a id="gad8639fe1f640949b820cd1496a67ca56" name="gad8639fe1f640949b820cd1496a67ca56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad8639fe1f640949b820cd1496a67ca56">&#9670;&#160;</a></span>SocketIPTracker_unique_ips()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SocketIPTracker_unique_ips </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__ip__tracker.html#ga763b573474982e2761d5b7fbdf9155fc">SocketIPTracker_T</a>&#160;</td>
          <td class="paramname"><em>tracker</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of unique IPs being tracked. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tracker</td><td>IP tracker instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of unique IP addresses with at least one connection. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - uses internal mutex.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga3e69b52a3b64cbba1b17711c9961095f" title="Get total tracked connections across all IPs.">SocketIPTracker_total()</a> for total connection count. </dd></dl>

</div>
</div>
<a id="ga6be6d5871d5869421280eb62f3492ca3" name="ga6be6d5871d5869421280eb62f3492ca3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6be6d5871d5869421280eb62f3492ca3">&#9670;&#160;</a></span>SocketSYNProtect_action_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketSYNProtect_action_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a>&#160;</td>
          <td class="paramname"><em>action</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert SYN action enum to human-readable string. </p>
<p>Converts an action enum value to its string representation for logging, debugging, monitoring dashboards, or user-facing display.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">action</td><td>Action enum value to convert</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to static null-terminated string ("ALLOW", "THROTTLE", "CHALLENGE", "BLOCK")</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - pure function returning constant data</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md192"></a>
Return Values</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Input   </th><th class="markdownTableHeadNone">Output    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SYN_ACTION_ALLOW   </td><td class="markdownTableBodyNone">"ALLOW"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SYN_ACTION_THROTTLE   </td><td class="markdownTableBodyNone">"THROTTLE"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SYN_ACTION_CHALLENGE   </td><td class="markdownTableBodyNone">"CHALLENGE"    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SYN_ACTION_BLOCK   </td><td class="markdownTableBodyNone">"BLOCK"    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(invalid)   </td><td class="markdownTableBodyNone">"UNKNOWN"   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md193"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> action = <a class="code hl_function" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a>(protect, client_ip, NULL);</div>
<div class="line">printf(<span class="stringliteral">&quot;Action for %s: %s\n&quot;</span>, client_ip,</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga6be6d5871d5869421280eb62f3492ca3">SocketSYNProtect_action_name</a>(action));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Logging pattern</span></div>
<div class="line">log_info(<span class="stringliteral">&quot;SYN check: ip=%s action=%s&quot;</span>, client_ip,</div>
<div class="line">         <a class="code hl_function" href="group__security.html#ga6be6d5871d5869421280eb62f3492ca3">SocketSYNProtect_action_name</a>(action));</div>
<div class="ttc" id="agroup__security_html_ga45b12919783a7ba4426db4134fda1a5f"><div class="ttname"><a href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a></div><div class="ttdeci">SocketSYN_Action SocketSYNProtect_check(SocketSYNProtect_T protect, const char *client_ip, SocketSYN_IPState *state_out)</div><div class="ttdoc">Evaluate client IP and determine protection action.</div></div>
<div class="ttc" id="agroup__security_html_ga6be6d5871d5869421280eb62f3492ca3"><div class="ttname"><a href="group__security.html#ga6be6d5871d5869421280eb62f3492ca3">SocketSYNProtect_action_name</a></div><div class="ttdeci">const char * SocketSYNProtect_action_name(SocketSYN_Action action)</div><div class="ttdoc">Convert SYN action enum to human-readable string.</div></div>
<div class="ttc" id="agroup__security_html_gaca8f2a71ab649ccd408fd3fdb3b693b9"><div class="ttname"><a href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a></div><div class="ttdeci">SocketSYN_Action</div><div class="ttdoc">Protection response actions for SYN connection attempts.</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00194">SocketSYNProtect.h:195</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Returns static string - do not free or modify</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - constant time lookup</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9" title="Protection response actions for SYN connection attempts.">SocketSYN_Action</a> for enum values and meanings </dd>
<dd>
<a class="el" href="group__security.html#gaaf2b0ff9a3054e262ba32b395c2abe50" title="Convert reputation enum to human-readable string.">SocketSYNProtect_reputation_name()</a> for reputation level strings </dd></dl>

</div>
</div>
<a id="ga02eca11c24cc41b3f1fafdcbcae6e485" name="ga02eca11c24cc41b3f1fafdcbcae6e485"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga02eca11c24cc41b3f1fafdcbcae6e485">&#9670;&#160;</a></span>SocketSYNProtect_blacklist_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketSYNProtect_blacklist_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>duration_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add an IP address to the blacklist. </p>
<p>Adds an IP address to the blacklist, causing all future connection attempts from this IP to immediately receive SYN_ACTION_BLOCK. Supports both temporary (auto-expiring) and permanent blocks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Null-terminated IP address string (IPv4 or IPv6) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">duration_ms</td><td>Block duration: positive = temporary (auto-expires), 0 = permanent</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (added or duration extended), 0 if blacklist is full</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md183"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Permanent block for known malicious IP</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, <span class="stringliteral">&quot;192.0.2.1&quot;</span>, 0);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Temporary 5-minute block</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, <span class="stringliteral">&quot;203.0.113.50&quot;</span>, 300000);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// 24-hour block for suspected attacker</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, <span class="stringliteral">&quot;198.51.100.10&quot;</span>, 86400000);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Automatic blocking based on behavior</span></div>
<div class="line"><span class="keywordtype">void</span> on_suspicious_activity(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, <span class="keyword">const</span> <span class="keywordtype">char</span> *ip) {</div>
<div class="line">    <span class="comment">// Progressive blocking: longer each time</span></div>
<div class="line">    <span class="keyword">static</span> <span class="keywordtype">int</span> block_duration = 60000; <span class="comment">// Start at 1 minute</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, ip, block_duration);</div>
<div class="line">    block_duration = (block_duration &lt; 3600000) ? block_duration * 2 :</div>
<div class="line">3600000;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Handle blacklist full condition</span></div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, attacker_ip, 0)) {</div>
<div class="line">    <span class="comment">// Blacklist full - run cleanup or increase max_blacklist</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga89041cde278498408febb062da3dd23b">SocketSYNProtect_cleanup</a>(protect);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, attacker_ip, 0);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga02eca11c24cc41b3f1fafdcbcae6e485"><div class="ttname"><a href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a></div><div class="ttdeci">int SocketSYNProtect_blacklist_add(SocketSYNProtect_T protect, const char *ip, int duration_ms)</div><div class="ttdoc">Add an IP address to the blacklist.</div></div>
<div class="ttc" id="agroup__security_html_ga89041cde278498408febb062da3dd23b"><div class="ttname"><a href="group__security.html#ga89041cde278498408febb062da3dd23b">SocketSYNProtect_cleanup</a></div><div class="ttdeci">size_t SocketSYNProtect_cleanup(SocketSYNProtect_T protect)</div><div class="ttdoc">Perform periodic cleanup of expired and stale protection state.</div></div>
<div class="ttc" id="agroup__security_html_structSocketSYNProtect__T"><div class="ttname"><a href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a></div><div class="ttdoc">Core internal structure for the SYN protection module.</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect-private_8h_source.html#l00224">SocketSYNProtect-private.h:225</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>If IP already blacklisted with temporary block, duration is extended</dd>
<dd>
Permanent blocks (duration_ms=0) persist until manual removal or reset</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average case - hash table insertion</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga88d4fb38017492beca3f130d311dadd5" title="Check if an IP address is currently blacklisted.">SocketSYNProtect_blacklist_contains()</a> to check block status </dd>
<dd>
<a class="el" href="group__security.html#ga4e67e158bb567ffb7620738ba28b16f8" title="Remove an IP address from the blacklist.">SocketSYNProtect_blacklist_remove()</a> for manual unblocking </dd>
<dd>
<a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b" title="Perform periodic cleanup of expired and stale protection state.">SocketSYNProtect_cleanup()</a> for automatic expiration of temporary blocks </dd>
<dd>
<a class="el" href="group__security.html#a7429afc5fc724582c34ce06cb3d3f5fa">SocketSYNProtect_Config::max_blacklist</a> for capacity limits </dd></dl>

</div>
</div>
<a id="ga9519e23838092f497693c4a488789f1b" name="ga9519e23838092f497693c4a488789f1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9519e23838092f497693c4a488789f1b">&#9670;&#160;</a></span>SocketSYNProtect_blacklist_clear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_blacklist_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clear all blacklist entries. </p>
<p>Removes all entries from the blacklist, including both temporary and permanent blocks. After this call, all previously blocked IPs will be subject to normal SYN protection evaluation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md186"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Clear blacklist after attack investigation concludes</span></div>
<div class="line"><span class="keywordtype">void</span> on_attack_resolved(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Attack resolved, clearing blacklist\n&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga9519e23838092f497693c4a488789f1b">SocketSYNProtect_blacklist_clear</a>(protect);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optionally reset stats for fresh monitoring</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga59f2d1168a808c2c2d0584b031d96422">SocketSYNProtect_stats_reset</a>(protect);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Replace blacklist with new set</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga9519e23838092f497693c4a488789f1b">SocketSYNProtect_blacklist_clear</a>(protect);</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, <span class="stringliteral">&quot;192.0.2.1&quot;</span>, 0);</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485">SocketSYNProtect_blacklist_add</a>(protect, <span class="stringliteral">&quot;198.51.100.0&quot;</span>, 0);</div>
<div class="ttc" id="agroup__security_html_ga59f2d1168a808c2c2d0584b031d96422"><div class="ttname"><a href="group__security.html#ga59f2d1168a808c2c2d0584b031d96422">SocketSYNProtect_stats_reset</a></div><div class="ttdeci">void SocketSYNProtect_stats_reset(SocketSYNProtect_T protect)</div><div class="ttdoc">Reset all resettable statistics counters to zero.</div></div>
<div class="ttc" id="agroup__security_html_ga9519e23838092f497693c4a488789f1b"><div class="ttname"><a href="group__security.html#ga9519e23838092f497693c4a488789f1b">SocketSYNProtect_blacklist_clear</a></div><div class="ttdeci">void SocketSYNProtect_blacklist_clear(SocketSYNProtect_T protect)</div><div class="ttdoc">Clear all blacklist entries.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Use with caution - may allow previously blocked attackers</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) - must free all blacklist entries</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485" title="Add an IP address to the blacklist.">SocketSYNProtect_blacklist_add()</a> to add new blocks </dd>
<dd>
<a class="el" href="group__security.html#ga4e67e158bb567ffb7620738ba28b16f8" title="Remove an IP address from the blacklist.">SocketSYNProtect_blacklist_remove()</a> for individual removal </dd>
<dd>
<a class="el" href="group__security.html#ga50962d47d9b56957714f313e2051e1bf" title="Clear all whitelist entries.">SocketSYNProtect_whitelist_clear()</a> for clearing whitelists </dd>
<dd>
<a class="el" href="group__security.html#ga01aa18277f6346e8803de9f705573528" title="Perform full reset of the SYN protection instance to initial state.">SocketSYNProtect_reset()</a> for full instance reset </dd></dl>

</div>
</div>
<a id="ga88d4fb38017492beca3f130d311dadd5" name="ga88d4fb38017492beca3f130d311dadd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga88d4fb38017492beca3f130d311dadd5">&#9670;&#160;</a></span>SocketSYNProtect_blacklist_contains()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketSYNProtect_blacklist_contains </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if an IP address is currently blacklisted. </p>
<p>Determines whether a specific IP address is actively blocked in the blacklist. Expired temporary blocks are not considered active and return 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Null-terminated IP address string to check (IPv4 or IPv6)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if actively blacklisted (not expired), 0 otherwise</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - read-only operation with mutex protection</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md185"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Check status for logging</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga88d4fb38017492beca3f130d311dadd5">SocketSYNProtect_blacklist_contains</a>(protect, client_ip)) {</div>
<div class="line">    log_warn(<span class="stringliteral">&quot;Connection attempt from blacklisted IP: %s&quot;</span>, client_ip);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Verify block is active before external action</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga88d4fb38017492beca3f130d311dadd5">SocketSYNProtect_blacklist_contains</a>(protect, attacker_ip)) {</div>
<div class="line">    <span class="comment">// Report to external threat intelligence</span></div>
<div class="line">    report_to_threat_intel(attacker_ip);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga88d4fb38017492beca3f130d311dadd5"><div class="ttname"><a href="group__security.html#ga88d4fb38017492beca3f130d311dadd5">SocketSYNProtect_blacklist_contains</a></div><div class="ttdeci">int SocketSYNProtect_blacklist_contains(SocketSYNProtect_T protect, const char *ip)</div><div class="ttdoc">Check if an IP address is currently blacklisted.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This is called internally by <code><a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a></code> </dd>
<dd>
Expired temporary blocks return 0 (considered not blacklisted)</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average case - hash table lookup</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485" title="Add an IP address to the blacklist.">SocketSYNProtect_blacklist_add()</a> for blocking IPs </dd>
<dd>
<a class="el" href="group__security.html#ga4e67e158bb567ffb7620738ba28b16f8" title="Remove an IP address from the blacklist.">SocketSYNProtect_blacklist_remove()</a> for manual unblocking </dd>
<dd>
<a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> which uses this internally </dd></dl>

</div>
</div>
<a id="ga4e67e158bb567ffb7620738ba28b16f8" name="ga4e67e158bb567ffb7620738ba28b16f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4e67e158bb567ffb7620738ba28b16f8">&#9670;&#160;</a></span>SocketSYNProtect_blacklist_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_blacklist_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove an IP address from the blacklist. </p>
<p>Immediately removes an IP address from the blacklist, allowing future connection attempts to be processed through normal rate limiting and reputation evaluation. This can be used for manual unblocking or administrative override.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Null-terminated IP address string to unblock (IPv4 or IPv6)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md184"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Admin override - unblock a false positive</span></div>
<div class="line"><span class="keywordtype">void</span> admin_unblock(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, <span class="keyword">const</span> <span class="keywordtype">char</span> *ip) {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga4e67e158bb567ffb7620738ba28b16f8">SocketSYNProtect_blacklist_remove</a>(protect, ip);</div>
<div class="line">    printf(<span class="stringliteral">&quot;IP %s removed from blacklist\n&quot;</span>, ip);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optionally whitelist to prevent re-blocking</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a>(protect, ip);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Verify removal succeeded</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga4e67e158bb567ffb7620738ba28b16f8">SocketSYNProtect_blacklist_remove</a>(protect, <span class="stringliteral">&quot;192.0.2.1&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group__security.html#ga88d4fb38017492beca3f130d311dadd5">SocketSYNProtect_blacklist_contains</a>(protect, <span class="stringliteral">&quot;192.0.2.1&quot;</span>)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;IP successfully unblocked\n&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga2a601f0c4520ae271b27a49c5bd19108"><div class="ttname"><a href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a></div><div class="ttdeci">int SocketSYNProtect_whitelist_add(SocketSYNProtect_T protect, const char *ip)</div><div class="ttdoc">Add an IP address to the whitelist.</div></div>
<div class="ttc" id="agroup__security_html_ga4e67e158bb567ffb7620738ba28b16f8"><div class="ttname"><a href="group__security.html#ga4e67e158bb567ffb7620738ba28b16f8">SocketSYNProtect_blacklist_remove</a></div><div class="ttdeci">void SocketSYNProtect_blacklist_remove(SocketSYNProtect_T protect, const char *ip)</div><div class="ttdoc">Remove an IP address from the blacklist.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>No-op if IP not currently blacklisted</dd>
<dd>
IP reputation state (if tracked) is preserved after unblocking</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average case - hash table lookup and removal</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga02eca11c24cc41b3f1fafdcbcae6e485" title="Add an IP address to the blacklist.">SocketSYNProtect_blacklist_add()</a> for blocking IPs </dd>
<dd>
<a class="el" href="group__security.html#ga88d4fb38017492beca3f130d311dadd5" title="Check if an IP address is currently blacklisted.">SocketSYNProtect_blacklist_contains()</a> to verify removal </dd>
<dd>
<a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b" title="Perform periodic cleanup of expired and stale protection state.">SocketSYNProtect_cleanup()</a> for automatic expiration </dd></dl>

</div>
</div>
<a id="ga45b12919783a7ba4426db4134fda1a5f" name="ga45b12919783a7ba4426db4134fda1a5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga45b12919783a7ba4426db4134fda1a5f">&#9670;&#160;</a></span>SocketSYNProtect_check()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> SocketSYNProtect_check </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>client_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a> *&#160;</td>
          <td class="paramname"><em>state_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Evaluate client IP and determine protection action. </p>
<p>Performs comprehensive SYN flood protection evaluation for an incoming connection attempt. Checks whitelist/blacklist status, rate limits, reputation scores, and applies appropriate protection actions. This is the core function called before accepting any connection.</p>
<p>The evaluation process:</p><ol type="1">
<li>Check whitelist/blacklist (immediate ALLOW/BLOCK)</li>
<li>Verify rate limits for the IP and globally</li>
<li>Assess reputation based on success/failure history</li>
<li>Determine action: ALLOW, THROTTLE, CHALLENGE, or BLOCK</li>
<li>Update attempt counters for rate limiting</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">client_ip</td><td>Client IP address (IPv4/IPv6) or NULL/empty for unconditional ALLOW </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">state_out</td><td>Optional output for detailed IP state information (may be NULL)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Protection action: SYN_ACTION_ALLOW, THROTTLE, CHALLENGE, or BLOCK</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - internal mutex protects all shared state modifications</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md173"></a>
Usage Pattern</h2>
<div class="fragment"><div class="line"><span class="comment">// In connection acceptance loop</span></div>
<div class="line"><span class="keyword">struct </span>sockaddr_in client_addr;</div>
<div class="line">socklen_t addr_len = <span class="keyword">sizeof</span>(client_addr);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> fd = accept(server_fd, (<span class="keyword">struct</span> sockaddr*)&amp;client_addr, &amp;addr_len);</div>
<div class="line"><span class="keywordflow">if</span> (fd &gt;= 0) {</div>
<div class="line">    <span class="keywordtype">char</span> client_ip[INET6_ADDRSTRLEN];</div>
<div class="line">    inet_ntop(client_addr.sin_family,</div>
<div class="line">              client_addr.sin_family == AF_INET ?</div>
<div class="line">                  (<span class="keywordtype">void</span>*)&amp;client_addr.sin_addr :</div>
<div class="line">                  (void*)&amp;((struct sockaddr_in6*)&amp;client_addr)-&gt;sin6_addr,</div>
<div class="line">              client_ip, sizeof(client_ip));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_enumeration" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> action = <a class="code hl_function" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a>(protect, client_ip,</div>
<div class="line">NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (action) {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9ab7af7c3605f188d109f9528dd72a7af8">SYN_ACTION_ALLOW</a>:</div>
<div class="line">            <span class="comment">// Normal processing</span></div>
<div class="line">            handle_connection(fd, client_ip);</div>
<div class="line">            <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect, client_ip);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9a57b3e54beba358c83e8a91f2136d61d9">SYN_ACTION_THROTTLE</a>:</div>
<div class="line">            <span class="comment">// Accept but add delay</span></div>
<div class="line">            usleep(100000); <span class="comment">// 100ms delay</span></div>
<div class="line">            handle_connection(fd, client_ip);</div>
<div class="line">            <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect, client_ip);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9a47e6cde53adccac1b4948afbc22b16d1">SYN_ACTION_CHALLENGE</a>:</div>
<div class="line">            <span class="comment">// Use TCP_DEFER_ACCEPT if available, or accept normally</span></div>
<div class="line">            handle_connection(fd, client_ip);</div>
<div class="line">            <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect, client_ip);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa">SYN_ACTION_BLOCK</a>:</div>
<div class="line">            <span class="comment">// Reject connection</span></div>
<div class="line">            close(fd);</div>
<div class="line">            <a class="code hl_function" href="group__security.html#ga573fee7bcaf625b171053b87159af53e">SocketSYNProtect_report_failure</a>(protect, client_ip,</div>
<div class="line">ECONNREFUSED); <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga573fee7bcaf625b171053b87159af53e"><div class="ttname"><a href="group__security.html#ga573fee7bcaf625b171053b87159af53e">SocketSYNProtect_report_failure</a></div><div class="ttdeci">void SocketSYNProtect_report_failure(SocketSYNProtect_T protect, const char *client_ip, int error_code)</div><div class="ttdoc">Report connection failure for IP reputation update.</div></div>
<div class="ttc" id="agroup__security_html_ga979954abc96c529d1205d432fc13c661"><div class="ttname"><a href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a></div><div class="ttdeci">void SocketSYNProtect_report_success(SocketSYNProtect_T protect, const char *client_ip)</div><div class="ttdoc">Report successful connection completion for IP reputation update.</div></div>
<div class="ttc" id="agroup__security_html_ggaca8f2a71ab649ccd408fd3fdb3b693b9a47e6cde53adccac1b4948afbc22b16d1"><div class="ttname"><a href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9a47e6cde53adccac1b4948afbc22b16d1">SYN_ACTION_CHALLENGE</a></div><div class="ttdeci">@ SYN_ACTION_CHALLENGE</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00200">SocketSYNProtect.h:199</a></div></div>
<div class="ttc" id="agroup__security_html_ggaca8f2a71ab649ccd408fd3fdb3b693b9a57b3e54beba358c83e8a91f2136d61d9"><div class="ttname"><a href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9a57b3e54beba358c83e8a91f2136d61d9">SYN_ACTION_THROTTLE</a></div><div class="ttdeci">@ SYN_ACTION_THROTTLE</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00198">SocketSYNProtect.h:197</a></div></div>
<div class="ttc" id="agroup__security_html_ggaca8f2a71ab649ccd408fd3fdb3b693b9ab7af7c3605f188d109f9528dd72a7af8"><div class="ttname"><a href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9ab7af7c3605f188d109f9528dd72a7af8">SYN_ACTION_ALLOW</a></div><div class="ttdeci">@ SYN_ACTION_ALLOW</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00196">SocketSYNProtect.h:196</a></div></div>
<div class="ttc" id="agroup__security_html_ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa"><div class="ttname"><a href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa">SYN_ACTION_BLOCK</a></div><div class="ttdeci">@ SYN_ACTION_BLOCK</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00202">SocketSYNProtect.h:201</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md174"></a>
Integration with SocketPool</h2>
<div class="fragment"><div class="line"><span class="comment">// SocketPool handles the check automatically</span></div>
<div class="line"><a class="code hl_struct" href="SocketPool-private_8h.html#structSocketPool__T">SocketPool_T</a> pool = <a class="code hl_function" href="group__connection__mgmt.html#ga2774ba952af4a9a218e33b492aed1a18">SocketPool_new</a>(arena, 1000, 4096);</div>
<div class="line"><a class="code hl_function" href="group__connection__mgmt.html#ga847e3ae8d165d8a999ef76a68d21ffa5">SocketPool_set_syn_protection</a>(pool, protect);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// This internally calls SocketSYNProtect_check()</span></div>
<div class="line">Connection_T conn = <a class="code hl_function" href="group__connection__mgmt.html#gabd8219ceff615ad4a4064cf389f137a6">SocketPool_accept_limited</a>(pool, server_socket);</div>
<div class="line"><span class="keywordflow">if</span> (conn) {</div>
<div class="line">    <span class="comment">// Connection accepted and tracked</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect,</div>
<div class="line">        <a class="code hl_function" href="group__core__io.html#gab0957f43694d0728e70b23364a89623c">Socket_getpeeraddr</a>(<a class="code hl_function" href="group__connection__mgmt.html#gaaeff7efb1109a312f56e35689b67c652">Connection_socket</a>(conn)));</div>
<div class="line">}</div>
<div class="ttc" id="aSocketPool-private_8h_html_structSocketPool__T"><div class="ttname"><a href="SocketPool-private_8h.html#structSocketPool__T">SocketPool_T</a></div><div class="ttdef"><b>Definition</b> <a href="SocketPool-private_8h_source.html#l00469">SocketPool-private.h:470</a></div></div>
<div class="ttc" id="agroup__connection__mgmt_html_ga2774ba952af4a9a218e33b492aed1a18"><div class="ttname"><a href="group__connection__mgmt.html#ga2774ba952af4a9a218e33b492aed1a18">SocketPool_new</a></div><div class="ttdeci">SocketPool_T SocketPool_new(Arena_T arena, size_t maxconns, size_t bufsize)</div><div class="ttdoc">Create a new connection pool.</div></div>
<div class="ttc" id="agroup__connection__mgmt_html_ga847e3ae8d165d8a999ef76a68d21ffa5"><div class="ttname"><a href="group__connection__mgmt.html#ga847e3ae8d165d8a999ef76a68d21ffa5">SocketPool_set_syn_protection</a></div><div class="ttdeci">void SocketPool_set_syn_protection(SocketPool_T pool, SocketSYNProtect_T protect)</div><div class="ttdoc">Enable SYN flood protection for pool.</div></div>
<div class="ttc" id="agroup__connection__mgmt_html_gaaeff7efb1109a312f56e35689b67c652"><div class="ttname"><a href="group__connection__mgmt.html#gaaeff7efb1109a312f56e35689b67c652">Connection_socket</a></div><div class="ttdeci">Socket_T Connection_socket(const Connection_T conn)</div><div class="ttdoc">Get connection's socket.</div></div>
<div class="ttc" id="agroup__connection__mgmt_html_gabd8219ceff615ad4a4064cf389f137a6"><div class="ttname"><a href="group__connection__mgmt.html#gabd8219ceff615ad4a4064cf389f137a6">SocketPool_accept_limited</a></div><div class="ttdeci">Socket_T SocketPool_accept_limited(SocketPool_T pool, Socket_T server)</div><div class="ttdoc">Accept connection with rate limiting.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Always call <code><a class="el" href="group__security.html#ga979954abc96c529d1205d432fc13c661" title="Report successful connection completion for IP reputation update.">SocketSYNProtect_report_success()</a></code> or <code><a class="el" href="group__security.html#ga573fee7bcaf625b171053b87159af53e" title="Report connection failure for IP reputation update.">SocketSYNProtect_report_failure()</a></code> after connection outcome is known</dd>
<dd>
NULL or empty client_ip always returns SYN_ACTION_ALLOW</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average case - hash table lookups</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9" title="Protection response actions for SYN connection attempts.">SocketSYN_Action</a> for action meanings and handling </dd>
<dd>
<a class="el" href="group__security.html#ga979954abc96c529d1205d432fc13c661" title="Report successful connection completion for IP reputation update.">SocketSYNProtect_report_success()</a> for successful connections </dd>
<dd>
<a class="el" href="group__security.html#ga573fee7bcaf625b171053b87159af53e" title="Report connection failure for IP reputation update.">SocketSYNProtect_report_failure()</a> for failed connections </dd>
<dd>
<a class="el" href="group__security.html#structSocketSYN__IPState" title="Per-IP address tracking and reputation state.">SocketSYN_IPState</a> for detailed state information </dd>
<dd>
<a class="el" href="group__connection__mgmt.html#ga847e3ae8d165d8a999ef76a68d21ffa5" title="Enable SYN flood protection for pool.">SocketPool_set_syn_protection()</a> for automatic integration </dd>
<dd>
docs/SYN-PROTECT.md for protection algorithms and tuning </dd></dl>

</div>
</div>
<a id="ga89041cde278498408febb062da3dd23b" name="ga89041cde278498408febb062da3dd23b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89041cde278498408febb062da3dd23b">&#9670;&#160;</a></span>SocketSYNProtect_cleanup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SocketSYNProtect_cleanup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform periodic cleanup of expired and stale protection state. </p>
<p>Performs maintenance operations to keep the protection system efficient and up-to-date. This function should be called regularly (every 1-10 seconds) to:</p>
<ul>
<li>Expire temporary blacklists and blocks based on duration settings</li>
<li>Evict least-recently-used IP states when approaching max_tracked_ips limit</li>
<li>Apply reputation score decay over time</li>
<li>Advance sliding windows for rate limiting calculations</li>
<li>Remove stale entries to maintain performance</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of IP entries cleaned up (evicted or expired)</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md196"></a>
Integration with Event Loops</h2>
<div class="fragment"><div class="line"><span class="comment">// Using SocketTimer for periodic cleanup</span></div>
<div class="line"><span class="keywordtype">void</span> cleanup_callback(<span class="keywordtype">void</span> *userdata) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect = (<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>)userdata;</div>
<div class="line">    <span class="keywordtype">size_t</span> cleaned = <a class="code hl_function" href="group__security.html#ga89041cde278498408febb062da3dd23b">SocketSYNProtect_cleanup</a>(protect);</div>
<div class="line">    <span class="keywordflow">if</span> (cleaned &gt; 0) {</div>
<div class="line">        printf(<span class="stringliteral">&quot;Cleaned up %zu stale entries\n&quot;</span>, cleaned);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set up 5-second periodic cleanup</span></div>
<div class="line"><a class="code hl_function" href="group__event__system.html#ga2537cebf106e583079ec472086a26d65">SocketTimer_add</a>(poll, 5000, cleanup_callback, protect);</div>
<div class="ttc" id="agroup__event__system_html_ga2537cebf106e583079ec472086a26d65"><div class="ttname"><a href="group__event__system.html#ga2537cebf106e583079ec472086a26d65">SocketTimer_add</a></div><div class="ttdeci">SocketTimer_T SocketTimer_add(SocketPoll_T poll, int64_t delay_ms, SocketTimerCallback callback, void *userdata)</div><div class="ttdoc">Add a one-shot timer to the event poll.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md197"></a>
Manual Cleanup in Simple Loops</h2>
<div class="fragment"><div class="line">time_t last_cleanup = time(NULL);</div>
<div class="line"><span class="keywordflow">while</span> (<a class="code hl_variable" href="http__server_8c.html#af1f449cc09f8d36befcce07bc38c29c0">running</a>) {</div>
<div class="line">    <span class="comment">// Check connections...</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Periodic cleanup every 10 seconds</span></div>
<div class="line">    <span class="keywordflow">if</span> (time(NULL) - last_cleanup &gt;= 10) {</div>
<div class="line">        <span class="keywordtype">size_t</span> cleaned = <a class="code hl_function" href="group__security.html#ga89041cde278498408febb062da3dd23b">SocketSYNProtect_cleanup</a>(protect);</div>
<div class="line">        last_cleanup = time(NULL);</div>
<div class="line">        <span class="keywordflow">if</span> (cleaned &gt; 0) {</div>
<div class="line">            log_info(<span class="stringliteral">&quot;Cleaned up %zu protection entries&quot;</span>, cleaned);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="ahttp__server_8c_html_af1f449cc09f8d36befcce07bc38c29c0"><div class="ttname"><a href="http__server_8c.html#af1f449cc09f8d36befcce07bc38c29c0">running</a></div><div class="ttdeci">static volatile int running</div><div class="ttdef"><b>Definition</b> <a href="http__server_8c_source.html#l00032">http_server.c:32</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Call frequency affects memory usage and responsiveness:<ul>
<li>Too frequent: unnecessary CPU overhead</li>
<li>Too infrequent: stale data accumulation, delayed expirations</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) worst case - must scan all tracked IPs, but typically much</dt><dd>faster due to early termination and efficient data structures</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#a2a865bdf6cf3990a6d2e100c96164d80">SocketSYNProtect_Config::max_tracked_ips</a> for eviction threshold </dd>
<dd>
<a class="el" href="group__security.html#a58785babfc923ba70d9c8f0d5b7a44cf">SocketSYNProtect_Config::block_duration_ms</a> for expiration timing </dd>
<dd>
<a class="el" href="group__security.html#a73ebdc5d7fdeb3217b8c0dfc99347bbb">SocketSYNProtect_Config::window_duration_ms</a> for window management </dd>
<dd>
<a class="el" href="group__security.html#ad86ba3309adf0a1b6ee5ef26f7031281">SocketSYNProtect_Config::score_decay_per_sec</a> for reputation decay </dd>
<dd>
<a class="el" href="group__security.html#gae797fcaf42654cdba172ab72a327a8b1" title="Clear all tracked IP states without affecting lists or stats.">SocketSYNProtect_clear_all()</a> for immediate full cleanup </dd></dl>

</div>
</div>
<a id="gae797fcaf42654cdba172ab72a327a8b1" name="gae797fcaf42654cdba172ab72a327a8b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae797fcaf42654cdba172ab72a327a8b1">&#9670;&#160;</a></span>SocketSYNProtect_clear_all()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_clear_all </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clear all tracked IP states without affecting lists or stats. </p>
<p>Evicts all per-IP tracking data including rate counters, reputation scores, and temporary blocks. Whitelists, blacklists, and global statistics are preserved. Useful for reducing memory usage during idle periods or after resolving attack situations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md198"></a>
What Gets Cleared</h2>
<ul>
<li>All per-IP tracking state</li>
<li>Rate limit counters</li>
<li>Reputation scores</li>
<li>Temporary blocks (from reputation system)</li>
</ul>
<h2><a class="anchor" id="autotoc_md199"></a>
What Is Preserved</h2>
<ul>
<li>Whitelist entries</li>
<li>Blacklist entries (manual blocks)</li>
<li>Global statistics counters</li>
<li>Configuration settings</li>
</ul>
<h2><a class="anchor" id="autotoc_md200"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Clear tracking during maintenance window</span></div>
<div class="line"><span class="keywordtype">void</span> on_maintenance_start(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Clearing IP tracking state during maintenance\n&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gae797fcaf42654cdba172ab72a327a8b1">SocketSYNProtect_clear_all</a>(protect);</div>
<div class="line">    <span class="comment">// Whitelists and blacklists preserved</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Memory cleanup after attack subsides</span></div>
<div class="line"><span class="keywordtype">void</span> after_attack_resolved(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a> stats;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a">SocketSYNProtect_stats</a>(protect, &amp;stats);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (stats.<a class="code hl_variable" href="group__security.html#a5c6dc902b20931d955219b937f8ed2d6">current_tracked_ips</a> &gt; 5000) {</div>
<div class="line">        <span class="comment">// Clear stale tracking data</span></div>
<div class="line">        <a class="code hl_function" href="group__security.html#gae797fcaf42654cdba172ab72a327a8b1">SocketSYNProtect_clear_all</a>(protect);</div>
<div class="line">        printf(<span class="stringliteral">&quot;Cleared %lu tracked IPs\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a5c6dc902b20931d955219b937f8ed2d6">current_tracked_ips</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_a5c6dc902b20931d955219b937f8ed2d6"><div class="ttname"><a href="group__security.html#a5c6dc902b20931d955219b937f8ed2d6">SocketSYNProtect_Stats::current_tracked_ips</a></div><div class="ttdeci">uint64_t current_tracked_ips</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00352">SocketSYNProtect.h:352</a></div></div>
<div class="ttc" id="agroup__security_html_ga602057379b47f0e3dbf46b6efd70a09a"><div class="ttname"><a href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a">SocketSYNProtect_stats</a></div><div class="ttdeci">void SocketSYNProtect_stats(SocketSYNProtect_T protect, SocketSYNProtect_Stats *stats)</div><div class="ttdoc">Retrieve aggregate statistics snapshot for the SYN protection module.</div></div>
<div class="ttc" id="agroup__security_html_gae797fcaf42654cdba172ab72a327a8b1"><div class="ttname"><a href="group__security.html#gae797fcaf42654cdba172ab72a327a8b1">SocketSYNProtect_clear_all</a></div><div class="ttdeci">void SocketSYNProtect_clear_all(SocketSYNProtect_T protect)</div><div class="ttdoc">Clear all tracked IP states without affecting lists or stats.</div></div>
<div class="ttc" id="agroup__security_html_structSocketSYNProtect__Stats"><div class="ttname"><a href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a></div><div class="ttdoc">Statistics snapshot for SYN protection activity.</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00343">SocketSYNProtect.h:344</a></div></div>
</div><!-- fragment --><dl class="section user"><dt>Complexity\n O(n) - must free all tracked IP entries</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b" title="Perform periodic cleanup of expired and stale protection state.">SocketSYNProtect_cleanup()</a> for incremental cleanup </dd>
<dd>
<a class="el" href="group__security.html#ga01aa18277f6346e8803de9f705573528" title="Perform full reset of the SYN protection instance to initial state.">SocketSYNProtect_reset()</a> for complete reset including lists </dd>
<dd>
<a class="el" href="group__security.html#ga50962d47d9b56957714f313e2051e1bf" title="Clear all whitelist entries.">SocketSYNProtect_whitelist_clear()</a> for whitelist management </dd>
<dd>
<a class="el" href="group__security.html#ga9519e23838092f497693c4a488789f1b" title="Clear all blacklist entries.">SocketSYNProtect_blacklist_clear()</a> for blacklist management </dd></dl>

</div>
</div>
<a id="gade1b436117d4a0854881ac52ce43f115" name="gade1b436117d4a0854881ac52ce43f115"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gade1b436117d4a0854881ac52ce43f115">&#9670;&#160;</a></span>SocketSYNProtect_config_defaults()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_config_defaults </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize configuration structure with safe defaults. </p>
<p>Populates a <a class="el" href="group__security.html#structSocketSYNProtect__Config" title="Configuration parameters for SYN flood protection.">SocketSYNProtect_Config</a> structure with conservative, production-ready default values suitable for most applications. The defaults provide good protection against SYN floods while allowing reasonable connection rates for legitimate traffic.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">config</td><td>Pointer to config structure to populate with defaults</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - pure function with no shared state</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md170"></a>
Default Values</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Setting   </th><th class="markdownTableHeadNone">Default   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">window_duration_ms   </td><td class="markdownTableBodyNone">10000   </td><td class="markdownTableBodyNone">10 second sliding window    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">max_attempts_per_window   </td><td class="markdownTableBodyNone">100   </td><td class="markdownTableBodyNone">Max attempts per IP per window    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max_global_per_second   </td><td class="markdownTableBodyNone">1000   </td><td class="markdownTableBodyNone">Global rate limit    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">min_success_ratio   </td><td class="markdownTableBodyNone">0.1   </td><td class="markdownTableBodyNone">Minimum 10% success rate    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">throttle_delay_ms   </td><td class="markdownTableBodyNone">100   </td><td class="markdownTableBodyNone">100ms delay for throttling    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">block_duration_ms   </td><td class="markdownTableBodyNone">300000   </td><td class="markdownTableBodyNone">5 minute automatic blocks    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">challenge_defer_sec   </td><td class="markdownTableBodyNone">10   </td><td class="markdownTableBodyNone">10 second TCP_DEFER_ACCEPT    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">score_throttle   </td><td class="markdownTableBodyNone">0.7   </td><td class="markdownTableBodyNone">Throttle below 70% score    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">score_challenge   </td><td class="markdownTableBodyNone">0.5   </td><td class="markdownTableBodyNone">Challenge below 50% score    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">score_block   </td><td class="markdownTableBodyNone">0.3   </td><td class="markdownTableBodyNone">Block below 30% score    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">max_tracked_ips   </td><td class="markdownTableBodyNone">10000   </td><td class="markdownTableBodyNone">Track up to 10k IPs   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md171"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Use all defaults</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> config;</div>
<div class="line"><a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config);</div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect = <a class="code hl_function" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a>(NULL, &amp;config);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Customize for high-traffic service</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config);</div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a5f9976be0331359859284315ebf66e1a">max_attempts_per_window</a> = 500;     <span class="comment">// Higher limit</span></div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a575daabf11edf0ee687ff8a547240c77">max_global_per_second</a> = 5000;      <span class="comment">// Higher global rate</span></div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a2a865bdf6cf3990a6d2e100c96164d80">max_tracked_ips</a> = 50000;           <span class="comment">// Track more IPs</span></div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a73ebdc5d7fdeb3217b8c0dfc99347bbb">window_duration_ms</a> = 5000;         <span class="comment">// Shorter windows</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Customize for low-resource device</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config);</div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a5f9976be0331359859284315ebf66e1a">max_attempts_per_window</a> = 20;      <span class="comment">// Lower limit</span></div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a2a865bdf6cf3990a6d2e100c96164d80">max_tracked_ips</a> = 1000;            <span class="comment">// Track fewer IPs</span></div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a73ebdc5d7fdeb3217b8c0dfc99347bbb">window_duration_ms</a> = 30000;        <span class="comment">// Longer windows</span></div>
<div class="ttc" id="agroup__security_html_a2a865bdf6cf3990a6d2e100c96164d80"><div class="ttname"><a href="group__security.html#a2a865bdf6cf3990a6d2e100c96164d80">SocketSYNProtect_Config::max_tracked_ips</a></div><div class="ttdeci">size_t max_tracked_ips</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00318">SocketSYNProtect.h:318</a></div></div>
<div class="ttc" id="agroup__security_html_a575daabf11edf0ee687ff8a547240c77"><div class="ttname"><a href="group__security.html#a575daabf11edf0ee687ff8a547240c77">SocketSYNProtect_Config::max_global_per_second</a></div><div class="ttdeci">int max_global_per_second</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00298">SocketSYNProtect.h:298</a></div></div>
<div class="ttc" id="agroup__security_html_a5f9976be0331359859284315ebf66e1a"><div class="ttname"><a href="group__security.html#a5f9976be0331359859284315ebf66e1a">SocketSYNProtect_Config::max_attempts_per_window</a></div><div class="ttdeci">int max_attempts_per_window</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00297">SocketSYNProtect.h:297</a></div></div>
<div class="ttc" id="agroup__security_html_a73ebdc5d7fdeb3217b8c0dfc99347bbb"><div class="ttname"><a href="group__security.html#a73ebdc5d7fdeb3217b8c0dfc99347bbb">SocketSYNProtect_Config::window_duration_ms</a></div><div class="ttdeci">int window_duration_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00294">SocketSYNProtect.h:294</a></div></div>
<div class="ttc" id="agroup__security_html_ga5f5d6f2ac8cbd366d57c1e8e55983143"><div class="ttname"><a href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a></div><div class="ttdeci">SocketSYNProtect_T SocketSYNProtect_new(Arena_T arena, const SocketSYNProtect_Config *config)</div><div class="ttdoc">Create a new instance of SYN protection.</div></div>
<div class="ttc" id="agroup__security_html_gade1b436117d4a0854881ac52ce43f115"><div class="ttname"><a href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a></div><div class="ttdeci">void SocketSYNProtect_config_defaults(SocketSYNProtect_Config *config)</div><div class="ttdoc">Initialize configuration structure with safe defaults.</div></div>
<div class="ttc" id="agroup__security_html_structSocketSYNProtect__Config"><div class="ttname"><a href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a></div><div class="ttdoc">Configuration parameters for SYN flood protection.</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00291">SocketSYNProtect.h:292</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Tune these values based on your expected legitimate traffic patterns</dd>
<dd>
Defaults are conservative - you may need to increase limits for high-traffic services</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - simple structure population</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__Config" title="Configuration parameters for SYN flood protection.">SocketSYNProtect_Config</a> for all available configuration options </dd>
<dd>
<a class="el" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143" title="Create a new instance of SYN protection.">SocketSYNProtect_new()</a> for creating instances with config </dd>
<dd>
<a class="el" href="group__security.html#ga59e979862677789482cb5f297f544001" title="Update protection configuration during runtime.">SocketSYNProtect_configure()</a> for runtime reconfiguration </dd>
<dd>
docs/SYN-PROTECT.md for detailed tuning guidance </dd></dl>

</div>
</div>
<a id="ga59e979862677789482cb5f297f544001" name="ga59e979862677789482cb5f297f544001"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga59e979862677789482cb5f297f544001">&#9670;&#160;</a></span>SocketSYNProtect_configure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_configure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> *&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update protection configuration during runtime. </p>
<p>Atomically updates the configuration of an active protection instance. Changes take effect immediately for all future <code><a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a></code> calls. Existing tracked IP states, whitelist/blacklist entries, and active blocks are preserved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">config</td><td>New configuration to apply</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketSYNProtect_Failed</td><td>if config contains invalid values</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected atomic update</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md172"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Tighten limits during detected attack</span></div>
<div class="line"><span class="keywordtype">void</span> on_attack_detected(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> config;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config);</div>
<div class="line">    config.<a class="code hl_variable" href="group__security.html#a5f9976be0331359859284315ebf66e1a">max_attempts_per_window</a> = 10;  <span class="comment">// Much stricter</span></div>
<div class="line">    config.<a class="code hl_variable" href="group__security.html#ab9ce44543382518e5ed2a7471dd67413">score_block</a> = 0.5;             <span class="comment">// Block at higher score</span></div>
<div class="line">    config.<a class="code hl_variable" href="group__security.html#a58785babfc923ba70d9c8f0d5b7a44cf">block_duration_ms</a> = 600000;    <span class="comment">// 10 minute blocks</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga59e979862677789482cb5f297f544001">SocketSYNProtect_configure</a>(protect, &amp;config);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Relax limits after attack subsides</span></div>
<div class="line"><span class="keywordtype">void</span> on_attack_ended(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> config;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config); <span class="comment">// Back to defaults</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga59e979862677789482cb5f297f544001">SocketSYNProtect_configure</a>(protect, &amp;config);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Dynamic adjustment based on load</span></div>
<div class="line"><span class="keywordtype">void</span> adjust_for_load(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, <span class="keywordtype">int</span> current_connections) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> config;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (current_connections &gt; 8000) {</div>
<div class="line">        <span class="comment">// High load - be more aggressive</span></div>
<div class="line">        config.<a class="code hl_variable" href="group__security.html#a5f9976be0331359859284315ebf66e1a">max_attempts_per_window</a> = 20;</div>
<div class="line">        config.<a class="code hl_variable" href="group__security.html#a1d688c73198839dedc956d3b8912f66d">score_throttle</a> = 0.8;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga59e979862677789482cb5f297f544001">SocketSYNProtect_configure</a>(protect, &amp;config);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_a1d688c73198839dedc956d3b8912f66d"><div class="ttname"><a href="group__security.html#a1d688c73198839dedc956d3b8912f66d">SocketSYNProtect_Config::score_throttle</a></div><div class="ttdeci">float score_throttle</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00307">SocketSYNProtect.h:307</a></div></div>
<div class="ttc" id="agroup__security_html_a58785babfc923ba70d9c8f0d5b7a44cf"><div class="ttname"><a href="group__security.html#a58785babfc923ba70d9c8f0d5b7a44cf">SocketSYNProtect_Config::block_duration_ms</a></div><div class="ttdeci">int block_duration_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00303">SocketSYNProtect.h:303</a></div></div>
<div class="ttc" id="agroup__security_html_ab9ce44543382518e5ed2a7471dd67413"><div class="ttname"><a href="group__security.html#ab9ce44543382518e5ed2a7471dd67413">SocketSYNProtect_Config::score_block</a></div><div class="ttdeci">float score_block</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00309">SocketSYNProtect.h:309</a></div></div>
<div class="ttc" id="agroup__security_html_ga59e979862677789482cb5f297f544001"><div class="ttname"><a href="group__security.html#ga59e979862677789482cb5f297f544001">SocketSYNProtect_configure</a></div><div class="ttdeci">void SocketSYNProtect_configure(SocketSYNProtect_T protect, const SocketSYNProtect_Config *config)</div><div class="ttdoc">Update protection configuration during runtime.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Reducing <code>max_tracked_ips</code> may trigger immediate LRU eviction</dd>
<dd>
Changing score thresholds affects all future checks but not existing blocks</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) if max_tracked_ips reduced (triggers eviction), O(1)</dt><dd>otherwise</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143" title="Create a new instance of SYN protection.">SocketSYNProtect_new()</a> for initial configuration </dd>
<dd>
<a class="el" href="group__security.html#gade1b436117d4a0854881ac52ce43f115" title="Initialize configuration structure with safe defaults.">SocketSYNProtect_config_defaults()</a> for baseline values </dd>
<dd>
<a class="el" href="group__security.html#structSocketSYNProtect__Config" title="Configuration parameters for SYN flood protection.">SocketSYNProtect_Config</a> for all tunable parameters </dd></dl>

</div>
</div>
<a id="ga9f5cc1e61a0b44b8b1b330ae54382511" name="ga9f5cc1e61a0b44b8b1b330ae54382511"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f5cc1e61a0b44b8b1b330ae54382511">&#9670;&#160;</a></span>SocketSYNProtect_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> *&#160;</td>
          <td class="paramname"><em>protect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dispose of a SYN protection instance and release all resources. </p>
<p>Releases all internal resources including hash tables, mutexes, whitelist/blacklist entries, and tracked IP states. For malloc-based instances, frees all memory. For arena-based instances, clears internal pointers (arena dispose handles memory).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">protect</td><td>Pointer to instance (set to NULL on success)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - acquires internal mutex during cleanup</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md169"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Standard cleanup</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect = <a class="code hl_function" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a>(NULL, NULL);</div>
<div class="line"><span class="comment">// ... use protect ...</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511">SocketSYNProtect_free</a>(&amp;protect); <span class="comment">// protect is now NULL</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Safe to call on NULL</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> maybe_null = NULL;</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511">SocketSYNProtect_free</a>(&amp;maybe_null); <span class="comment">// No-op, safe</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Arena-managed cleanup</span></div>
<div class="line"><a class="code hl_typedef" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> arena = <a class="code hl_function" href="group__foundation.html#ga6a6d6890eb6ed1248ae1a5f0c677c7a4">Arena_new</a>();</div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect = <a class="code hl_function" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a>(arena, NULL);</div>
<div class="line"><span class="comment">// Option 1: Explicit free</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511">SocketSYNProtect_free</a>(&amp;protect);</div>
<div class="line"><span class="comment">// Option 2: Arena dispose handles everything</span></div>
<div class="line"><a class="code hl_function" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d">Arena_dispose</a>(&amp;arena); <span class="comment">// Also frees protect if not already freed</span></div>
<div class="ttc" id="agroup__security_html_ga9f5cc1e61a0b44b8b1b330ae54382511"><div class="ttname"><a href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511">SocketSYNProtect_free</a></div><div class="ttdeci">void SocketSYNProtect_free(SocketSYNProtect_T *protect)</div><div class="ttdoc">Dispose of a SYN protection instance and release all resources.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Safe to call on NULL pointer (no-op)</dd>
<dd>
After this call, the pointer is set to NULL to prevent use-after-free</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) - must clean up all tracked IPs and list entries</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143" title="Create a new instance of SYN protection.">SocketSYNProtect_new()</a> for creation </dd>
<dd>
<a class="el" href="group__security.html#gae797fcaf42654cdba172ab72a327a8b1" title="Clear all tracked IP states without affecting lists or stats.">SocketSYNProtect_clear_all()</a> to clear state without freeing </dd>
<dd>
<a class="el" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d" title="Dispose of an arena and all its allocations, freeing underlying memory chunks.">Arena_dispose()</a> for arena-managed cleanup patterns </dd></dl>

</div>
</div>
<a id="ga36629010083cc94526b37d57cc40bbce" name="ga36629010083cc94526b37d57cc40bbce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga36629010083cc94526b37d57cc40bbce">&#9670;&#160;</a></span>SocketSYNProtect_get_ip_state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketSYNProtect_get_ip_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a> *&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the current state and reputation metrics for a specific IP address. </p>
<p>Retrieves a read-only snapshot of the tracking data for a specific IP address, including attempt counts, success/failure ratios, reputation score, and block status. This is useful for debugging, monitoring dashboards, or administrative interfaces.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>IP address string to query (IPv4 or IPv6) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">state</td><td>Output structure populated with IP state if found</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if IP found and state populated, 0 if IP not currently tracked</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected atomic snapshot</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md187"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Query IP state for debugging</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a> state;</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga36629010083cc94526b37d57cc40bbce">SocketSYNProtect_get_ip_state</a>(protect, client_ip, &amp;state)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;IP: %s\n&quot;</span>, state.<a class="code hl_variable" href="group__security.html#a856b3a23c98e17f5c213a3d26a0a9590">ip</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Attempts (current window): %u\n&quot;</span>, state.<a class="code hl_variable" href="group__security.html#a6d2446089e798132b58c0333ba78cb3e">attempts_current</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Successes: %u, Failures: %u\n&quot;</span>, state.<a class="code hl_variable" href="group__security.html#abe2bcfaef720a4a375fe1c67b92c37d6">successes</a>,</div>
<div class="line">state.<a class="code hl_variable" href="group__security.html#a77f8fbce111a5f7338f8cc8cb4a7bca9">failures</a>); printf(<span class="stringliteral">&quot;  Score: %.2f\n&quot;</span>, state.<a class="code hl_variable" href="group__security.html#aaa43aaa7c28639d949e57ac1e14b2189">score</a>); printf(<span class="stringliteral">&quot;</span></div>
<div class="line"><span class="stringliteral">Reputation: %s\n&quot;</span>, <a class="code hl_function" href="group__security.html#gaaf2b0ff9a3054e262ba32b395c2abe50">SocketSYNProtect_reputation_name</a>(state.<a class="code hl_variable" href="group__security.html#a3f543090a343b51bdf4e7930e182366d">rep</a>)); <span class="keywordflow">if</span></div>
<div class="line">(state.<a class="code hl_variable" href="group__security.html#ae664aa07891130d5bb60edf6a1d72bf7">block_until_ms</a> &gt; 0) { printf(<span class="stringliteral">&quot;  Blocked until: %lld ms\n&quot;</span>,</div>
<div class="line">state.<a class="code hl_variable" href="group__security.html#ae664aa07891130d5bb60edf6a1d72bf7">block_until_ms</a>);</div>
<div class="line">    }</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    printf(<span class="stringliteral">&quot;IP %s not currently tracked\n&quot;</span>, client_ip);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Build monitoring dashboard data</span></div>
<div class="line"><span class="keywordtype">void</span> populate_dashboard(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect, <span class="keyword">const</span> <span class="keywordtype">char</span> **ips, <span class="keywordtype">size_t</span></div>
<div class="line">count) { <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; count; i++) { <a class="code hl_struct" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a> state; <span class="keywordflow">if</span></div>
<div class="line">(<a class="code hl_function" href="group__security.html#ga36629010083cc94526b37d57cc40bbce">SocketSYNProtect_get_ip_state</a>(protect, ips[i], &amp;state)) {</div>
<div class="line">            dashboard_update_ip(ips[i], state.<a class="code hl_variable" href="group__security.html#aaa43aaa7c28639d949e57ac1e14b2189">score</a>, state.<a class="code hl_variable" href="group__security.html#a3f543090a343b51bdf4e7930e182366d">rep</a>);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_a3f543090a343b51bdf4e7930e182366d"><div class="ttname"><a href="group__security.html#a3f543090a343b51bdf4e7930e182366d">SocketSYN_IPState::rep</a></div><div class="ttdeci">SocketSYN_Reputation rep</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00266">SocketSYNProtect.h:266</a></div></div>
<div class="ttc" id="agroup__security_html_a6d2446089e798132b58c0333ba78cb3e"><div class="ttname"><a href="group__security.html#a6d2446089e798132b58c0333ba78cb3e">SocketSYN_IPState::attempts_current</a></div><div class="ttdeci">uint32_t attempts_current</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00257">SocketSYNProtect.h:257</a></div></div>
<div class="ttc" id="agroup__security_html_a77f8fbce111a5f7338f8cc8cb4a7bca9"><div class="ttname"><a href="group__security.html#a77f8fbce111a5f7338f8cc8cb4a7bca9">SocketSYN_IPState::failures</a></div><div class="ttdeci">uint32_t failures</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00261">SocketSYNProtect.h:261</a></div></div>
<div class="ttc" id="agroup__security_html_a856b3a23c98e17f5c213a3d26a0a9590"><div class="ttname"><a href="group__security.html#a856b3a23c98e17f5c213a3d26a0a9590">SocketSYN_IPState::ip</a></div><div class="ttdeci">char ip[64]</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00253">SocketSYNProtect.h:253</a></div></div>
<div class="ttc" id="agroup__security_html_aaa43aaa7c28639d949e57ac1e14b2189"><div class="ttname"><a href="group__security.html#aaa43aaa7c28639d949e57ac1e14b2189">SocketSYN_IPState::score</a></div><div class="ttdeci">float score</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00267">SocketSYNProtect.h:267</a></div></div>
<div class="ttc" id="agroup__security_html_abe2bcfaef720a4a375fe1c67b92c37d6"><div class="ttname"><a href="group__security.html#abe2bcfaef720a4a375fe1c67b92c37d6">SocketSYN_IPState::successes</a></div><div class="ttdeci">uint32_t successes</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00260">SocketSYNProtect.h:260</a></div></div>
<div class="ttc" id="agroup__security_html_ae664aa07891130d5bb60edf6a1d72bf7"><div class="ttname"><a href="group__security.html#ae664aa07891130d5bb60edf6a1d72bf7">SocketSYN_IPState::block_until_ms</a></div><div class="ttdeci">int64_t block_until_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00264">SocketSYNProtect.h:264</a></div></div>
<div class="ttc" id="agroup__security_html_ga36629010083cc94526b37d57cc40bbce"><div class="ttname"><a href="group__security.html#ga36629010083cc94526b37d57cc40bbce">SocketSYNProtect_get_ip_state</a></div><div class="ttdeci">int SocketSYNProtect_get_ip_state(SocketSYNProtect_T protect, const char *ip, SocketSYN_IPState *state)</div><div class="ttdoc">Retrieve the current state and reputation metrics for a specific IP address.</div></div>
<div class="ttc" id="agroup__security_html_gaaf2b0ff9a3054e262ba32b395c2abe50"><div class="ttname"><a href="group__security.html#gaaf2b0ff9a3054e262ba32b395c2abe50">SocketSYNProtect_reputation_name</a></div><div class="ttdeci">const char * SocketSYNProtect_reputation_name(SocketSYN_Reputation rep)</div><div class="ttdoc">Convert reputation enum to human-readable string.</div></div>
<div class="ttc" id="agroup__security_html_structSocketSYN__IPState"><div class="ttname"><a href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a></div><div class="ttdoc">Per-IP address tracking and reputation state.</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00251">SocketSYNProtect.h:252</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This is a read-only operation - does not modify counters or state</dd>
<dd>
State may become stale immediately after return due to concurrent updates</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average case - hash table lookup</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYN__IPState" title="Per-IP address tracking and reputation state.">SocketSYN_IPState</a> for structure field details </dd>
<dd>
<a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> for state updates during evaluation </dd>
<dd>
<a class="el" href="group__security.html#ga979954abc96c529d1205d432fc13c661" title="Report successful connection completion for IP reputation update.">SocketSYNProtect_report_success()</a> and <code>report_failure()</code> for counter updates </dd></dl>

</div>
</div>
<a id="ga5f5d6f2ac8cbd366d57c1e8e55983143" name="ga5f5d6f2ac8cbd366d57c1e8e55983143"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f5d6f2ac8cbd366d57c1e8e55983143">&#9670;&#160;</a></span>SocketSYNProtect_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> SocketSYNProtect_new </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a>&#160;</td>
          <td class="paramname"><em>arena</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> *&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a new instance of SYN protection. </p>
<p>Allocates and initializes a new SYN flood protection instance with the specified configuration. Creates internal data structures for IP tracking, rate limiting, reputation scoring, and whitelist/blacklist management.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">arena</td><td>Memory arena for allocations (NULL uses malloc/free) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">config</td><td>Protection configuration (NULL uses defaults)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New <a class="el" href="group__security.html#structSocketSYNProtect__T" title="Core internal structure for the SYN protection module.">SocketSYNProtect_T</a> instance, or NULL on failure</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketSYNProtect_Failed</td><td>on allocation or initialization failure</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - creates independent instance safe to use from any thread</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md167"></a>
Basic Usage</h2>
<div class="fragment"><div class="line"><span class="comment">// Create with default configuration</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect = <a class="code hl_function" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a>(NULL, NULL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create with custom config</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> config;</div>
<div class="line"><a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config);</div>
<div class="line">config.<a class="code hl_variable" href="group__security.html#a5f9976be0331359859284315ebf66e1a">max_attempts_per_window</a> = 50; <span class="comment">// Tighter limits</span></div>
<div class="line">protect = <a class="code hl_function" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a>(NULL, &amp;config);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use in connection acceptance</span></div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> action = <a class="code hl_function" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a>(protect, client_ip, NULL);</div>
<div class="line"><span class="keywordflow">if</span> (action == <a class="code hl_enumvalue" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9ab7af7c3605f188d109f9528dd72a7af8">SYN_ACTION_ALLOW</a>) {</div>
<div class="line">    <span class="comment">// Accept connection</span></div>
<div class="line">    Socket_T conn = <a class="code hl_function" href="group__core__io.html#ga32b67d95639513cd6a602f6175b48f15">Socket_accept</a>(server_socket);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect, client_ip);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// Handle throttling/blocking</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511">SocketSYNProtect_free</a>(&amp;protect);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md168"></a>
Arena Usage</h2>
<div class="fragment"><div class="line"><a class="code hl_typedef" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> arena = <a class="code hl_function" href="group__foundation.html#ga6a6d6890eb6ed1248ae1a5f0c677c7a4">Arena_new</a>();</div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect = <a class="code hl_function" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143">SocketSYNProtect_new</a>(arena, NULL);</div>
<div class="line"><span class="comment">// ... use protect ...</span></div>
<div class="line"><span class="comment">// All memory freed when arena is disposed</span></div>
<div class="line"><a class="code hl_function" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d">Arena_dispose</a>(&amp;arena); <span class="comment">// Also frees protect</span></div>
</div><!-- fragment --><dl class="section user"><dt>Complexity\n O(1) - constant time initialization</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gade1b436117d4a0854881ac52ce43f115" title="Initialize configuration structure with safe defaults.">SocketSYNProtect_config_defaults()</a> for configuration setup </dd>
<dd>
<a class="el" href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511" title="Dispose of a SYN protection instance and release all resources.">SocketSYNProtect_free()</a> for cleanup </dd>
<dd>
<a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> for protection evaluation </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> for <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> considerations </dd>
<dd>
docs/SYN-PROTECT.md for detailed configuration guide </dd></dl>

</div>
</div>
<a id="ga573fee7bcaf625b171053b87159af53e" name="ga573fee7bcaf625b171053b87159af53e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga573fee7bcaf625b171053b87159af53e">&#9670;&#160;</a></span>SocketSYNProtect_report_failure()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_report_failure </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>client_ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>error_code</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Report connection failure for IP reputation update. </p>
<p>Updates the reputation system with a failed connection outcome for the specified IP address. This reduces the IP's reputation score, potentially triggering stricter rate limits, throttling, or blocking in future checks.</p>
<p>Call this function when a connection attempt fails at any stage:</p><ul>
<li>TCP handshake failure (ECONNREFUSED, ETIMEDOUT, ECONNRESET)</li>
<li>Immediate disconnect after accept</li>
<li>Protocol handshake failure</li>
<li>Any other connection establishment error</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">client_ip</td><td>IP address of the failed connection (IPv4/IPv6) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">error_code</td><td>errno value from failed operation (0 if unknown)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md176"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Connection failure during accept</span></div>
<div class="line"><span class="keywordtype">int</span> fd = accept(server_fd, NULL, NULL);</div>
<div class="line"><span class="keywordflow">if</span> (fd &lt; 0) {</div>
<div class="line">    <span class="comment">// Accept failed - report failure if we have client IP</span></div>
<div class="line">    <span class="keywordflow">if</span> (client_ip_known) {</div>
<div class="line">        <a class="code hl_function" href="group__security.html#ga573fee7bcaf625b171053b87159af53e">SocketSYNProtect_report_failure</a>(protect, client_ip, errno);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Connection accepted but fails immediately</span></div>
<div class="line"><a class="code hl_enumeration" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> action = <a class="code hl_function" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a>(protect, client_ip, NULL);</div>
<div class="line"><span class="keywordflow">if</span> (action != <a class="code hl_enumvalue" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa">SYN_ACTION_BLOCK</a>) {</div>
<div class="line">    Socket_T conn = <a class="code hl_function" href="group__core__io.html#ga32b67d95639513cd6a602f6175b48f15">Socket_accept</a>(server_socket);</div>
<div class="line">    <span class="keywordflow">if</span> (conn) {</div>
<div class="line">        <span class="keywordflow">if</span> (!perform_initial_handshake(conn)) {</div>
<div class="line">            <span class="comment">// Handshake failed</span></div>
<div class="line">            <a class="code hl_function" href="group__security.html#ga573fee7bcaf625b171053b87159af53e">SocketSYNProtect_report_failure</a>(protect, client_ip, EPROTO);</div>
<div class="line">            <a class="code hl_function" href="group__core__io.html#ga74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a>(&amp;conn);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">// Success</span></div>
<div class="line">            <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect, client_ip);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>No-op if IP is not currently tracked or is whitelisted</dd>
<dd>
The error_code parameter helps with debugging but doesn't affect reputation scoring - all failures are treated equally</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - hash table lookup and atomic update</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga979954abc96c529d1205d432fc13c661" title="Report successful connection completion for IP reputation update.">SocketSYNProtect_report_success()</a> for successful connections </dd>
<dd>
<a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> which evaluates reputation </dd>
<dd>
<a class="el" href="group__security.html#a77f8fbce111a5f7338f8cc8cb4a7bca9">SocketSYN_IPState::failures</a> for failure counter tracking </dd>
<dd>
<a class="el" href="group__security.html#ae55192b1a0a6bf438bf424cd87f9572a">SocketSYNProtect_Config::score_penalty_failure</a> for penalty tuning </dd></dl>

</div>
</div>
<a id="ga979954abc96c529d1205d432fc13c661" name="ga979954abc96c529d1205d432fc13c661"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga979954abc96c529d1205d432fc13c661">&#9670;&#160;</a></span>SocketSYNProtect_report_success()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_report_success </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>client_ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Report successful connection completion for IP reputation update. </p>
<p>Updates the reputation system with a successful connection outcome for the specified IP address. This improves the IP's reputation score, potentially allowing more lenient rate limits and reducing throttling in future checks.</p>
<p>Call this function after a connection has completed successfully:</p><ul>
<li>TCP handshake established</li>
<li>Initial protocol handshake (if any) completed</li>
<li><a class="el" href="group__connection__mgmt.html#structConnection" title="Internal structure representing a pooled connection slot.">Connection</a> is ready for normal data exchange</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">client_ip</td><td>IP address of the successful connection (IPv4/IPv6)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md175"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><a class="code hl_enumeration" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> action = <a class="code hl_function" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a>(protect, client_ip, NULL);</div>
<div class="line"><span class="keywordflow">if</span> (action != <a class="code hl_enumvalue" href="group__security.html#ggaca8f2a71ab649ccd408fd3fdb3b693b9aefd772a5165c7769765f8008396893fa">SYN_ACTION_BLOCK</a>) {</div>
<div class="line">    Socket_T conn = <a class="code hl_function" href="group__core__io.html#ga32b67d95639513cd6a602f6175b48f15">Socket_accept</a>(server_socket);</div>
<div class="line">    <span class="keywordflow">if</span> (conn &amp;&amp; perform_initial_handshake(conn)) {</div>
<div class="line">        <span class="comment">// Connection fully established</span></div>
<div class="line">        <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect, client_ip);</div>
<div class="line">        handle_normal_connection(conn);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// Connection failed after accept</span></div>
<div class="line">        <a class="code hl_function" href="group__security.html#ga573fee7bcaf625b171053b87159af53e">SocketSYNProtect_report_failure</a>(protect, client_ip, errno);</div>
<div class="line">        <a class="code hl_function" href="group__core__io.html#ga74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a>(&amp;conn);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>No-op if IP is not currently tracked or is whitelisted</dd>
<dd>
Call this only after successful connection establishment</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - hash table lookup and atomic update</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga573fee7bcaf625b171053b87159af53e" title="Report connection failure for IP reputation update.">SocketSYNProtect_report_failure()</a> for failed connections </dd>
<dd>
<a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> for initial evaluation </dd>
<dd>
<a class="el" href="group__security.html#abe2bcfaef720a4a375fe1c67b92c37d6">SocketSYN_IPState::successes</a> for success counter tracking </dd>
<dd>
<a class="el" href="group__security.html#ad6ecd5f04a5c197c4a740ee02611fdae">SocketSYNProtect_Config::score_reward_success</a> for score adjustment </dd></dl>

</div>
</div>
<a id="gaaf2b0ff9a3054e262ba32b395c2abe50" name="gaaf2b0ff9a3054e262ba32b395c2abe50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaaf2b0ff9a3054e262ba32b395c2abe50">&#9670;&#160;</a></span>SocketSYNProtect_reputation_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketSYNProtect_reputation_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#gad7b655dd229bc52cb32ec3cc1674d423">SocketSYN_Reputation</a>&#160;</td>
          <td class="paramname"><em>rep</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert reputation enum to human-readable string. </p>
<p>Converts a reputation enum value to its string representation for logging, debugging, monitoring dashboards, or user-facing display.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">rep</td><td>Reputation enum value to convert</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to static null-terminated string ("TRUSTED", "NEUTRAL", "SUSPECT", "HOSTILE")</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - pure function returning constant data</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md194"></a>
Return Values</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Input   </th><th class="markdownTableHeadNone">Output   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SYN_REP_TRUSTED   </td><td class="markdownTableBodyNone">"TRUSTED"   </td><td class="markdownTableBodyNone">Whitelisted or consistently good behavior    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SYN_REP_NEUTRAL   </td><td class="markdownTableBodyNone">"NEUTRAL"   </td><td class="markdownTableBodyNone">New or unknown IP    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SYN_REP_SUSPECT   </td><td class="markdownTableBodyNone">"SUSPECT"   </td><td class="markdownTableBodyNone">Elevated rates or low success ratio    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SYN_REP_HOSTILE   </td><td class="markdownTableBodyNone">"HOSTILE"   </td><td class="markdownTableBodyNone">Detected attack patterns    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">(invalid)   </td><td class="markdownTableBodyNone">"UNKNOWN"   </td><td class="markdownTableBodyNone">Invalid enum value   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md195"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketSYN__IPState">SocketSYN_IPState</a> state;</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga36629010083cc94526b37d57cc40bbce">SocketSYNProtect_get_ip_state</a>(protect, client_ip, &amp;state)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;IP %s reputation: %s (score: %.2f)\n&quot;</span>,</div>
<div class="line">           client_ip, <a class="code hl_function" href="group__security.html#gaaf2b0ff9a3054e262ba32b395c2abe50">SocketSYNProtect_reputation_name</a>(state.<a class="code hl_variable" href="group__security.html#a3f543090a343b51bdf4e7930e182366d">rep</a>),</div>
<div class="line">state.<a class="code hl_variable" href="group__security.html#aaa43aaa7c28639d949e57ac1e14b2189">score</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Monitoring dashboard</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *rep_str = <a class="code hl_function" href="group__security.html#gaaf2b0ff9a3054e262ba32b395c2abe50">SocketSYNProtect_reputation_name</a>(state.<a class="code hl_variable" href="group__security.html#a3f543090a343b51bdf4e7930e182366d">rep</a>);</div>
<div class="line">dashboard_update(client_ip, rep_str);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Returns static string - do not free or modify</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - constant time lookup</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gad7b655dd229bc52cb32ec3cc1674d423" title="IP reputation levels based on behavior history.">SocketSYN_Reputation</a> for enum values and criteria </dd>
<dd>
<a class="el" href="group__security.html#ga6be6d5871d5869421280eb62f3492ca3" title="Convert SYN action enum to human-readable string.">SocketSYNProtect_action_name()</a> for action strings </dd>
<dd>
<a class="el" href="group__security.html#a3f543090a343b51bdf4e7930e182366d">SocketSYN_IPState::rep</a> for per-IP reputation storage </dd></dl>

</div>
</div>
<a id="ga01aa18277f6346e8803de9f705573528" name="ga01aa18277f6346e8803de9f705573528"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga01aa18277f6346e8803de9f705573528">&#9670;&#160;</a></span>SocketSYNProtect_reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform full reset of the SYN protection instance to initial state. </p>
<p>Completely resets all internal state to as-if-newly-created condition. This includes clearing all tracked IPs, whitelists, blacklists, temporary blocks, and statistics counters. The current configuration is retained. Uptime counter is preserved for operational tracking.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md201"></a>
What Gets Cleared</h2>
<ul>
<li>All per-IP tracking state</li>
<li>All whitelist entries</li>
<li>All blacklist entries</li>
<li>All temporary blocks</li>
<li>All statistics counters</li>
</ul>
<h2><a class="anchor" id="autotoc_md202"></a>
What Is Preserved</h2>
<ul>
<li>Configuration settings</li>
<li>Uptime counter</li>
<li>Internal data structures (hash tables, etc.)</li>
</ul>
<h2><a class="anchor" id="autotoc_md203"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Complete reset for testing</span></div>
<div class="line"><span class="keywordtype">void</span> reset_for_test(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga01aa18277f6346e8803de9f705573528">SocketSYNProtect_reset</a>(protect);</div>
<div class="line">    <span class="comment">// Instance now behaves as if newly created</span></div>
<div class="line">    <span class="comment">// but configuration is preserved</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Emergency reset during security incident</span></div>
<div class="line"><span class="keywordtype">void</span> emergency_reset(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Performing emergency protection reset\n&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga01aa18277f6346e8803de9f705573528">SocketSYNProtect_reset</a>(protect);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Re-establish known-good whitelist</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;10.0.0.0/8&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;127.0.0.0/8&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;Protection reset complete, core whitelists restored\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Clean slate for new deployment</span></div>
<div class="line"><span class="keywordtype">void</span> prepare_for_deployment(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga01aa18277f6346e8803de9f705573528">SocketSYNProtect_reset</a>(protect);</div>
<div class="line">    load_production_whitelist(protect);</div>
<div class="line">    load_known_bad_actors(protect);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga01aa18277f6346e8803de9f705573528"><div class="ttname"><a href="group__security.html#ga01aa18277f6346e8803de9f705573528">SocketSYNProtect_reset</a></div><div class="ttdeci">void SocketSYNProtect_reset(SocketSYNProtect_T protect)</div><div class="ttdoc">Perform full reset of the SYN protection instance to initial state.</div></div>
<div class="ttc" id="agroup__security_html_ga67fef0b3b6d93c87648e8b0caa1c4bc0"><div class="ttname"><a href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a></div><div class="ttdeci">int SocketSYNProtect_whitelist_add_cidr(SocketSYNProtect_T protect, const char *cidr)</div><div class="ttdoc">Add a CIDR range to the whitelist.</div></div>
</div><!-- fragment --><dl class="section warning"><dt>Warning</dt><dd>This is a destructive operation - all accumulated reputation and block data is lost</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) - must free all entries from all internal tables</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga5f5d6f2ac8cbd366d57c1e8e55983143" title="Create a new instance of SYN protection.">SocketSYNProtect_new()</a> for creating new instances </dd>
<dd>
<a class="el" href="group__security.html#ga9f5cc1e61a0b44b8b1b330ae54382511" title="Dispose of a SYN protection instance and release all resources.">SocketSYNProtect_free()</a> for disposing instances </dd>
<dd>
<a class="el" href="group__security.html#gae797fcaf42654cdba172ab72a327a8b1" title="Clear all tracked IP states without affecting lists or stats.">SocketSYNProtect_clear_all()</a> for partial clear (preserves lists) </dd>
<dd>
<a class="el" href="group__security.html#ga59e979862677789482cb5f297f544001" title="Update protection configuration during runtime.">SocketSYNProtect_configure()</a> to update config without clearing state </dd></dl>

</div>
</div>
<a id="ga602057379b47f0e3dbf46b6efd70a09a" name="ga602057379b47f0e3dbf46b6efd70a09a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga602057379b47f0e3dbf46b6efd70a09a">&#9670;&#160;</a></span>SocketSYNProtect_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a> *&#160;</td>
          <td class="paramname"><em>stats</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve aggregate statistics snapshot for the SYN protection module. </p>
<p>Retrieves a consistent snapshot of all protection counters and metrics. The snapshot is suitable for monitoring dashboards, logging, alerting, and capacity planning. Privacy-safe: excludes per-IP details and list contents.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stats</td><td>Output structure populated with current metrics</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - uses atomic operations for consistent concurrent reads</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md188"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Periodic monitoring</span></div>
<div class="line"><span class="keywordtype">void</span> log_protection_stats(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a> stats;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a">SocketSYNProtect_stats</a>(protect, &amp;stats);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;SYN Protection Stats:\n&quot;</span>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Uptime: %lld ms\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#addc5d09c4b26fa03979894a037830a03">uptime_ms</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Total attempts: %lu\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a6e80ed205ec9330c6291d010863f810b">total_attempts</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Allowed: %lu (%.1f%%)\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a158331134454296a07e713e4efe46ae1">total_allowed</a>,</div>
<div class="line">           100.0 * stats.<a class="code hl_variable" href="group__security.html#a158331134454296a07e713e4efe46ae1">total_allowed</a> / (stats.<a class="code hl_variable" href="group__security.html#a6e80ed205ec9330c6291d010863f810b">total_attempts</a> ?: 1));</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Throttled: %lu\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a109c6d0a07655ac0ab5a48b5ba09c5ae">total_throttled</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Challenged: %lu\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a03ba7e002b3ac41d8aa5e9042cd99211">total_challenged</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Blocked: %lu\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a7c029f370305000dd71a42aaa52c393a">total_blocked</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Whitelisted: %lu\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a5a571ad87a6efbfaa2c7521f8589fa80">total_whitelisted</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Blacklisted: %lu\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a614ae093175b9319c4523296d16569d8">total_blacklisted</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Currently tracking: %lu IPs\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a5c6dc902b20931d955219b937f8ed2d6">current_tracked_ips</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  Currently blocked: %lu IPs\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a62d7ed28eb018dac7c46b19f7447a420">current_blocked_ips</a>);</div>
<div class="line">    printf(<span class="stringliteral">&quot;  LRU evictions: %lu\n&quot;</span>, stats.<a class="code hl_variable" href="group__security.html#a0e134430eac30ed54777c52221adec76">lru_evictions</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Alert on attack detection</span></div>
<div class="line"><span class="keywordtype">void</span> check_for_attack(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a> stats;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a">SocketSYNProtect_stats</a>(protect, &amp;stats);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Alert if block rate exceeds threshold</span></div>
<div class="line">    <span class="keywordtype">double</span> block_rate = (double)stats.<a class="code hl_variable" href="group__security.html#a7c029f370305000dd71a42aaa52c393a">total_blocked</a> / (stats.<a class="code hl_variable" href="group__security.html#a6e80ed205ec9330c6291d010863f810b">total_attempts</a></div>
<div class="line">?: 1); <span class="keywordflow">if</span> (block_rate &gt; 0.5 &amp;&amp; stats.<a class="code hl_variable" href="group__security.html#a6e80ed205ec9330c6291d010863f810b">total_attempts</a> &gt; 100) {</div>
<div class="line">        alert_security_team(<span class="stringliteral">&quot;Possible SYN flood attack detected&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Export to metrics system (e.g., Prometheus)</span></div>
<div class="line"><span class="keywordtype">void</span> export_to_prometheus(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a> stats;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a">SocketSYNProtect_stats</a>(protect, &amp;stats);</div>
<div class="line"> </div>
<div class="line">    prometheus_gauge_set(<span class="stringliteral">&quot;syn_protect_tracked_ips&quot;</span>,</div>
<div class="line">stats.<a class="code hl_variable" href="group__security.html#a5c6dc902b20931d955219b937f8ed2d6">current_tracked_ips</a>);</div>
<div class="line">    prometheus_counter_set(<span class="stringliteral">&quot;syn_protect_total_blocked&quot;</span>,</div>
<div class="line">stats.<a class="code hl_variable" href="group__security.html#a7c029f370305000dd71a42aaa52c393a">total_blocked</a>); prometheus_counter_set(<span class="stringliteral">&quot;syn_protect_total_allowed&quot;</span>,</div>
<div class="line">stats.<a class="code hl_variable" href="group__security.html#a158331134454296a07e713e4efe46ae1">total_allowed</a>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_a03ba7e002b3ac41d8aa5e9042cd99211"><div class="ttname"><a href="group__security.html#a03ba7e002b3ac41d8aa5e9042cd99211">SocketSYNProtect_Stats::total_challenged</a></div><div class="ttdeci">uint64_t total_challenged</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00348">SocketSYNProtect.h:348</a></div></div>
<div class="ttc" id="agroup__security_html_a0e134430eac30ed54777c52221adec76"><div class="ttname"><a href="group__security.html#a0e134430eac30ed54777c52221adec76">SocketSYNProtect_Stats::lru_evictions</a></div><div class="ttdeci">uint64_t lru_evictions</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00354">SocketSYNProtect.h:354</a></div></div>
<div class="ttc" id="agroup__security_html_a109c6d0a07655ac0ab5a48b5ba09c5ae"><div class="ttname"><a href="group__security.html#a109c6d0a07655ac0ab5a48b5ba09c5ae">SocketSYNProtect_Stats::total_throttled</a></div><div class="ttdeci">uint64_t total_throttled</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00347">SocketSYNProtect.h:347</a></div></div>
<div class="ttc" id="agroup__security_html_a158331134454296a07e713e4efe46ae1"><div class="ttname"><a href="group__security.html#a158331134454296a07e713e4efe46ae1">SocketSYNProtect_Stats::total_allowed</a></div><div class="ttdeci">uint64_t total_allowed</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00346">SocketSYNProtect.h:346</a></div></div>
<div class="ttc" id="agroup__security_html_a5a571ad87a6efbfaa2c7521f8589fa80"><div class="ttname"><a href="group__security.html#a5a571ad87a6efbfaa2c7521f8589fa80">SocketSYNProtect_Stats::total_whitelisted</a></div><div class="ttdeci">uint64_t total_whitelisted</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00350">SocketSYNProtect.h:350</a></div></div>
<div class="ttc" id="agroup__security_html_a614ae093175b9319c4523296d16569d8"><div class="ttname"><a href="group__security.html#a614ae093175b9319c4523296d16569d8">SocketSYNProtect_Stats::total_blacklisted</a></div><div class="ttdeci">uint64_t total_blacklisted</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00351">SocketSYNProtect.h:351</a></div></div>
<div class="ttc" id="agroup__security_html_a62d7ed28eb018dac7c46b19f7447a420"><div class="ttname"><a href="group__security.html#a62d7ed28eb018dac7c46b19f7447a420">SocketSYNProtect_Stats::current_blocked_ips</a></div><div class="ttdeci">uint64_t current_blocked_ips</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00353">SocketSYNProtect.h:353</a></div></div>
<div class="ttc" id="agroup__security_html_a6e80ed205ec9330c6291d010863f810b"><div class="ttname"><a href="group__security.html#a6e80ed205ec9330c6291d010863f810b">SocketSYNProtect_Stats::total_attempts</a></div><div class="ttdeci">uint64_t total_attempts</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00345">SocketSYNProtect.h:345</a></div></div>
<div class="ttc" id="agroup__security_html_a7c029f370305000dd71a42aaa52c393a"><div class="ttname"><a href="group__security.html#a7c029f370305000dd71a42aaa52c393a">SocketSYNProtect_Stats::total_blocked</a></div><div class="ttdeci">uint64_t total_blocked</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00349">SocketSYNProtect.h:349</a></div></div>
<div class="ttc" id="agroup__security_html_addc5d09c4b26fa03979894a037830a03"><div class="ttname"><a href="group__security.html#addc5d09c4b26fa03979894a037830a03">SocketSYNProtect_Stats::uptime_ms</a></div><div class="ttdeci">int64_t uptime_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketSYNProtect_8h_source.html#l00355">SocketSYNProtect.h:355</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Counters may wrap at UINT64_MAX (sufficient for 100+ years of activity)</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - atomic reads of pre-computed values</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketSYNProtect__Stats" title="Statistics snapshot for SYN protection activity.">SocketSYNProtect_Stats</a> for all available metrics </dd>
<dd>
<a class="el" href="group__security.html#ga59f2d1168a808c2c2d0584b031d96422" title="Reset all resettable statistics counters to zero.">SocketSYNProtect_stats_reset()</a> to reset counters </dd>
<dd>
<a class="el" href="group__security.html#ga89041cde278498408febb062da3dd23b" title="Perform periodic cleanup of expired and stale protection state.">SocketSYNProtect_cleanup()</a> which updates eviction stats </dd></dl>

</div>
</div>
<a id="ga59f2d1168a808c2c2d0584b031d96422" name="ga59f2d1168a808c2c2d0584b031d96422"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga59f2d1168a808c2c2d0584b031d96422">&#9670;&#160;</a></span>SocketSYNProtect_stats_reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_stats_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reset all resettable statistics counters to zero. </p>
<p>Clears cumulative counters (attempts, actions, evictions) while preserving all tracked IP states, whitelists, blacklists, and uptime. Useful for starting fresh reporting periods without affecting protection behavior.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md189"></a>
Counters Reset</h2>
<ul>
<li>total_attempts  0</li>
<li>total_allowed  0</li>
<li>total_throttled  0</li>
<li>total_challenged  0</li>
<li>total_blocked  0</li>
<li>total_whitelisted  0</li>
<li>total_blacklisted  0</li>
<li>lru_evictions  0</li>
</ul>
<h2><a class="anchor" id="autotoc_md190"></a>
Counters Preserved</h2>
<ul>
<li>uptime_ms (continues counting)</li>
<li>current_tracked_ips (reflects actual state)</li>
<li>current_blocked_ips (reflects actual state)</li>
</ul>
<h2><a class="anchor" id="autotoc_md191"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Reset stats at start of new reporting period</span></div>
<div class="line"><span class="keywordtype">void</span> start_new_period(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <span class="comment">// Log final stats from previous period</span></div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Stats">SocketSYNProtect_Stats</a> stats;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a">SocketSYNProtect_stats</a>(protect, &amp;stats);</div>
<div class="line">    log_period_summary(&amp;stats);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Reset for new period</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga59f2d1168a808c2c2d0584b031d96422">SocketSYNProtect_stats_reset</a>(protect);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Daily rotation for metrics</span></div>
<div class="line"><span class="keywordtype">void</span> on_midnight(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga59f2d1168a808c2c2d0584b031d96422">SocketSYNProtect_stats_reset</a>(protect);</div>
<div class="line">    printf(<span class="stringliteral">&quot;Protection stats reset for new day\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section user"><dt>Complexity\n O(1) - atomic counter resets</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga602057379b47f0e3dbf46b6efd70a09a" title="Retrieve aggregate statistics snapshot for the SYN protection module.">SocketSYNProtect_stats()</a> to view statistics </dd>
<dd>
<a class="el" href="group__security.html#ga01aa18277f6346e8803de9f705573528" title="Perform full reset of the SYN protection instance to initial state.">SocketSYNProtect_reset()</a> for full instance reset </dd></dl>

</div>
</div>
<a id="ga2a601f0c4520ae271b27a49c5bd19108" name="ga2a601f0c4520ae271b27a49c5bd19108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2a601f0c4520ae271b27a49c5bd19108">&#9670;&#160;</a></span>SocketSYNProtect_whitelist_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketSYNProtect_whitelist_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add an IP address to the whitelist. </p>
<p>Adds an IP address to the whitelist, causing all future connection attempts from this IP to bypass SYN flood protection entirely. Whitelisted IPs always receive SYN_ACTION_ALLOW regardless of rate limits, reputation scores, or blacklist status.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Null-terminated IP address string (IPv4: "192.168.1.1", IPv6: "2001:db8::1")</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (added or already present), 0 if whitelist is full</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md177"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Whitelist trusted internal network</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a>(protect, <span class="stringliteral">&quot;10.0.0.1&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a>(protect, <span class="stringliteral">&quot;10.0.0.2&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Whitelist IPv6 address</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a>(protect, <span class="stringliteral">&quot;2001:db8::1&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Check before adding (optional)</span></div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc">SocketSYNProtect_whitelist_contains</a>(protect, <span class="stringliteral">&quot;192.168.1.100&quot;</span>)) {</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_function" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a>(protect, <span class="stringliteral">&quot;192.168.1.100&quot;</span>)) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Whitelist full, could not add IP\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_ga5036b24b808b28a69de280c9ce0727fc"><div class="ttname"><a href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc">SocketSYNProtect_whitelist_contains</a></div><div class="ttdeci">int SocketSYNProtect_whitelist_contains(SocketSYNProtect_T protect, const char *ip)</div><div class="ttdoc">Check if an IP address is whitelisted.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md178"></a>
Integration with Monitoring</h2>
<div class="fragment"><div class="line"><span class="comment">// Add IP that just authenticated successfully</span></div>
<div class="line"><span class="keywordtype">int</span> login_successful = authenticate_user(username, password);</div>
<div class="line"><span class="keywordflow">if</span> (login_successful) {</div>
<div class="line">    <span class="comment">// Trust this IP for future connections</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a>(protect, client_ip);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga979954abc96c529d1205d432fc13c661">SocketSYNProtect_report_success</a>(protect, client_ip);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Whitelisted IPs completely bypass all protection mechanisms</dd>
<dd>
Use CIDR ranges with <code><a class="el" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0" title="Add a CIDR range to the whitelist.">SocketSYNProtect_whitelist_add_cidr()</a></code> for networks</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average case - hash table insertion</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0" title="Add a CIDR range to the whitelist.">SocketSYNProtect_whitelist_add_cidr()</a> for CIDR range whitelisting </dd>
<dd>
<a class="el" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc" title="Check if an IP address is whitelisted.">SocketSYNProtect_whitelist_contains()</a> to check membership </dd>
<dd>
<a class="el" href="group__security.html#gaa2b5e921cf7b0b24e270870f0ddc92be" title="Remove an IP address from the whitelist.">SocketSYNProtect_whitelist_remove()</a> to remove entries </dd>
<dd>
<a class="el" href="group__security.html#a0acad8adbb06f59ee96249bb1f5a417b">SocketSYNProtect_Config::max_whitelist</a> for capacity limits </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> for whitelist <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> considerations </dd></dl>

</div>
</div>
<a id="ga67fef0b3b6d93c87648e8b0caa1c4bc0" name="ga67fef0b3b6d93c87648e8b0caa1c4bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67fef0b3b6d93c87648e8b0caa1c4bc0">&#9670;&#160;</a></span>SocketSYNProtect_whitelist_add_cidr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketSYNProtect_whitelist_add_cidr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cidr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add a CIDR range to the whitelist. </p>
<p>Adds an entire IP address range to the whitelist using CIDR notation. Any IP address falling within the specified range will bypass all SYN flood protection and receive SYN_ACTION_ALLOW.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cidr</td><td>CIDR notation string (e.g., "10.0.0.0/8", "192.168.1.0/24", "2001:db8::/32")</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 on success (added or already present), 0 on parse error or whitelist full</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md179"></a>
Usage Examples</h2>
<div class="fragment"><div class="line"><span class="comment">// Whitelist internal networks</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;10.0.0.0/8&quot;</span>);      <span class="comment">// Class A</span></div>
<div class="line"><span class="keyword">private</span> <a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;172.16.0.0/12&quot;</span>);   <span class="comment">//</span></div>
<div class="line">Class B <span class="keyword">private</span> <a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect,</div>
<div class="line"><span class="stringliteral">&quot;192.168.0.0/16&quot;</span>);  <span class="comment">// Class C private</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Whitelist IPv6 network</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;2001:db8::/32&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Whitelist localhost</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;127.0.0.0/8&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;::1/128&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Whitelist specific subnet</span></div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;203.0.113.0/24&quot;</span>)) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Failed to add CIDR (invalid or whitelist full)\n&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>CIDR ranges are more memory-efficient than individual IP entries</dd>
<dd>
Invalid CIDR notation (e.g., "10.0.0.0/33") returns 0</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - constant time insertion</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108" title="Add an IP address to the whitelist.">SocketSYNProtect_whitelist_add()</a> for individual IP addresses </dd>
<dd>
<a class="el" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc" title="Check if an IP address is whitelisted.">SocketSYNProtect_whitelist_contains()</a> for membership checking </dd>
<dd>
<a class="el" href="group__security.html#a0acad8adbb06f59ee96249bb1f5a417b">SocketSYNProtect_Config::max_whitelist</a> for capacity limits </dd></dl>

</div>
</div>
<a id="ga50962d47d9b56957714f313e2051e1bf" name="ga50962d47d9b56957714f313e2051e1bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga50962d47d9b56957714f313e2051e1bf">&#9670;&#160;</a></span>SocketSYNProtect_whitelist_clear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_whitelist_clear </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clear all whitelist entries. </p>
<p>Removes all entries from the whitelist, including individual IP addresses and CIDR ranges. After this call, all IPs will be subject to normal SYN protection evaluation regardless of previous whitelist status.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md182"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Clear whitelist during security incident</span></div>
<div class="line"><span class="keywordtype">void</span> on_security_incident(<a class="code hl_struct" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a> protect) {</div>
<div class="line">    <span class="comment">// Remove all trusted IPs - trust no one during incident</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga50962d47d9b56957714f313e2051e1bf">SocketSYNProtect_whitelist_clear</a>(protect);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optionally, tighten overall protection</span></div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketSYNProtect__Config">SocketSYNProtect_Config</a> config;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gade1b436117d4a0854881ac52ce43f115">SocketSYNProtect_config_defaults</a>(&amp;config);</div>
<div class="line">    config.<a class="code hl_variable" href="group__security.html#a5f9976be0331359859284315ebf66e1a">max_attempts_per_window</a> = 5;</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga59e979862677789482cb5f297f544001">SocketSYNProtect_configure</a>(protect, &amp;config);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Reset whitelist to new set</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga50962d47d9b56957714f313e2051e1bf">SocketSYNProtect_whitelist_clear</a>(protect);</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;10.0.0.0/8&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108">SocketSYNProtect_whitelist_add</a>(protect, <span class="stringliteral">&quot;trusted.example.com&quot;</span>);</div>
<div class="ttc" id="agroup__security_html_ga50962d47d9b56957714f313e2051e1bf"><div class="ttname"><a href="group__security.html#ga50962d47d9b56957714f313e2051e1bf">SocketSYNProtect_whitelist_clear</a></div><div class="ttdeci">void SocketSYNProtect_whitelist_clear(SocketSYNProtect_T protect)</div><div class="ttdoc">Clear all whitelist entries.</div></div>
</div><!-- fragment --><dl class="section user"><dt>Complexity\n O(n) - must free all whitelist entries</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108" title="Add an IP address to the whitelist.">SocketSYNProtect_whitelist_add()</a> to add new entries </dd>
<dd>
<a class="el" href="group__security.html#gaa2b5e921cf7b0b24e270870f0ddc92be" title="Remove an IP address from the whitelist.">SocketSYNProtect_whitelist_remove()</a> for individual removal </dd>
<dd>
<a class="el" href="group__security.html#ga9519e23838092f497693c4a488789f1b" title="Clear all blacklist entries.">SocketSYNProtect_blacklist_clear()</a> for clearing blacklists </dd>
<dd>
<a class="el" href="group__security.html#ga01aa18277f6346e8803de9f705573528" title="Perform full reset of the SYN protection instance to initial state.">SocketSYNProtect_reset()</a> for full instance reset </dd></dl>

</div>
</div>
<a id="ga5036b24b808b28a69de280c9ce0727fc" name="ga5036b24b808b28a69de280c9ce0727fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5036b24b808b28a69de280c9ce0727fc">&#9670;&#160;</a></span>SocketSYNProtect_whitelist_contains()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketSYNProtect_whitelist_contains </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if an IP address is whitelisted. </p>
<p>Determines whether a specific IP address is in the whitelist, either as an exact match or within a whitelisted CIDR range. Whitelisted IPs bypass all SYN protection mechanisms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Null-terminated IP address string to check (IPv4 or IPv6)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if whitelisted (exact match or within CIDR range), 0 otherwise</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - read-only operation with mutex protection</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md181"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Check before manual processing</span></div>
<div class="line"><span class="keywordflow">if</span> (<a class="code hl_function" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc">SocketSYNProtect_whitelist_contains</a>(protect, client_ip)) {</div>
<div class="line">    <span class="comment">// Skip protection checks for whitelisted IPs</span></div>
<div class="line">    handle_trusted_connection(client_ip);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// Normal protection evaluation</span></div>
<div class="line">    <a class="code hl_enumeration" href="group__security.html#gaca8f2a71ab649ccd408fd3fdb3b693b9">SocketSYN_Action</a> action = <a class="code hl_function" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f">SocketSYNProtect_check</a>(protect, client_ip,</div>
<div class="line">NULL);</div>
<div class="line">    <span class="comment">// ... handle action ...</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Verify CIDR matching</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0">SocketSYNProtect_whitelist_add_cidr</a>(protect, <span class="stringliteral">&quot;10.0.0.0/8&quot;</span>);</div>
<div class="line">assert(<a class="code hl_function" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc">SocketSYNProtect_whitelist_contains</a>(protect, <span class="stringliteral">&quot;10.1.2.3&quot;</span>) == 1);</div>
<div class="line">assert(<a class="code hl_function" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc">SocketSYNProtect_whitelist_contains</a>(protect, <span class="stringliteral">&quot;192.168.1.1&quot;</span>) == 0);</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This is called internally by <code><a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a></code> </dd></dl>
<dl class="section user"><dt>Complexity\n O(n) worst case - checks exact matches then CIDR ranges</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108" title="Add an IP address to the whitelist.">SocketSYNProtect_whitelist_add()</a> for adding IP addresses </dd>
<dd>
<a class="el" href="group__security.html#ga67fef0b3b6d93c87648e8b0caa1c4bc0" title="Add a CIDR range to the whitelist.">SocketSYNProtect_whitelist_add_cidr()</a> for adding CIDR ranges </dd>
<dd>
<a class="el" href="group__security.html#ga45b12919783a7ba4426db4134fda1a5f" title="Evaluate client IP and determine protection action.">SocketSYNProtect_check()</a> which uses this internally </dd></dl>

</div>
</div>
<a id="gaa2b5e921cf7b0b24e270870f0ddc92be" name="gaa2b5e921cf7b0b24e270870f0ddc92be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa2b5e921cf7b0b24e270870f0ddc92be">&#9670;&#160;</a></span>SocketSYNProtect_whitelist_remove()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketSYNProtect_whitelist_remove </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove an IP address from the whitelist. </p>
<p>Removes a specific IP address from the whitelist. Future connection attempts from this IP will be subject to normal rate limiting and reputation checks. Also removes any CIDR entries that would match this IP.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">protect</td><td>Active protection instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ip</td><td>Null-terminated IP address string to remove (IPv4 or IPv6)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - mutex-protected update operation</dt><dd></dd></dl>
<h2><a class="anchor" id="autotoc_md180"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Remove previously whitelisted IP</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gaa2b5e921cf7b0b24e270870f0ddc92be">SocketSYNProtect_whitelist_remove</a>(protect, <span class="stringliteral">&quot;10.0.0.5&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Verify removal</span></div>
<div class="line"><span class="keywordflow">if</span> (!<a class="code hl_function" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc">SocketSYNProtect_whitelist_contains</a>(protect, <span class="stringliteral">&quot;10.0.0.5&quot;</span>)) {</div>
<div class="line">    printf(<span class="stringliteral">&quot;IP successfully removed from whitelist\n&quot;</span>);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__security_html_gaa2b5e921cf7b0b24e270870f0ddc92be"><div class="ttname"><a href="group__security.html#gaa2b5e921cf7b0b24e270870f0ddc92be">SocketSYNProtect_whitelist_remove</a></div><div class="ttdeci">void SocketSYNProtect_whitelist_remove(SocketSYNProtect_T protect, const char *ip)</div><div class="ttdoc">Remove an IP address from the whitelist.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>No-op if IP not found in whitelist</dd>
<dd>
This also removes CIDR entries containing the IP</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) - may need to search CIDR entries</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga2a601f0c4520ae271b27a49c5bd19108" title="Add an IP address to the whitelist.">SocketSYNProtect_whitelist_add()</a> for adding entries </dd>
<dd>
<a class="el" href="group__security.html#ga5036b24b808b28a69de280c9ce0727fc" title="Check if an IP address is whitelisted.">SocketSYNProtect_whitelist_contains()</a> to verify removal </dd>
<dd>
<a class="el" href="group__security.html#ga50962d47d9b56957714f313e2051e1bf" title="Clear all whitelist entries.">SocketSYNProtect_whitelist_clear()</a> to remove all entries </dd></dl>

</div>
</div>
<a id="ga122ad62f86b4477f7be54d55b769d58b" name="ga122ad62f86b4477f7be54d55b769d58b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga122ad62f86b4477f7be54d55b769d58b">&#9670;&#160;</a></span>SocketTLS_config_defaults()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLS_config_defaults </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize the TLS configuration with secure library defaults. </p>
<p>Populates the structure with safe defaults: sets min_version and max_version to TLS 1.3 (SOCKET_TLS_MIN_VERSION == SOCKET_TLS_MAX_VERSION), zero-initializes other fields. This enforces a strict TLS 1.3-only policy by default, disabling legacy protocols for enhanced security against downgrade attacks.</p>
<p>No-op if config is NULL (no exception raised).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">config</td><td>Pointer to <a class="el" href="group__tls__config.html#structSocketTLSConfig__T" title="TLS configuration parameters for customizing TLS protocol versions and other settings.">SocketTLSConfig_T</a> structure to initialize. Ignored if NULL. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td>- no exceptions raised, handles invalid input gracefully.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - pure function with no shared state or side effects; safe</dt><dd>from any thread.</dd></dl>
<h2><a class="anchor" id="autotoc_md570"></a>
Defaults Set</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field   </th><th class="markdownTableHeadNone">Value Set    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">min_version   </td><td class="markdownTableBodyNone">SOCKET_TLS_MIN_VERSION (TLS1_3_VERSION)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">max_version   </td><td class="markdownTableBodyNone">SOCKET_TLS_MAX_VERSION (TLS1_3_VERSION)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">other fields   </td><td class="markdownTableBodyNone">0 (zero-initialized)   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md571"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a> config;</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga122ad62f86b4477f7be54d55b769d58b">SocketTLS_config_defaults</a>(&amp;config);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Create custom context with secure defaults</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234">SocketTLSContext_new</a>(&amp;config);</div>
<div class="line"><span class="keywordflow">if</span> (ctx) {</div>
<div class="line">    <span class="comment">// Use context to secure sockets, e.g.:</span></div>
<div class="line">    <span class="comment">// SocketTLS_enable(sock, ctx);</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#gaea7ca3e656e9b58706fafc3232147203">SocketTLSContext_free</a>(&amp;ctx);</div>
<div class="line">}</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Future versions will set additional defaults for ciphers, timeouts, cert policies, etc. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Defaults prioritize security; custom changes may reduce protection if not careful. </dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - simple struct field assignments</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__tls__config.html#structSocketTLSConfig__T" title="TLS configuration parameters for customizing TLS protocol versions and other settings.">SocketTLSConfig_T</a> for structure details and fields. </dd>
<dd>
<a class="el" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234" title="Create client TLS context with custom config.">SocketTLSContext_new()</a> to create contexts using this configuration. </dd>
<dd>
<a class="el" href="group__tls__config.html">TLS Configuration Constants</a> for constants defining the secure defaults. </dd>
<dd>
<a class="el" href="group__security.html">Security Modules</a> for TLS <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> overview. </dd></dl>

</div>
</div>
<a id="gab9a8fb788aa1f0d21b5773bc43a48d6f" name="gab9a8fb788aa1f0d21b5773bc43a48d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab9a8fb788aa1f0d21b5773bc43a48d6f">&#9670;&#160;</a></span>SocketTLS_enable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLS_enable </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable TLS on a socket using the provided context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance to enable TLS on </td></tr>
    <tr><td class="paramname">ctx</td><td>The TLS context to use for this connection</td></tr>
  </table>
  </dd>
</dl>
<p>Enables TLS/SSL encryption on the specified socket. The socket must be connected before calling this function. Creates an SSL object from the context, associates it with the socket's file descriptor, sets client/server mode, and initializes TLS buffers and state.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if TLS cannot be enabled (e.g., already enabled, invalid socket, context error) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies socket state directly</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gac14390090ee26136c1f7a816fc08406e" title="Establish a connection to a remote host and port.">Socket_connect()</a> for establishing connections before enabling TLS </dd>
<dd>
<a class="el" href="group__core__io.html#ga32b67d95639513cd6a602f6175b48f15" title="Accept incoming connection.">Socket_accept()</a> for accepting connections before enabling TLS </dd>
<dd>
<a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454" title="Perform non-blocking TLS handshake.">SocketTLS_handshake()</a> for performing the TLS handshake </dd>
<dd>
<a class="el" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022" title="Create client TLS context.">SocketTLSContext_new_client()</a> for creating client contexts </dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="ga56acd283757bb0af4f4d59d3c0f218ea" name="ga56acd283757bb0af4f4d59d3c0f218ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga56acd283757bb0af4f4d59d3c0f218ea">&#9670;&#160;</a></span>SocketTLS_get_alpn_selected()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_alpn_selected </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the negotiated ALPN protocol. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>Socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the ALPN protocol that was negotiated during the TLS handshake. This is useful for determining which application protocol to use (e.g., "h2", "http/1.1").</p>
<dl class="section return"><dt>Returns</dt><dd>Negotiated protocol string, or NULL if none negotiated or unavailable </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - reads immutable post-handshake state - reads immutable</dt><dd>post-handshake state</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga4fcc29a81cf5c643ee9a56deb46b9ec8" title="Advertise ALPN protocols.">SocketTLSContext_set_alpn_protos()</a> for advertising supported protocols. </dd>
<dd>
<a class="el" href="group__security.html#gab7c088402bdf132a710551ebe2268ed0" title="Set custom ALPN protocol selection callback.">SocketTLSContext_set_alpn_callback()</a> for custom protocol selection. </dd>
<dd>
<a class="el" href="group__http.html">HTTP Modules</a> for examples like "h2" (HTTP/2) and "http/1.1". </dd></dl>

</div>
</div>
<a id="ga0859f0a6e05840bdc037c3765e22b7b1" name="ga0859f0a6e05840bdc037c3765e22b7b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0859f0a6e05840bdc037c3765e22b7b1">&#9670;&#160;</a></span>SocketTLS_get_cipher()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_cipher </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get negotiated cipher suite name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the name of the cipher suite negotiated during handshake (e.g., "TLS_AES_256_GCM_SHA384").</p>
<dl class="section return"><dt>Returns</dt><dd>Const string with cipher name, or NULL if unavailable </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - reads immutable post-handshake state - reads immutable</dt><dd>post-handshake state</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaef0f67021658d05419f1da479be2957e" title="Get negotiated TLS protocol version.">SocketTLS_get_version()</a> for protocol version. </dd>
<dd>
<a class="el" href="group__security.html#ga2e731151980c8c30a7fbb18da74ddffa" title="Set allowed cipher suites.">SocketTLSContext_set_cipher_list()</a> for configuring ciphers. </dd>
<dd>
docs/SECURITY_GUIDE.md for cipher <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> recommendations. </dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="gae1a1b2392cfa8dd68e636bbef9df443f" name="gae1a1b2392cfa8dd68e636bbef9df443f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae1a1b2392cfa8dd68e636bbef9df443f">&#9670;&#160;</a></span>SocketTLS_get_ocsp_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLS_get_ocsp_status </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get OCSP status after handshake (client). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>TLS socket with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Parses stapled OCSP response from server, validates, returns status. Returns OCSP_STATUS_GOOD=1, REVOKED=2, UNKNOWN=3, NONE=0 if no response. Caller can check for revocation.</p>
<dl class="section return"><dt>Returns</dt><dd>int (OCSP status code) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td>(returns error code on parse fail) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (post-handshake)</dt><dd></dd></dl>

</div>
</div>
<a id="ga39a966c33421653c64f78261f24ee1f1" name="ga39a966c33421653c64f78261f24ee1f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39a966c33421653c64f78261f24ee1f1">&#9670;&#160;</a></span>SocketTLS_get_verify_error_string()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_verify_error_string </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get detailed verification error string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>TLS socket </td></tr>
    <tr><td class="paramname">buf</td><td>Output buffer for error description </td></tr>
    <tr><td class="paramname">size</td><td>Buffer size (including null terminator)</td></tr>
  </table>
  </dd>
</dl>
<p>Provides human-readable string for the last verification error (from CRL/OCSP/custom verify). Uses X509_verify_cert_error_string or OpenSSL ERR queue.</p>
<dl class="section return"><dt>Returns</dt><dd>buf if error found, NULL if no error or invalid args </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No (ERR queue shared)</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga4fd56e743762151aa449744a8d574164" title="Get peer certificate verification result.">SocketTLS_get_verify_result()</a> for the numeric error code. </dd>
<dd>
<a class="el" href="group__security.html#gabe406e483a861198db5bca58300f1728" title="Peer certificate verification failure.">SocketTLS_VerifyFailed</a> for when verification fails. </dd>
<dd>
ERR_get_error() for accessing OpenSSL error queue directly.</dd></dl>
<p>Requires: tls_handshake_done </p>

</div>
</div>
<a id="ga4fd56e743762151aa449744a8d574164" name="ga4fd56e743762151aa449744a8d574164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fd56e743762151aa449744a8d574164">&#9670;&#160;</a></span>SocketTLS_get_verify_result()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long SocketTLS_get_verify_result </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get peer certificate verification result. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Returns OpenSSL's X509 verify result code. 0 (X509_V_OK) indicates successful verification. Non-zero codes detail failures (e.g., untrusted CA).</p>
<dl class="section return"><dt>Returns</dt><dd>long verify result code (X509_V_OK = 0 on success) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td>(caller checks and may raise SocketTLS_VerifyFailed) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - reads immutable post-handshake state (read-only</dt><dd>post-handshake)</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gabe406e483a861198db5bca58300f1728" title="Peer certificate verification failure.">SocketTLS_VerifyFailed</a> exception for handling verification failures. </dd>
<dd>
<a class="el" href="group__security.html#ga39a966c33421653c64f78261f24ee1f1" title="Get detailed verification error string.">SocketTLS_get_verify_error_string()</a> for detailed error description. </dd>
<dd>
<a class="el" href="group__security.html#ga71084c00bec22f65b90301188868b759" title="Set certificate verification policy.">SocketTLSContext_set_verify_mode()</a> to configure verification policy. </dd>
<dd>
X509_verify_cert_error_string() for OpenSSL error code meanings.</dd></dl>
<p>Requires: tls_enabled and tls_handshake_done </p>

</div>
</div>
<a id="gaef0f67021658d05419f1da479be2957e" name="gaef0f67021658d05419f1da479be2957e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef0f67021658d05419f1da479be2957e">&#9670;&#160;</a></span>SocketTLS_get_version()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char * SocketTLS_get_version </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get negotiated TLS protocol version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Returns the TLS protocol version string (e.g., "TLSv1.3").</p>
<dl class="section return"><dt>Returns</dt><dd>Const string with version, or NULL if unavailable </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - reads immutable post-handshake state</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga0859f0a6e05840bdc037c3765e22b7b1" title="Get negotiated cipher suite name.">SocketTLS_get_cipher()</a> for negotiated cipher suite. </dd>
<dd>
<a class="el" href="group__security.html#gaa7703e1d2c80b49601af8237e81729ef" title="Set minimum supported TLS version.">SocketTLSContext_set_min_protocol()</a> for minimum version. </dd>
<dd>
<a class="el" href="group__security.html#gad094c4db92c9979bcde108166193abee" title="Set maximum supported TLS version.">SocketTLSContext_set_max_protocol()</a> for maximum version. </dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="gaeaa77dd7852b535baf17b53ee2518454" name="gaeaa77dd7852b535baf17b53ee2518454"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeaa77dd7852b535baf17b53ee2518454">&#9670;&#160;</a></span>SocketTLS_handshake()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> SocketTLS_handshake </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform non-blocking TLS handshake. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with TLS enabled</td></tr>
  </table>
  </dd>
</dl>
<p>Performs one step of the TLS handshake. For non-blocking sockets, this may return WANT_READ or WANT_WRITE indicating more data or writability is needed. Call repeatedly in a poll loop until TLS_HANDSHAKE_COMPLETE is returned.</p>
<dl class="section return"><dt>Returns</dt><dd>TLSHandshakeState indicating progress (COMPLETE, WANT_READ, WANT_WRITE, ERROR) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_HandshakeFailed</td><td>on fatal handshake errors (e.g., protocol mismatch, cert verify fail) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies socket TLS state and SSL object</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__poll__private.html#structSocketPoll__T" title="Opaque internal state structure for SocketPoll instance.">SocketPoll_T</a> for event-driven handshake completion </dd>
<dd>
<a class="el" href="group__security.html#ga439248f2ff7b87470520de0607569d06" title="Complete handshake with timeout (non-blocking)">SocketTLS_handshake_loop()</a> for timeout-based completion </dd>
<dd>
<a class="el" href="group__security.html#ga54a01327e253586278c0f740c2764010" title="Complete handshake using socket&#39;s timeout config.">SocketTLS_handshake_auto()</a> for automatic timeout handling </dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="ga54a01327e253586278c0f740c2764010" name="ga54a01327e253586278c0f740c2764010"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga54a01327e253586278c0f740c2764010">&#9670;&#160;</a></span>SocketTLS_handshake_auto()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> SocketTLS_handshake_auto </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Complete handshake using socket's timeout config. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with TLS enabled</td></tr>
  </table>
  </dd>
</dl>
<p>Convenience function that performs a TLS handshake using the socket's configured operation_timeout_ms. If operation_timeout_ms is 0 or not set, uses SOCKET_DEFAULT_TLS_HANDSHAKE_TIMEOUT_MS (30 seconds).</p>
<p>This is the recommended function for production code as it automatically uses the socket's timeout configuration, ensuring consistent timeout behavior across the application.</p>
<dl class="section return"><dt>Returns</dt><dd>TLSHandshakeState (COMPLETE on success, ERROR on failure/timeout) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_HandshakeFailed</td><td>on error or timeout </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="ga439248f2ff7b87470520de0607569d06" name="ga439248f2ff7b87470520de0607569d06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga439248f2ff7b87470520de0607569d06">&#9670;&#160;</a></span>SocketTLS_handshake_loop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> SocketTLS_handshake_loop </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timeout_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Complete handshake with timeout (non-blocking) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with TLS enabled </td></tr>
    <tr><td class="paramname">timeout_ms</td><td>Maximum time to wait for handshake completion (0 for non-blocking)</td></tr>
  </table>
  </dd>
</dl>
<p>Convenience function to run the handshake loop until complete or timeout. Uses SocketPoll internally for non-blocking operation if timeout &gt; 0.</p>
<dl class="section return"><dt>Returns</dt><dd>TLSHandshakeState (COMPLETE on success, ERROR on failure/timeout) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_HandshakeFailed</td><td>on error or timeout </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>
<p>Note: This is a higher-level helper; low-level code should use <a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454" title="Perform non-blocking TLS handshake.">SocketTLS_handshake()</a> directly. </p>

</div>
</div>
<a id="ga315ccceb9cb5b74d8b90f1439ce57344" name="ga315ccceb9cb5b74d8b90f1439ce57344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga315ccceb9cb5b74d8b90f1439ce57344">&#9670;&#160;</a></span>SocketTLS_is_session_reused()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLS_is_session_reused </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if TLS session was resumed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with completed handshake</td></tr>
  </table>
  </dd>
</dl>
<p>Determines if the connection used a resumed session (faster handshake via session tickets/cache).</p>
<dl class="section return"><dt>Returns</dt><dd>1 if reused, 0 if full handshake, -1 if unavailable </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - reads immutable post-handshake state</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga6f0a68e802e789df40eaa28cb641a422" title="Enable session caching.infrastructure.">SocketTLSContext_enable_session_cache()</a> for enabling session caching. </dd>
<dd>
<a class="el" href="group__security.html#gae7d40e475eec529625a3d6ba74d23f4a" title="Enable stateless session.resumption using tickets.">SocketTLSContext_enable_session_tickets()</a> for ticket-based resumption. </dd>
<dd>
<a class="el" href="group__security.html#ga2093721c235cb8ebc83e90606abdcb33" title="Get session cache statistics.">SocketTLSContext_get_cache_stats()</a> for monitoring cache performance. </dd>
<dd>
docs/SECURITY_GUIDE.md for session resumption <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> considerations. </dd></dl>

</div>
</div>
<a id="ga1c71fc02141cd9e6da4fdf1c88dbbaf3" name="ga1c71fc02141cd9e6da4fdf1c88dbbaf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1c71fc02141cd9e6da4fdf1c88dbbaf3">&#9670;&#160;</a></span>SocketTLS_recv()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketTLS_recv </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Receive data from TLS-encrypted connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with completed TLS handshake </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer to receive data into </td></tr>
    <tr><td class="paramname">len</td><td>Maximum number of bytes to receive</td></tr>
  </table>
  </dd>
</dl>
<p>Receives data using SSL_read(). For non-blocking sockets, returns 0 and sets errno=EAGAIN if would block. Returns 0 and raises Socket_Closed on clean peer shutdown.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes received, or 0 if would block or EOF </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on TLS errors, Socket_Closed on clean shutdown </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies SSL buffers and state</dt><dd></dd></dl>
<p>Note: Application must handle partial reads by looping until desired amount received. </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="gabdb38e692dde58bbec4ab905eeb8b3aa" name="gabdb38e692dde58bbec4ab905eeb8b3aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabdb38e692dde58bbec4ab905eeb8b3aa">&#9670;&#160;</a></span>SocketTLS_send()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ssize_t SocketTLS_send </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Send data over TLS-encrypted connection. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with completed TLS handshake </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer containing data to send </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes to send from buf</td></tr>
  </table>
  </dd>
</dl>
<p>Sends data using SSL_write(). For non-blocking sockets, returns 0 and sets errno=EAGAIN if the operation would block. Handshake must be complete before calling.</p>
<dl class="section return"><dt>Returns</dt><dd>Number of bytes sent, or 0 if would block </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on TLS errors, Socket_Closed if connection closed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies SSL buffers and state</dt><dd></dd></dl>
<p>Note: Does not perform partial sends; application must loop if needed. </p>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="ga15d2c8f4eaea80114bbd2123da025e56" name="ga15d2c8f4eaea80114bbd2123da025e56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga15d2c8f4eaea80114bbd2123da025e56">&#9670;&#160;</a></span>SocketTLS_set_hostname()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLS_set_hostname </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hostname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set SNI hostname for client TLS connections. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance </td></tr>
    <tr><td class="paramname">hostname</td><td>Null-terminated hostname string for SNI and verification</td></tr>
  </table>
  </dd>
</dl>
<p>Sets the Server Name Indication (SNI) hostname for the TLS connection. This is required for virtual hosting on servers and enables hostname verification for clients. The hostname is validated and allocated in the socket's arena. Should be called after <a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f" title="Enable TLS on a socket using the provided context.">SocketTLS_enable()</a> but before <a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454" title="Perform non-blocking TLS handshake.">SocketTLS_handshake()</a>.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if TLS not enabled, invalid hostname, or OpenSSL </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies socket and SSL state</dt><dd></dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="gab11506db6f41f31e9fc170b3d0e848f1" name="gab11506db6f41f31e9fc170b3d0e848f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab11506db6f41f31e9fc170b3d0e848f1">&#9670;&#160;</a></span>SocketTLS_shutdown()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLS_shutdown </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform graceful TLS connection shutdown. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>The socket instance with TLS enabled</td></tr>
  </table>
  </dd>
</dl>
<p>Initiates a bidirectional TLS shutdown (close_notify alert). May need multiple calls for full shutdown in non-blocking mode. Call before Socket_close() to ensure proper TLS termination.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_ShutdownFailed</td><td>on error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies SSL object state</dt><dd></dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="ga92be47dab18fc79c409fc8b450e7aa0d" name="ga92be47dab18fc79c409fc8b450e7aa0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga92be47dab18fc79c409fc8b450e7aa0d">&#9670;&#160;</a></span>SocketTLSContext_add_certificate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_add_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hostname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cert_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add certificate mapping for SNI virtual hosting. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">hostname</td><td>Hostname this certificate is for (NULL for default certificate) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert_file</td><td>Certificate file path (PEM format) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_file</td><td>Private key file path (PEM format)</td></tr>
  </table>
  </dd>
</dl>
<p>Adds a certificate/key pair for SNI-based virtual hosting. Multiple certificates can be loaded for different hostnames. The first certificate loaded becomes the default if no hostname match is found.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on error (file not found, invalid cert/key, allocation) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="ga34caeef50e78017625d2eb62142a7e45" name="ga34caeef50e78017625d2eb62142a7e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga34caeef50e78017625d2eb62142a7e45">&#9670;&#160;</a></span>SocketTLSContext_add_pin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_add_pin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>sha256_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add SPKI SHA256 pin (binary format). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sha256_hash</td><td>32-byte SHA256 hash of the SPKI DER encoding</td></tr>
  </table>
  </dd>
</dl>
<p>Adds a certificate pin using raw binary hash. The hash is copied to context-owned storage. Duplicate pins are silently ignored.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if hash is NULL or max pins exceeded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga445003fff70029dd096df971801be0e4" title="Exception raised when certificate pin verification fails during TLS handshake or manual check.">SocketTLS_PinVerifyFailed</a> for the exception raised on mismatch. </dd>
<dd>
<a class="el" href="group__security.html#gafd50881da0db97098204ff6fa920bb26" title="Add SPKI SHA256 pin (hex string).">SocketTLSContext_add_pin_hex()</a> for hex-encoded input. </dd>
<dd>
<a class="el" href="group__security.html#gaa535f69cf93b2f0dec403e71336b0682" title="Extract and add pin from certificate.">SocketTLSContext_add_pin_from_cert()</a> to generate from file. </dd>
<dd>
<a class="el" href="group__security.html#ga8a972b0da962c5515936444b6921182d" title="Set pin enforcement mode.">SocketTLSContext_set_pin_enforcement()</a> to control failure behavior. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="gaa535f69cf93b2f0dec403e71336b0682" name="gaa535f69cf93b2f0dec403e71336b0682"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa535f69cf93b2f0dec403e71336b0682">&#9670;&#160;</a></span>SocketTLSContext_add_pin_from_cert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_add_pin_from_cert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cert_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Extract and add pin from certificate. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert_file</td><td>Path to PEM-encoded certificate file</td></tr>
  </table>
  </dd>
</dl>
<p>Loads certificate, extracts SPKI, computes SHA256, and adds as pin. Useful for pinning leaf certificates or intermediate CAs.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if file invalid, parse error, or max pins exceeded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="gacf5982c65823fa0eedc34d8d933710a9" name="gacf5982c65823fa0eedc34d8d933710a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacf5982c65823fa0eedc34d8d933710a9">&#9670;&#160;</a></span>SocketTLSContext_add_pin_from_x509()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_add_pin_from_x509 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const X509 *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add pin from X509 certificate object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cert</td><td>OpenSSL X509 certificate object</td></tr>
  </table>
  </dd>
</dl>
<p>Extracts SPKI hash from provided X509 and adds as pin. The certificate is not freed by this function; caller retains ownership.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if cert NULL, extraction fails, or max exceeded </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="gafd50881da0db97098204ff6fa920bb26" name="gafd50881da0db97098204ff6fa920bb26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafd50881da0db97098204ff6fa920bb26">&#9670;&#160;</a></span>SocketTLSContext_add_pin_hex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_add_pin_hex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hex_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add SPKI SHA256 pin (hex string). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hex_hash</td><td>64-character hex string (optionally prefixed with "sha256//")</td></tr>
  </table>
  </dd>
</dl>
<p>Adds a certificate pin using hex-encoded SHA256 hash of the peer's SPKI. Validates format (64 hex chars or prefixed), decodes to binary, stores in context (duplicates ignored). Pins checked during verification; mismatch raises SocketTLS_PinVerifyFailed if enforced.</p>
<p>Hex format: 64 lowercase/uppercase digits; supports HPKP-style "sha256//" prefix (base64-decoded but here hex for simplicity). Max pins limited by config (default 32).</p>
<h2><a class="anchor" id="autotoc_md587"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><span class="comment">// Pin example.com&#39;s known server key</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *pin =</div>
<div class="line"><span class="stringliteral">&quot;b5bb9d8014a0f9b1d61e21e796d78dccdf1352f23cd32812f4850b878ae4944c&quot;</span>; <a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gafd50881da0db97098204ff6fa920bb26">SocketTLSContext_add_pin_hex</a>(ctx, pin);</div>
<div class="line">    <span class="comment">// Or with prefix for HPKP compat</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#gafd50881da0db97098204ff6fa920bb26">SocketTLSContext_add_pin_hex</a>(ctx, <span class="stringliteral">&quot;sha256//base64-pin==&quot;</span>); <span class="comment">// But use</span></div>
<div class="line">hex <a class="code hl_function" href="group__security.html#ga8a972b0da962c5515936444b6921182d">SocketTLSContext_set_pin_enforcement</a>(ctx, 1); <span class="comment">// Fail on mismatch }</span></div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Invalid format or max exceeded</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__security_html_ga8a972b0da962c5515936444b6921182d"><div class="ttname"><a href="group__security.html#ga8a972b0da962c5515936444b6921182d">SocketTLSContext_set_pin_enforcement</a></div><div class="ttdeci">void SocketTLSContext_set_pin_enforcement(SocketTLSContext_T ctx, int enforce)</div><div class="ttdoc">Set pin enforcement mode.</div></div>
<div class="ttc" id="agroup__security_html_gafd50881da0db97098204ff6fa920bb26"><div class="ttname"><a href="group__security.html#gafd50881da0db97098204ff6fa920bb26">SocketTLSContext_add_pin_hex</a></div><div class="ttdeci">void SocketTLSContext_add_pin_hex(SocketTLSContext_T ctx, const char *hex_hash)</div><div class="ttdoc">Add SPKI SHA256 pin (hex string).</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md588"></a>
Generating Pins</h2>
<p>Use OpenSSL to extract SPKI hash: </p><div class="fragment"><div class="line">openssl x509 -in server.crt -pubkey -noout | openssl pkey -pubin -outform</div>
<div class="line">DER | openssl dgst -sha256 -hex | cut -d&#39; &#39; -f2</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Pins survive cert renewal if key unchanged; prefer over full cert pinning </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Test pins with <a class="el" href="group__security.html#gac051204c676250b114e00af223055686" title="Check if hash matches any pin.">SocketTLSContext_verify_pin()</a> before deploy </dd>
<dd>
Limit pins to known/trusted endpoints; too many degrade perf </dd></dl>
<dl class="section user"><dt>Complexity\n O(1) decode + hash compare during verify</dt><dd></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if invalid hex format, decode fail, or max pins exceeded (SOCKET_TLS_MAX_PINS ~32) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - safe for concurrent add/verify</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga34caeef50e78017625d2eb62142a7e45" title="Add SPKI SHA256 pin (binary format).">SocketTLSContext_add_pin()</a> for binary input </dd>
<dd>
<a class="el" href="group__security.html#gaa535f69cf93b2f0dec403e71336b0682" title="Extract and add pin from certificate.">SocketTLSContext_add_pin_from_cert()</a> for file-based </dd>
<dd>
<a class="el" href="group__security.html#ga445003fff70029dd096df971801be0e4" title="Exception raised when certificate pin verification fails during TLS handshake or manual check.">SocketTLS_PinVerifyFailed</a> exception on mismatch </dd>
<dd>
<a class="el" href="group__security.html#ga8a972b0da962c5515936444b6921182d" title="Set pin enforcement mode.">SocketTLSContext_set_pin_enforcement()</a> to toggle strict mode </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#certificate-pinning for strategy </dd></dl>

</div>
</div>
<a id="gab4bee293124b9d83681f9471f0519689" name="gab4bee293124b9d83681f9471f0519689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4bee293124b9d83681f9471f0519689">&#9670;&#160;</a></span>SocketTLSContext_cancel_crl_auto_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_cancel_crl_auto_refresh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Disable automatic CRL refresh. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<p>Cancels any configured automatic refresh. The current CRL remains loaded.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="gae201aacce977d32ab0187dd8b97d6c9a" name="gae201aacce977d32ab0187dd8b97d6c9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae201aacce977d32ab0187dd8b97d6c9a">&#9670;&#160;</a></span>SocketTLSContext_clear_pins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_clear_pins </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove all certificate pins. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<p>Securely clears all configured pins. Memory is zeroed before release. Pin enforcement mode is preserved.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="ga516c739f9ab7a0a5968279aba78a250c" name="ga516c739f9ab7a0a5968279aba78a250c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga516c739f9ab7a0a5968279aba78a250c">&#9670;&#160;</a></span>SocketTLSContext_crl_check_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_crl_check_refresh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check and perform CRL refresh if due. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<p>Call this periodically from your event loop. If a refresh is scheduled and due, it will reload the CRL and invoke the callback.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if refresh was performed, 0 if not due or not configured </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td>(errors reported via callback) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="ga1e822bd45ec2dad56c13d541dcd0c23d" name="ga1e822bd45ec2dad56c13d541dcd0c23d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e822bd45ec2dad56c13d541dcd0c23d">&#9670;&#160;</a></span>SocketTLSContext_crl_next_refresh_ms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">long SocketTLSContext_crl_next_refresh_ms </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get milliseconds until next refresh. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<p>Returns time until next scheduled CRL refresh. Useful for setting poll/select timeouts in event loops.</p>
<dl class="section return"><dt>Returns</dt><dd>-1 if disabled, 0 if due now/past, positive ms until next, LONG_MAX if far future (overflow prot.) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - read-only</dt><dd></dd></dl>

</div>
</div>
<a id="ga3b70029e86352f55e3710673ba30c23f" name="ga3b70029e86352f55e3710673ba30c23f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3b70029e86352f55e3710673ba30c23f">&#9670;&#160;</a></span>SocketTLSContext_ct_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_ct_enabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if CT verification is enabled. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if CT enabled, 0 if disabled </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only)</dt><dd></dd></dl>

</div>
</div>
<a id="gaf27bede9402c6c8c7541143e019c635f" name="gaf27bede9402c6c8c7541143e019c635f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf27bede9402c6c8c7541143e019c635f">&#9670;&#160;</a></span>SocketTLSContext_enable_ct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_enable_ct </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#ga4d930163393a67950a5378e540c0e939">CTValidationMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable Certificate Transparency verification. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance (client only) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mode</td><td>Validation mode (strict or permissive)</td></tr>
  </table>
  </dd>
</dl>
<p>Enables CT verification for client connections. In strict mode, connections fail if no valid SCTs are present. In permissive mode, missing SCTs are logged but don't cause failure.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if CT not supported or server context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="ga414fb627189037256afd8c4e015b74d1" name="ga414fb627189037256afd8c4e015b74d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga414fb627189037256afd8c4e015b74d1">&#9670;&#160;</a></span>SocketTLSContext_enable_ocsp_stapling()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_enable_ocsp_stapling </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable OCSP stapling request (client). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context instance (client only)</td></tr>
  </table>
  </dd>
</dl>
<p>Configures client context to request OCSP stapled responses from servers during TLS handshake. After handshake, use <a class="el" href="group__security.html#gae1a1b2392cfa8dd68e636bbef9df443f" title="Get OCSP status after handshake (client).">SocketTLS_get_ocsp_status()</a> to check the stapled response.</p>
<p>Note: This enables the STATUS_REQUEST TLS extension. The server must support OCSP stapling and have a valid OCSP response configured.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if server context or OpenSSL error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="ga6f0a68e802e789df40eaa28cb641a422" name="ga6f0a68e802e789df40eaa28cb641a422"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f0a68e802e789df40eaa28cb641a422">&#9670;&#160;</a></span>SocketTLSContext_enable_session_cache()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_enable_session_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_sessions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>timeout_seconds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable session caching.infrastructure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">max_sessions</td><td>Maximum number of sessions to cache (&gt;0), 0 for default </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">timeout_seconds</td><td>Session timeout in seconds, 0 for OpenSSL default (300s)</td></tr>
  </table>
  </dd>
</dl>
<p>Extends <code><a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a></code> with session cache configuration. Implements session cache using OpenSSL's built-in caching with thread-safe storage. Adds cache size and timeout configuration. Enables statistics tracking.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if cannot enable or configure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context during setup</dt><dd></dd></dl>

</div>
</div>
<a id="gae7d40e475eec529625a3d6ba74d23f4a" name="gae7d40e475eec529625a3d6ba74d23f4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae7d40e475eec529625a3d6ba74d23f4a">&#9670;&#160;</a></span>SocketTLSContext_enable_session_tickets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_enable_session_tickets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>key_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable stateless session.resumption using tickets. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">key</td><td>Ticket encryption key material (SOCKET_TLS_TICKET_KEY_LEN bytes required) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">key_len</td><td>Length of key (must be SOCKET_TLS_TICKET_KEY_LEN = 80 bytes)</td></tr>
  </table>
  </dd>
</dl>
<p>Implements stateless session resumption using encrypted session tickets. OpenSSL requires 80 bytes: 16 (name) + 32 (AES) + 32 (HMAC). Configures ticket key management, encryption/decryption using provided key. Supports ticket lifetime matching session timeout, and basic rotation. Requires cache enabled for full effect.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if invalid key length or OpenSSL config fails </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="gaea7ca3e656e9b58706fafc3232147203" name="gaea7ca3e656e9b58706fafc3232147203"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaea7ca3e656e9b58706fafc3232147203">&#9670;&#160;</a></span>SocketTLSContext_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> *&#160;</td>
          <td class="paramname"><em>ctx_p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dispose of TLS context and resources. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx_p</td><td>Pointer to context pointer (set to NULL on success)</td></tr>
  </table>
  </dd>
</dl>
<p>Frees the SSL_CTX, Arena (internal allocations), SNI arrays/certs/keys, ALPN data, and securely wipes sensitive material (e.g., session ticket keys via OPENSSL_cleanse, pinning data via SocketCrypto_secure_clear). Caller must not use context after free. Reverse of new_server/client. Security: Ensures no residual sensitive data in memory; thread-safe but avoid concurrent access.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td>(safe for NULL) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc" title="Create server TLS context with cert/key.">SocketTLSContext_new_server()</a>, <a class="el" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022" title="Create client TLS context.">SocketTLSContext_new_client()</a>, <a class="el" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234" title="Create client TLS context with custom config.">SocketTLSContext_new()</a> for context creation. </dd>
<dd>
<a class="el" href="group__foundation.html">Except_T</a> and Arena for exception and memory handling integrated here. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes (but avoid concurrent use)</dt><dd></dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="ga2093721c235cb8ebc83e90606abdcb33" name="ga2093721c235cb8ebc83e90606abdcb33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2093721c235cb8ebc83e90606abdcb33">&#9670;&#160;</a></span>SocketTLSContext_get_cache_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_get_cache_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>misses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>stores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get session cache statistics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">hits</td><td>Output: number of cache hits </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">misses</td><td>Output: number of cache misses </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">stores</td><td>Output: number of sessions stored</td></tr>
  </table>
  </dd>
</dl>
<p>Fills provided pointers with current session cache statistics. Statistics are thread-safe and cumulative since cache enable. If pointers NULL, skipped.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="gaf18e867664012c78a758c5454f62c367" name="gaf18e867664012c78a758c5454f62c367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf18e867664012c78a758c5454f62c367">&#9670;&#160;</a></span>SocketTLSContext_get_ct_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#ga4d930163393a67950a5378e540c0e939">CTValidationMode</a> SocketTLSContext_get_ct_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current CT validation mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>CT validation mode (strict or permissive) if enabled, or CT_VALIDATION_PERMISSIVE if disabled </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - read-only</dt><dd>(read-only) </dd></dl>

</div>
</div>
<a id="gaec2e531425cc03bff359517f60aa474c" name="gaec2e531425cc03bff359517f60aa474c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaec2e531425cc03bff359517f60aa474c">&#9670;&#160;</a></span>SocketTLSContext_get_pin_count()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SocketTLSContext_get_pin_count </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get number of configured pins. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of pins currently configured </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only)</dt><dd></dd></dl>

</div>
</div>
<a id="ga9d03fb564c11628d54e76a1c177b8494" name="ga9d03fb564c11628d54e76a1c177b8494"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9d03fb564c11628d54e76a1c177b8494">&#9670;&#160;</a></span>SocketTLSContext_get_pin_enforcement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_get_pin_enforcement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get current enforcement mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if strict enforcement, 0 if warn-only </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only)</dt><dd></dd></dl>

</div>
</div>
<a id="ga6e8aae1b6b1182d3f83b8673fdbbe945" name="ga6e8aae1b6b1182d3f83b8673fdbbe945"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6e8aae1b6b1182d3f83b8673fdbbe945">&#9670;&#160;</a></span>SocketTLSContext_get_ssl_ctx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * SocketTLSContext_get_ssl_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get underlying OpenSSL SSL_CTX*. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<p>Internal access to raw SSL_CTX for <a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f" title="Enable TLS on a socket using the provided context.">SocketTLS_enable()</a> etc.</p>
<dl class="section return"><dt>Returns</dt><dd>void* to SSL_CTX (cast as needed) </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="gaea37c149f7babbf14c28caf0ffef97cf" name="gaea37c149f7babbf14c28caf0ffef97cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaea37c149f7babbf14c28caf0ffef97cf">&#9670;&#160;</a></span>SocketTLSContext_has_pins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_has_pins </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if any pins are configured. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if pins configured, 0 if none </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only)</dt><dd></dd></dl>

</div>
</div>
<a id="ga39bd71708494c1c833d3064c3a70f8ad" name="ga39bd71708494c1c833d3064c3a70f8ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga39bd71708494c1c833d3064c3a70f8ad">&#9670;&#160;</a></span>SocketTLSContext_is_server()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_is_server </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if context is server-mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<p>Internal helper to determine client vs server configuration.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if server, 0 if client </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="gac4de1881e05f041a3d5016cba7d5a045" name="gac4de1881e05f041a3d5016cba7d5a045"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac4de1881e05f041a3d5016cba7d5a045">&#9670;&#160;</a></span>SocketTLSContext_load_ca()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_load_ca </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load trusted CA certificates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ca_file</td><td>Path to CA file or directory containing PEM CA certs</td></tr>
  </table>
  </dd>
</dl>
<p>Loads trusted CA certificates from file or directory for peer (client/server) verification. Supports PEM format files or hashed directories (OpenSSL style). Multiple calls accumulate CAs. Essential for preventing MITM by validating peer cert chain against trusted roots/intermediates.</p>
<p>Directory mode scans for CA files named by subject hash (e.g., &lt;hash&gt;.0). File mode loads concatenated PEM bundle.</p>
<h2><a class="anchor" id="autotoc_md586"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a>(NULL); <span class="comment">// Start without</span></div>
<div class="line">CA <a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> { <a class="code hl_function" href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045">SocketTLSContext_load_ca</a>(ctx,</div>
<div class="line"><span class="stringliteral">&quot;/etc/ssl/certs/ca-certificates.crt&quot;</span>); <span class="comment">// System bundle</span></div>
<div class="line">    <span class="comment">// Or directory:</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045">SocketTLSContext_load_ca</a>(ctx, <span class="stringliteral">&quot;/etc/ssl/certs/&quot;</span>); <span class="comment">// Ubuntu/Debian style</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga71084c00bec22f65b90301188868b759">SocketTLSContext_set_verify_mode</a>(ctx, <a class="code hl_enumvalue" href="group__security.html#ggac32c3958835b92ff683ae15f78448694ae56010acbcb7edcdcd7707be028cc6fe">TLS_VERIFY_PEER</a>); <span class="comment">// Require valid</span></div>
<div class="line">cert } <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Handle: file not found, invalid PEM, OpenSSL parse error</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Call after context creation, before handshakes; affects all connections using ctx </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Use only trusted CAs; avoid self-signed or unverified bundles in production </dd>
<dd>
Directory must contain valid CA files; invalid files logged but skipped </dd></dl>
<dl class="section user"><dt>Complexity\n O(n) where n=number of certs loaded (parse/verify each)</dt><dd></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on load/parse errors (ENOMEM, invalid format, I/O) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (internal mutex protects shared store)</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga71084c00bec22f65b90301188868b759" title="Set certificate verification policy.">SocketTLSContext_set_verify_mode()</a> to require CA validation </dd>
<dd>
<a class="el" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022" title="Create client TLS context.">SocketTLSContext_new_client()</a> which auto-loads if ca_file provided </dd>
<dd>
<a class="el" href="group__security.html#ga4fd56e743762151aa449744a8d574164" title="Get peer certificate verification result.">SocketTLS_get_verify_result()</a> post-handshake to check verification outcome </dd></dl>

</div>
</div>
<a id="ga1e2af3e4421c3c20c7dbc4b99cfb4211" name="ga1e2af3e4421c3c20c7dbc4b99cfb4211"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e2af3e4421c3c20c7dbc4b99cfb4211">&#9670;&#160;</a></span>SocketTLSContext_load_certificate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_load_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cert_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load server certificate and private key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert_file</td><td>Path to certificate file (PEM) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_file</td><td>Path to private key file (PEM)</td></tr>
  </table>
  </dd>
</dl>
<p>Loads and validates server certificate/private key pair. Verifies key matches cert.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on file errors, format issues, or mismatch </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="ga8bf03223d7c3b3cd28f8d03fe082d15e" name="ga8bf03223d7c3b3cd28f8d03fe082d15e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8bf03223d7c3b3cd28f8d03fe082d15e">&#9670;&#160;</a></span>SocketTLSContext_load_crl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_load_crl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>crl_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load CRL file or directory into verification store. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ctx</td><td>TLS context instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">crl_path</td><td>Path to CRL file (PEM/DER) or directory of CRL files (hashed names)</td></tr>
  </table>
  </dd>
</dl>
<p>Loads CRL data into the context's X509_STORE for revocation checking during peer verification. Supports single file or directory (auto-detect via stat). Multiple calls append additional CRLs. Enables CRL_CHECK flags automatically. CRL refresh not implemented (manual reload via re-call).</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if load/path invalid or OpenSSL error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared store; call during</dt><dd>setup Note: Effective only if verify_mode requires peer cert check (PEER/FAIL_IF_NO_PEER) </dd></dl>

</div>
</div>
<a id="ga69b7880fa99df9a39b4db5259a9e1234" name="ga69b7880fa99df9a39b4db5259a9e1234"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga69b7880fa99df9a39b4db5259a9e1234">&#9670;&#160;</a></span>SocketTLSContext_new()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> SocketTLSContext_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a> *&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create client TLS context with custom config. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">config</td><td>Custom TLS configuration (or NULL for defaults)</td></tr>
  </table>
  </dd>
</dl>
<p>Creates a client-side TLS context with provided configuration. If config NULL, uses secure defaults.</p>
<dl class="section return"><dt>Returns</dt><dd>New opaque <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> instance </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on OpenSSL errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="ga7fe51da14439d768bdf72f4ed8fbb022" name="ga7fe51da14439d768bdf72f4ed8fbb022"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7fe51da14439d768bdf72f4ed8fbb022">&#9670;&#160;</a></span>SocketTLSContext_new_client()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> SocketTLSContext_new_client </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create client TLS context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ca_file</td><td>Optional path to CA file/directory for server verification (NULL to disable)</td></tr>
  </table>
  </dd>
</dl>
<p>Creates a client-side TLS context with TLS1.3-only and modern ciphers (ECDHE</p><ul>
<li>AES-GCM/ChaCha20-Poly1305). Loads CA if provided and enables peer verification by default. Security: Enforces TLS 1.3-only protocol; disables renegotiation and compression; warns on missing CA (MITM risk); peer verification required; securely clears sensitive data on free.</li>
</ul>
<h2><a class="anchor" id="autotoc_md584"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a>(<span class="stringliteral">&quot;ca-bundle.pem&quot;</span>);</div>
<div class="line">    <span class="comment">// Enable advanced features</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#gaf27bede9402c6c8c7541143e019c635f">SocketTLSContext_enable_ct</a>(ctx, <a class="code hl_enumvalue" href="group__security.html#gga4d930163393a67950a5378e540c0e939a102a7857300a9c88684ed50efe69d3ab">CT_VALIDATION_STRICT</a>);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga414fb627189037256afd8c4e015b74d1">SocketTLSContext_enable_ocsp_stapling</a>(ctx);</div>
<div class="line">    <span class="comment">// Pin known server key</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#gafd50881da0db97098204ff6fa920bb26">SocketTLSContext_add_pin_hex</a>(ctx, <span class="stringliteral">&quot;sha256//server-pin-hash&quot;</span>);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Handle CA load fail or OpenSSL error</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__security_html_ga414fb627189037256afd8c4e015b74d1"><div class="ttname"><a href="group__security.html#ga414fb627189037256afd8c4e015b74d1">SocketTLSContext_enable_ocsp_stapling</a></div><div class="ttdeci">void SocketTLSContext_enable_ocsp_stapling(SocketTLSContext_T ctx)</div><div class="ttdoc">Enable OCSP stapling request (client).</div></div>
<div class="ttc" id="agroup__security_html_gaf27bede9402c6c8c7541143e019c635f"><div class="ttname"><a href="group__security.html#gaf27bede9402c6c8c7541143e019c635f">SocketTLSContext_enable_ct</a></div><div class="ttdeci">void SocketTLSContext_enable_ct(SocketTLSContext_T ctx, CTValidationMode mode)</div><div class="ttdoc">Enable Certificate Transparency verification.</div></div>
<div class="ttc" id="agroup__security_html_gga4d930163393a67950a5378e540c0e939a102a7857300a9c88684ed50efe69d3ab"><div class="ttname"><a href="group__security.html#gga4d930163393a67950a5378e540c0e939a102a7857300a9c88684ed50efe69d3ab">CT_VALIDATION_STRICT</a></div><div class="ttdeci">@ CT_VALIDATION_STRICT</div><div class="ttdef"><b>Definition</b> <a href="SocketTLSContext_8h_source.html#l01228">SocketTLSContext.h:1227</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md585"></a>
With Custom Config</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__tls__config.html#structSocketTLSConfig__T">SocketTLSConfig_T</a> config = {0};</div>
<div class="line">SocketTLSConfig_defaults(&amp;config);</div>
<div class="line">config.<a class="code hl_variable" href="group__tls__config.html#a670bdce01faa6f2ff73dc3ce67b14db5">min_version</a> = TLS1_2_VERSION; <span class="comment">// Allow TLS1.2 fallback if needed</span></div>
<div class="line"><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga69b7880fa99df9a39b4db5259a9e1234">SocketTLSContext_new</a>(&amp;config);</div>
<div class="ttc" id="agroup__tls__config_html_a670bdce01faa6f2ff73dc3ce67b14db5"><div class="ttname"><a href="group__tls__config.html#a670bdce01faa6f2ff73dc3ce67b14db5">SocketTLSConfig_T::min_version</a></div><div class="ttdeci">int min_version</div><div class="ttdef"><b>Definition</b> <a href="SocketTLSConfig_8h_source.html#l00175">SocketTLSConfig.h:175</a></div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Prefer system CA bundle or pinned CAs for production </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>NULL ca_file disables verification - only for testing/internal </dd></dl>
<dl class="section user"><dt>Complexity\n O(1) + CA file parse time</dt><dd></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>New opaque <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> instance </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on OpenSSL errors or invalid CA </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaea7ca3e656e9b58706fafc3232147203" title="Dispose of TLS context and resources.">SocketTLSContext_free()</a> for disposal. </dd>
<dd>
<a class="el" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc" title="Create server TLS context with cert/key.">SocketTLSContext_new_server()</a> for server context. </dd>
<dd>
<a class="el" href="group__security.html#ga71084c00bec22f65b90301188868b759" title="Set certificate verification policy.">SocketTLSContext_set_verify_mode()</a> to adjust verification. </dd>
<dd>
<a class="el" href="group__security.html">Security Modules</a> for other TLS <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> features like pinning and OCSP. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="ga79a403f2f54f21c90a92e9cb73e24cbc" name="ga79a403f2f54f21c90a92e9cb73e24cbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga79a403f2f54f21c90a92e9cb73e24cbc">&#9670;&#160;</a></span>SocketTLSContext_new_server()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> SocketTLSContext_new_server </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cert_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create server TLS context with cert/key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cert_file</td><td>Path to server certificate file (PEM format) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_file</td><td>Path to private key file (PEM format) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ca_file</td><td>Optional path to CA file/directory for client auth (NULL to disable)</td></tr>
  </table>
  </dd>
</dl>
<p>Creates a server-side TLS context, loads server cert/key, sets TLS1.3-only, modern ciphers (ECDHE + AES-GCM/ChaCha20-Poly1305 for PFS), and optionally CA for client verification. Security: Enforces TLS 1.3-only protocol; disables renegotiation, compression, and legacy features; server cipher preference; peer verification configurable; securely clears sensitive keys/material on free.</p>
<h2><a class="anchor" id="autotoc_md582"></a>
Usage Example</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc">SocketTLSContext_new_server</a>(<span class="stringliteral">&quot;server.crt&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;server.key&quot;</span>, <span class="stringliteral">&quot;ca-bundle.pem&quot;</span>);</div>
<div class="line">    <span class="comment">// Optional: Load CRL for revocation checking</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga8bf03223d7c3b3cd28f8d03fe082d15e">SocketTLSContext_load_crl</a>(ctx, <span class="stringliteral">&quot;/path/to/crl/&quot;</span>);</div>
<div class="line">    <span class="comment">// Optional: Enable OCSP stapling for clients</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga414fb627189037256afd8c4e015b74d1">SocketTLSContext_enable_ocsp_stapling</a>(ctx);</div>
<div class="line">    <span class="comment">// Apply to server socket</span></div>
<div class="line">    <a class="code hl_function" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a>(server_sock, ctx);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#gabc011202dd4f2e080b6ea8eb0f24287e">SocketTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Handle: invalid cert/key, file I/O error, OpenSSL init fail</span></div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Server TLS setup failed: %s\n&quot;</span>, <a class="code hl_function" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a>());</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> {</div>
<div class="line">    <span class="keywordflow">if</span> (ctx) <a class="code hl_function" href="group__security.html#gaea7ca3e656e9b58706fafc3232147203">SocketTLSContext_free</a>(&amp;ctx); <span class="comment">// Ensure cleanup</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__security_html_ga8bf03223d7c3b3cd28f8d03fe082d15e"><div class="ttname"><a href="group__security.html#ga8bf03223d7c3b3cd28f8d03fe082d15e">SocketTLSContext_load_crl</a></div><div class="ttdeci">void SocketTLSContext_load_crl(SocketTLSContext_T ctx, const char *crl_path)</div><div class="ttdoc">Load CRL file or directory into verification store.</div></div>
<div class="ttc" id="agroup__security_html_gab9a8fb788aa1f0d21b5773bc43a48d6f"><div class="ttname"><a href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a></div><div class="ttdeci">void SocketTLS_enable(Socket_T socket, SocketTLSContext_T ctx)</div><div class="ttdoc">Enable TLS on a socket using the provided context.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md583"></a>
Advanced Usage with SNI and Pinning</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga79a403f2f54f21c90a92e9cb73e24cbc">SocketTLSContext_new_server</a>(<span class="stringliteral">&quot;default.crt&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;default.key&quot;</span>, NULL);</div>
<div class="line"><span class="comment">// Add SNI certs</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#ga92be47dab18fc79c409fc8b450e7aa0d">SocketTLSContext_add_certificate</a>(ctx, <span class="stringliteral">&quot;www.example.com&quot;</span>, <span class="stringliteral">&quot;example.crt&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;example.key&quot;</span>); <a class="code hl_function" href="group__security.html#ga92be47dab18fc79c409fc8b450e7aa0d">SocketTLSContext_add_certificate</a>(ctx, <span class="stringliteral">&quot;api.example.com&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;api.crt&quot;</span>, <span class="stringliteral">&quot;api.key&quot;</span>);</div>
<div class="line"><span class="comment">// Pin backup key for resilience</span></div>
<div class="line"><a class="code hl_function" href="group__security.html#gaa535f69cf93b2f0dec403e71336b0682">SocketTLSContext_add_pin_from_cert</a>(ctx, <span class="stringliteral">&quot;backup.crt&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga8a972b0da962c5515936444b6921182d">SocketTLSContext_set_pin_enforcement</a>(ctx, 1); <span class="comment">// Fail if no match</span></div>
<div class="ttc" id="agroup__security_html_ga92be47dab18fc79c409fc8b450e7aa0d"><div class="ttname"><a href="group__security.html#ga92be47dab18fc79c409fc8b450e7aa0d">SocketTLSContext_add_certificate</a></div><div class="ttdeci">void SocketTLSContext_add_certificate(SocketTLSContext_T ctx, const char *hostname, const char *cert_file, const char *key_file)</div><div class="ttdoc">Add certificate mapping for SNI virtual hosting.</div></div>
<div class="ttc" id="agroup__security_html_gaa535f69cf93b2f0dec403e71336b0682"><div class="ttname"><a href="group__security.html#gaa535f69cf93b2f0dec403e71336b0682">SocketTLSContext_add_pin_from_cert</a></div><div class="ttdeci">void SocketTLSContext_add_pin_from_cert(SocketTLSContext_T ctx, const char *cert_file)</div><div class="ttdoc">Extract and add pin from certificate.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Create ctx once at startup; reuse for all connections to same server/domain </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Match cert to domain; use ECDSA or RSA-4096 keys; rotate periodically </dd>
<dd>
ca_file enables client auth; without it, anonymous clients allowed (security risk) </dd></dl>
<dl class="section user"><dt>Complexity\n O(1) base + O(n) for cert chain validation and file reads</dt><dd>(n=chain length)</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>New opaque <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> instance </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on OpenSSL errors, file I/O, or invalid cert/key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaea7ca3e656e9b58706fafc3232147203" title="Dispose of TLS context and resources.">SocketTLSContext_free()</a> for disposing the context. </dd>
<dd>
<a class="el" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022" title="Create client TLS context.">SocketTLSContext_new_client()</a> for client-side context. </dd>
<dd>
<a class="el" href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045" title="Load trusted CA certificates.">SocketTLSContext_load_ca()</a> for additional CA configuration. </dd>
<dd>
<a class="el" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f" title="Enable TLS on a socket using the provided context.">SocketTLS_enable()</a> to apply context to a socket. </dd>
<dd>
<a class="el" href="group__foundation.html">Core Foundation Modules</a> for Arena-based memory management used internally. </dd>
<dd>
<a class="el" href="group__core__io.html">Socket</a> for base socket operations secured by TLS. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - each call creates independent context</dt><dd></dd></dl>

</div>
</div>
<a id="ga7f214a19238ce8cd567d6ad6efa806c9" name="ga7f214a19238ce8cd567d6ad6efa806c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f214a19238ce8cd567d6ad6efa806c9">&#9670;&#160;</a></span>SocketTLSContext_ocsp_stapling_enabled()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_ocsp_stapling_enabled </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if OCSP stapling is enabled. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context instance</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if OCSP stapling request enabled, 0 otherwise </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only)</dt><dd></dd></dl>

</div>
</div>
<a id="ga9ea9577387ebc9edb186a6c491c67ab4" name="ga9ea9577387ebc9edb186a6c491c67ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9ea9577387ebc9edb186a6c491c67ab4">&#9670;&#160;</a></span>SocketTLSContext_refresh_crl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_refresh_crl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>crl_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Refresh a specific CRL (re-load). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ctx</td><td>TLS context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">crl_path</td><td>Path to refresh</td></tr>
  </table>
  </dd>
</dl>
<p>Re-loads the CRL from path (appends to store). Use for periodic refresh. For full store refresh, recreate context (CRLs accumulate). </p><dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on load error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac5ba25c0153bc63b6087cff6304f4938" name="gac5ba25c0153bc63b6087cff6304f4938"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac5ba25c0153bc63b6087cff6304f4938">&#9670;&#160;</a></span>SocketTLSContext_reload_crl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_reload_crl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>crl_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reload CRL from path (alias for refresh_crl). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ctx</td><td>TLS context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">crl_path</td><td>Path to CRL file or directory</td></tr>
  </table>
  </dd>
</dl>
<p>Reloads the CRL from the specified path. This is an alias for <a class="el" href="group__security.html#ga9ea9577387ebc9edb186a6c491c67ab4" title="Refresh a specific CRL (re-load).">SocketTLSContext_refresh_crl()</a> provided for semantic clarity. Use when you have downloaded an updated CRL and want to reload it.</p>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on load error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab7c088402bdf132a710551ebe2268ed0" name="gab7c088402bdf132a710551ebe2268ed0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab7c088402bdf132a710551ebe2268ed0">&#9670;&#160;</a></span>SocketTLSContext_set_alpn_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_alpn_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__tls__context.html#gaa53566f8d54960bb2d44516a50f67c70">SocketTLSAlpnCallback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set custom ALPN protocol selection callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">callback</td><td>Function to call for ALPN protocol selection </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">user_data</td><td>User data passed to callback function</td></tr>
  </table>
  </dd>
</dl>
<p>Sets a custom callback for ALPN protocol selection instead of using default priority order. The callback receives parsed and validated client-offered protocols (library rejects malformed lists per RFC 7301 Section 3.2). Return a const char* to a persistent matching protocol string or NULL to decline. Library validates return (must match offered list, valid length/chars), internally allocates a copy for OpenSSL (avoids UAF if returning temporary ptr), and uses it during handshake.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on invalid parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>
<p>Note: Callback is called during TLS handshake, must be thread-safe if context is shared. </p>

</div>
</div>
<a id="ga4fcc29a81cf5c643ee9a56deb46b9ec8" name="ga4fcc29a81cf5c643ee9a56deb46b9ec8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fcc29a81cf5c643ee9a56deb46b9ec8">&#9670;&#160;</a></span>SocketTLSContext_set_alpn_protos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_alpn_protos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>protos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Advertise ALPN protocols. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">protos</td><td>Array of null-terminated protocol strings (e.g., "h2", "http/1.1") </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">count</td><td>Number of protocols</td></tr>
  </table>
  </dd>
</dl>
<p>Sets list of supported ALPN protocols in wire format, allocated from context arena. Validates lengths (1-255 bytes per protocol, max SOCKET_TLS_MAX_ALPN_PROTOCOLS) and contents (full RFC 7301 Section 3.2: printable ASCII 0x21-0x7E only, rejects invalid lists/entries). Invalid names raise SocketTLS_Failed. Uses SocketSecurity limits at runtime.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on invalid protos or allocation error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>
<p>Note: Protocols advertised in preference order (first preferred). </p>

</div>
</div>
<a id="gae1d9ff9d7e15f5a798d316ddf6ec6d53" name="gae1d9ff9d7e15f5a798d316ddf6ec6d53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae1d9ff9d7e15f5a798d316ddf6ec6d53">&#9670;&#160;</a></span>SocketTLSContext_set_cert_lookup_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_cert_lookup_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#ga5c2914ee879d575869932c3a3aed4863">SocketTLSCertLookupCallback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register custom cert lookup. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context instance </td></tr>
    <tr><td class="paramname">callback</td><td>Lookup function (NULL to disable) </td></tr>
    <tr><td class="paramname">user_data</td><td>User data passed to callback</td></tr>
  </table>
  </dd>
</dl>
<p>Sets a custom callback for certificate lookup during verification. This allows loading certificates from databases, HSMs, or other sources instead of the filesystem.</p>
<p>Note: Requires OpenSSL 1.1.0+ for X509_STORE_set_lookup_certs_cb.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if not supported or OpenSSL error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - configure before sharing context</dt><dd></dd></dl>

</div>
</div>
<a id="ga2e731151980c8c30a7fbb18da74ddffa" name="ga2e731151980c8c30a7fbb18da74ddffa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2e731151980c8c30a7fbb18da74ddffa">&#9670;&#160;</a></span>SocketTLSContext_set_cipher_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_cipher_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ciphers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set allowed cipher suites. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">ciphers</td><td>Cipher list string in OpenSSL format, or NULL for defaults</td></tr>
  </table>
  </dd>
</dl>
<p>Configures allowed ciphers. Defaults to secure modern list if NULL.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if invalid list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="gac049c86b0b5edba0a7bcb73ca2e1e2eb" name="gac049c86b0b5edba0a7bcb73ca2e1e2eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac049c86b0b5edba0a7bcb73ca2e1e2eb">&#9670;&#160;</a></span>SocketTLSContext_set_crl_auto_refresh()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_crl_auto_refresh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>crl_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>interval_seconds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#ga60686895b6fbdd1290a6f6176484bf5b">SocketTLSCrlCallback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable automatic CRL refresh. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">ctx</td><td>TLS context instance </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">crl_path</td><td>Path to CRL file (copied to context) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">interval_seconds</td><td>Refresh interval (minimum 60, 0 to disable) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">callback</td><td>Optional callback for refresh notifications (may be NULL) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">user_data</td><td>User data passed to callback</td></tr>
  </table>
  </dd>
</dl>
<p>Configures automatic CRL refresh. The CRL will be reloaded every interval_seconds. Call <a class="el" href="group__security.html#ga516c739f9ab7a0a5968279aba78a250c" title="Check and perform CRL refresh if due.">SocketTLSContext_crl_check_refresh()</a> from your event loop to trigger scheduled refreshes.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on invalid parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - configure before sharing context</dt><dd></dd></dl>

</div>
</div>
<a id="gada967caf61c070399281b088b35ed78a" name="gada967caf61c070399281b088b35ed78a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada967caf61c070399281b088b35ed78a">&#9670;&#160;</a></span>SocketTLSContext_set_ctlog_list_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_ctlog_list_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>log_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load custom CT log list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance (client only) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">log_file</td><td>Path to CT log list file (OpenSSL format)</td></tr>
  </table>
  </dd>
</dl>
<p>Loads a custom list of trusted CT logs from file, overriding OpenSSL defaults. Validates file path and format. Call before enable_ct for effect.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if file invalid, load fails, or server context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No (config phase only)</dt><dd></dd></dl>

</div>
</div>
<a id="gad094c4db92c9979bcde108166193abee" name="gad094c4db92c9979bcde108166193abee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad094c4db92c9979bcde108166193abee">&#9670;&#160;</a></span>SocketTLSContext_set_max_protocol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_max_protocol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set maximum supported TLS version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">version</td><td>OpenSSL version constant (e.g., TLS1_3_VERSION)</td></tr>
  </table>
  </dd>
</dl>
<p>Sets max TLS version using set_max_proto_version().</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if cannot set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="gaa7703e1d2c80b49601af8237e81729ef" name="gaa7703e1d2c80b49601af8237e81729ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa7703e1d2c80b49601af8237e81729ef">&#9670;&#160;</a></span>SocketTLSContext_set_min_protocol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_min_protocol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set minimum supported TLS version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">version</td><td>OpenSSL version constant (e.g., TLS1_3_VERSION)</td></tr>
  </table>
  </dd>
</dl>
<p>Sets min TLS version using set_min_proto_version() with fallback to options.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if cannot set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="ga0b49040701aa37f11720d9539c046347" name="ga0b49040701aa37f11720d9539c046347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0b49040701aa37f11720d9539c046347">&#9670;&#160;</a></span>SocketTLSContext_set_ocsp_gen_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_ocsp_gen_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#ga1acd7a590114ffbf4307a6f5a3bab35c">SocketTLSOcspGenCallback</a>&#160;</td>
          <td class="paramname"><em>cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register dynamic OCSP response generator. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context (server) </td></tr>
    <tr><td class="paramname">cb</td><td>Callback to generate OCSP response during handshake </td></tr>
    <tr><td class="paramname">arg</td><td>User data passed to cb</td></tr>
  </table>
  </dd>
</dl>
<p>Enables dynamic OCSP stapling. Called during handshake to generate response. Wrapper handles serialization and SSL_set_tlsext_status_ocsp_resp. </p><dl class="section user"><dt>Thread Safety\n cb must be; called in handshake thread.</dt><dd></dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if OpenSSL cb set fails </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gacad0c368922de598277e4237779504b7" name="gacad0c368922de598277e4237779504b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacad0c368922de598277e4237779504b7">&#9670;&#160;</a></span>SocketTLSContext_set_ocsp_response()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_ocsp_response </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set static OCSP response for stapling.(server) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context instance </td></tr>
    <tr><td class="paramname">response</td><td>OCSP response bytes (DER encoded) </td></tr>
    <tr><td class="paramname">len</td><td>Length of response</td></tr>
  </table>
  </dd>
</dl>
<p>Sets a static OCSP response to staple in server handshakes. Multiple calls override. Validates basic response format.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if invalid response (len=0 or parse fail) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd>Note: For dynamic, use set_ocsp_callback. </dd></dl>

</div>
</div>
<a id="ga8a972b0da962c5515936444b6921182d" name="ga8a972b0da962c5515936444b6921182d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a972b0da962c5515936444b6921182d">&#9670;&#160;</a></span>SocketTLSContext_set_pin_enforcement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_pin_enforcement </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enforce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set pin enforcement mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">enforce</td><td>1 = strict (fail on mismatch), 0 = warn only</td></tr>
  </table>
  </dd>
</dl>
<p>Controls behavior when no pin matches during verification:</p><ul>
<li>enforce=1 (default): Handshake fails with X509_V_ERR_APPLICATION_VERIFICATION</li>
<li>enforce=0: Verification continues, mismatch is logged</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context</dt><dd></dd></dl>

</div>
</div>
<a id="ga51fa29a23c87a8f2a9c7b71b6731fb50" name="ga51fa29a23c87a8f2a9c7b71b6731fb50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga51fa29a23c87a8f2a9c7b71b6731fb50">&#9670;&#160;</a></span>SocketTLSContext_set_session_cache_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_session_cache_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Limit cached sessions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">size</td><td>Max number of sessions to cache (&gt;0)</td></tr>
  </table>
  </dd>
</dl>
<p>Controls memory usage of session cache.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if invalid size or cannot set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="ga2712efd6f1918aa87a3120547c0cf64d" name="ga2712efd6f1918aa87a3120547c0cf64d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2712efd6f1918aa87a3120547c0cf64d">&#9670;&#160;</a></span>SocketTLSContext_set_verify_callback()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_verify_callback </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#gac9a12208531822c8304c23dcbcb8ba97">SocketTLSVerifyCallback</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>user_data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Register custom verification callback. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">callback</td><td>User callback function (NULL to disable custom and use default) </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">user_data</td><td>Opaque data passed to callback (lifetime managed by caller)</td></tr>
  </table>
  </dd>
</dl>
<p>Sets a custom verification callback, overriding default OpenSSL behavior while respecting current verify_mode. The wrapper ensures thread-safety and error propagation via exceptions.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>if OpenSSL configuration fails </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected) - modifies shared context; call before</dt><dd>sharing</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gac9a12208531822c8304c23dcbcb8ba97" title="User-defined certificate verification callback.">SocketTLSVerifyCallback</a> for the callback function signature and usage. </dd>
<dd>
<a class="el" href="group__security.html#ga71084c00bec22f65b90301188868b759" title="Set certificate verification policy.">SocketTLSContext_set_verify_mode()</a> for configuring base verification policy. </dd>
<dd>
<a class="el" href="group__security.html">Security Modules</a> for other TLS verification features like CRL and OCSP. </dd></dl>

</div>
</div>
<a id="ga71084c00bec22f65b90301188868b759" name="ga71084c00bec22f65b90301188868b759"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga71084c00bec22f65b90301188868b759">&#9670;&#160;</a></span>SocketTLSContext_set_verify_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketTLSContext_set_verify_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set certificate verification policy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">mode</td><td>Verification mode enum (TLS_VERIFY_NONE, PEER, etc.)</td></tr>
  </table>
  </dd>
</dl>
<p>Configures peer cert verification behavior, mapping to OpenSSL SSL_VERIFY_* flags.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketTLS_Failed</td><td>on invalid mode </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (mutex protected)</dt><dd></dd></dl>

</div>
</div>
<a id="gae69fbca6dae1712eb7abd1f1b268926b" name="gae69fbca6dae1712eb7abd1f1b268926b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae69fbca6dae1712eb7abd1f1b268926b">&#9670;&#160;</a></span>SocketTLSContext_verify_cert_pin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_verify_cert_pin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const X509 *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if certificate matches any pin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">cert</td><td>X509 certificate to verify</td></tr>
  </table>
  </dd>
</dl>
<p>Extracts SPKI hash from certificate and checks against pins. Useful for manual chain verification.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if match found, 0 if no match </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only)</dt><dd></dd></dl>

</div>
</div>
<a id="gac051204c676250b114e00af223055686" name="gac051204c676250b114e00af223055686"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac051204c676250b114e00af223055686">&#9670;&#160;</a></span>SocketTLSContext_verify_pin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketTLSContext_verify_pin </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>sha256_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if hash matches any pin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The TLS context instance </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">sha256_hash</td><td>32-byte hash to check</td></tr>
  </table>
  </dd>
</dl>
<p>Manual verification without full handshake. Useful for testing or custom verification logic.</p>
<dl class="section return"><dt>Returns</dt><dd>1 if match found, 0 if no match </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes (read-only)</dt><dd></dd></dl>

</div>
</div>
<a id="gacf287a7019c5ff677321e8b5fa390cf2" name="gacf287a7019c5ff677321e8b5fa390cf2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacf287a7019c5ff677321e8b5fa390cf2">&#9670;&#160;</a></span>synprotect_clamp_score()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static float synprotect_clamp_score </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>score</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clamp reputation score to valid range [0.0f, 1.0f]. </p>
<p>Utility for ensuring scores stay bounded during calculations.</p>
<p>Prevents invalid scores from propagating through reputation algorithms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">score</td><td>Input score value which may be out of bounds. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Clamped score value, guaranteed to be &gt;= 0.0f and &lt;= 1.0f.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Used extensively in score adjustment logic. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gae82758ef1761626baf114a11955520e1" title="Initial reputation score for newly encountered IP addresses.">SOCKET_SYN_INITIAL_SCORE</a>, <a class="el" href="group__security.html#ga94b45dbd0567c33d239bcfe0b8de2391" title="Reputation score assigned to whitelisted or fully trusted IPs.">SOCKET_SYN_TRUSTED_SCORE</a> constants. </dd>
<dd>
<a class="el" href="group__security.html#aaa43aaa7c28639d949e57ac1e14b2189">SocketSYN_IPState::score</a> field. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00313">313</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="ga93f5774d64aab235b0af3908cf5fa15a" name="ga93f5774d64aab235b0af3908cf5fa15a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga93f5774d64aab235b0af3908cf5fa15a">&#9670;&#160;</a></span>synprotect_hash_ip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned synprotect_hash_ip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketSYNProtect__T">SocketSYNProtect_T</a>&#160;</td>
          <td class="paramname"><em>protect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>table_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute hash index for an IP address using instance-specific seed. </p>
<p>Internal hashing utility for distributing IP entries.</p>
<p>Combines DJB2-style hash with per-instance seed and modulo for table indexing. Designed to resist hash flooding attacks by randomizing per deployment.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protect</td><td>The SYN protection instance providing hash_seed. </td></tr>
    <tr><td class="paramname">ip</td><td>Null-terminated C string containing IPv4 or IPv6 address. </td></tr>
    <tr><td class="paramname">table_size</td><td>Number of buckets in the target hash table (typically prime). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Unsigned integer hash index in range [0, table_size).</dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - pure function with no observable side effects.</dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Relies on <a class="el" href="group__foundation.html#gaacb8ea34fa3de46f676cc0b1bd887f66" title="Case-insensitive length-aware DJB2 hash.">socket_util_hash_djb2_ci_len()</a> internally for case-insensitive hashing. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html#gaacb8ea34fa3de46f676cc0b1bd887f66" title="Case-insensitive length-aware DJB2 hash.">socket_util_hash_djb2_ci_len()</a> base algorithm. </dd>
<dd>
<a class="el" href="group__security.html#ae8aea9e4cc570341d5cc8901f3cb814e">SocketSYNProtect_Config::hash_seed</a> for seed configuration. </dd></dl>

</div>
</div>
<a id="ga86342ee431726d93daa749ed5eae611a" name="ga86342ee431726d93daa749ed5eae611a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga86342ee431726d93daa749ed5eae611a">&#9670;&#160;</a></span>synprotect_max()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int64_t synprotect_max </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the maximum of two int64_t values. </p>
<p>Generic max utility for internal bounds checking and timing.</p>
<p>Complements <a class="el" href="group__security.html#ga10a168a8c7d6d98660b8371b9b886fa8" title="Compute the minimum of two int64_t values.">synprotect_min()</a> for symmetric operations in algorithms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>First integer value. </td></tr>
    <tr><td class="paramname">b</td><td>Second integer value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The larger (maximum) of the two input values.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Used alongside <a class="el" href="group__security.html#ga10a168a8c7d6d98660b8371b9b886fa8" title="Compute the minimum of two int64_t values.">synprotect_min()</a> for range clamping. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga10a168a8c7d6d98660b8371b9b886fa8" title="Compute the minimum of two int64_t values.">synprotect_min()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00356">356</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="ga10a168a8c7d6d98660b8371b9b886fa8" name="ga10a168a8c7d6d98660b8371b9b886fa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga10a168a8c7d6d98660b8371b9b886fa8">&#9670;&#160;</a></span>synprotect_min()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int64_t synprotect_min </td>
          <td>(</td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the minimum of two int64_t values. </p>
<p>Generic min utility for timing and counter calculations.</p>
<p>Simple, branchless where possible, for use in internal algorithms.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">a</td><td>First integer value. </td></tr>
    <tr><td class="paramname">b</td><td>Second integer value. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The smaller (minimum) of the two input values.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Used for clamping timeouts, windows, and limits. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketSYNProtect-private_8h_source.html#l00336">336</a> of file <a class="el" href="SocketSYNProtect-private_8h_source.html">SocketSYNProtect-private.h</a>.</p>

</div>
</div>
<a id="ga5521981e692a3cdd4176000e2282398f" name="ga5521981e692a3cdd4176000e2282398f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5521981e692a3cdd4176000e2282398f">&#9670;&#160;</a></span>tls_cleanup_alpn_temp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void tls_cleanup_alpn_temp </td>
          <td>(</td>
          <td class="paramtype">SSL *&#160;</td>
          <td class="paramname"><em>ssl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Clean up temporary ALPN protocol buffer from SSL ex_data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl</td><td>OpenSSL SSL object to clean.</td></tr>
  </table>
  </dd>
</dl>
<p>Frees any arena-allocated ALPN protocol string stored in the SSL's ex_data using tls_get_alpn_ex_idx and clears the ex_data slot to NULL. Prevents memory leaks in ALPN callbacks; safe for repeated calls or non-ALPN SSLs. Called internally before SSL_free in socket TLS cleanup.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab904e51ebbeabc985c3988fc0980776e" title="Validate file path for certificates, keys, or CAs against security threats.">tls_get_alpn_ex_idx()</a> for the ex_data index used. </dd>
<dd>
<a class="el" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d" title="Dispose of an arena and all its allocations, freeing underlying memory chunks.">Arena_dispose()</a> indirect via buffer free. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Conditional - safe if no concurrent access to SSL ex_data.</dt><dd></dd></dl>

</div>
</div>
<a id="gaafa8d212678f77cf8c99a4e4914b6d97" name="gaafa8d212678f77cf8c99a4e4914b6d97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaafa8d212678f77cf8c99a4e4914b6d97">&#9670;&#160;</a></span>tls_context_get_from_ssl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> tls_context_get_from_ssl </td>
          <td>(</td>
          <td class="paramtype">const SSL *&#160;</td>
          <td class="paramname"><em>ssl</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> associated with an SSL object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl</td><td>OpenSSL SSL object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> or NULL if not found</dd></dl>
<p>Looks up the library TLS context stored in the SSL object's ex_data. Used in OpenSSL callbacks to access configuration and state.</p>
<dl class="section user"><dt>Thread Safety\n Yes - read-only lookup</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gacc208c7e1bc1f93a93e8db60903527fa" title="Retrieve SocketTLSContext_T associated with an SSL_CTX object.">tls_context_get_from_ssl_ctx()</a> for SSL_CTX lookup </dd></dl>

</div>
</div>
<a id="gacc208c7e1bc1f93a93e8db60903527fa" name="gacc208c7e1bc1f93a93e8db60903527fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacc208c7e1bc1f93a93e8db60903527fa">&#9670;&#160;</a></span>tls_context_get_from_ssl_ctx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> tls_context_get_from_ssl_ctx </td>
          <td>(</td>
          <td class="paramtype">SSL_CTX *&#160;</td>
          <td class="paramname"><em>ssl_ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> associated with an SSL_CTX object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ssl_ctx</td><td>OpenSSL SSL_CTX object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> or NULL if not found</dd></dl>
<p>Looks up the library TLS context stored in the SSL_CTX's ex_data. Used during context initialization and OpenSSL callbacks.</p>
<dl class="section user"><dt>Thread Safety\n Yes - read-only lookup</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaafa8d212678f77cf8c99a4e4914b6d97" title="Retrieve SocketTLSContext_T associated with an SSL object.">tls_context_get_from_ssl()</a> for SSL object lookup </dd></dl>

</div>
</div>
<a id="ga603f6b5acb264e31bf6a0f71d5b48be5" name="ga603f6b5acb264e31bf6a0f71d5b48be5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga603f6b5acb264e31bf6a0f71d5b48be5">&#9670;&#160;</a></span>tls_format_openssl_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tls_format_openssl_error </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>context</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Format OpenSSL error into the thread-local error buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">context</td><td>Context string for the error message.</td></tr>
  </table>
  </dd>
</dl>
<p>Formats the current OpenSSL error queue into tls_error_buf prefixed with the given context. Clears the error queue after formatting to prevent interference with subsequent operations. Used internally for consistent error reporting in TLS functions.</p>
<dl class="section user"><dt>Thread Safety\n Yes - operates on thread-local error buffer.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga6e8705fd2d3c92c43e4b8105d38f3854" title="tls_handle_ssl_error - Map OpenSSL errors to TLSHandshakeState">tls_handle_ssl_error()</a> for SSL error state mapping. </dd>
<dd>
ERR_clear_error() OpenSSL error queue management. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00373">373</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketUtil_8h_source.html#l01311">SOCKET_ERROR_MSG</a>, and <a class="el" href="SocketTLSConfig_8h_source.html#l00526">SOCKET_TLS_OPENSSL_ERRSTR_BUFSIZE</a>.</p>

</div>
</div>
<a id="gab904e51ebbeabc985c3988fc0980776e" name="gab904e51ebbeabc985c3988fc0980776e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab904e51ebbeabc985c3988fc0980776e">&#9670;&#160;</a></span>tls_get_alpn_ex_idx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tls_get_alpn_ex_idx </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate file path for certificates, keys, or CAs against security threats. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">path</td><td>Null-terminated file path string to validate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if path passes all security checks, 0 otherwise.</dd></dl>
<p>Comprehensive validation to mitigate path traversal, symlink following, and injection attacks:</p><ul>
<li>Length limits and non-empty check</li>
<li>Blocks traversal patterns like "/../", "\\..\\", etc.</li>
<li>Rejects control characters and embedded nulls</li>
<li>Detects and rejects symlinks via lstat (if accessible)</li>
<li>Case-insensitive on Windows patterns if needed (platform-specific)</li>
</ul>
<p>Essential for secure loading of TLS credentials from potentially untrusted sources.</p>
<dl class="section user"><dt>Thread Safety\n Yes - pure string and stat operations, no shared state.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaebeabc646fbd6961894512930a822ca9" title="Validate SNI hostname against RFC-compliant format rules.">tls_validate_hostname()</a> for SNI name validation. </dd>
<dd>
<a class="el" href="group__security.html#gabf9cbcc9cfbd30df1d1252ccaf34b8d0" title="Securely free EVP_PKEY with key material zeroization.">tls_secure_free_pkey()</a> for secure key handling post-load. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>lstat failure (e.g., no permission) allows validation to proceed conservatively.</dd></dl>
<p>Get global ex_data index for ALPN temporary protocol buffers.</p>
<dl class="section return"><dt>Returns</dt><dd>Non-negative ex_data index for SSL/SSL_CTX ex_data storage.</dd></dl>
<p>Lazily initializes and returns the process-global SSL ex_data index used to store arena-allocated copies of ALPN protocol strings in callbacks. Thread-safe initialization using atomic operations or mutex. Prevents use-after-free by persisting short-lived protocol pointers.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga5521981e692a3cdd4176000e2282398f" title="Clean up temporary ALPN protocol buffer from SSL ex_data.">tls_cleanup_alpn_temp()</a> for buffer cleanup on SSL free. </dd>
<dd>
SSL_set_ex_data() / SSL_get_ex_data() OpenSSL ex_data API. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - atomic initialization, read-only after init.</dt><dd></dd></dl>

</div>
</div>
<a id="ga6e8705fd2d3c92c43e4b8105d38f3854" name="ga6e8705fd2d3c92c43e4b8105d38f3854"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6e8705fd2d3c92c43e4b8105d38f3854">&#9670;&#160;</a></span>tls_handle_ssl_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> tls_handle_ssl_error </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SSL *&#160;</td>
          <td class="paramname"><em>ssl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ssl_result</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tls_handle_ssl_error - Map OpenSSL errors to TLSHandshakeState </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>Socket instance </td></tr>
    <tr><td class="paramname">ssl</td><td>SSL object </td></tr>
    <tr><td class="paramname">ssl_result</td><td>Result from SSL operation </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TLSHandshakeState based on error type</dd></dl>
<p>Maps OpenSSL error codes to TLS handshake states for event-driven I/O. Handles the complex mapping between OpenSSL's error model and the socket library's state machine. Critical for non-blocking TLS operations.</p>
<p>Error handling:</p><ul>
<li>SSL_ERROR_NONE: Complete - handshake finished successfully</li>
<li>SSL_ERROR_WANT_READ/WRITE: Non-blocking - need I/O, errno=EAGAIN</li>
<li>SSL_ERROR_SYSCALL: System error - errno preserved for diagnostics</li>
<li>SSL_ERROR_SSL: Protocol error - detailed in OpenSSL error queue</li>
<li>SSL_ERROR_ZERO_RETURN: Clean peer shutdown</li>
</ul>
<dl class="section user"><dt>Thread Safety\n Yes - operates on per-connection SSL state</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00307">307</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketTLS_8h_source.html#l00551">TLS_HANDSHAKE_COMPLETE</a>, <a class="el" href="SocketTLS_8h_source.html#l00552">TLS_HANDSHAKE_ERROR</a>, <a class="el" href="SocketTLS_8h_source.html#l00549">TLS_HANDSHAKE_WANT_READ</a>, and <a class="el" href="SocketTLS_8h_source.html#l00550">TLS_HANDSHAKE_WANT_WRITE</a>.</p>

</div>
</div>
<a id="ga5757cbf91f1a33f9da5ceedd6e7c19a9" name="ga5757cbf91f1a33f9da5ceedd6e7c19a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5757cbf91f1a33f9da5ceedd6e7c19a9">&#9670;&#160;</a></span>tls_pinning_check_chain()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tls_pinning_check_chain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const STACK_OF(X509) *&#160;</td>
          <td class="paramname"><em>chain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Verify if any certificate in the chain matches a configured pin. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>TLS context with pinning configuration. </td></tr>
    <tr><td class="paramname">chain</td><td>STACK_OF(X509) certificate chain (leaf first). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if a matching pin is found, 0 if no match (or pinning disabled).</dd></dl>
<p>Iterates through the certificate chain, extracts SPKI hashes for each cert, and checks against configured pins using constant-time comparison. Logs warnings or errors based on enforce mode; may raise exceptions in strict mode.</p>
<p>Called during TLS verification callback to enforce pinning policy.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga828d1176538dad4796620257b2e9a4cb" title="Compute SPKI SHA256 hash from X509 certificate for pinning verification.">tls_pinning_extract_spki_hash()</a> for hash extraction. </dd>
<dd>
<a class="el" href="group__security.html#ga5de766a20624317123f664a08d5ca13d" title="Perform constant-time search for a hash in pinning array.">tls_pinning_find()</a> for pin matching logic. </dd>
<dd>
<a class="el" href="group__security.html#ga34caeef50e78017625d2eb62142a7e45" title="Add SPKI SHA256 pin (binary format).">SocketTLSContext_add_pin()</a> for configuring pins. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - locks pinning mutex internally.</dt><dd></dd></dl>

</div>
</div>
<a id="ga828d1176538dad4796620257b2e9a4cb" name="ga828d1176538dad4796620257b2e9a4cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga828d1176538dad4796620257b2e9a4cb">&#9670;&#160;</a></span>tls_pinning_extract_spki_hash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tls_pinning_extract_spki_hash </td>
          <td>(</td>
          <td class="paramtype">const X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out_hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute SPKI SHA256 hash from X509 certificate for pinning verification. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cert</td><td>Input X509 certificate object. </td></tr>
    <tr><td class="paramname">out_hash</td><td>Output buffer for the 32-byte SHA256 hash (must be at least SOCKET_TLS_PIN_HASH_LEN). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, -1 on failure (e.g., invalid certificate or DER extraction error).</dd></dl>
<p>Extracts the SubjectPublicKeyInfo (SPKI) DER from the certificate and computes its SHA256 digest. This method is recommended by OWASP for certificate pinning as it targets the public key material, surviving certificate renewals with the same key.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga5757cbf91f1a33f9da5ceedd6e7c19a9" title="Verify if any certificate in the chain matches a configured pin.">tls_pinning_check_chain()</a> for verifying chain against pins. </dd>
<dd>
<a class="el" href="group__security.html#ga5de766a20624317123f664a08d5ca13d" title="Perform constant-time search for a hash in pinning array.">tls_pinning_find()</a> for constant-time hash matching. </dd>
<dd>
RFC 7469 Certificate Transparency and Public Key Pinning Extension. </dd></dl>
<dl class="section user"><dt>Thread Safety\n Yes - pure computation on input objects.</dt><dd></dd></dl>

</div>
</div>
<a id="ga5de766a20624317123f664a08d5ca13d" name="ga5de766a20624317123f664a08d5ca13d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5de766a20624317123f664a08d5ca13d">&#9670;&#160;</a></span>tls_pinning_find()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tls_pinning_find </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="group__security.html#structTLSCertPin">TLSCertPin</a> *&#160;</td>
          <td class="paramname"><em>pins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>hash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Perform constant-time search for a hash in pinning array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pins</td><td>Array of <a class="el" href="group__security.html#structTLSCertPin" title="TLSCertPin - Single certificate pin entry (SPKI SHA256 hash)">TLSCertPin</a> structures. </td></tr>
    <tr><td class="paramname">count</td><td>Number of pins in the array. </td></tr>
    <tr><td class="paramname">hash</td><td>32-byte SHA256 hash to search for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if exact match found, 0 otherwise.</dd></dl>
<p>Scans the entire pin array using SocketCrypto_secure_compare for each entry to prevent timing side-channel attacks. Accumulates comparison results in constant time regardless of position.</p>
<p>Critical for secure certificate pinning verification.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html#gae5f9b65e71620529159130c81b6d0dba" title="Perform constant-time comparison of two buffers.">SocketCrypto_secure_compare()</a> for constant-time memcmp. </dd>
<dd>
<a class="el" href="group__security.html#ga828d1176538dad4796620257b2e9a4cb" title="Compute SPKI SHA256 hash from X509 certificate for pinning verification.">tls_pinning_extract_spki_hash()</a> for generating search hashes. </dd></dl>
<dl class="section user"><dt>Thread Safety\n No - caller must hold pinning lock.</dt><dd></dd></dl>

</div>
</div>
<a id="ga726c939b0e3e55893537751d2ea87dd8" name="ga726c939b0e3e55893537751d2ea87dd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga726c939b0e3e55893537751d2ea87dd8">&#9670;&#160;</a></span>tls_pinning_init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tls_pinning_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structTLSContextPinning">TLSContextPinning</a> *&#160;</td>
          <td class="paramname"><em>pinning</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Initialize TLS certificate pinning configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pinning</td><td>Pointer to <a class="el" href="group__security.html#structTLSContextPinning" title="TLSContextPinning - Certificate pinning configuration.">TLSContextPinning</a> structure</td></tr>
  </table>
  </dd>
</dl>
<p>Sets up the pinning array and mutex for thread-safe operation. Must be called before adding pins or using the pinning config.</p>
<dl class="section see"><dt>See also</dt><dd>tls_pinning_add() to add pins after initialization </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l01101">1101</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketTLS-private_8h_source.html#l00665">TLSContextPinning::capacity</a>, <a class="el" href="SocketTLS-private_8h_source.html#l00664">TLSContextPinning::count</a>, <a class="el" href="SocketTLS-private_8h_source.html#l00666">TLSContextPinning::enforce</a>, <a class="el" href="SocketTLS-private_8h_source.html#l00668">TLSContextPinning::lock</a>, and <a class="el" href="SocketTLS-private_8h_source.html#l00663">TLSContextPinning::pins</a>.</p>

</div>
</div>
<a id="gabf9cbcc9cfbd30df1d1252ccaf34b8d0" name="gabf9cbcc9cfbd30df1d1252ccaf34b8d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabf9cbcc9cfbd30df1d1252ccaf34b8d0">&#9670;&#160;</a></span>tls_secure_free_pkey()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void tls_secure_free_pkey </td>
          <td>(</td>
          <td class="paramtype">EVP_PKEY *&#160;</td>
          <td class="paramname"><em>pkey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Securely free EVP_PKEY with key material zeroization. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkey</td><td>EVP_PKEY private key to free (safe for NULL).</td></tr>
  </table>
  </dd>
</dl>
<p>Exports the private key to DER, securely wipes the key bytes using SocketCrypto_secure_clear, then frees both DER buffer and EVP_PKEY. Mitigates forensic recovery of keys from memory post-free.</p>
<p>Best-effort: succeeds even if export fails; always calls EVP_PKEY_free. OpenSSL may leave some metadata, but sensitive key bytes are overwritten.</p>
<dl class="section user"><dt>Thread Safety\n Conditional - safe if no concurrent use of pkey.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html#ga00f94677d393f24e0b0c549be7bbcdf2" title="Securely clear sensitive data from memory.">SocketCrypto_secure_clear()</a> constant-time memory wipe. </dd>
<dd>
i2d_PrivateKey() OpenSSL DER export. </dd>
<dd>
<a class="el" href="group__security.html#gabf9cbcc9cfbd30df1d1252ccaf34b8d0" title="Securely free EVP_PKEY with key material zeroization.">tls_secure_free_pkey</a> in context cleanup for usage. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00542">542</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="group__foundation.html#ga00f94677d393f24e0b0c549be7bbcdf2">SocketCrypto_secure_clear()</a>.</p>

</div>
</div>
<a id="gac08c4201eb8ac29014cead5bf4a17adb" name="gac08c4201eb8ac29014cead5bf4a17adb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac08c4201eb8ac29014cead5bf4a17adb">&#9670;&#160;</a></span>tls_socket_get_ssl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static SSL * tls_socket_get_ssl </td>
          <td>(</td>
          <td class="paramtype">Socket_T&#160;</td>
          <td class="paramname"><em>socket</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>tls_socket_get_ssl - Get SSL* from socket </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">socket</td><td>Socket instance </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SSL* pointer or NULL if TLS not enabled/available</dd></dl>
<p>Safely extracts the SSL object from a TLS-enabled socket. Performs null checks and TLS enablement validation before returning the SSL pointer. Returns NULL if socket is invalid, TLS is not enabled, or SSL object is not available.</p>
<dl class="section user"><dt>Thread Safety\n Yes - read-only operation on socket state</dt><dd></dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00273">273</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

</div>
</div>
<a id="gaebeabc646fbd6961894512930a822ca9" name="gaebeabc646fbd6961894512930a822ca9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaebeabc646fbd6961894512930a822ca9">&#9670;&#160;</a></span>tls_validate_hostname()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int tls_validate_hostname </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>hostname</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Validate SNI hostname against RFC-compliant format rules. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hostname</td><td>Null-terminated hostname string for SNI. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if valid SNI hostname, 0 if invalid or malformed.</dd></dl>
<p>Enforces RFC 952/1123/1035/6066 rules for domain labels:</p><ul>
<li>Alphanumeric + hyphen only, no starting/ending hyphen per label</li>
<li>Label length 1-63 chars, total &lt;=255 chars for SNI</li>
<li>No empty labels, proper dot separation</li>
<li>Basic IDN support via punycode assumption (caller normalizes)</li>
</ul>
<p>Prevents invalid SNI attacks like label injection or buffer overflows in virtual servers.</p>
<dl class="section user"><dt>Thread Safety\n Yes - pure string parsing, no side effects.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd>RFC 6066 for TLS SNI extension details. </dd>
<dd>
RFC 1123 for domain name syntax updates. </dd>
<dd>
<a class="el" href="SocketTLS-private_8h.html#a7c1796c12a4cab58c4bc3eba891efc59">tls_validate_file_path()</a> companion for file path <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a>. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Does not perform DNS resolution or existence check. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketTLS-private_8h_source.html#l00581">581</a> of file <a class="el" href="SocketTLS-private_8h_source.html">SocketTLS-private.h</a>.</p>

<p class="reference">References <a class="el" href="SocketTLSConfig_8h_source.html#l00489">SOCKET_TLS_MAX_SNI_LEN</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ga1189362a5c97fc90222e06232de1bdfe" name="ga1189362a5c97fc90222e06232de1bdfe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1189362a5c97fc90222e06232de1bdfe">&#9670;&#160;</a></span>dtls_ctx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_ctx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Opaque pointer to the DTLS context object. References an instance of <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> or underlying TLS library context (e.g., SSL_CTX *). Manages global security parameters: certificates, private keys, cipher suites, and protocol versions for the connection. Created during DTLS enablement and used to initialize per-connection SSL objects.</p>
<p>Opaque pointer to the DTLS context object. References an instance of <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> or underlying TLS library context (e.g., SSL_CTX *). Manages global security parameters: certificates, private keys, cipher suites, and protocol versions for the connection. Created during DTLS enablement and used to initialize per-connection SSL objects.</p>
<p>DTLS-specific fields for secure datagram encryption.</p>
<p>These fields are included only when SOCKET_HAS_TLS is enabled at compile time. They provide Datagram TLS (DTLS) support, allowing TLS-secured UDP communications. Key differences from stream TLS: handles packet loss/reordering, MTU fragmentation, and uses memory BIOs for event-loop integration.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html">Security group</a> for TLS/DTLS modules. </dd>
<dd>
<a class="el" href="SocketDTLS_8h.html" title="Core DTLS API for secure UDP sockets.">SocketDTLS.h</a> for public DTLS API. </dd>
<dd>
<a class="el" href="SocketDTLSConfig_8h.html" title="DTLS configuration constants and secure defaults.">SocketDTLSConfig.h</a> for configuration options.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> for public type. </dd>
<dd>
<a class="el" href="SocketDTLSConfig_8h.html" title="DTLS configuration constants and secure defaults.">SocketDTLSConfig.h</a> for configuration options. </dd>
<dd>
<a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for per-connection session object.  </dd></dl>
<p>DTLS-specific fields for secure datagram encryption.</p>
<p>These fields are included only when SOCKET_HAS_TLS is enabled at compile time. They provide Datagram TLS (DTLS) support, allowing TLS-secured UDP communications. Key differences from stream TLS: handles packet loss/reordering, MTU fragmentation, and uses memory BIOs for event-loop integration.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html">Security group</a> for TLS/DTLS modules. </dd>
<dd>
<a class="el" href="SocketDTLS_8h.html" title="Core DTLS API for secure UDP sockets.">SocketDTLS.h</a> for public DTLS API. </dd>
<dd>
<a class="el" href="SocketDTLSConfig_8h.html" title="DTLS configuration constants and secure defaults.">SocketDTLSConfig.h</a> for configuration options.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> for public type. </dd>
<dd>
<a class="el" href="SocketDTLSConfig_8h.html" title="DTLS configuration constants and secure defaults.">SocketDTLSConfig.h</a> for configuration options. </dd>
<dd>
<a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for per-connection session object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00076">76</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga8b5dc596873a18adc6003b2595394223" name="ga8b5dc596873a18adc6003b2595394223"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b5dc596873a18adc6003b2595394223">&#9670;&#160;</a></span>dtls_enabled</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_enabled</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Flag indicating if DTLS is enabled on this datagram socket. Set to 1 when DTLS context and SSL object are initialized and active, 0 otherwise. Controls whether DTLS encryption/decryption is applied to I/O operations.</p>
<p>Flag indicating if DTLS is enabled on this datagram socket. Set to 1 when DTLS context and SSL object are initialized and active, 0 otherwise. Controls whether DTLS encryption/decryption is applied to I/O operations.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> or equivalent initialization function. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> and <a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for enabled components.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> or equivalent initialization function. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> and <a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for enabled components. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00102">102</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="SocketDTLS-private_8h_source.html#l00559">dtls_socket_get_ssl()</a>.</p>

</div>
</div>
<a id="ga5a3d07842374d449a9fa61fab416edc8" name="ga5a3d07842374d449a9fa61fab416edc8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5a3d07842374d449a9fa61fab416edc8">&#9670;&#160;</a></span>dtls_handshake_done</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_handshake_done</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Flag indicating whether the DTLS handshake has completed successfully. Set to 1 upon successful completion of the DTLS handshake process, 0 otherwise. This flag is used internally to determine if encrypted data transfer can begin.</p>
<p>Flag indicating whether the DTLS handshake has completed successfully. Set to 1 upon successful completion of the DTLS handshake process, 0 otherwise. This flag is used internally to determine if encrypted data transfer can begin.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for the SSL object used in handshake. </dd>
<dd>
<a class="el" href="SocketDTLS_8h.html" title="Core DTLS API for secure UDP sockets.">SocketDTLS.h</a> for public DTLS handshake functions.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for the SSL object used in handshake. </dd>
<dd>
<a class="el" href="SocketDTLS_8h.html" title="Core DTLS API for secure UDP sockets.">SocketDTLS.h</a> for public DTLS handshake functions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00114">114</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="SocketDTLS-private_8h_source.html#l00663">dtls_handle_ssl_error()</a>.</p>

</div>
</div>
<a id="ga3b8a6cfd63b8f12340dec5f778111c90" name="ga3b8a6cfd63b8f12340dec5f778111c90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3b8a6cfd63b8f12340dec5f778111c90">&#9670;&#160;</a></span>dtls_last_handshake_state</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_last_handshake_state</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Records the last DTLS handshake state from the TLS library. Stores the result of the most recent DTLS handshake operation (e.g., DTLS_HANDSHAKE_WANT_READ). Used for resuming or error recovery in non-blocking handshake loops.</p>
<p>Records the last DTLS handshake state from the TLS library. Stores the result of the most recent DTLS handshake operation (e.g., DTLS_HANDSHAKE_WANT_READ). Used for resuming or error recovery in non-blocking handshake loops.</p>
<dl class="section see"><dt>See also</dt><dd>SocketDTLSHandshakeState for possible values. </dd>
<dd>
<a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for the SSL context providing this state.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd>SocketDTLSHandshakeState for possible values. </dd>
<dd>
<a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for the SSL context providing this state. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00138">138</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="gab4c14b4e6c07e5f1ff646987622a611a" name="gab4c14b4e6c07e5f1ff646987622a611a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4c14b4e6c07e5f1ff646987622a611a">&#9670;&#160;</a></span>dtls_mtu</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_mtu</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Configured Maximum Transmission Unit (MTU) for DTLS packets. Specifies the maximum size of DTLS records to avoid IP fragmentation. Typically set to path MTU minus DTLS overhead (e.g., 1200-1400 bytes).</p>
<p>Configured Maximum Transmission Unit (MTU) for DTLS packets. Specifies the maximum size of DTLS records to avoid IP fragmentation. Typically set to path MTU minus DTLS overhead (e.g., 1200-1400 bytes).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga804d5dd4b27255e3c9c28c58a2914a18" title="Set per-connection MTU for DTLS record sizing.">SocketDTLS_set_mtu()</a> if public API exists, or configuration functions. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> for context where MTU is applied.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga804d5dd4b27255e3c9c28c58a2914a18" title="Set per-connection MTU for DTLS record sizing.">SocketDTLS_set_mtu()</a> if public API exists, or configuration functions. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> for context where MTU is applied. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00150">150</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga40b959d65731e8a1462d8e6ef01d4a75" name="ga40b959d65731e8a1462d8e6ef01d4a75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga40b959d65731e8a1462d8e6ef01d4a75">&#9670;&#160;</a></span>dtls_peer_cache_ts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_peer_cache_ts</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Monotonic timestamp when peer resolution cache was populated. Used to enforce 30-second TTL for cache validity; cache invalidated if current time exceeds this + 30s. Relies on <a class="el" href="group__foundation.html#ga264bfa9d1cf07aa22446a4df6c4936bf" title="Socket_get_monotonic_ms - Get current monotonic time in milliseconds.">Socket_get_monotonic_ms()</a> for consistent timing across system clock changes.</p>
<p>Monotonic timestamp when peer resolution cache was populated. Used to enforce 30-second TTL for cache validity; cache invalidated if current time exceeds this + 30s. Relies on <a class="el" href="group__foundation.html#ga264bfa9d1cf07aa22446a4df6c4936bf" title="Socket_get_monotonic_ms - Get current monotonic time in milliseconds.">Socket_get_monotonic_ms()</a> for consistent timing across system clock changes.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html#ga264bfa9d1cf07aa22446a4df6c4936bf" title="Socket_get_monotonic_ms - Get current monotonic time in milliseconds.">Socket_get_monotonic_ms()</a> for time source. </dd>
<dd>
<a class="el" href="group__security.html#ga62d63165a3c926aaf21241ac798e0fe3">dtls_peer_res</a> for cached data controlled by this timestamp.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html#ga264bfa9d1cf07aa22446a4df6c4936bf" title="Socket_get_monotonic_ms - Get current monotonic time in milliseconds.">Socket_get_monotonic_ms()</a> for time source. </dd>
<dd>
<a class="el" href="group__security.html#ga62d63165a3c926aaf21241ac798e0fe3">dtls_peer_res</a> for cached data controlled by this timestamp. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00222">222</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga0430ae66a05abe2f9a50e79656d05b84" name="ga0430ae66a05abe2f9a50e79656d05b84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0430ae66a05abe2f9a50e79656d05b84">&#9670;&#160;</a></span>dtls_peer_host</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_peer_host</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Cached peer hostname for efficient DTLS resolution. Arena-allocated string storing the last resolved hostname to avoid repeated DNS lookups. Part of the peer resolution cache with 30-second TTL.</p>
<p>Cached peer hostname for efficient DTLS resolution. Arena-allocated string storing the last resolved hostname to avoid repeated DNS lookups. Part of the peer resolution cache with 30-second TTL.</p>
<p>Cached peer resolution cache for efficient DTLS operations.</p>
<p>Optimizes repeated sendto/recvfrom to the same host/port by caching addrinfo results with a 30-second TTL (monotonic time-based). Invalidated on resolution failure, expiry, or explicit reset. Reduces DNS overhead in persistent DTLS sessions.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketDNS_8h.html" title="Asynchronous DNS resolution API for non-blocking network applications.">SocketDNS.h</a> for asynchronous DNS resolution used in population.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga40b959d65731e8a1462d8e6ef01d4a75">dtls_peer_cache_ts</a> for cache timestamp. </dd>
<dd>
<a class="el" href="SocketDNS_8h.html" title="Asynchronous DNS resolution API for non-blocking network applications.">SocketDNS.h</a> for DNS resolution used to populate this cache.  </dd></dl>
<p>Cached peer resolution cache for efficient DTLS operations.</p>
<p>Optimizes repeated sendto/recvfrom to the same host/port by caching addrinfo results with a 30-second TTL (monotonic time-based). Invalidated on resolution failure, expiry, or explicit reset. Reduces DNS overhead in persistent DTLS sessions.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketDNS_8h.html" title="Asynchronous DNS resolution API for non-blocking network applications.">SocketDNS.h</a> for asynchronous DNS resolution used in population.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga40b959d65731e8a1462d8e6ef01d4a75">dtls_peer_cache_ts</a> for cache timestamp. </dd>
<dd>
<a class="el" href="SocketDNS_8h.html" title="Asynchronous DNS resolution API for non-blocking network applications.">SocketDNS.h</a> for DNS resolution used to populate this cache. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00186">186</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga560ea9583d1317b5992f825e4f9367e2" name="ga560ea9583d1317b5992f825e4f9367e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga560ea9583d1317b5992f825e4f9367e2">&#9670;&#160;</a></span>dtls_peer_port</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_peer_port</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Cached peer port number for the DTLS connection. Stores the port associated with the cached hostname and resolution for quick access. Updated during cache population from resolution results.</p>
<p>Cached peer port number for the DTLS connection. Stores the port associated with the cached hostname and resolution for quick access. Updated during cache population from resolution results.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga0430ae66a05abe2f9a50e79656d05b84">dtls_peer_host</a> for associated hostname. </dd>
<dd>
<a class="el" href="group__security.html#ga62d63165a3c926aaf21241ac798e0fe3">dtls_peer_res</a> for resolved addresses.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga0430ae66a05abe2f9a50e79656d05b84">dtls_peer_host</a> for associated hostname. </dd>
<dd>
<a class="el" href="group__security.html#ga62d63165a3c926aaf21241ac798e0fe3">dtls_peer_res</a> for resolved addresses. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00197">197</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga62d63165a3c926aaf21241ac798e0fe3" name="ga62d63165a3c926aaf21241ac798e0fe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga62d63165a3c926aaf21241ac798e0fe3">&#9670;&#160;</a></span>dtls_peer_res</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_peer_res</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Cached resolved address information for peer. Pointer to addrinfo structure from getaddrinfo, holding IP addresses and socket params. Freed with freeaddrinfo() upon cache invalidation or socket free. Enables efficient sendto/recvfrom without re-resolving host each time.</p>
<p>Cached resolved address information for peer. Pointer to addrinfo structure from getaddrinfo, holding IP addresses and socket params. Freed with freeaddrinfo() upon cache invalidation or socket free. Enables efficient sendto/recvfrom without re-resolving host each time.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga0430ae66a05abe2f9a50e79656d05b84">dtls_peer_host</a> and <a class="el" href="group__security.html#ga560ea9583d1317b5992f825e4f9367e2">dtls_peer_port</a> for cache keys. </dd>
<dd>
<a class="el" href="SocketDNS_8h.html" title="Asynchronous DNS resolution API for non-blocking network applications.">SocketDNS.h</a> for resolution source.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga0430ae66a05abe2f9a50e79656d05b84">dtls_peer_host</a> and <a class="el" href="group__security.html#ga560ea9583d1317b5992f825e4f9367e2">dtls_peer_port</a> for cache keys. </dd>
<dd>
<a class="el" href="SocketDNS_8h.html" title="Asynchronous DNS resolution API for non-blocking network applications.">SocketDNS.h</a> for resolution source. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00210">210</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="gac9279985541f6f5feae01827ec148bd5" name="gac9279985541f6f5feae01827ec148bd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac9279985541f6f5feae01827ec148bd5">&#9670;&#160;</a></span>dtls_rbio</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_rbio</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Read BIO for incoming encrypted DTLS data. Memory BIO buffering encrypted packets received from the socket before decryption by the DTLS layer. Integrates with non-blocking I/O via SocketPoll for read readiness.</p>
<p>Read BIO for incoming encrypted DTLS data. Memory BIO buffering encrypted packets received from the socket before decryption by the DTLS layer. Integrates with non-blocking I/O via SocketPoll for read readiness.</p>
<p>Memory BIOs for non-blocking DTLS I/O buffering.</p>
<p>In DTLS, memory BIOs (Basic Input/Output) are used to handle encrypted data independently of socket operations. This allows non-blocking handshake and data transfer by buffering partial records and integrating with SocketPoll for read/write readiness checks.</p>
<ul>
<li>dtls_rbio: Buffer for incoming encrypted data from socket before decryption.</li>
<li>dtls_wbio: Buffer for outgoing encrypted data to socket after encryption.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketPoll_8h.html" title="Cross-platform high-level interface for monitoring multiple sockets for I/O events.">SocketPoll.h</a> for event-driven I/O multiplexing. </dd>
<dd>
BIO(3) man page or TLS library docs for BIO usage.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>BIO(3) for OpenSSL BIO documentation. </dd>
<dd>
<a class="el" href="SocketPoll_8h.html" title="Cross-platform high-level interface for monitoring multiple sockets for I/O events.">SocketPoll.h</a> for event integration. </dd>
<dd>
<a class="el" href="group__security.html#ga36e474764992051d21d2f5bbc2fcf4b2">dtls_wbio</a> for write counterpart.  </dd></dl>
<p>Memory BIOs for non-blocking DTLS I/O buffering.</p>
<p>In DTLS, memory BIOs (Basic Input/Output) are used to handle encrypted data independently of socket operations. This allows non-blocking handshake and data transfer by buffering partial records and integrating with SocketPoll for read/write readiness checks.</p>
<ul>
<li>dtls_rbio: Buffer for incoming encrypted data from socket before decryption.</li>
<li>dtls_wbio: Buffer for outgoing encrypted data to socket after encryption.</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketPoll_8h.html" title="Cross-platform high-level interface for monitoring multiple sockets for I/O events.">SocketPoll.h</a> for event-driven I/O multiplexing. </dd>
<dd>
BIO(3) man page or TLS library docs for BIO usage.</dd></dl>
<dl class="section see"><dt>See also</dt><dd>BIO(3) for OpenSSL BIO documentation. </dd>
<dd>
<a class="el" href="SocketPoll_8h.html" title="Cross-platform high-level interface for monitoring multiple sockets for I/O events.">SocketPoll.h</a> for event integration. </dd>
<dd>
<a class="el" href="group__security.html#ga36e474764992051d21d2f5bbc2fcf4b2">dtls_wbio</a> for write counterpart. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00253">253</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga627026386fc506cec37e59271659a1cb" name="ga627026386fc506cec37e59271659a1cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga627026386fc506cec37e59271659a1cb">&#9670;&#160;</a></span>dtls_read_buf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_read_buf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Buffer for decrypted application data received via DTLS. Arena-allocated raw buffer holding plaintext data after DTLS decryption. Facilitates zero-copy processing in non-blocking recv operations.</p>
<p>Buffer for decrypted application data received via DTLS. Arena-allocated raw buffer holding plaintext data after DTLS decryption. Facilitates zero-copy processing in non-blocking recv operations.</p>
<p>Buffers for DTLS application data handling.</p>
<p>Dedicated buffers for decrypted read data and encrypted write data at the DTLS record layer. These facilitate zero-copy or minimal-copy processing in non-blocking environments, with lengths tracking current usage.</p>
<dl class="section note"><dt>Note</dt><dd>Buffers are securely cleared on free to prevent data leakage. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketBuf_8h.html" title="Circular buffer for efficient socket I/O operations.">SocketBuf.h</a> for general buffer management patterns (though these are raw).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gae8075af8c029579e8f939ac57d7a5699">dtls_read_buf_len</a> for current content length. </dd>
<dd>
<a class="el" href="group__core__io.html#gaf0f12ab9bbed33398141c41561c1fcb7" title="Securely erase all data by zeroing memory contents.">SocketBuf_secureclear()</a> pattern for sensitive data handling (though raw buffer).  </dd></dl>
<p>Buffers for DTLS application data handling.</p>
<p>Dedicated buffers for decrypted read data and encrypted write data at the DTLS record layer. These facilitate zero-copy or minimal-copy processing in non-blocking environments, with lengths tracking current usage.</p>
<dl class="section note"><dt>Note</dt><dd>Buffers are securely cleared on free to prevent data leakage. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketBuf_8h.html" title="Circular buffer for efficient socket I/O operations.">SocketBuf.h</a> for general buffer management patterns (though these are raw).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gae8075af8c029579e8f939ac57d7a5699">dtls_read_buf_len</a> for current content length. </dd>
<dd>
<a class="el" href="group__core__io.html#gaf0f12ab9bbed33398141c41561c1fcb7" title="Securely erase all data by zeroing memory contents.">SocketBuf_secureclear()</a> pattern for sensitive data handling (though raw buffer). </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00291">291</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="gae8075af8c029579e8f939ac57d7a5699" name="gae8075af8c029579e8f939ac57d7a5699"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae8075af8c029579e8f939ac57d7a5699">&#9670;&#160;</a></span>dtls_read_buf_len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_read_buf_len</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Length of valid decrypted data in the read buffer. Tracks the number of bytes currently available in dtls_read_buf after decryption. Updated after successful recv/decrypt operations; used for data availability checks.</p>
<p>Length of valid decrypted data in the read buffer. Tracks the number of bytes currently available in dtls_read_buf after decryption. Updated after successful recv/decrypt operations; used for data availability checks.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga627026386fc506cec37e59271659a1cb">dtls_read_buf</a> for the buffer data. </dd>
<dd>
<a class="el" href="group__security.html#gacb96f6937a0f3c07e23f5073629f6bb4">dtls_write_buf_len</a> for write counterpart.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga627026386fc506cec37e59271659a1cb">dtls_read_buf</a> for the buffer data. </dd>
<dd>
<a class="el" href="group__security.html#gacb96f6937a0f3c07e23f5073629f6bb4">dtls_write_buf_len</a> for write counterpart. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00316">316</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga701871c2fa48e90c055fc70524d65b04" name="ga701871c2fa48e90c055fc70524d65b04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga701871c2fa48e90c055fc70524d65b04">&#9670;&#160;</a></span>dtls_shutdown_done</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_shutdown_done</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Flag indicating whether the DTLS shutdown process has completed. Set to 1 after successful DTLS shutdown handshake or close_notify alert exchange, 0 otherwise. Used to track connection closure state for resource cleanup.</p>
<p>Flag indicating whether the DTLS shutdown process has completed. Set to 1 after successful DTLS shutdown handshake or close_notify alert exchange, 0 otherwise. Used to track connection closure state for resource cleanup.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab42fd91bb31edaf15149d75920446a0a" title="Initiate graceful DTLS connection shutdown.">SocketDTLS_shutdown()</a> for initiating shutdown. </dd>
<dd>
<a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for the SSL object involved in shutdown.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab42fd91bb31edaf15149d75920446a0a" title="Initiate graceful DTLS connection shutdown.">SocketDTLS_shutdown()</a> for initiating shutdown. </dd>
<dd>
<a class="el" href="group__security.html#ga539711122c1eb94e27ac1d1f98581e4f">dtls_ssl</a> for the SSL object involved in shutdown. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00126">126</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga4fdda17cd54e1f2365c69210a28b7c7c" name="ga4fdda17cd54e1f2365c69210a28b7c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fdda17cd54e1f2365c69210a28b7c7c">&#9670;&#160;</a></span>dtls_sni_hostname</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_sni_hostname</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Server Name Indication (SNI) hostname string for DTLS. Arena-allocated string used during TLS handshake to indicate the target server name. Allows virtual hosting on the server side; required for SNI extension in TLS.</p>
<p>Server Name Indication (SNI) hostname string for DTLS. Arena-allocated string used during TLS handshake to indicate the target server name. Allows virtual hosting on the server side; required for SNI extension in TLS.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3" title="Set SNI hostname for client DTLS connections.">SocketDTLS_set_hostname()</a> or equivalent for setting. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> for context configuration.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3" title="Set SNI hostname for client DTLS connections.">SocketDTLS_set_hostname()</a> or equivalent for setting. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> for context configuration. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00162">162</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga539711122c1eb94e27ac1d1f98581e4f" name="ga539711122c1eb94e27ac1d1f98581e4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga539711122c1eb94e27ac1d1f98581e4f">&#9670;&#160;</a></span>dtls_ssl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_ssl</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Opaque pointer to the per-connection DTLS SSL session object. Instance of underlying TLS library's SSL structure (e.g., OpenSSL SSL *) handling the specific DTLS session. Manages handshake state, record encryption/decryption, certificate verification, and session keys. Created from dtls_ctx during connection setup.</p>
<p>Opaque pointer to the per-connection DTLS SSL session object. Instance of underlying TLS library's SSL structure (e.g., OpenSSL SSL *) handling the specific DTLS session. Manages handshake state, record encryption/decryption, certificate verification, and session keys. Created from dtls_ctx during connection setup.</p>
<dl class="section see"><dt>See also</dt><dd>SSL(3) or equivalent TLS library docs for details. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> for the parent context. </dd>
<dd>
<a class="el" href="group__security.html#ga5a3d07842374d449a9fa61fab416edc8">dtls_handshake_done</a> for handshake status.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd>SSL(3) or equivalent TLS library docs for details. </dd>
<dd>
<a class="el" href="group__security.html#ga1189362a5c97fc90222e06232de1bdfe">dtls_ctx</a> for the parent context. </dd>
<dd>
<a class="el" href="group__security.html#ga5a3d07842374d449a9fa61fab416edc8">dtls_handshake_done</a> for handshake status. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00090">90</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="SocketDTLS-private_8h_source.html#l00559">dtls_socket_get_ssl()</a>.</p>

</div>
</div>
<a id="ga36e474764992051d21d2f5bbc2fcf4b2" name="ga36e474764992051d21d2f5bbc2fcf4b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga36e474764992051d21d2f5bbc2fcf4b2">&#9670;&#160;</a></span>dtls_wbio</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_wbio</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Write BIO for outgoing encrypted DTLS data. Memory BIO buffering encrypted packets generated by the DTLS layer before transmission over the socket. Supports non-blocking write operations with flow control and partial writes.</p>
<p>Write BIO for outgoing encrypted DTLS data. Memory BIO buffering encrypted packets generated by the DTLS layer before transmission over the socket. Supports non-blocking write operations with flow control and partial writes.</p>
<dl class="section see"><dt>See also</dt><dd>BIO(3) for OpenSSL BIO documentation. </dd>
<dd>
<a class="el" href="SocketPoll_8h.html" title="Cross-platform high-level interface for monitoring multiple sockets for I/O events.">SocketPoll.h</a> for event-driven write readiness. </dd>
<dd>
<a class="el" href="group__security.html#gac9279985541f6f5feae01827ec148bd5">dtls_rbio</a> for read counterpart.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd>BIO(3) for OpenSSL BIO documentation. </dd>
<dd>
<a class="el" href="SocketPoll_8h.html" title="Cross-platform high-level interface for monitoring multiple sockets for I/O events.">SocketPoll.h</a> for event-driven write readiness. </dd>
<dd>
<a class="el" href="group__security.html#gac9279985541f6f5feae01827ec148bd5">dtls_rbio</a> for read counterpart. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00266">266</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="gabc75afb656bc9e46f3953b6fc0feb8c4" name="gabc75afb656bc9e46f3953b6fc0feb8c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabc75afb656bc9e46f3953b6fc0feb8c4">&#9670;&#160;</a></span>dtls_write_buf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_write_buf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Buffer holding encrypted data ready for transmission over DTLS. Arena-allocated storage for ciphertext generated by the DTLS encryption process. Used to buffer outgoing data post-encryption before socket send operations. Supports minimal-copy transmission in non-blocking scenarios.</p>
<p>Buffer holding encrypted data ready for transmission over DTLS. Arena-allocated storage for ciphertext generated by the DTLS encryption process. Used to buffer outgoing data post-encryption before socket send operations. Supports minimal-copy transmission in non-blocking scenarios.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gacb96f6937a0f3c07e23f5073629f6bb4">dtls_write_buf_len</a> for tracking filled length. </dd>
<dd>
<a class="el" href="SocketBuf_8h.html" title="Circular buffer for efficient socket I/O operations.">SocketBuf.h</a> for related buffer management concepts. </dd>
<dd>
<a class="el" href="group__security.html#ga36e474764992051d21d2f5bbc2fcf4b2">dtls_wbio</a> for the associated memory BIO.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gacb96f6937a0f3c07e23f5073629f6bb4">dtls_write_buf_len</a> for tracking filled length. </dd>
<dd>
<a class="el" href="SocketBuf_8h.html" title="Circular buffer for efficient socket I/O operations.">SocketBuf.h</a> for related buffer management concepts. </dd>
<dd>
<a class="el" href="group__security.html#ga36e474764992051d21d2f5bbc2fcf4b2">dtls_wbio</a> for the associated memory BIO. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00304">304</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="gacb96f6937a0f3c07e23f5073629f6bb4" name="gacb96f6937a0f3c07e23f5073629f6bb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacb96f6937a0f3c07e23f5073629f6bb4">&#9670;&#160;</a></span>dtls_write_buf_len</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SocketDgram_T::dtls_write_buf_len</td>
        </tr>
      </table>
</div><div class="memdoc">

<p></p>
<p>Length of valid encrypted data in the write buffer. Tracks bytes ready for transmission in dtls_write_buf post-encryption. Incremented after encrypt operations, decremented after successful sends.</p>
<p>Length of valid encrypted data in the write buffer. Tracks bytes ready for transmission in dtls_write_buf post-encryption. Incremented after encrypt operations, decremented after successful sends.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gabc75afb656bc9e46f3953b6fc0feb8c4">dtls_write_buf</a> for the buffer data. </dd>
<dd>
<a class="el" href="group__security.html#gae8075af8c029579e8f939ac57d7a5699">dtls_read_buf_len</a> for read counterpart.  </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gabc75afb656bc9e46f3953b6fc0feb8c4">dtls_write_buf</a> for the buffer data. </dd>
<dd>
<a class="el" href="group__security.html#gae8075af8c029579e8f939ac57d7a5699">dtls_read_buf_len</a> for read counterpart. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketDgram-private_8h_source.html#l00327">327</a> of file <a class="el" href="SocketDgram-private_8h_source.html">SocketDgram-private.h</a>.</p>

</div>
</div>
<a id="ga69b6e30fa30bd7fe0a621d807796d73f" name="ga69b6e30fa30bd7fe0a621d807796d73f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga69b6e30fa30bd7fe0a621d807796d73f">&#9670;&#160;</a></span>SocketDTLS_CookieFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketDTLS_CookieFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Cookie exchange failure. </p>
<p>Raised during server-side cookie verification or generation errors in DoS protection mode.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b" title="Configure the HMAC secret key for DTLS cookie generation.">SocketDTLSContext_set_cookie_secret()</a> </dd></dl>

</div>
</div>
<a id="ga083605c4d8e6ea5658b72883f8e41be9" name="ga083605c4d8e6ea5658b72883f8e41be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga083605c4d8e6ea5658b72883f8e41be9">&#9670;&#160;</a></span>SocketDTLS_Failed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketDTLS_Failed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>General DTLS operation failure. </p>
<p>Raised for generic errors in DTLS operations, such as invalid state or SSL library failures not covered by specific exceptions.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketUtil_8h.html#aad11dd8cef83792df92437f8d7ae3991">socket_error_buf</a> in <a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> for detailed error message (thread-local). </dd></dl>

</div>
</div>
<a id="gadffbcee0cdd3e2ea80a6a03a73755085" name="gadffbcee0cdd3e2ea80a6a03a73755085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadffbcee0cdd3e2ea80a6a03a73755085">&#9670;&#160;</a></span>SocketDTLS_HandshakeFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketDTLS_HandshakeFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DTLS handshake failure. </p>
<p>Occurs during DTLS handshake due to protocol errors, incompatible versions, or peer rejection.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c" title="Perform one step of the non-blocking DTLS handshake.">SocketDTLS_handshake()</a> </dd>
<dd>
<a class="el" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755" title="Blocking DTLS handshake with configurable timeout.">SocketDTLS_handshake_loop()</a> </dd>
<dd>
<a class="el" href="group__dtls__context.html#gad674b683e396a1af639691d9a18c6aa0" title="Set minimum supported DTLS version.">SocketDTLSContext_set_min_protocol()</a> </dd></dl>

</div>
</div>
<a id="ga28d15a7e6fc136b5d542236ef27f0be6" name="ga28d15a7e6fc136b5d542236ef27f0be6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga28d15a7e6fc136b5d542236ef27f0be6">&#9670;&#160;</a></span>SocketDTLS_ShutdownFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketDTLS_ShutdownFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>DTLS shutdown failure. </p>
<p>Error during graceful shutdown (close_notify alert transmission or reception).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab42fd91bb31edaf15149d75920446a0a" title="Initiate graceful DTLS connection shutdown.">SocketDTLS_shutdown()</a> </dd></dl>

</div>
</div>
<a id="ga9a2543bc8c6671e774391f4861d4fa5d" name="ga9a2543bc8c6671e774391f4861d4fa5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a2543bc8c6671e774391f4861d4fa5d">&#9670;&#160;</a></span>SocketDTLS_TimeoutExpired</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketDTLS_TimeoutExpired</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handshake timeout expired. </p>
<p>Thrown when handshake_loop() exceeds the specified timeout without completing.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755" title="Blocking DTLS handshake with configurable timeout.">SocketDTLS_handshake_loop()</a> </dd></dl>

</div>
</div>
<a id="gaf1324e42b633182c01b0157ebfba0e9e" name="gaf1324e42b633182c01b0157ebfba0e9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf1324e42b633182c01b0157ebfba0e9e">&#9670;&#160;</a></span>SocketDTLS_VerifyFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketDTLS_VerifyFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Certificate verification failure. </p>
<p>Triggered when peer certificate fails validation (e.g., untrusted CA, expired, hostname mismatch).</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga167f13bc2d88dd59da040a6423cbb741" title="Set certificate verification policy.">SocketDTLSContext_set_verify_mode()</a> </dd>
<dd>
<a class="el" href="group__security.html#gad0e45780e041b9ddb58956d9f0fb20d1" title="Get peer certificate verification result.">SocketDTLS_get_verify_result()</a> </dd>
<dd>
<a class="el" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3" title="Set SNI hostname for client DTLS connections.">SocketDTLS_set_hostname()</a> </dd></dl>

</div>
</div>
<a id="ga4692098ecf52e6929c8763f0fa9fe222" name="ga4692098ecf52e6929c8763f0fa9fe222"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4692098ecf52e6929c8763f0fa9fe222">&#9670;&#160;</a></span>SocketIPTracker_Failed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketIPTracker_Failed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Base exception for IP tracker module failures. </p>
<p>Raised when operations fail due to allocation errors, mutex issues, or internal state corruption. Specific causes logged via SocketLog.</p>
<h2><a class="anchor" id="autotoc_md79"></a>
Common Causes</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Scenario   </th><th class="markdownTableHeadNone">Details    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Alloc Fail   </td><td class="markdownTableBodyNone">Arena or malloc failure for buckets/entries    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Mutex Fail   </td><td class="markdownTableBodyNone">pthread_mutex_init/destroy error    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Config Error   </td><td class="markdownTableBodyNone">Overflow in bucket calculation   </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>Use TRY/EXCEPT(SocketIPTracker_Failed) around new() and critical ops. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="Except_8h.html" title="Structured exception handling for C with TRY/EXCEPT/FINALLY blocks.">Except.h</a> For exception handling macros (<a class="el" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0" title="Start a TRY/EXCEPT/FINALLY exception handling block.">TRY</a>, <a class="el" href="group__foundation.html#ga45e87c4d7dee50346b15c7761b0b340a" title="Raise an exception with current file and line information.">RAISE</a>, etc.) </dd>
<dd>
<a class="el" href="group__security.html#gab87cad57ddf1ed19226cf8535456bbde" title="Create and initialize a new IP connection tracker instance.">SocketIPTracker_new()</a> Main allocation point </dd></dl>

</div>
</div>
<a id="gacfbf054296946c43e621dcf10b9295a9" name="gacfbf054296946c43e621dcf10b9295a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacfbf054296946c43e621dcf10b9295a9">&#9670;&#160;</a></span>SocketSYNProtect_Failed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketSYNProtect_Failed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>General SYN protection operation failure. </p>
<p>Category: SYSTEM Retryable: DEPENDS - often due to resource exhaustion; retry after cleanup.</p>
<p>Raised in cases such as:</p><ul>
<li>Memory allocation failure (arena exhaustion or malloc failure)</li>
<li>Invalid configuration parameters (e.g., negative window duration)</li>
<li>Internal data structure corruption or hash collisions</li>
<li>Mutex acquisition failures under extreme contention</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html#structExcept__T" title="Exception structure for structured error handling.">Except_T</a> for exception handling patterns. </dd>
<dd>
<a class="el" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db" title="Socket_GetLastError - Retrieve the most recent formatted error message.">Socket_GetLastError()</a> for detailed error string. </dd>
<dd>
docs/ERROR_HANDLING.md for module exception guidelines. </dd></dl>

</div>
</div>
<a id="gabc011202dd4f2e080b6ea8eb0f24287e" name="gabc011202dd4f2e080b6ea8eb0f24287e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabc011202dd4f2e080b6ea8eb0f24287e">&#9670;&#160;</a></span>SocketTLS_Failed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketTLS_Failed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>General TLS operation failure. </p>
<p>Category: PROTOCOL Retryable: NO - Usually indicates configuration or setup error.</p>
<p>Used for generic TLS errors not covered by more specific exceptions like handshake or verification failures.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b" title="Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.">tls_error_buf</a> for detailed OpenSSL error information. </dd>
<dd>
<a class="el" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db" title="Socket_GetLastError - Retrieve the most recent formatted error message.">Socket_GetLastError()</a> for formatted error string. </dd>
<dd>
<a class="el" href="group__foundation.html#ga4b19847d604cdc5896376e694ee2a9c1" title="SocketError_categorize_errno - Classify errno into SocketErrorCategory.">SocketError_categorize_errno()</a> for system error classification. </dd></dl>

</div>
</div>
<a id="ga82be75dd764021fb64cd6824768e2254" name="ga82be75dd764021fb64cd6824768e2254"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga82be75dd764021fb64cd6824768e2254">&#9670;&#160;</a></span>SocketTLS_HandshakeFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketTLS_HandshakeFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>TLS handshake could not complete. </p>
<p>Category: PROTOCOL Retryable: NO - Protocol/version mismatch or server rejection.</p>
<p>Raised when the TLS handshake fails due to:</p><ul>
<li>Protocol version mismatch</li>
<li>Cipher suite negotiation failure</li>
<li>Server rejection of connection parameters</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gaeaa77dd7852b535baf17b53ee2518454" title="Perform non-blocking TLS handshake.">SocketTLS_handshake()</a>, <a class="el" href="group__security.html#ga439248f2ff7b87470520de0607569d06" title="Complete handshake with timeout (non-blocking)">SocketTLS_handshake_loop()</a>, <a class="el" href="group__security.html#ga54a01327e253586278c0f740c2764010" title="Complete handshake using socket&#39;s timeout config.">SocketTLS_handshake_auto()</a> for handshake APIs. </dd>
<dd>
<a class="el" href="group__security.html#gabe406e483a861198db5bca58300f1728" title="Peer certificate verification failure.">SocketTLS_VerifyFailed</a> for certificate issues during handshake. </dd>
<dd>
<a class="el" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b" title="Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.">tls_error_buf</a> for OpenSSL-specific error details. </dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="ga445003fff70029dd096df971801be0e4" name="ga445003fff70029dd096df971801be0e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga445003fff70029dd096df971801be0e4">&#9670;&#160;</a></span>SocketTLS_PinVerifyFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketTLS_PinVerifyFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Exception raised when certificate pin verification fails during TLS handshake or manual check. </p>
<p>Thrown by pin verification functions when no configured SPKI hash matches the peer certificate's public key. Indicates potential man-in-the-middle attack or misconfiguration.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga34caeef50e78017625d2eb62142a7e45" title="Add SPKI SHA256 pin (binary format).">SocketTLSContext_add_pin()</a> for adding pins. </dd>
<dd>
<a class="el" href="group__security.html#ga8a972b0da962c5515936444b6921182d" title="Set pin enforcement mode.">SocketTLSContext_set_pin_enforcement()</a> for enforcement mode. </dd>
<dd>
<a class="el" href="group__security.html#gac051204c676250b114e00af223055686" title="Check if hash matches any pin.">SocketTLSContext_verify_pin()</a> for manual checks. </dd>
<dd>
<a class="el" href="group__foundation.html">Core Foundation Modules</a> for exception handling with <a class="el" href="group__foundation.html#structExcept__T" title="Exception structure for structured error handling.">Except_T</a>. </dd></dl>

</div>
</div>
<a id="gad97195716332983bae10a77f275740bd" name="gad97195716332983bae10a77f275740bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad97195716332983bae10a77f275740bd">&#9670;&#160;</a></span>SocketTLS_ProtocolError</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketTLS_ProtocolError</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>TLS protocol violation or internal state error. </p>
<p>Category: PROTOCOL Retryable: NO - Indicates malformed messages or desynchronization.</p>
<p>Raised for errors in TLS record layer, handshake messages, or application data, such as invalid records, decryption failures, or unexpected alerts.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gabdb38e692dde58bbec4ab905eeb8b3aa" title="Send data over TLS-encrypted connection.">SocketTLS_send()</a>, <a class="el" href="group__security.html#ga1c71fc02141cd9e6da4fdf1c88dbbaf3" title="Receive data from TLS-encrypted connection.">SocketTLS_recv()</a> for I/O functions that can trigger this. </dd>
<dd>
<a class="el" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b" title="Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.">tls_error_buf</a> for specific protocol alert codes and details. </dd>
<dd>
<a class="el" href="group__security.html#ga82be75dd764021fb64cd6824768e2254" title="TLS handshake could not complete.">SocketTLS_HandshakeFailed</a> for handshake-specific protocol issues. </dd></dl>

</div>
</div>
<a id="gaa724dbe4115729ef621c0f1f74b5afd6" name="gaa724dbe4115729ef621c0f1f74b5afd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa724dbe4115729ef621c0f1f74b5afd6">&#9670;&#160;</a></span>SocketTLS_ShutdownFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketTLS_ShutdownFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>TLS graceful shutdown failure. </p>
<p>Category: PROTOCOL Retryable: NO - Shutdown alert exchange failed; connection may be compromised.</p>
<p>Raised when the bidirectional close_notify alert cannot be completed, typically due to peer abrupt disconnect, network errors, or prior protocol issues.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gab11506db6f41f31e9fc170b3d0e848f1" title="Perform graceful TLS connection shutdown.">SocketTLS_shutdown()</a> for performing the shutdown sequence. </dd>
<dd>
Socket_close() for underlying socket cleanup after shutdown attempt. </dd>
<dd>
<a class="el" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b" title="Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting.">tls_error_buf</a> for low-level error details. </dd></dl>

</div>
</div>
<a id="gabe406e483a861198db5bca58300f1728" name="gabe406e483a861198db5bca58300f1728"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe406e483a861198db5bca58300f1728">&#9670;&#160;</a></span>SocketTLS_VerifyFailed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="group__foundation.html#structExcept__T">Except_T</a> SocketTLS_VerifyFailed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Peer certificate verification failure. </p>
<p>Category: PROTOCOL Retryable: NO - Certificate validation failure persists on retry.</p>
<p>Raised during handshake when peer certificate or chain fails validation:</p><ul>
<li>Expired or not-yet-valid certificate</li>
<li>Invalid signature or malformed chain</li>
<li>Hostname or SNI mismatch</li>
<li>Unknown or untrusted CA</li>
<li>Revocation detected (CRL/OCSP)</li>
</ul>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#ga4fd56e743762151aa449744a8d574164" title="Get peer certificate verification result.">SocketTLS_get_verify_result()</a> for X509 verification error code. </dd>
<dd>
<a class="el" href="group__security.html#ga39a966c33421653c64f78261f24ee1f1" title="Get detailed verification error string.">SocketTLS_get_verify_error_string()</a> for human-readable description. </dd>
<dd>
<a class="el" href="group__security.html#ga71084c00bec22f65b90301188868b759" title="Set certificate verification policy.">SocketTLSContext_set_verify_mode()</a> to configure verification policy. </dd>
<dd>
<a class="el" href="group__security.html#gac4de1881e05f041a3d5016cba7d5a045" title="Load trusted CA certificates.">SocketTLSContext_load_ca()</a> for CA trust store management. </dd></dl>

<p class="reference">Referenced by <a class="el" href="proxy__connect_8c_source.html#l00129">main()</a>.</p>

</div>
</div>
<a id="gaf6dd40cb19f09e9fffb7f30594372db2" name="gaf6dd40cb19f09e9fffb7f30594372db2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf6dd40cb19f09e9fffb7f30594372db2">&#9670;&#160;</a></span>tls_context_exdata_idx</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int tls_context_exdata_idx</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global ex_data index for storing <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> in SSL_CTX. </p>
<p>Used to associate <a class="el" href="group__security.html#structSocketTLSContext__T" title="TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...">SocketTLSContext_T</a> instances with their corresponding OpenSSL SSL_CTX objects. Allows retrieving the library context from OpenSSL callbacks and internal operations. Lazily initialized once per process.</p>
<dl class="section see"><dt>See also</dt><dd>SSL_CTX_set_ex_data() for OpenSSL ex_data usage. </dd></dl>

</div>
</div>
<a id="ga8ca0182ebb7a93df98871664989b949b" name="ga8ca0182ebb7a93df98871664989b949b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8ca0182ebb7a93df98871664989b949b">&#9670;&#160;</a></span>tls_error_buf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">tls_error_buf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread-local buffer for comprehensive TLS/OpenSSL error diagnostics and reporting. </p>
<p>Dedicated per-thread buffer for storing formatted error strings from TLS operations. Combines OpenSSL ERR codes, X509 verify results, system errno, and contextual details (e.g., "SSL_connect: error:0A0C0103:SSL
routines::certificate verify failed; hostname mismatch"). Enables consistent, detailed logging without repeated OpenSSL calls in error handlers.</p>
<p>Fixed-size to avoid allocations under stress: SOCKET_TLS_OPENSSL_ERRSTR_BUFSIZE (256 bytes default). Automatically managed by library macros; thread-safe via TLS storage.</p>
<h2><a class="anchor" id="autotoc_md551"></a>
Error String Format</h2>
<p>Typical contents:</p><ul>
<li>Function name (e.g., SSL_read, X509_verify_cert)</li>
<li>OpenSSL error code (hex) and reason string</li>
<li>Verify errors (e.g., X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT)</li>
<li>Socket errno if applicable</li>
<li>Custom context from macros (e.g., fd, hostname)</li>
</ul>
<h2><a class="anchor" id="autotoc_md552"></a>
Access Patterns</h2>
<ul>
<li><b>Automatic</b>: Populated on all SocketTLS_* exceptions</li>
<li><b>Manual</b>: Use TLS_FORMAT_ERROR() macro for custom errors</li>
<li><b>Logging</b>: Safe in EXCEPT blocks or callbacks</li>
<li><b>Inspection</b>: Read-only during error handling; cleared post-recovery</li>
</ul>
<h2><a class="anchor" id="autotoc_md553"></a>
Usage in Error Handling</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketTLS_8h.html">tls/SocketTLS.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Except_8h.html">core/Except.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="group__security.html#ga7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a>(<span class="stringliteral">&quot;ca.pem&quot;</span>);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a>(sock, ctx);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#ga54a01327e253586278c0f740c2764010">SocketTLS_handshake_auto</a>(sock);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#gabe406e483a861198db5bca58300f1728">SocketTLS_VerifyFailed</a>) {</div>
<div class="line">    <span class="comment">// tls_error_buf contains verify details</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *err = <a class="code hl_variable" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a>;</div>
<div class="line">    <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;Cert verify failed: %s&quot;</span>, err);</div>
<div class="line">    <span class="comment">// Optional: Parse for specific X509 errors</span></div>
<div class="line">    <span class="keywordtype">long</span> vresult = <a class="code hl_function" href="group__security.html#ga4fd56e743762151aa449744a8d574164">SocketTLS_get_verify_result</a>(sock);</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Verify code: %ld (%s)\n&quot;</span>, vresult,</div>
<div class="line"><a class="code hl_function" href="group__security.html#ga39a966c33421653c64f78261f24ee1f1">SocketTLS_get_verify_error_string</a>(sock, buf, <span class="keyword">sizeof</span>(buf)));</div>
<div class="line">    <span class="comment">// Decide: retry? blacklist peer? etc.</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga82be75dd764021fb64cd6824768e2254">SocketTLS_HandshakeFailed</a>) {</div>
<div class="line">    <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;Handshake error details: %s&quot;</span>, <a class="code hl_variable" href="group__security.html#ga8ca0182ebb7a93df98871664989b949b">tls_error_buf</a>);</div>
<div class="line">    <span class="comment">// Analyze for protocol/cipher issues</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> {</div>
<div class="line">    <span class="comment">// Cleanup regardless</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aExcept_8h_html"><div class="ttname"><a href="Except_8h.html">Except.h</a></div><div class="ttdoc">Structured exception handling for C with TRY/EXCEPT/FINALLY blocks.</div></div>
<div class="ttc" id="agroup__security_html_ga39a966c33421653c64f78261f24ee1f1"><div class="ttname"><a href="group__security.html#ga39a966c33421653c64f78261f24ee1f1">SocketTLS_get_verify_error_string</a></div><div class="ttdeci">const char * SocketTLS_get_verify_error_string(Socket_T socket, char *buf, size_t size)</div><div class="ttdoc">Get detailed verification error string.</div></div>
<div class="ttc" id="agroup__security_html_ga4fd56e743762151aa449744a8d574164"><div class="ttname"><a href="group__security.html#ga4fd56e743762151aa449744a8d574164">SocketTLS_get_verify_result</a></div><div class="ttdeci">long SocketTLS_get_verify_result(Socket_T socket)</div><div class="ttdoc">Get peer certificate verification result.</div></div>
<div class="ttc" id="agroup__security_html_ga54a01327e253586278c0f740c2764010"><div class="ttname"><a href="group__security.html#ga54a01327e253586278c0f740c2764010">SocketTLS_handshake_auto</a></div><div class="ttdeci">TLSHandshakeState SocketTLS_handshake_auto(Socket_T socket)</div><div class="ttdoc">Complete handshake using socket's timeout config.</div></div>
<div class="ttc" id="agroup__security_html_ga82be75dd764021fb64cd6824768e2254"><div class="ttname"><a href="group__security.html#ga82be75dd764021fb64cd6824768e2254">SocketTLS_HandshakeFailed</a></div><div class="ttdeci">const Except_T SocketTLS_HandshakeFailed</div><div class="ttdoc">TLS handshake could not complete.</div></div>
<div class="ttc" id="agroup__security_html_gabe406e483a861198db5bca58300f1728"><div class="ttname"><a href="group__security.html#gabe406e483a861198db5bca58300f1728">SocketTLS_VerifyFailed</a></div><div class="ttdeci">const Except_T SocketTLS_VerifyFailed</div><div class="ttdoc">Peer certificate verification failure.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md554"></a>
Thread Safety &amp; Limitations</h2>
<ul>
<li><b>Thread-Local</b>: Each thread has isolated buffer; no mutex needed</li>
<li><b>Size Limit</b>: Truncates if &gt; BUFSIZE; sufficient for most errors</li>
<li><b>Persistence</b>: Overwritten on next error in thread; copy if needed</li>
<li><b>Platform</b>: __thread (GCC/Clang) or __declspec(thread) (MSVC)</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Define SOCKET_TLS_OPENSSL_ERRSTR_BUFSIZE before including headers to customize size </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Buffer not null-terminated if truncated; use snprintf-safe reads </dd>
<dd>
Avoid long-lived reads across async ops; use <a class="el" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db" title="Socket_GetLastError - Retrieve the most recent formatted error message.">Socket_GetLastError()</a> for snapshots</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - direct string formatting from ERR queue</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db" title="Socket_GetLastError - Retrieve the most recent formatted error message.">Socket_GetLastError()</a> - high-level error string (leverages this buffer) </dd>
<dd>
<a class="el" href="group__security.html#ga39a966c33421653c64f78261f24ee1f1" title="Get detailed verification error string.">SocketTLS_get_verify_error_string()</a> - cert-specific details </dd>
<dd>
<a class="el" href="group__security.html#gaaa5d5a165d617e880e0761f54333d859" title="tls_error_buf - Thread-local TLS error message buffer (see SocketTLS.h for details).">RAISE_TLS_ERROR()</a> / TLS_RAISE_VERIFY_ERROR() - macros populating buffer </dd>
<dd>
<a class="el" href="SocketTLS-private_8h.html" title="Internal TLS module shared definitions, macros, and helper functions.">SocketTLS-private.h</a> - internal error macros and defines </dd>
<dd>
docs/ERROR_HANDLING.md - exception patterns and logging </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#tls-errors - TLS-specific error categorization </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<footer class="footer">
  <div style="max-width: 960px; margin: 0 auto; padding: 40px 24px;">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 40px;">
      <!-- Brand -->
      <div style="flex: 1; min-width: 200px;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 6px;"></div>
          <span style="font-size: 1rem; font-weight: 600; color: #f7f9fa;">Socket Library</span>
        </div>
        <p style="color: #8b98a5; font-size: 0.8125rem; line-height: 1.6; margin: 0;">
          High-performance socket toolkit for POSIX systems with exception-based error handling and TLS 1.3 support.
        </p>
      </div>
      <!-- Links -->
      <div style="display: flex; gap: 48px; flex-wrap: wrap;">
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Documentation</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="index.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Getting Started</a></li>
            <li style="margin: 6px 0;"><a href="annotated.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Data Structures</a></li>
            <li style="margin: 6px 0;"><a href="globals.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">API Reference</a></li>
          </ul>
        </div>
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Resources</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="files.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Header Files</a></li>
            <li style="margin: 6px 0;"><a href="https://x.com/tetsuocorp" target="_blank" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Twitter/X</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Bottom -->
    <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #30363d; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
      <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 0.75rem; font-weight: 500; color: #10b981; background: rgba(16, 185, 129, 0.1); padding: 4px 8px; border-radius: 4px;">C11</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #3b82f6; background: rgba(59, 130, 246, 0.1); padding: 4px 8px; border-radius: 4px;">POSIX</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #8b5cf6; background: rgba(139, 92, 246, 0.1); padding: 4px 8px; border-radius: 4px;">TLS 1.3</span>
      </div>
      <div style="color: #6e7681; font-size: 0.75rem; display: flex; align-items: center; gap: 8px;">
        <span> 2025 Tetsuo Corporation</span>
        <span style="color: #30363d;"></span>
        <a href="https://opensource.org/licenses/MIT" target="_blank" style="color: #8b98a5; text-decoration: none;">MIT License</a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
