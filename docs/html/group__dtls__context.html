<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="High-performance, exception-driven socket toolkit for POSIX systems">
<meta name="keywords" content="socket, networking, C, POSIX, TCP, UDP, TLS, async, high-performance, library">
<meta name="author" content="Tetsuo Corporation">
<meta name="theme-color" content="#3b82f6">
<title>DTLS Context Management</title>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%233b82f6'/><stop offset='100%25' stop-color='%238b5cf6'/></linearGradient></defs><rect width='100' height='100' rx='20' fill='url(%23g)'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white' font-family='sans-serif' font-weight='bold'>S</text></svg>">
</head>
<body>
<div id="top">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Socket Library<span id="projectnumber">1.0.0</span></div>
   <div id="projectbrief">High-performance, exception-driven socket toolkit for POSIX systems</div>
  </td>
  <td style="text-align: right; padding: 20px; vertical-align: middle;">
    <div style="display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap; align-items: center;">
      <a href="index.html" class="quick-link">Home</a>
      <a href="annotated.html" class="quick-link">Structures</a>
      <a href="files.html" class="quick-link">Files</a>
      <a href="globals.html" class="quick-link">API</a>
    </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__dtls__context.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">DTLS Context Management<div class="ingroups"><a class="el" href="group__security.html">Security Modules</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Secure DTLS context configuration and lifecycle management.  
<a href="#details">More...</a></p>
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for DTLS Context Management:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__dtls__context.svg" width="367" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="files" name="files"></a>
Files</h2></td></tr>
<tr class="memitem:SocketDTLSContext_8h" id="r_SocketDTLSContext_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="SocketDTLSContext_8h.html">SocketDTLSContext.h</a></td></tr>
<tr class="memdesc:SocketDTLSContext_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">DTLS context management with cookie protection and secure defaults. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga0acb682b8260ab1c60b918599864e2e5" id="r_ga0acb682b8260ab1c60b918599864e2e5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga0acb682b8260ab1c60b918599864e2e5">T</a>&#160;&#160;&#160;<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a></td></tr>
<tr class="separator:ga0acb682b8260ab1c60b918599864e2e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga0e99fc1644e610eb26324fb12cb96a57" id="r_ga0e99fc1644e610eb26324fb12cb96a57"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a> (const char *cert_file, const char *key_file, const char *ca_file)</td></tr>
<tr class="memdesc:ga0e99fc1644e610eb26324fb12cb96a57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a server-side DTLS context with certificate and key loading.  <br /></td></tr>
<tr class="separator:ga0e99fc1644e610eb26324fb12cb96a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafa2f96caa6d90a1fae0ce4f8fb52970a" id="r_gafa2f96caa6d90a1fae0ce4f8fb52970a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a> (const char *ca_file)</td></tr>
<tr class="memdesc:gafa2f96caa6d90a1fae0ce4f8fb52970a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a client-side DTLS context with optional CA for server verification.  <br /></td></tr>
<tr class="separator:gafa2f96caa6d90a1fae0ce4f8fb52970a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf05f6e0175668dd52a2d68af50f67983" id="r_gaf05f6e0175668dd52a2d68af50f67983"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> *ctx_p)</td></tr>
<tr class="memdesc:gaf05f6e0175668dd52a2d68af50f67983"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dispose of a DTLS context, freeing all associated resources.  <br /></td></tr>
<tr class="separator:gaf05f6e0175668dd52a2d68af50f67983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga52fb3ca5d16466a21ac871ad2217904c" id="r_ga52fb3ca5d16466a21ac871ad2217904c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga52fb3ca5d16466a21ac871ad2217904c">SocketDTLSContext_load_certificate</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, const char *cert_file, const char *key_file)</td></tr>
<tr class="memdesc:ga52fb3ca5d16466a21ac871ad2217904c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load and configure server certificate and private key into the DTLS context.  <br /></td></tr>
<tr class="separator:ga52fb3ca5d16466a21ac871ad2217904c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga210798613a063bb2be1fdf07a5d9648c" id="r_ga210798613a063bb2be1fdf07a5d9648c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga210798613a063bb2be1fdf07a5d9648c">SocketDTLSContext_load_ca</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, const char *ca_file)</td></tr>
<tr class="memdesc:ga210798613a063bb2be1fdf07a5d9648c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load trusted CA certificates.  <br /></td></tr>
<tr class="separator:ga210798613a063bb2be1fdf07a5d9648c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga167f13bc2d88dd59da040a6423cbb741" id="r_ga167f13bc2d88dd59da040a6423cbb741"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga167f13bc2d88dd59da040a6423cbb741">SocketDTLSContext_set_verify_mode</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, <a class="el" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a> mode)</td></tr>
<tr class="memdesc:ga167f13bc2d88dd59da040a6423cbb741"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set certificate verification policy.  <br /></td></tr>
<tr class="separator:ga167f13bc2d88dd59da040a6423cbb741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabbffd63c9a5c7551ecaf8f89a4034eb4" id="r_gabbffd63c9a5c7551ecaf8f89a4034eb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gabbffd63c9a5c7551ecaf8f89a4034eb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.  <br /></td></tr>
<tr class="separator:gabbffd63c9a5c7551ecaf8f89a4034eb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19b67aa468ee1ad317683b1839b26e7b" id="r_ga19b67aa468ee1ad317683b1839b26e7b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b">SocketDTLSContext_set_cookie_secret</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, const unsigned char *secret, size_t len)</td></tr>
<tr class="memdesc:ga19b67aa468ee1ad317683b1839b26e7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the HMAC secret key for DTLS cookie generation.  <br /></td></tr>
<tr class="separator:ga19b67aa468ee1ad317683b1839b26e7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga488bdfe1b7d278bbcb2d2f80a9540df5" id="r_ga488bdfe1b7d278bbcb2d2f80a9540df5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5">SocketDTLSContext_rotate_cookie_secret</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga488bdfe1b7d278bbcb2d2f80a9540df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate the DTLS cookie HMAC secret key to a new random value.  <br /></td></tr>
<tr class="separator:ga488bdfe1b7d278bbcb2d2f80a9540df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga473e4425731c220ae48a1bfec9ba279d" id="r_ga473e4425731c220ae48a1bfec9ba279d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d">SocketDTLSContext_set_mtu</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, size_t mtu)</td></tr>
<tr class="memdesc:ga473e4425731c220ae48a1bfec9ba279d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configure the path MTU for DTLS record fragmentation and padding.  <br /></td></tr>
<tr class="separator:ga473e4425731c220ae48a1bfec9ba279d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9edc0ddb77ac1a52c2d65e202d6c4fdc" id="r_ga9edc0ddb77ac1a52c2d65e202d6c4fdc"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga9edc0ddb77ac1a52c2d65e202d6c4fdc">SocketDTLSContext_get_mtu</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga9edc0ddb77ac1a52c2d65e202d6c4fdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the currently configured path MTU from the DTLS context.  <br /></td></tr>
<tr class="separator:ga9edc0ddb77ac1a52c2d65e202d6c4fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad674b683e396a1af639691d9a18c6aa0" id="r_gad674b683e396a1af639691d9a18c6aa0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gad674b683e396a1af639691d9a18c6aa0">SocketDTLSContext_set_min_protocol</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, int version)</td></tr>
<tr class="memdesc:gad674b683e396a1af639691d9a18c6aa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set minimum supported DTLS version.  <br /></td></tr>
<tr class="separator:gad674b683e396a1af639691d9a18c6aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47bb5aa1a1eafa97c6e026d5b66b0ad9" id="r_ga47bb5aa1a1eafa97c6e026d5b66b0ad9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga47bb5aa1a1eafa97c6e026d5b66b0ad9">SocketDTLSContext_set_max_protocol</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, int version)</td></tr>
<tr class="memdesc:ga47bb5aa1a1eafa97c6e026d5b66b0ad9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set maximum supported DTLS version.  <br /></td></tr>
<tr class="separator:ga47bb5aa1a1eafa97c6e026d5b66b0ad9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gada5ef3bbfb37dfe6c7f92c09958cf75c" id="r_gada5ef3bbfb37dfe6c7f92c09958cf75c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gada5ef3bbfb37dfe6c7f92c09958cf75c">SocketDTLSContext_set_cipher_list</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, const char *ciphers)</td></tr>
<tr class="memdesc:gada5ef3bbfb37dfe6c7f92c09958cf75c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set allowed cipher suites.  <br /></td></tr>
<tr class="separator:gada5ef3bbfb37dfe6c7f92c09958cf75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga090ce55e808027fc886ea6e6232b5a01" id="r_ga090ce55e808027fc886ea6e6232b5a01"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga090ce55e808027fc886ea6e6232b5a01">SocketDTLSContext_set_alpn_protos</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, const char **protos, size_t count)</td></tr>
<tr class="memdesc:ga090ce55e808027fc886ea6e6232b5a01"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advertise ALPN protocols.  <br /></td></tr>
<tr class="separator:ga090ce55e808027fc886ea6e6232b5a01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga880ec894956f1a3a9029c512259df71b" id="r_ga880ec894956f1a3a9029c512259df71b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga880ec894956f1a3a9029c512259df71b">SocketDTLSContext_enable_session_cache</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, size_t max_sessions, long timeout_seconds)</td></tr>
<tr class="memdesc:ga880ec894956f1a3a9029c512259df71b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enable session caching.  <br /></td></tr>
<tr class="separator:ga880ec894956f1a3a9029c512259df71b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeaff18122638de5b79f9e261a4a63761" id="r_gaeaff18122638de5b79f9e261a4a63761"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gaeaff18122638de5b79f9e261a4a63761">SocketDTLSContext_get_cache_stats</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, size_t *hits, size_t *misses, size_t *stores)</td></tr>
<tr class="memdesc:gaeaff18122638de5b79f9e261a4a63761"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get session cache statistics.  <br /></td></tr>
<tr class="separator:gaeaff18122638de5b79f9e261a4a63761"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf81e36256b380aaf7060607a22842d20" id="r_gaf81e36256b380aaf7060607a22842d20"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gaf81e36256b380aaf7060607a22842d20">SocketDTLSContext_set_timeout</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx, int initial_ms, int max_ms)</td></tr>
<tr class="memdesc:gaf81e36256b380aaf7060607a22842d20"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set handshake timeout parameters.  <br /></td></tr>
<tr class="separator:gaf81e36256b380aaf7060607a22842d20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3319b2d0dcdfd165af1cb81448cdb9f9" id="r_ga3319b2d0dcdfd165af1cb81448cdb9f9"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga3319b2d0dcdfd165af1cb81448cdb9f9">SocketDTLSContext_get_ssl_ctx</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga3319b2d0dcdfd165af1cb81448cdb9f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal accessor for the underlying OpenSSL SSL_CTX pointer.  <br /></td></tr>
<tr class="separator:ga3319b2d0dcdfd165af1cb81448cdb9f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga25c64fa874902c37b8aafcd9601b7cef" id="r_ga25c64fa874902c37b8aafcd9601b7cef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#ga25c64fa874902c37b8aafcd9601b7cef">SocketDTLSContext_is_server</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:ga25c64fa874902c37b8aafcd9601b7cef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine if the DTLS context is configured for server role.  <br /></td></tr>
<tr class="separator:ga25c64fa874902c37b8aafcd9601b7cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf77697da681e01b26f48c9472f13efad" id="r_gaf77697da681e01b26f48c9472f13efad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__dtls__context.html#gaf77697da681e01b26f48c9472f13efad">SocketDTLSContext_has_cookie_exchange</a> (<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx)</td></tr>
<tr class="memdesc:gaf77697da681e01b26f48c9472f13efad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query if cookie exchange (DoS protection) is enabled on the context.  <br /></td></tr>
<tr class="separator:gaf77697da681e01b26f48c9472f13efad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Secure DTLS context configuration and lifecycle management. </p>
<p>Wraps OpenSSL SSL_CTX with socket library integration, providing secure defaults (DTLS 1.2+, ECDHE ciphers), certificate handling, cookie DoS protection (RFC 6347), ALPN, MTU config, and session caching for UDP/TLS.</p>
<p>Thread safety: Creation thread-safe; modifications not safe after sharing. Use per-thread contexts or mutex-protect config phase.</p>
<dl class="section see"><dt>See also</dt><dd>SocketDTLS_T for applying contexts to UDP sockets. </dd>
<dd>
<a class="el" href="SocketDTLSConfig_8h.html" title="DTLS configuration constants and secure defaults.">SocketDTLSConfig.h</a> for constants (e.g., ciphersuites, timeouts). </dd>
<dd>
<a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> for TLS/SYN protection modules. </dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga0acb682b8260ab1c60b918599864e2e5" name="ga0acb682b8260ab1c60b918599864e2e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0acb682b8260ab1c60b918599864e2e5">&#9670;&#160;</a></span>T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define T&#160;&#160;&#160;<a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketDTLSContext_8h_source.html#l00068">68</a> of file <a class="el" href="SocketDTLSContext_8h_source.html">SocketDTLSContext.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gabbffd63c9a5c7551ecaf8f89a4034eb4" name="gabbffd63c9a5c7551ecaf8f89a4034eb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabbffd63c9a5c7551ecaf8f89a4034eb4">&#9670;&#160;</a></span>SocketDTLSContext_enable_cookie_exchange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_enable_cookie_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable cookie exchange mechanism for stateless DoS protection in DTLS servers. </p>
<p>Activates the RFC 6347 "stateless cookie" mechanism to mitigate denial-of-service attacks via forged ClientHello messages (DTLS equivalent of SYN floods). When enabled on a server context, upon receiving a ClientHello, the server generates a cryptographically signed cookie (using HMAC with a secret key) and responds with a HelloVerifyRequest instead of allocating server-side handshake state. The client must include the cookie in its second ClientHello to prove reachability (round-trip validation), preventing resource exhaustion from spoofed IPs.</p>
<p>This adds one extra round-trip to successful handshakes (increased latency ~1 RTT) but drastically reduces server memory/CPU usage under attack. Cookies are short-lived and stateless on server side until valid handshake proceeds.</p>
<p>Automatic secret key generation occurs on enable (random 32-byte key). For load-balanced or clustered servers, set a shared secret via <a class="el" href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b" title="Configure the HMAC secret key for DTLS cookie generation.">SocketDTLSContext_set_cookie_secret()</a> before or after enabling to ensure cookie compatibility across instances. Rotate periodically with <a class="el" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5" title="Rotate the DTLS cookie HMAC secret key to a new random value.">SocketDTLSContext_rotate_cookie_secret()</a> to limit replay attacks.</p>
<p>Client contexts ignore this setting. Only applicable to server-mode contexts.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The server-side <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>If:<ul>
<li>ctx is NULL or not server-mode (use is_server() to check)</li>
<li>OpenSSL DTLS cookie callbacks cannot be installed</li>
<li>Internal random number generation for initial secret fails</li>
<li>Context already finalized or incompatible state</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - Installs OpenSSL callbacks and generates/stores secret key,</dt><dd>modifying shared context state. Synchronize access if shared across threads.</dd></dl>
<h2><a class="anchor" id="autotoc_md614"></a>
Enabling DoS Protection in Server Setup</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(<span class="stringliteral">&quot;server.crt&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;server.key&quot;</span>, NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Enable cookie exchange for production DoS resistance</span></div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a>(ctx);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optional: Set shared secret for cluster (before or after enable)</span></div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> secret[32];  <span class="comment">// SOCKET_DTLS_COOKIE_SECRET_LEN</span></div>
<div class="line">    RAND_bytes(secret, <span class="keyword">sizeof</span>(secret));  <span class="comment">// Or load from secure storage</span></div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b">SocketDTLSContext_set_cookie_secret</a>(ctx, secret, <span class="keyword">sizeof</span>(secret));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Apply to UDP listener</span></div>
<div class="line">    <a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> listener = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, IPPROTO_UDP);</div>
<div class="line">    <a class="code hl_function" href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind</a>(listener, <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 4433);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(listener, ctx);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// In event loop: accept with cookie validation handled internally by</span></div>
<div class="line">OpenSSL <span class="keywordflow">while</span> (<a class="code hl_variable" href="connection__pool_8c.html#af1f449cc09f8d36befcce07bc38c29c0">running</a>) { <a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> client_sock =</div>
<div class="line">SocketDTLS_accept(listener);  <span class="comment">// Blocks until valid handshake if</span></div>
<div class="line">(client_sock) { handle_secure_client(client_sock);</div>
<div class="line">            <a class="code hl_function" href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4">SocketDgram_free</a>(&amp;client_sock);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Handle error</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> {</div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a>(&amp;ctx);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aSocketDgram-private_8h_html_structSocketDgram__T"><div class="ttname"><a href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a></div><div class="ttdoc">Opaque type representing a datagram socket instance.</div><div class="ttdef"><b>Definition</b> <a href="SocketDgram-private_8h_source.html#l00043">SocketDgram-private.h:44</a></div></div>
<div class="ttc" id="aconnection__pool_8c_html_af1f449cc09f8d36befcce07bc38c29c0"><div class="ttname"><a href="connection__pool_8c.html#af1f449cc09f8d36befcce07bc38c29c0">running</a></div><div class="ttdeci">static volatile int running</div><div class="ttdef"><b>Definition</b> <a href="connection__pool_8c_source.html#l00029">connection_pool.c:29</a></div></div>
<div class="ttc" id="agroup__dtls__context_html_ga0e99fc1644e610eb26324fb12cb96a57"><div class="ttname"><a href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a></div><div class="ttdeci">SocketDTLSContext_T SocketDTLSContext_new_server(const char *cert_file, const char *key_file, const char *ca_file)</div><div class="ttdoc">Create a server-side DTLS context with certificate and key loading.</div></div>
<div class="ttc" id="agroup__dtls__context_html_ga19b67aa468ee1ad317683b1839b26e7b"><div class="ttname"><a href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b">SocketDTLSContext_set_cookie_secret</a></div><div class="ttdeci">void SocketDTLSContext_set_cookie_secret(SocketDTLSContext_T ctx, const unsigned char *secret, size_t len)</div><div class="ttdoc">Configure the HMAC secret key for DTLS cookie generation.</div></div>
<div class="ttc" id="agroup__dtls__context_html_gabbffd63c9a5c7551ecaf8f89a4034eb4"><div class="ttname"><a href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a></div><div class="ttdeci">void SocketDTLSContext_enable_cookie_exchange(SocketDTLSContext_T ctx)</div><div class="ttdoc">Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.</div></div>
<div class="ttc" id="agroup__dtls__context_html_gaf05f6e0175668dd52a2d68af50f67983"><div class="ttname"><a href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a></div><div class="ttdeci">void SocketDTLSContext_free(SocketDTLSContext_T *ctx_p)</div><div class="ttdoc">Dispose of a DTLS context, freeing all associated resources.</div></div>
<div class="ttc" id="agroup__foundation_html_ga0e2a75478cd44f1666a6aca626c5c50b"><div class="ttname"><a href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a></div><div class="ttdeci">#define FINALLY</div><div class="ttdoc">Define cleanup code that executes regardless of exceptions.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l01326">Except.h:1326</a></div></div>
<div class="ttc" id="agroup__foundation_html_gab5e72fc2bd41014c75e0ace4feabfe8e"><div class="ttname"><a href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a></div><div class="ttdeci">#define EXCEPT(e)</div><div class="ttdoc">Catch a specific exception type within a TRY block.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l01105">Except.h:1105</a></div></div>
<div class="ttc" id="agroup__foundation_html_gad2746371528bdf15c3910b7bf217dac0"><div class="ttname"><a href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a></div><div class="ttdeci">#define TRY</div><div class="ttdoc">Start a TRY/EXCEPT/FINALLY exception handling block.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00991">Except.h:991</a></div></div>
<div class="ttc" id="agroup__foundation_html_gae6628ac788ad213363b89dba9868420b"><div class="ttname"><a href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a></div><div class="ttdeci">#define END_TRY</div><div class="ttdoc">Complete a TRY/EXCEPT/FINALLY exception handling block.</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l01439">Except.h:1439</a></div></div>
<div class="ttc" id="agroup__security_html_ga083605c4d8e6ea5658b72883f8e41be9"><div class="ttname"><a href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a></div><div class="ttdeci">const Except_T SocketDTLS_Failed</div><div class="ttdoc">General DTLS operation failure.</div></div>
<div class="ttc" id="agroup__security_html_gad2f26460b23a711e0fa74605371cf127"><div class="ttname"><a href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a></div><div class="ttdeci">void SocketDTLS_enable(SocketDgram_T socket, SocketDTLSContext_T ctx)</div><div class="ttdoc">Enable DTLS encryption on a datagram socket.</div></div>
<div class="ttc" id="agroup__security_html_structSocketDTLSContext__T"><div class="ttname"><a href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a></div><div class="ttdoc">SocketDTLSContext_T - DTLS Context Structure.</div><div class="ttdef"><b>Definition</b> <a href="SocketDTLS-private_8h_source.html#l00797">SocketDTLS-private.h:798</a></div></div>
<div class="ttc" id="agroup__socket__dgram_html_ga020169c79640786afa4c36fd1dc965e4"><div class="ttname"><a href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4">SocketDgram_free</a></div><div class="ttdeci">void SocketDgram_free(SocketDgram_T *socket)</div><div class="ttdoc">Dispose of a datagram socket, closing the underlying file descriptor and freeing resources.</div></div>
<div class="ttc" id="agroup__socket__dgram_html_ga0c81d9ef1d90e7ab34dd7286f13878ee"><div class="ttname"><a href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind</a></div><div class="ttdeci">void SocketDgram_bind(SocketDgram_T socket, const char *host, int port)</div><div class="ttdoc">Bind a datagram socket to a local IP address and port.</div></div>
<div class="ttc" id="agroup__socket__dgram_html_gad6902c87ab5883f155dab2adfa950c52"><div class="ttname"><a href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a></div><div class="ttdeci">SocketDgram_T SocketDgram_new(int domain, int protocol)</div><div class="ttdoc">Create a new UDP/datagram socket with specified domain and protocol.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md615"></a>
Periodic Secret Rotation</h2>
<div class="fragment"><div class="line"><span class="comment">// In timer callback or cron job</span></div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5">SocketDTLSContext_rotate_cookie_secret</a>(ctx);  <span class="comment">// Generates new secret,</span></div>
<div class="line">invalidates old cookies</div>
<div class="line"><span class="comment">// Clients will retry handshake automatically</span></div>
<div class="ttc" id="agroup__dtls__context_html_ga488bdfe1b7d278bbcb2d2f80a9540df5"><div class="ttname"><a href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5">SocketDTLSContext_rotate_cookie_secret</a></div><div class="ttdeci">void SocketDTLSContext_rotate_cookie_secret(SocketDTLSContext_T ctx)</div><div class="ttdoc">Rotate the DTLS cookie HMAC secret key to a new random value.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Cookies include client IP, timestamp, and opaque data, signed with HMAC-SHA256. Secret rotation invalidates existing cookies, forcing client retries (harmless). </dd>
<dd>
Adds ~100-200 bytes to HelloVerifyRequest; minimal bandwidth overhead. </dd>
<dd>
Compatible with DTLS 1.2 clients; older versions may fail handshake. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Without cookies, servers vulnerable to UDP amplification/reflection attacks. Always enable on internet-facing DTLS servers. </dd>
<dd>
Shared secrets must be securely distributed and identical across cluster nodes; mismatch causes handshake failures.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Configuration and callback registration; secret gen is</dt><dd>O(1) crypto.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b" title="Configure the HMAC secret key for DTLS cookie generation.">SocketDTLSContext_set_cookie_secret()</a> for manual secret configuration. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5" title="Rotate the DTLS cookie HMAC secret key to a new random value.">SocketDTLSContext_rotate_cookie_secret()</a> for key rotation. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> which creates compatible server contexts. </dd>
<dd>
RFC 6347 Section 4.2.1 for protocol details on hello verification. </dd>
<dd>
docs/SYN-PROTECT.md for complementary TCP SYN protection strategies. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#dos-mitigation for broader DoS defense in socket library. </dd></dl>

</div>
</div>
<a id="ga880ec894956f1a3a9029c512259df71b" name="ga880ec894956f1a3a9029c512259df71b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga880ec894956f1a3a9029c512259df71b">&#9670;&#160;</a></span>SocketDTLSContext_enable_session_cache()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_enable_session_cache </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>max_sessions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>timeout_seconds</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Enable session caching. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">max_sessions</td><td>Maximum number of sessions to cache (&gt;0), 0 for default </td></tr>
    <tr><td class="paramname">timeout_seconds</td><td>Session timeout in seconds, 0 for OpenSSL default (300s)</td></tr>
  </table>
  </dd>
</dl>
<p>Enables session resumption for reduced handshake latency (1-RTT vs 2-RTT).</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>if cannot enable or configure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - modifies shared context during setup</dt><dd></dd></dl>

</div>
</div>
<a id="gaf05f6e0175668dd52a2d68af50f67983" name="gaf05f6e0175668dd52a2d68af50f67983"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf05f6e0175668dd52a2d68af50f67983">&#9670;&#160;</a></span>SocketDTLSContext_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> *&#160;</td>
          <td class="paramname"><em>ctx_p</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dispose of a DTLS context, freeing all associated resources. </p>
<p>Releases the underlying OpenSSL SSL_CTX, internal Arena_T allocations (including loaded certificates, CA stores, cookie secrets, ALPN protocol lists, and session cache if enabled), and any other context-specific resources. Sets the provided pointer to NULL to prevent use-after-free errors. This is the counterpart to <a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> or new_client().</p>
<p>All SSL/DTLS objects created from this context (via <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a>) must be freed separately before or after context disposal, as they hold references to shared state. However, disposing the context invalidates those objects immediately, so free sockets first in production code for graceful shutdowns.</p>
<p>Safe to call with NULL pointer (no-op). Idempotent: repeated calls on same pointer (already NULL) do nothing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx_p</td><td>Pointer to the <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> handle. Set to NULL on success.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td>- Errors during cleanup (e.g., OpenSSL internal) are logged but do not raise exceptions to avoid complicating cleanup paths.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - But avoid concurrent calls on the same context pointer</dt><dd>without external synchronization. Read-only after full setup; disposal is atomic but may block briefly during resource release.</dd></dl>
<h2><a class="anchor" id="autotoc_md611"></a>
Basic Cleanup Pattern</h2>
<div class="fragment"><div class="line"><span class="comment">// In normal operation</span></div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a>(&amp;ctx);  <span class="comment">// Sets ctx to NULL</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Safe for NULL</span></div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a>(NULL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// In TRY/FINALLY for error safety</span></div>
<div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(...);</div>
<div class="line">    <span class="comment">// ... use ctx to enable DTLS on sockets ...</span></div>
<div class="line">    <span class="comment">// Free sockets first</span></div>
<div class="line">    <a class="code hl_function" href="group__socket__dgram.html#ga020169c79640786afa4c36fd1dc965e4">SocketDgram_free</a>(&amp;sock);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> {</div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a>(&amp;ctx);</div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This function does not flush or invalidate active sessions in the cache; ongoing handshakes or data exchanges on associated sockets may fail post-disposal. </dd>
<dd>
For servers handling many connections, consider graceful drain: stop accepting new connections, wait for existing to complete, then free context. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Do not use the context or any derived SSL objects after calling free(). Undefined behavior, potential crashes or leaks. </dd>
<dd>
In multi-threaded environments, ensure no threads are using the context during disposal; use synchronization primitives if necessary.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) average, O(n) worst case where n is number of cached</dt><dd>sessions or loaded certs to free. Arena clear is O(allocated bytes) but fast.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> and <a class="el" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a" title="Create a client-side DTLS context with optional CA for server verification.">SocketDTLSContext_new_client()</a> for creation. </dd>
<dd>
<a class="el" href="group__foundation.html#ga6842e66018614df08139e67826cf3e0d" title="Dispose of an arena and all its allocations, freeing underlying memory chunks.">Arena_dispose()</a> for underlying memory management details. </dd>
<dd>
SocketDTLS_free() for cleaning up per-socket DTLS state. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#resource-management for best practices on TLS context lifecycle. </dd></dl>

</div>
</div>
<a id="gaeaff18122638de5b79f9e261a4a63761" name="gaeaff18122638de5b79f9e261a4a63761"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeaff18122638de5b79f9e261a4a63761">&#9670;&#160;</a></span>SocketDTLSContext_get_cache_stats()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_get_cache_stats </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>hits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>misses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>stores</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get session cache statistics. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">hits</td><td>Output number of cache hits </td></tr>
    <tr><td class="paramname">misses</td><td>Output number of cache misses </td></tr>
    <tr><td class="paramname">stores</td><td>Output number of sessions stored</td></tr>
  </table>
  </dd>
</dl>
<p>Fills provided pointers with current session cache statistics. Statistics are thread-safe and cumulative since cache enable. If pointers NULL, skipped.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes</dt><dd></dd></dl>

</div>
</div>
<a id="ga9edc0ddb77ac1a52c2d65e202d6c4fdc" name="ga9edc0ddb77ac1a52c2d65e202d6c4fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9edc0ddb77ac1a52c2d65e202d6c4fdc">&#9670;&#160;</a></span>SocketDTLSContext_get_mtu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t SocketDTLSContext_get_mtu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the currently configured path MTU from the DTLS context. </p>
<p>Returns the MTU value set via <a class="el" href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d" title="Configure the path MTU for DTLS record fragmentation and padding.">SocketDTLSContext_set_mtu()</a> or the internal default. Useful for logging, debugging, or dynamic adjustment logic. Read-only operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Configured MTU in bytes (512-65535 or default).</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Pure read access to immutable config value; safe</dt><dd>concurrent.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Default value is 1200 if not explicitly set.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Direct field access.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d" title="Configure the path MTU for DTLS record fragmentation and padding.">SocketDTLSContext_set_mtu()</a> for setting. </dd>
<dd>
<a class="el" href="group__security.html#ga7752aae6c38da47f187f8d766b4ae12e" title="Get current effective MTU.">SocketDTLS_get_mtu()</a> for per-socket value (may override). </dd></dl>

</div>
</div>
<a id="ga3319b2d0dcdfd165af1cb81448cdb9f9" name="ga3319b2d0dcdfd165af1cb81448cdb9f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3319b2d0dcdfd165af1cb81448cdb9f9">&#9670;&#160;</a></span>SocketDTLSContext_get_ssl_ctx()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void * SocketDTLSContext_get_ssl_ctx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Internal accessor for the underlying OpenSSL SSL_CTX pointer. </p>
<p>Provides direct access to the OpenSSL SSL_CTX* managed by this wrapper, intended solely for internal library use such as <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> which needs to create SSL* instances and associate them with sockets.</p>
<p>End users should not call this; use high-level APIs like <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a>. Violates encapsulation; raw pointer management risks misuse.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void* castable to SSL_CTX* (non-NULL if ctx valid).</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Returns const pointer to immutable SSL_CTX after setup.</dt><dd></dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Internal API; subject to change. Do not use in application code.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Direct field return.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> internal user. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> creates the SSL_CTX. </dd></dl>

</div>
</div>
<a id="gaf77697da681e01b26f48c9472f13efad" name="gaf77697da681e01b26f48c9472f13efad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf77697da681e01b26f48c9472f13efad">&#9670;&#160;</a></span>SocketDTLSContext_has_cookie_exchange()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketDTLSContext_has_cookie_exchange </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Query if cookie exchange (DoS protection) is enabled on the context. </p>
<p>Returns whether <a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> has been called and callbacks installed for hello verification. Used internally to conditionalize server behavior or logging.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance (server preferred).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if enabled, 0 if disabled or client context.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Reads immutable flag set at enable time.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Flag check.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> sets this flag. </dd>
<dd>
SocketDTLS_has_cookie_exchange() for per-socket query. </dd></dl>

</div>
</div>
<a id="ga25c64fa874902c37b8aafcd9601b7cef" name="ga25c64fa874902c37b8aafcd9601b7cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga25c64fa874902c37b8aafcd9601b7cef">&#9670;&#160;</a></span>SocketDTLSContext_is_server()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int SocketDTLSContext_is_server </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Determine if the DTLS context is configured for server role. </p>
<p>Internal utility to query whether the context was created with server options (e.g., via new_server, loaded cert/key) or client (new_client). Used by library internals like SocketDTLS_accept() vs connect logic.</p>
<p>End users typically do not need this; role is implicit in usage.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if server-mode, 0 if client-mode.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Reads immutable role flag set at creation.</dt><dd></dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Direct flag check.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> sets server mode. </dd>
<dd>
<a class="el" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a" title="Create a client-side DTLS context with optional CA for server verification.">SocketDTLSContext_new_client()</a> sets client mode. </dd>
<dd>
SocketDTLS_is_server() for per-socket role query. </dd></dl>

</div>
</div>
<a id="ga210798613a063bb2be1fdf07a5d9648c" name="ga210798613a063bb2be1fdf07a5d9648c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga210798613a063bb2be1fdf07a5d9648c">&#9670;&#160;</a></span>SocketDTLSContext_load_ca()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_load_ca </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load trusted CA certificates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">ca_file</td><td>Path to CA file or directory containing PEM CA certs</td></tr>
  </table>
  </dd>
</dl>
<p>Loads CA certs for peer verification. Tries as file then directory.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on load errors </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="ga52fb3ca5d16466a21ac871ad2217904c" name="ga52fb3ca5d16466a21ac871ad2217904c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga52fb3ca5d16466a21ac871ad2217904c">&#9670;&#160;</a></span>SocketDTLSContext_load_certificate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_load_certificate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cert_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Load and configure server certificate and private key into the DTLS context. </p>
<p>Reads the specified certificate and private key files in PEM format, parses them using OpenSSL, validates that the private key corresponds to the certificate's public key, and installs them into the context's SSL_CTX for use in server-side DTLS handshakes. Supports certificate chains (multiple certs in file) for intermediate CA inclusion.</p>
<p>This function is useful for dynamic certificate reloading without recreating the entire context, e.g., for certificate rotation in long-running servers. It replaces any previously loaded server certificate/key pair.</p>
<p>Note: Client contexts can also use this for mutual TLS (client authentication), though new_client() does not load them by default.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance to configure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert_file</td><td>Path to the server/client certificate file(s) in PEM format. May contain certificate chain (server cert first, then intermediates). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_file</td><td>Path to the private key file in PEM, PKCS#8, or traditional format. Encrypted keys prompt for passphrase via OpenSSL callback (not supported in non-interactive mode; exception raised).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>If:<ul>
<li>ctx is NULL or invalid</li>
<li>File read errors (ENOENT, EACCES, EISDIR)</li>
<li>Invalid PEM/PKCS format or parsing failure</li>
<li>Private key does not match certificate (key mismatch)</li>
<li>OpenSSL X509/SSL installation fails</li>
<li>Memory allocation error during parsing</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - Modifies shared SSL_CTX and internal state. Caller must</dt><dd>synchronize if context is shared across threads. Prefer per-thread contexts for high-contention scenarios.</dd></dl>
<h2><a class="anchor" id="autotoc_md612"></a>
Dynamic Certificate Reload</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <span class="comment">// Existing context from new_server() or new_client()</span></div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#ga52fb3ca5d16466a21ac871ad2217904c">SocketDTLSContext_load_certificate</a>(ctx, <span class="stringliteral">&quot;new-server.crt&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;new-server.key&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Context now uses new cert/key for subsequent handshakes</span></div>
<div class="line">    <span class="comment">// Existing connections unaffected (use SSL_CTX_set_session_id_context</span></div>
<div class="line">or reload sockets)</div>
<div class="line"> </div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">    <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;Cert load failed: %s&quot;</span>, <a class="code hl_function" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a>());</div>
<div class="line">    <span class="comment">// Rollback or retry logic here</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aSocketUtil_8h_html_a16642c35dec627aeb4976538671b1552"><div class="ttname"><a href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a></div><div class="ttdeci">#define SOCKET_LOG_ERROR_MSG(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00548">SocketUtil.h:548</a></div></div>
<div class="ttc" id="agroup__dtls__context_html_ga52fb3ca5d16466a21ac871ad2217904c"><div class="ttname"><a href="group__dtls__context.html#ga52fb3ca5d16466a21ac871ad2217904c">SocketDTLSContext_load_certificate</a></div><div class="ttdeci">void SocketDTLSContext_load_certificate(SocketDTLSContext_T ctx, const char *cert_file, const char *key_file)</div><div class="ttdoc">Load and configure server certificate and private key into the DTLS context.</div></div>
<div class="ttc" id="agroup__foundation_html_gac71a25566cdc9e11eaecb16c966081db"><div class="ttname"><a href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a></div><div class="ttdeci">const char * Socket_GetLastError(void)</div><div class="ttdoc">Socket_GetLastError - Retrieve the most recent formatted error message.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md613"></a>
Client Certificate for Mutual TLS</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> client_ctx = <a class="code hl_function" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a>(<span class="stringliteral">&quot;ca.pem&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#ga52fb3ca5d16466a21ac871ad2217904c">SocketDTLSContext_load_certificate</a>(client_ctx, <span class="stringliteral">&quot;client.crt&quot;</span>, <span class="stringliteral">&quot;client.key&quot;</span>);</div>
<div class="line"><span class="comment">// Now client presents cert during handshake if server requests</span></div>
<div class="ttc" id="agroup__dtls__context_html_gafa2f96caa6d90a1fae0ce4f8fb52970a"><div class="ttname"><a href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a></div><div class="ttdeci">SocketDTLSContext_T SocketDTLSContext_new_client(const char *ca_file)</div><div class="ttdoc">Create a client-side DTLS context with optional CA for server verification.</div></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Previously loaded certificates are replaced; no support for multiple certs (SNI-based selection requires custom OpenSSL extensions not implemented here). </dd>
<dd>
Key files with passphrases are not supported in this library; use unencrypted keys or external decryption. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Verify file permissions: cert/key files should be 0600, owned by server process. Leaked keys compromise security. </dd>
<dd>
After loading, test with a handshake to confirm validity; silent failures possible if OpenSSL accepts but peer rejects.</dd></dl>
<dl class="section user"><dt>Complexity\n O(n) where n is combined size of cert and key files for parsing</dt><dd>and validation. Key-cert matching involves cryptographic operations (O(1) but compute-heavy).</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> which calls this internally during creation. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga210798613a063bb2be1fdf07a5d9648c" title="Load trusted CA certificates.">SocketDTLSContext_load_ca()</a> for loading trust anchors. </dd>
<dd>
SSL_CTX_use_certificate_chain_file() and SSL_CTX_use_PrivateKey_file() for OpenSSL equivalents. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#certificate-management for rotation strategies and best practices. </dd></dl>

</div>
</div>
<a id="gafa2f96caa6d90a1fae0ce4f8fb52970a" name="gafa2f96caa6d90a1fae0ce4f8fb52970a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafa2f96caa6d90a1fae0ce4f8fb52970a">&#9670;&#160;</a></span>SocketDTLSContext_new_client()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> SocketDTLSContext_new_client </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a client-side DTLS context with optional CA for server verification. </p>
<p>Initializes an OpenSSL SSL_CTX for DTLS client use, enforcing DTLS 1.2 minimum protocol and configuring secure modern cipher suites prioritizing perfect forward secrecy (PFS) such as ECDHE with AES-GCM or ChaCha20-Poly1305. If a CA file or directory is provided, loads trusted CA certificates and enables server certificate verification, including hostname matching when applied to sockets.</p>
<p>This function sets up the context for secure outbound DTLS connections over UDP, suitable for applications like secure IoT communication (CoAP/DTLS), VPNs, or real-time media streaming. By default, hostname verification is not enforced at context level but can be set per-socket via <a class="el" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3" title="Set SNI hostname for client DTLS connections.">SocketDTLS_set_hostname()</a>.</p>
<p>Further customization post-creation includes setting ALPN protocols for negotiation (e.g., "coap"), enabling session resumption for performance, or adjusting MTU for path MTU discovery. Apply the context to UDP sockets using <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> before initiating handshakes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ca_file</td><td>Optional path to a CA bundle file (PEM format) or directory containing trusted CA certificates for verifying the server's identity. Pass NULL to disable server verification (not recommended for production; vulnerable to MITM attacks).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Newly created <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance, configured for client use. Returns NULL only if an exception is raised.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>If:<ul>
<li>OpenSSL SSL_CTX creation or initialization fails</li>
<li>Provided CA file/directory cannot be read or parsed (ENOENT, invalid PEM, permission denied)</li>
<li>Memory allocation fails in internal arena</li>
<li>Internal OpenSSL errors (e.g., insufficient entropy)</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Creates an independent context with private state.</dt><dd>Concurrent calls from multiple threads are safe and produce isolated contexts.</dd></dl>
<h2><a class="anchor" id="autotoc_md609"></a>
Basic Client Usage</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a>(<span class="stringliteral">&quot;ca-bundle.pem&quot;</span>);</div>
<div class="line"><span class="comment">// Verify servers</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optional: Advertise ALPN for protocol negotiation</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *protos[] = {<span class="stringliteral">&quot;coap&quot;</span>, NULL};</div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#ga090ce55e808027fc886ea6e6232b5a01">SocketDTLSContext_set_alpn_protos</a>(ctx, protos, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optional: Enable session cache for repeated connections</span></div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#ga880ec894956f1a3a9029c512259df71b">SocketDTLSContext_enable_session_cache</a>(ctx, 500, 1800);  <span class="comment">// 500</span></div>
<div class="line">sessions, 30min</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create UDP socket, enable DTLS, connect</span></div>
<div class="line">    <a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> sock = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, IPPROTO_UDP);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(sock, ctx);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3">SocketDTLS_set_hostname</a>(sock, <span class="stringliteral">&quot;example.com&quot;</span>);  <span class="comment">// For SNI and</span></div>
<div class="line">verification <a class="code hl_function" href="group__socket__dgram.html#gabcb18c16142d3b5ef49bee08a96e15fa">SocketDgram_connect</a>(sock, <span class="stringliteral">&quot;example.com&quot;</span>, 5684);  <span class="comment">// CoAP</span></div>
<div class="line"><span class="keywordflow">default</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Perform handshake</span></div>
<div class="line">    <a class="code hl_enumeration" href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a> state = <a class="code hl_function" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a>(sock);</div>
<div class="line">    <span class="keywordflow">while</span> (state == <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a> || state ==</div>
<div class="line"><a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a>) {</div>
<div class="line">        <span class="comment">// Handle I/O in event loop</span></div>
<div class="line">        state = <a class="code hl_function" href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755">SocketDTLS_handshake_loop</a>(sock, 1000);  <span class="comment">// 1s timeout</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (state == <a class="code hl_enumvalue" href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a>) {</div>
<div class="line">        <span class="comment">// Socket ready for encrypted send/recv</span></div>
<div class="line">        ssize_t sent = <a class="code hl_function" href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460">SocketDTLS_send</a>(sock, data, len);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">    <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;DTLS client setup failed: %s&quot;</span>,</div>
<div class="line"><a class="code hl_function" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a>()); } <a class="code hl_define" href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> { <a class="code hl_function" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a>(&amp;ctx); } <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__dtls__context_html_ga090ce55e808027fc886ea6e6232b5a01"><div class="ttname"><a href="group__dtls__context.html#ga090ce55e808027fc886ea6e6232b5a01">SocketDTLSContext_set_alpn_protos</a></div><div class="ttdeci">void SocketDTLSContext_set_alpn_protos(SocketDTLSContext_T ctx, const char **protos, size_t count)</div><div class="ttdoc">Advertise ALPN protocols.</div></div>
<div class="ttc" id="agroup__dtls__context_html_ga880ec894956f1a3a9029c512259df71b"><div class="ttname"><a href="group__dtls__context.html#ga880ec894956f1a3a9029c512259df71b">SocketDTLSContext_enable_session_cache</a></div><div class="ttdeci">void SocketDTLSContext_enable_session_cache(SocketDTLSContext_T ctx, size_t max_sessions, long timeout_seconds)</div><div class="ttdoc">Enable session caching.</div></div>
<div class="ttc" id="agroup__security_html_ga095bfc830b421398fbecacb1ac3d6755"><div class="ttname"><a href="group__security.html#ga095bfc830b421398fbecacb1ac3d6755">SocketDTLS_handshake_loop</a></div><div class="ttdeci">DTLSHandshakeState SocketDTLS_handshake_loop(SocketDgram_T socket, int timeout_ms)</div><div class="ttdoc">Blocking DTLS handshake with configurable timeout.</div></div>
<div class="ttc" id="agroup__security_html_ga17e8bd79af2c5a20b5dbb9e8dff6f84c"><div class="ttname"><a href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c">SocketDTLS_handshake</a></div><div class="ttdeci">DTLSHandshakeState SocketDTLS_handshake(SocketDgram_T socket)</div><div class="ttdoc">Perform one step of the non-blocking DTLS handshake.</div></div>
<div class="ttc" id="agroup__security_html_ga9fe6acb926cc7fbc8c4f0239834b5460"><div class="ttname"><a href="group__security.html#ga9fe6acb926cc7fbc8c4f0239834b5460">SocketDTLS_send</a></div><div class="ttdeci">ssize_t SocketDTLS_send(SocketDgram_T socket, const void *buf, size_t len)</div><div class="ttdoc">Send application data over established DTLS connection.</div></div>
<div class="ttc" id="agroup__security_html_gabf3857e3cea92190f4c6eca7a8418be3"><div class="ttname"><a href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3">SocketDTLS_set_hostname</a></div><div class="ttdeci">void SocketDTLS_set_hostname(SocketDgram_T socket, const char *hostname)</div><div class="ttdoc">Set SNI hostname for client DTLS connections.</div></div>
<div class="ttc" id="agroup__security_html_gad092160c037d01929df1bb8d5b75b43c"><div class="ttname"><a href="group__security.html#gad092160c037d01929df1bb8d5b75b43c">TLSHandshakeState</a></div><div class="ttdeci">TLSHandshakeState</div><div class="ttdoc">TLS handshake progress states for non-blocking and event-driven operations.</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00545">SocketTLS.h:546</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cab268d75e71356121ccf44e8e5f4ab592">TLS_HANDSHAKE_WANT_READ</a></div><div class="ttdeci">@ TLS_HANDSHAKE_WANT_READ</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00549">SocketTLS.h:549</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cac9d764c27bc5b541bd5e7a4c42eddfce">TLS_HANDSHAKE_COMPLETE</a></div><div class="ttdeci">@ TLS_HANDSHAKE_COMPLETE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00551">SocketTLS.h:551</a></div></div>
<div class="ttc" id="agroup__security_html_ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac"><div class="ttname"><a href="group__security.html#ggad092160c037d01929df1bb8d5b75b43cad39cdf43af44417566b39aa9929f7aac">TLS_HANDSHAKE_WANT_WRITE</a></div><div class="ttdeci">@ TLS_HANDSHAKE_WANT_WRITE</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00550">SocketTLS.h:550</a></div></div>
<div class="ttc" id="agroup__socket__dgram_html_gabcb18c16142d3b5ef49bee08a96e15fa"><div class="ttname"><a href="group__socket__dgram.html#gabcb18c16142d3b5ef49bee08a96e15fa">SocketDgram_connect</a></div><div class="ttdeci">void SocketDgram_connect(SocketDgram_T socket, const char *host, int port)</div><div class="ttdoc">Set default destination for socket.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md610"></a>
Without Server Verification (Development Only)</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a">SocketDTLSContext_new_client</a>(NULL);  <span class="comment">// No</span></div>
<div class="line">verification</div>
<div class="line"><span class="comment">// WARNING: Insecure; use only for testing internal networks</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>The internal Arena_T manages all context-related memory, including loaded CA certs and temporary buffers. Freed automatically on context disposal. </dd>
<dd>
For client auth (mutual TLS), load client cert/key separately using <a class="el" href="group__dtls__context.html#ga52fb3ca5d16466a21ac871ad2217904c" title="Load and configure server certificate and private key into the DTLS context.">SocketDTLSContext_load_certificate()</a> after creation. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Disabling verification (ca_file=NULL) exposes connections to man-in-the-middle attacks. Always use trusted CAs in production. </dd>
<dd>
Ensure the CA bundle includes all necessary root and intermediate certificates to avoid verification failures.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) for context creation, O(n) for CA loading/parsing where n</dt><dd>is CA bundle size. OpenSSL initialization is O(1) but may block briefly for entropy gathering.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57" title="Create a server-side DTLS context with certificate and key loading.">SocketDTLSContext_new_server()</a> for server-side contexts. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga210798613a063bb2be1fdf07a5d9648c" title="Load trusted CA certificates.">SocketDTLSContext_load_ca()</a> for additional CA loading post-creation. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga090ce55e808027fc886ea6e6232b5a01" title="Advertise ALPN protocols.">SocketDTLSContext_set_alpn_protos()</a> for protocol negotiation. </dd>
<dd>
<a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> and <a class="el" href="group__security.html#gabf3857e3cea92190f4c6eca7a8418be3" title="Set SNI hostname for client DTLS connections.">SocketDTLS_set_hostname()</a> for socket integration. </dd>
<dd>
<a class="el" href="group__security.html#ga17e8bd79af2c5a20b5dbb9e8dff6f84c" title="Perform one step of the non-blocking DTLS handshake.">SocketDTLS_handshake()</a> for performing the DTLS handshake. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#tls-client-configuration for secure client setup guidelines. </dd></dl>

</div>
</div>
<a id="ga0e99fc1644e610eb26324fb12cb96a57" name="ga0e99fc1644e610eb26324fb12cb96a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0e99fc1644e610eb26324fb12cb96a57">&#9670;&#160;</a></span>SocketDTLSContext_new_server()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> SocketDTLSContext_new_server </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>cert_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>key_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ca_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a server-side DTLS context with certificate and key loading. </p>
<p>Initializes an OpenSSL SSL_CTX for DTLS server use, enforcing DTLS 1.2 minimum protocol, configuring modern secure cipher suites (ECDHE with AES-GCM or ChaCha20-Poly1305), loading the provided server certificate and private key, and optionally setting up CA certificates for client authentication. This function performs all initial setup required for secure DTLS server operation over UDP sockets.</p>
<p>Key features enabled by default:</p><ul>
<li>Protocol versions: DTLS 1.2 only (forward secrecy enforced)</li>
<li>Ciphers: High-security suites with perfect forward secrecy (PFS)</li>
<li>Certificate verification: Optional client cert auth via CA</li>
<li>Non-blocking compatible: Supports non-blocking socket I/O</li>
</ul>
<p>Cookie exchange for DoS protection (RFC 6347) is disabled by default to avoid compatibility issues with legacy clients. Enable explicitly with <a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> for production servers under attack risk.</p>
<p>After creation, further customize with set_mtu(), set_alpn_protos(), enable_session_cache(), or load additional certificates. Then apply to UDP sockets using <a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cert_file</td><td>Path to the server certificate file in PEM format. Must contain the full certificate chain if intermediate CAs are needed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_file</td><td>Path to the corresponding private key file in PEM or PKCS#8 format. The key must match the certificate; mismatch raises exception. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ca_file</td><td>Optional path to CA bundle file or directory containing PEM-encoded trusted CA certificates for verifying client certificates. Pass NULL to disable client authentication.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Newly created <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance, ready for further configuration or immediate use. Returns NULL only if exception is raised.</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>If:<ul>
<li>OpenSSL initialization or SSL_CTX creation fails</li>
<li>Certificate or key file cannot be read (ENOENT, EACCES)</li>
<li>Invalid PEM format in cert/key files</li>
<li>Private key does not match certificate public key</li>
<li>CA file/directory invalid or unreadable</li>
<li>Memory allocation failure in internal arena</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n Yes - Each call creates an independent context instance with its</dt><dd>own internal arena and SSL_CTX. Safe to call concurrently from multiple threads.</dd></dl>
<h2><a class="anchor" id="autotoc_md607"></a>
Basic Server Setup</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(<span class="stringliteral">&quot;server.crt&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;server.key&quot;</span>, <span class="stringliteral">&quot;ca-bundle.pem&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optional: Enable DoS protection</span></div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a>(ctx);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Optional: Set MTU for path</span></div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d">SocketDTLSContext_set_mtu</a>(ctx, 1400);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create UDP socket and enable DTLS</span></div>
<div class="line">    <a class="code hl_struct" href="SocketDgram-private_8h.html#structSocketDgram__T">SocketDgram_T</a> sock = <a class="code hl_function" href="group__socket__dgram.html#gad6902c87ab5883f155dab2adfa950c52">SocketDgram_new</a>(AF_INET, IPPROTO_UDP);</div>
<div class="line">    <a class="code hl_function" href="group__socket__dgram.html#ga0c81d9ef1d90e7ab34dd7286f13878ee">SocketDgram_bind</a>(sock, <span class="stringliteral">&quot;0.0.0.0&quot;</span>, 4433);</div>
<div class="line">    <a class="code hl_function" href="group__security.html#gad2f26460b23a711e0fa74605371cf127">SocketDTLS_enable</a>(sock, ctx);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now accept DTLS connections via SocketDTLS_accept() or similar</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">    <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;Failed to create DTLS context: %s&quot;</span>,</div>
<div class="line"><a class="code hl_function" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a>()); } <a class="code hl_define" href="group__foundation.html#ga0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> { <a class="code hl_function" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983">SocketDTLSContext_free</a>(&amp;ctx); } <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="agroup__dtls__context_html_ga473e4425731c220ae48a1bfec9ba279d"><div class="ttname"><a href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d">SocketDTLSContext_set_mtu</a></div><div class="ttdeci">void SocketDTLSContext_set_mtu(SocketDTLSContext_T ctx, size_t mtu)</div><div class="ttdoc">Configure the path MTU for DTLS record fragmentation and padding.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md608"></a>
With Session Caching</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(<span class="stringliteral">&quot;cert.pem&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;key.pem&quot;</span>, NULL); <a class="code hl_function" href="group__dtls__context.html#ga880ec894956f1a3a9029c512259df71b">SocketDTLSContext_enable_session_cache</a>(ctx, 1000, 3600);</div>
<div class="line"><span class="comment">// 1000 sessions, 1hr timeout</span></div>
<div class="line"><span class="comment">// ... rest of setup ...</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>This function internally creates an Arena_T for all allocations related to the context, including temporary buffers, ALPN data, and session cache. The arena is disposed automatically on <a class="el" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983" title="Dispose of a DTLS context, freeing all associated resources.">SocketDTLSContext_free()</a>. </dd>
<dd>
For production, always enable cookie exchange on public-facing servers to mitigate SYN flood-like attacks adapted for UDP (hello flood). </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure cert_file and key_file permissions are 0600; readable by server process only. Exposing private keys risks compromise. </dd>
<dd>
Client authentication (non-NULL ca_file) increases handshake latency; use only when required for security policy.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) for creation, plus O(n) for file I/O and PEM parsing where</dt><dd>n is file size. Certificate validation is O(1) but CPU-intensive for large chains.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#gafa2f96caa6d90a1fae0ce4f8fb52970a" title="Create a client-side DTLS context with optional CA for server verification.">SocketDTLSContext_new_client()</a> for client-side context creation. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga52fb3ca5d16466a21ac871ad2217904c" title="Load and configure server certificate and private key into the DTLS context.">SocketDTLSContext_load_certificate()</a> for loading certs after initial creation. </dd>
<dd>
<a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> for DoS protection. </dd>
<dd>
<a class="el" href="group__security.html#gad2f26460b23a711e0fa74605371cf127" title="Enable DTLS encryption on a datagram socket.">SocketDTLS_enable()</a> for applying context to UDP sockets. </dd>
<dd>
<a class="el" href="group__dtls__context.html#gaf05f6e0175668dd52a2d68af50f67983" title="Dispose of a DTLS context, freeing all associated resources.">SocketDTLSContext_free()</a> for cleanup. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> for TLS best practices and cipher recommendations. </dd></dl>

</div>
</div>
<a id="ga488bdfe1b7d278bbcb2d2f80a9540df5" name="ga488bdfe1b7d278bbcb2d2f80a9540df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga488bdfe1b7d278bbcb2d2f80a9540df5">&#9670;&#160;</a></span>SocketDTLSContext_rotate_cookie_secret()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_rotate_cookie_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rotate the DTLS cookie HMAC secret key to a new random value. </p>
<p>Generates a new cryptographically secure random secret key (SOCKET_DTLS_COOKIE_SECRET_LEN bytes) and updates the OpenSSL cookie generation callbacks to use it for subsequent HMAC operations. This limits the window for cookie replay attacks by invalidating previously issued cookies.</p>
<p>Recommended for production servers to call periodically (e.g., every 1-24 hours via timer) or on security events. Clients using old cookies will receive handshake failure and retry with a new ClientHello, incurring minimal extra latency under normal load but preventing long-term replay.</p>
<p>Requires cookie exchange enabled and a server context. The old secret is overwritten immediately; no fallback mechanism. For clustered setups, synchronize rotation across all nodes to avoid verification failures.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The server-side <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance with cookies enabled.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>If:<ul>
<li>ctx is NULL or not server-mode</li>
<li>Cookie exchange not enabled</li>
<li>Random number generation fails (low entropy, OpenSSL error)</li>
<li>Key storage or callback update fails</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - Generates and stores new secret, updates shared OpenSSL</dt><dd>state. Lock if context shared; call during low-traffic periods.</dd></dl>
<h2><a class="anchor" id="autotoc_md618"></a>
Periodic Rotation Setup</h2>
<div class="fragment"><div class="line"><span class="comment">// Using SocketTimer for hourly rotation</span></div>
<div class="line"><span class="keywordtype">void</span> rotation_cb(<span class="keywordtype">void</span> *userdata) {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> *ctx = userdata;</div>
<div class="line">    <a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">        <a class="code hl_function" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5">SocketDTLSContext_rotate_cookie_secret</a>(*ctx);</div>
<div class="line">        <a class="code hl_define" href="SocketUtil_8h.html#a9fe70c7ab8b971af2971f3a102b82819">SOCKET_LOG_INFO_MSG</a>(<span class="stringliteral">&quot;Cookie secret rotated for DoS protection.&quot;</span>);</div>
<div class="line">    } <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">        <a class="code hl_define" href="SocketUtil_8h.html#a16642c35dec627aeb4976538671b1552">SOCKET_LOG_ERROR_MSG</a>(<span class="stringliteral">&quot;Secret rotation failed: %s&quot;</span>,</div>
<div class="line"><a class="code hl_function" href="group__foundation.html#gac71a25566cdc9e11eaecb16c966081db">Socket_GetLastError</a>()); } <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// In server init after enable_cookie_exchange(ctx)</span></div>
<div class="line"><a class="code hl_struct" href="group__event__system.html#structSocketTimer__T">SocketTimer_T</a> timer = <a class="code hl_function" href="group__event__system.html#ga6961bde0e491d732450b66577294d097">SocketTimer_add_repeating</a>(poll, 3600000, rotation_cb,</div>
<div class="line">&amp;ctx);  <span class="comment">// 1hr</span></div>
<div class="ttc" id="aSocketUtil_8h_html_a9fe70c7ab8b971af2971f3a102b82819"><div class="ttname"><a href="SocketUtil_8h.html#a9fe70c7ab8b971af2971f3a102b82819">SOCKET_LOG_INFO_MSG</a></div><div class="ttdeci">#define SOCKET_LOG_INFO_MSG(fmt,...)</div><div class="ttdef"><b>Definition</b> <a href="SocketUtil_8h_source.html#l00540">SocketUtil.h:540</a></div></div>
<div class="ttc" id="agroup__event__system_html_ga6961bde0e491d732450b66577294d097"><div class="ttname"><a href="group__event__system.html#ga6961bde0e491d732450b66577294d097">SocketTimer_add_repeating</a></div><div class="ttdeci">SocketTimer_T SocketTimer_add_repeating(SocketPoll_T poll, int64_t interval_ms, SocketTimerCallback callback, void *userdata)</div><div class="ttdoc">Add a repeating (periodic) timer to the event poll.</div></div>
<div class="ttc" id="agroup__event__system_html_structSocketTimer__T"><div class="ttname"><a href="group__event__system.html#structSocketTimer__T">SocketTimer_T</a></div><div class="ttdoc">Internal representation of a single scheduled timer event.</div><div class="ttdef"><b>Definition</b> <a href="SocketTimer-private_8h_source.html#l00140">SocketTimer-private.h:141</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md619"></a>
Manual Rotation on Signal</h2>
<div class="fragment"><div class="line"><span class="comment">// In signal handler or admin command</span></div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5">SocketDTLSContext_rotate_cookie_secret</a>(ctx);</div>
<div class="line"><span class="comment">// Notify cluster nodes to rotate synchronously</span></div>
<div class="line">broadcast_rotation_signal();</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>New secret affects only new cookies; existing valid cookies (with old secret) remain verifiable until expiry (typically short, ~5-10 min per RFC). </dd>
<dd>
OpenSSL RAND_bytes() used for randomness; blocks if entropy low (rare on modern systems). </dd>
<dd>
Rotation increases brief handshake failures for in-flight clients, but enhances security. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>In clusters, unsynchronized rotation causes widespread handshake failures; use coordinated timing or key version in cookie. </dd>
<dd>
Frequent rotation ( &lt;1hr) increases client retries under load; balance security vs perf.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Random gen and update; RAND_bytes is O(1) amortized.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b" title="Configure the HMAC secret key for DTLS cookie generation.">SocketDTLSContext_set_cookie_secret()</a> for manual shared keys. </dd>
<dd>
<a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> prerequisite. </dd>
<dd>
SocketTimer for scheduling rotations. </dd>
<dd>
RFC 6347 Section 4.2.1 for cookie <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> and replay protection. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#rotation for key rotation best practices. </dd></dl>

</div>
</div>
<a id="ga090ce55e808027fc886ea6e6232b5a01" name="ga090ce55e808027fc886ea6e6232b5a01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga090ce55e808027fc886ea6e6232b5a01">&#9670;&#160;</a></span>SocketDTLSContext_set_alpn_protos()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_alpn_protos </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char **&#160;</td>
          <td class="paramname"><em>protos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Advertise ALPN protocols. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">protos</td><td>Array of null-terminated protocol strings (e.g., "coap", "h3") </td></tr>
    <tr><td class="paramname">count</td><td>Number of protocols</td></tr>
  </table>
  </dd>
</dl>
<p>Sets list of supported ALPN protocols in wire format, allocated from context arena. Validates lengths and formats for TLS compliance.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on invalid protos or allocation error </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>
<p>Note Protocols advertised in preference order (first preferred). </p>

</div>
</div>
<a id="gada5ef3bbfb37dfe6c7f92c09958cf75c" name="gada5ef3bbfb37dfe6c7f92c09958cf75c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gada5ef3bbfb37dfe6c7f92c09958cf75c">&#9670;&#160;</a></span>SocketDTLSContext_set_cipher_list()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_cipher_list </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>ciphers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set allowed cipher suites. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">ciphers</td><td>Cipher list string in OpenSSL format, or NULL for defaults</td></tr>
  </table>
  </dd>
</dl>
<p>Configures allowed ciphers. Defaults to secure modern list if NULL.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>if invalid list </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="ga19b67aa468ee1ad317683b1839b26e7b" name="ga19b67aa468ee1ad317683b1839b26e7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga19b67aa468ee1ad317683b1839b26e7b">&#9670;&#160;</a></span>SocketDTLSContext_set_cookie_secret()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_cookie_secret </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>secret</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configure the HMAC secret key for DTLS cookie generation. </p>
<p>Specifies the cryptographic secret key used by OpenSSL for HMAC-SHA256 signing of DTLS cookies in the hello verification exchange. This key ensures cookies generated by one server instance are verifiable by others in a cluster or load-balanced setup, enabling consistent DoS protection across multiple servers.</p>
<p>The key must be exactly SOCKET_DTLS_COOKIE_SECRET_LEN (typically 32 bytes) long for security and compatibility. Calling this after <a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> overrides the auto-generated random secret. For security, use cryptographically secure random bytes or derive from a master key with rotation.</p>
<p>Secret is stored in the internal arena and zeroed on context free. Rotation via <a class="el" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5" title="Rotate the DTLS cookie HMAC secret key to a new random value.">SocketDTLSContext_rotate_cookie_secret()</a> generates a new random key while preserving the length.</p>
<p>Only meaningful if cookie exchange is enabled; ignored otherwise. Client contexts do not use cookies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The server-side <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance with cookies enabled. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">secret</td><td>Buffer containing the secret key bytes. Copied internally; original can be zeroed after call for security. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of secret buffer in bytes. Must match SOCKET_DTLS_COOKIE_SECRET_LEN exactly or exception raised.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>If:<ul>
<li>ctx is NULL or not server-mode</li>
<li>len != SOCKET_DTLS_COOKIE_SECRET_LEN (compile-time constant)</li>
<li>Cookie exchange not enabled on ctx</li>
<li>Memory copy or storage fails (arena alloc)</li>
<li>OpenSSL callback update fails</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - Modifies shared secret and OpenSSL context state. External</dt><dd>locking required if context shared. Best called during setup before sharing.</dd></dl>
<h2><a class="anchor" id="autotoc_md616"></a>
Cluster Secret Configuration</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(<span class="stringliteral">&quot;cert.pem&quot;</span>,</div>
<div class="line"><span class="stringliteral">&quot;key.pem&quot;</span>, NULL); <a class="code hl_function" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4">SocketDTLSContext_enable_cookie_exchange</a>(ctx);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Load shared secret from secure storage or config</span></div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> shared_secret[32];</div>
<div class="line">    load_secure_key(shared_secret, <span class="keyword">sizeof</span>(shared_secret));  <span class="comment">// e.g., from</span></div>
<div class="line">HSM or file <a class="code hl_function" href="group__dtls__context.html#ga19b67aa468ee1ad317683b1839b26e7b">SocketDTLSContext_set_cookie_secret</a>(ctx, shared_secret,</div>
<div class="line"><span class="keyword">sizeof</span>(shared_secret)); secure_zero(shared_secret, <span class="keyword">sizeof</span>(shared_secret));</div>
<div class="line"><span class="comment">// Erase from memory</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// All cluster nodes must use same secret for compatibility</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Log and handle</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md617"></a>
Rotation with Shared Secret</h2>
<div class="fragment"><div class="line"><span class="comment">// After enable and set, rotate periodically</span></div>
<div class="line"><a class="code hl_function" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5">SocketDTLSContext_rotate_cookie_secret</a>(ctx);  <span class="comment">// Generates new random,</span></div>
<div class="line">invalidates old</div>
<div class="line"><span class="comment">// Update cluster nodes synchronously or use key derivation with timestamps</span></div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Secret is used in HMAC(cookie_data, secret) where cookie_data includes client IP, port, timestamp to prevent replay. Length 32 bytes for SHA256 security margin. </dd>
<dd>
For high-security, rotate secrets every 1-24 hours and distribute securely (e.g., via KMS or encrypted config). </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Weak or short secrets reduce HMAC security; use full-length random bytes. </dd>
<dd>
Mismatched secrets across cluster cause client handshake failures (retry ok but increases load). </dd>
<dd>
Secret stored in memory until context free; use mlock or similar for sensitive deployments.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Key copy and OpenSSL update; no crypto computation here.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#gabbffd63c9a5c7551ecaf8f89a4034eb4" title="Enable cookie exchange mechanism for stateless DoS protection in DTLS servers.">SocketDTLSContext_enable_cookie_exchange()</a> prerequisite. </dd>
<dd>
<a class="el" href="group__dtls__context.html#ga488bdfe1b7d278bbcb2d2f80a9540df5" title="Rotate the DTLS cookie HMAC secret key to a new random value.">SocketDTLSContext_rotate_cookie_secret()</a> for auto-rotation. </dd>
<dd>
RFC 6347 for cookie format and <a class="el" href="group__security.html" title="Comprehensive security protections for network applications.">Security Modules</a> considerations. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a>#key-management for best practices on secret handling. </dd></dl>

</div>
</div>
<a id="ga47bb5aa1a1eafa97c6e026d5b66b0ad9" name="ga47bb5aa1a1eafa97c6e026d5b66b0ad9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47bb5aa1a1eafa97c6e026d5b66b0ad9">&#9670;&#160;</a></span>SocketDTLSContext_set_max_protocol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_max_protocol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set maximum supported DTLS version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">version</td><td>OpenSSL version constant (e.g., DTLS1_2_VERSION)</td></tr>
  </table>
  </dd>
</dl>
<p>Sets maximum DTLS version.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>if cannot set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="gad674b683e396a1af639691d9a18c6aa0" name="gad674b683e396a1af639691d9a18c6aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad674b683e396a1af639691d9a18c6aa0">&#9670;&#160;</a></span>SocketDTLSContext_set_min_protocol()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_min_protocol </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set minimum supported DTLS version. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">version</td><td>OpenSSL version constant (e.g., DTLS1_2_VERSION)</td></tr>
  </table>
  </dd>
</dl>
<p>Sets minimum DTLS version. Default is DTLS 1.2.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>if cannot set </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="ga473e4425731c220ae48a1bfec9ba279d" name="ga473e4425731c220ae48a1bfec9ba279d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga473e4425731c220ae48a1bfec9ba279d">&#9670;&#160;</a></span>SocketDTLSContext_set_mtu()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_mtu </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>mtu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configure the path MTU for DTLS record fragmentation and padding. </p>
<p>Sets the maximum transmission unit (MTU) value used by OpenSSL to fragment DTLS records and add IP/UDP headers in path MTU discovery. This prevents IP fragmentation on the network path, reducing overhead and avoiding blackhole routers that drop fragmented packets.</p>
<p>Default (if not set) is a conservative 1200 bytes to accommodate IPv6 headers (40B), UDP (8B), DTLS record overhead (~13B), and common VPN/tunnel encapsulations. For known paths (e.g., LAN 1500 MTU), set higher for better throughput. Values below 512 or above 65535 raise exception.</p>
<p>Applies to all SSL objects created from this context. Per-socket override possible via <a class="el" href="group__security.html#ga804d5dd4b27255e3c9c28c58a2914a18" title="Set per-connection MTU for DTLS record sizing.">SocketDTLS_set_mtu()</a> if needed. Recommended to probe actual path MTU using ICMP or packet traces for optimal setting.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>The <a class="el" href="group__security.html#structSocketDTLSContext__T" title="SocketDTLSContext_T - DTLS Context Structure.">SocketDTLSContext_T</a> instance. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mtu</td><td>MTU in bytes (512-65535). Should include IP+UDP headers; OpenSSL subtracts them internally for record sizing.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>If mtu out of valid range ( &lt;512 or &gt;65535) or ctx invalid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No - Updates shared SSL_CTX MTU configuration. Synchronize if</dt><dd>shared.</dd></dl>
<h2><a class="anchor" id="autotoc_md620"></a>
MTU Setup for Different Networks</h2>
<div class="fragment"><div class="line"><a class="code hl_define" href="group__foundation.html#gad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_struct" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a> ctx = <a class="code hl_function" href="group__dtls__context.html#ga0e99fc1644e610eb26324fb12cb96a57">SocketDTLSContext_new_server</a>(...);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// LAN: full Ethernet MTU</span></div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d">SocketDTLSContext_set_mtu</a>(ctx, 1472);  <span class="comment">// 1500 - IP(20) - UDP(8)</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// VPN or IPv6: conservative</span></div>
<div class="line">    <span class="comment">// SocketDTLSContext_set_mtu(ctx, 1200); // Default safe</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Custom probe</span></div>
<div class="line">    <span class="keywordtype">size_t</span> probed_mtu = probe_path_mtu(<span class="stringliteral">&quot;remote.ip&quot;</span>, port);</div>
<div class="line">    <a class="code hl_function" href="group__dtls__context.html#ga473e4425731c220ae48a1bfec9ba279d">SocketDTLSContext_set_mtu</a>(ctx, probed_mtu - DTLS_OVERHEAD);</div>
<div class="line"> </div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="group__security.html#ga083605c4d8e6ea5658b72883f8e41be9">SocketDTLS_Failed</a>) {</div>
<div class="line">    <span class="comment">// Fallback to default</span></div>
<div class="line">} <a class="code hl_define" href="group__foundation.html#gae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>OpenSSL uses mtu for DTLS1_RECORD_OVERHEAD calculation; too low causes excessive fragmentation, too high risks packet drops. </dd>
<dd>
For UDP, actual path MTU includes IP+UDP headers (~28B IPv4, 48B IPv6); set accordingly. </dd>
<dd>
Change invalidates any pre-allocated buffers; test handshakes after set. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Incorrect MTU causes performance degradation or connection failures; always test on target network. </dd>
<dd>
Larger MTU improves throughput but increases latency if fragmentation occurs.</dd></dl>
<dl class="section user"><dt>Complexity\n O(1) - Simple config set on SSL_CTX.</dt><dd></dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__dtls__context.html#ga9edc0ddb77ac1a52c2d65e202d6c4fdc" title="Retrieve the currently configured path MTU from the DTLS context.">SocketDTLSContext_get_mtu()</a> to query current value. </dd>
<dd>
<a class="el" href="group__security.html#ga804d5dd4b27255e3c9c28c58a2914a18" title="Set per-connection MTU for DTLS record sizing.">SocketDTLS_set_mtu()</a> for per-socket override. </dd>
<dd>
RFC 6347 Section 4.2.3 for DTLS fragmentation details. </dd>
<dd>
<a class="el" href="ASYNC__IO_8md.html">docs/ASYNC_IO.md</a> for UDP path considerations in async I/O. </dd></dl>

</div>
</div>
<a id="gaf81e36256b380aaf7060607a22842d20" name="gaf81e36256b380aaf7060607a22842d20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf81e36256b380aaf7060607a22842d20">&#9670;&#160;</a></span>SocketDTLSContext_set_timeout()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_timeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>initial_ms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_ms</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set handshake timeout parameters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">initial_ms</td><td>Initial retransmission timeout in milliseconds </td></tr>
    <tr><td class="paramname">max_ms</td><td>Maximum timeout after exponential backoff</td></tr>
  </table>
  </dd>
</dl>
<p>Configures DTLS handshake retransmission timer. OpenSSL handles retransmission internally using these parameters.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">SocketDTLS_Failed</td><td>on invalid parameters </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
<a id="ga167f13bc2d88dd59da040a6423cbb741" name="ga167f13bc2d88dd59da040a6423cbb741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga167f13bc2d88dd59da040a6423cbb741">&#9670;&#160;</a></span>SocketDTLSContext_set_verify_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void SocketDTLSContext_set_verify_mode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__security.html#structSocketDTLSContext__T">SocketDTLSContext_T</a>&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__security.html#gac32c3958835b92ff683ae15f78448694">TLSVerifyMode</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set certificate verification policy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The DTLS context instance </td></tr>
    <tr><td class="paramname">mode</td><td>Verification mode enum (TLS_VERIFY_NONE, PEER, etc.)</td></tr>
  </table>
  </dd>
</dl>
<p>Configures peer cert verification behavior, mapping to OpenSSL SSL_VERIFY_* flags.</p>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>
<dl class="section note"><dt>Note</dt><dd>Maps provided flags to OpenSSL SSL_VERIFY_* constants; invalid or unsupported flags are ignored without error. </dd></dl>
<dl class="section user"><dt>Thread Safety\n No</dt><dd></dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<footer class="footer">
  <div style="max-width: 960px; margin: 0 auto; padding: 40px 24px;">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 40px;">
      <!-- Brand -->
      <div style="flex: 1; min-width: 200px;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 6px;"></div>
          <span style="font-size: 1rem; font-weight: 600; color: #f7f9fa;">Socket Library</span>
        </div>
        <p style="color: #8b98a5; font-size: 0.8125rem; line-height: 1.6; margin: 0;">
          High-performance socket toolkit for POSIX systems with exception-based error handling and TLS 1.3 support.
        </p>
      </div>
      <!-- Links -->
      <div style="display: flex; gap: 48px; flex-wrap: wrap;">
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Documentation</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="index.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Getting Started</a></li>
            <li style="margin: 6px 0;"><a href="annotated.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Data Structures</a></li>
            <li style="margin: 6px 0;"><a href="globals.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">API Reference</a></li>
          </ul>
        </div>
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Resources</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="files.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Header Files</a></li>
            <li style="margin: 6px 0;"><a href="https://x.com/tetsuocorp" target="_blank" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Twitter/X</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Bottom -->
    <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #30363d; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
      <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 0.75rem; font-weight: 500; color: #10b981; background: rgba(16, 185, 129, 0.1); padding: 4px 8px; border-radius: 4px;">C11</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #3b82f6; background: rgba(59, 130, 246, 0.1); padding: 4px 8px; border-radius: 4px;">POSIX</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #8b5cf6; background: rgba(139, 92, 246, 0.1); padding: 4px 8px; border-radius: 4px;">TLS 1.3</span>
      </div>
      <div style="color: #6e7681; font-size: 0.75rem; display: flex; align-items: center; gap: 8px;">
        <span> 2025 Tetsuo Corporation</span>
        <span style="color: #30363d;"></span>
        <a href="https://opensource.org/licenses/MIT" target="_blank" style="color: #8b98a5; text-decoration: none;">MIT License</a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
