<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="High-performance, exception-driven socket toolkit for POSIX systems">
<meta name="keywords" content="socket, networking, C, POSIX, TCP, UDP, TLS, async, high-performance, library">
<meta name="author" content="Tetsuo Corporation">
<meta name="theme-color" content="#3b82f6">
<title>SocketProxy-private.h Source File</title>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%233b82f6'/><stop offset='100%25' stop-color='%238b5cf6'/></linearGradient></defs><rect width='100' height='100' rx='20' fill='url(%23g)'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white' font-family='sans-serif' font-weight='bold'>S</text></svg>">
</head>
<body>
<div id="top">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Socket Library<span id="projectnumber">1.0.0</span></div>
   <div id="projectbrief">High-performance, exception-driven socket toolkit for POSIX systems</div>
  </td>
  <td style="text-align: right; padding: 20px; vertical-align: middle;">
    <div style="display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap; align-items: center;">
      <a href="index.html" class="quick-link">Home</a>
      <a href="annotated.html" class="quick-link">Structures</a>
      <a href="files.html" class="quick-link">Files</a>
      <a href="globals.html" class="quick-link">API</a>
    </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('SocketProxy-private_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">SocketProxy-private.h</div></div>
</div><!--header-->
<div class="contents">
<a href="SocketProxy-private_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#ifndef SOCKETPROXY_PRIVATE_INCLUDED</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#define SOCKETPROXY_PRIVATE_INCLUDED</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">#include &quot;<a class="code" href="Arena_8h.html">core/Arena.h</a>&quot;</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">#include &quot;<a class="code" href="SocketUtil_8h.html">core/SocketUtil.h</a>&quot;</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">#include &quot;<a class="code" href="SocketDNS_8h.html">dns/SocketDNS.h</a>&quot;</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="preprocessor">#include &quot;<a class="code" href="SocketHTTP1_8h.html">http/SocketHTTP1.h</a>&quot;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">#include &quot;<a class="code" href="SocketPoll_8h.html">poll/SocketPoll.h</a>&quot;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="preprocessor">#include &quot;<a class="code" href="Socket_8h.html">socket/Socket.h</a>&quot;</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="preprocessor">#include &quot;<a class="code" href="SocketBuf_8h.html">socket/SocketBuf.h</a>&quot;</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="preprocessor">#include &quot;<a class="code" href="SocketHappyEyeballs_8h.html">socket/SocketHappyEyeballs.h</a>&quot;</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="preprocessor">#include &quot;<a class="code" href="SocketProxy_8h.html">socket/SocketProxy.h</a>&quot;</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span><span class="preprocessor">#ifndef SOCKET_PROXY_ERROR_BUFSIZE</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga787c1af36f15b60e2f85339f94bfbe49">  104</a></span><span class="preprocessor">#define SOCKET_PROXY_ERROR_BUFSIZE 256</span></div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span><span class="preprocessor">#ifndef SOCKET_PROXY_BUFFER_SIZE</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gadfe4c6b10bc2da57d2677a32a8fc2f02">  121</a></span><span class="preprocessor">#define SOCKET_PROXY_BUFFER_SIZE 65536</span></div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="preprocessor">#ifndef SOCKET_PROXY_MAX_URL_LEN</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga9af35160f08629ec1a5b5700581c9a34">  136</a></span><span class="preprocessor">#define SOCKET_PROXY_MAX_URL_LEN 2048</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span><span class="preprocessor">#ifndef SOCKET_PROXY_STATIC_BUFFER_SIZE</span></div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga0f936941652891a3270993b5bd57730d">  152</a></span><span class="preprocessor">#define SOCKET_PROXY_STATIC_BUFFER_SIZE 1024</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga9f5752234c11ead463ea1e91cf03a2ad">  164</a></span><span class="preprocessor">#define SOCKET_PROXY_MS_PER_SEC 1000</span></div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga52309497faa9acfa9ff1c6c143ef7d07">  177</a></span><span class="preprocessor">#define SOCKET_PROXY_NS_PER_MS 1000000LL</span></div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span><span class="preprocessor">#ifndef SOCKET_PROXY_DEFAULT_POLL_TIMEOUT_MS</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gad7c7855b84a0bc59ee29df1d16f3b390">  191</a></span><span class="preprocessor">#define SOCKET_PROXY_DEFAULT_POLL_TIMEOUT_MS 1000</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga4c409afdc74bda0aa590309dbfb60e83">  223</a></span><span class="preprocessor">#define SOCKS4_VERSION 4</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gab3df315d612ee6df173a2567c464ed7e">  231</a></span><span class="preprocessor">#define SOCKS4_CMD_CONNECT 1</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span> </div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga7df58477af7c9a978ce11fb41564d4c1">  239</a></span><span class="preprocessor">#define SOCKS4_REPLY_GRANTED 90</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gad060585ee25e3b3b62753d0a57c662ef">  240</a></span><span class="preprocessor">#define SOCKS4_REPLY_REJECTED 91</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gac55e6af1d26c1b104efbf39e27553947">  241</a></span><span class="preprocessor">#define SOCKS4_REPLY_NO_IDENTD 92</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga1923310fdf482b7aebd613652b7eb2bf">  242</a></span><span class="preprocessor">#define SOCKS4_REPLY_IDENTD_MISMATCH 93</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga5b416217434efd51f168a4d339a92eb3">  250</a></span><span class="preprocessor">#define SOCKS5_VERSION 5</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga341dfd976e8ded0551eba1d09d4818c9">  258</a></span><span class="preprocessor">#define SOCKS5_AUTH_VERSION 1</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga7f574e2ab614cc6e85d36a9fa363c59d">  267</a></span><span class="preprocessor">#define SOCKS5_AUTH_NONE 0x00</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gabd8de982ea3b948d3a1258ca8b36699d">  268</a></span><span class="preprocessor">#define SOCKS5_AUTH_GSSAPI 0x01</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga899b27c99a9931c5696e2f82660a5747">  269</a></span><span class="preprocessor">#define SOCKS5_AUTH_PASSWORD 0x02</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gad4d23c2ae0d1914d13bb1cb21863c8db">  270</a></span><span class="preprocessor">#define SOCKS5_AUTH_NO_ACCEPTABLE 0xFF</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga108e237a994aebc73ad3bbcf141b6de4">  278</a></span><span class="preprocessor">#define SOCKS5_CMD_CONNECT 0x01</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gae1581edc98795710ca1a7995170c0594">  279</a></span><span class="preprocessor">#define SOCKS5_CMD_BIND 0x02</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga18469924a98b80175ed350975ac5ffdb">  280</a></span><span class="preprocessor">#define SOCKS5_CMD_UDP_ASSOCIATE 0x03</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga9be4c9660ff9166120889c3680d91539">  289</a></span><span class="preprocessor">#define SOCKS5_ATYP_IPV4 0x01</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga14afd87de02a66fe870f981f9efe9862">  290</a></span><span class="preprocessor">#define SOCKS5_ATYP_DOMAIN 0x03</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga64e32f131e3d76116ebec676d9866594">  291</a></span><span class="preprocessor">#define SOCKS5_ATYP_IPV6 0x04</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gac61a81038f320a72896daefe88499731">  300</a></span><span class="preprocessor">#define SOCKS5_REPLY_SUCCESS 0x00</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga29296d14962426df565a8032fc35f17d">  301</a></span><span class="preprocessor">#define SOCKS5_REPLY_GENERAL_FAILURE 0x01</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gae5d6ec38590c939fd2badd59f50fb67a">  302</a></span><span class="preprocessor">#define SOCKS5_REPLY_NOT_ALLOWED 0x02</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gaae81fa32c9a7e2b16ac437ddccf8459a">  303</a></span><span class="preprocessor">#define SOCKS5_REPLY_NETWORK_UNREACHABLE 0x03</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gaf97dacb625f06c93f7af9297a66373e6">  304</a></span><span class="preprocessor">#define SOCKS5_REPLY_HOST_UNREACHABLE 0x04</span></div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga734956bbb3cba2c1c28b62ca06000442">  305</a></span><span class="preprocessor">#define SOCKS5_REPLY_CONNECTION_REFUSED 0x05</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga7f1453ad2ffabd1b55a8449044544951">  306</a></span><span class="preprocessor">#define SOCKS5_REPLY_TTL_EXPIRED 0x06</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga89e495f86e65eb8e16b3627a4746bdf6">  307</a></span><span class="preprocessor">#define SOCKS5_REPLY_COMMAND_NOT_SUPPORTED 0x07</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga959bad341e17a9074582254d97b2ca91">  308</a></span><span class="preprocessor">#define SOCKS5_REPLY_ADDRESS_TYPE_NOT_SUPPORTED 0x08</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span> </div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga8acf82fb4990e729e3d2173f897484c1">  316</a></span><span class="preprocessor">#define SOCKS5_IPV4_ADDR_SIZE 4  </span></div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga13428a508dd2f201ff1a4c348b600ab3">  317</a></span><span class="preprocessor">#define SOCKS5_IPV6_ADDR_SIZE 16 </span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gac06606832cfef92d3ffea479fff6d709">  318</a></span><span class="preprocessor">#define SOCKS5_PORT_SIZE 2       </span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gaf311c4dffb9708d0a95e14abaa8f11dd">  326</a></span><span class="preprocessor">#define SOCKS5_METHOD_RESPONSE_SIZE 2 </span></div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga6f777fd21e113340db6dc6b29615bccd">  327</a></span><span class="preprocessor">#define SOCKS5_AUTH_RESPONSE_SIZE 2   </span></div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga3b6c9b679741441ebb94976c60debdd9">  328</a></span><span class="preprocessor">#define SOCKS5_CONNECT_HEADER_SIZE 4  </span></div>
<div class="foldopen" id="foldopen00336" data-start="" data-end="">
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga9988f978dd580fa47a6806c10b396b6e">  336</a></span><span class="preprocessor">#define SOCKS5_CONNECT_IPV4_RESPONSE_SIZE                                     \</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span><span class="preprocessor">  (SOCKS5_CONNECT_HEADER_SIZE + SOCKS5_IPV4_ADDR_SIZE + SOCKS5_PORT_SIZE)</span></div>
</div>
<div class="foldopen" id="foldopen00338" data-start="" data-end="">
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gab22b33a4f85b73bdcce74accde1798f4">  338</a></span><span class="preprocessor">#define SOCKS5_CONNECT_IPV6_RESPONSE_SIZE                                     \</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="preprocessor">  (SOCKS5_CONNECT_HEADER_SIZE + SOCKS5_IPV6_ADDR_SIZE + SOCKS5_PORT_SIZE)</span></div>
</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span><span class="comment"> * Internal Protocol State</span></div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="comment"> */</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="foldopen" id="foldopen00364" data-start="{" data-end="};">
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">  364</a></span><span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>{</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493caf5542717d2ee90d3d17b63b4cf6ece64">PROTO_STATE_INIT</a> = 0, </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>  <span class="comment">/* SOCKS5 states (RFC 1928 multi-step negotiation) */</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cafba3acda31e424f195898a8ba5488940">PROTO_STATE_SOCKS5_GREETING_SENT</a>, </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca8767b75e57730c4169d8e5299fbf81f7">PROTO_STATE_SOCKS5_METHOD_RECEIVED</a>, </div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cad9cbdb2e2397158bbd069ababd33e7af">PROTO_STATE_SOCKS5_AUTH_SENT</a>, </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca429c6f1b7b064fcfe594a9de4d5bd85b">PROTO_STATE_SOCKS5_AUTH_RECEIVED</a>, </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493caf20756c410fcc0f622ea89994f10c81a">PROTO_STATE_SOCKS5_CONNECT_SENT</a>, </div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca4cf8dced08ab39ea15cda595922bf111">PROTO_STATE_SOCKS5_CONNECT_RECEIVED</a>, </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>  <span class="comment">/* SOCKS4/4a states (simpler single request/response cycle) */</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca4111e707281eccc70e9e6aa97777a1a9">PROTO_STATE_SOCKS4_CONNECT_SENT</a>, </div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca798e97b768cc911a58b89bca9e242d08">PROTO_STATE_SOCKS4_CONNECT_RECEIVED</a>, </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>  <span class="comment">/* HTTP CONNECT states (RFC 7230 Section 5.3 for tunneling) */</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cac2f57b720922a9a40199634cf679beb2">PROTO_STATE_HTTP_REQUEST_SENT</a>, </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca6ebbcb3c7028113f0d93a18a1fa96155">PROTO_STATE_HTTP_RESPONSE_RECEIVED</a>, </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  <span class="comment">/* Terminal state */</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>  <a class="code hl_enumvalue" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca385541d759585795ce1310609ec3d6bd">PROTO_STATE_DONE</a> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca385541d759585795ce1310609ec3d6bd">  406</a></span>} <a class="code hl_enumeration" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">SocketProxy_ProtoState</a>;</div>
</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span> </div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span><span class="comment">/* Override log component for this module */</span></div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span><span class="preprocessor">#undef SOCKET_LOG_COMPONENT</span></div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gae461bf5ddae6eda683926a6303af87f6">  443</a></span><span class="preprocessor">#define SOCKET_LOG_COMPONENT &quot;Proxy&quot;</span></div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gabe33454412b97fd3d344b2bbfd042b2d">  469</a></span><span class="preprocessor">#define PROXY_ERROR_FMT(fmt, ...) SOCKET_ERROR_FMT (fmt, ##__VA_ARGS__)</span></div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span> </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga1e37b31329a2b2041a65e255cc2a77d8">  484</a></span><span class="preprocessor">#define PROXY_ERROR_MSG(fmt, ...) SOCKET_ERROR_MSG (fmt, ##__VA_ARGS__)</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gae79febff78c4084b69989b8b3099ae33">  502</a></span><span class="preprocessor">#define RAISE_PROXY_ERROR(e) SOCKET_RAISE_MODULE_ERROR (Proxy, e)</span></div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span> </div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span><span class="comment"> * Main Context Structure</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span><span class="comment"> */</span></div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="foldopen" id="foldopen00552" data-start="{" data-end="};">
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno"><a class="line" href="group__proxy__private.html">  552</a></span><span class="keyword">struct </span><a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a></div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>{</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>  <span class="comment">/* Configuration (copied from user) */</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a894986448a6771af2c160558763cf5cc">  555</a></span>  <a class="code hl_enumeration" href="group__core__io.html#gaaa33f7bdae951cc7b53a2fb049e89132">SocketProxyType</a> <a class="code hl_variable" href="group__proxy__private.html#a894986448a6771af2c160558763cf5cc">type</a>;     </div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a0e96e5f0261bce7086ad5cc7af7e4b08">  556</a></span>  <span class="keywordtype">char</span> *<a class="code hl_variable" href="group__proxy__private.html#a0e96e5f0261bce7086ad5cc7af7e4b08">proxy_host</a>;         </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a11cf9d48eaae7621057f67b9589edf6b">  557</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#a11cf9d48eaae7621057f67b9589edf6b">proxy_port</a>;           </div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ad2b795e71eb9323949e6384665970a84">  558</a></span>  <span class="keywordtype">char</span> *<a class="code hl_variable" href="group__proxy__private.html#ad2b795e71eb9323949e6384665970a84">username</a>;           </div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a7d71e6abcb8cb29cc286d94caa492142">  559</a></span>  <span class="keywordtype">char</span> *<a class="code hl_variable" href="group__proxy__private.html#a7d71e6abcb8cb29cc286d94caa492142">password</a>;           </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a257faf2aa4300a913c14f65c5941e820">  560</a></span>  <span class="keywordtype">char</span> *<a class="code hl_variable" href="group__proxy__private.html#a257faf2aa4300a913c14f65c5941e820">target_host</a>;        </div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ae390638a08d19534bc6d0e698b4da476">  561</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#ae390638a08d19534bc6d0e698b4da476">target_port</a>;          </div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ae0aebb2175653871184fe8875f57c633">  562</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#ae0aebb2175653871184fe8875f57c633">connect_timeout_ms</a>;   </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno"><a class="line" href="group__proxy__private.html#aa314392e96e493c77a1deed89728e43c">  563</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#aa314392e96e493c77a1deed89728e43c">handshake_timeout_ms</a>; </div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a2224b074511d1fe06fdcae44d6953dc5">  564</a></span>  SocketHTTP_Headers_T <a class="code hl_variable" href="group__proxy__private.html#a2224b074511d1fe06fdcae44d6953dc5">extra_headers</a>; </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span><span class="preprocessor">#if SOCKET_HAS_TLS</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a5a7d11532a403ff7f63d99eac1186617">  566</a></span>  <a class="code hl_struct" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a> <a class="code hl_variable" href="group__proxy__private.html#a5a7d11532a403ff7f63d99eac1186617">tls_ctx</a>; </div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a4858544617c2129855e2b8574df86cf7">  567</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#a4858544617c2129855e2b8574df86cf7">tls_enabled</a>;            </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span> </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>  <span class="comment">/* Internal resources (owned) */</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a083369e24cff29efd9dc20163e541a16">  571</a></span>  <a class="code hl_typedef" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> <a class="code hl_variable" href="group__proxy__private.html#a083369e24cff29efd9dc20163e541a16">arena</a>;       </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a2c3fc65e5bee85f64a52dea4c4efeb33">  572</a></span>  Socket_T <a class="code hl_variable" href="group__proxy__private.html#a2c3fc65e5bee85f64a52dea4c4efeb33">socket</a>;     </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno"><a class="line" href="group__proxy__private.html#aafa5f04a528b20448930f6524568beb2">  573</a></span>  <a class="code hl_typedef" href="group__core__io.html#gad4b3ec10874282833e1b15760efa1b6c">SocketBuf_T</a> <a class="code hl_variable" href="group__proxy__private.html#aafa5f04a528b20448930f6524568beb2">recvbuf</a>; </div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>  <span class="comment">/* Async connection resources */</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a431a582be92ea3900cddfcf6ace76048">  576</a></span>  <a class="code hl_struct" href="group__dns.html#structSocketDNS__T">SocketDNS_T</a> <a class="code hl_variable" href="group__proxy__private.html#a431a582be92ea3900cddfcf6ace76048">dns</a>;   </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a84361c1bf1c9efec61171b729effa6e1">  577</a></span>  SocketPoll_T <a class="code hl_variable" href="group__proxy__private.html#a84361c1bf1c9efec61171b729effa6e1">poll</a>; </div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a2153b2db669de8d281e0139a91c7c92e">  578</a></span>  <a class="code hl_struct" href="group__async__io.html#structSocketHE__T">SocketHE_T</a> <a class="code hl_variable" href="group__proxy__private.html#a2153b2db669de8d281e0139a91c7c92e">he</a>;     </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a548c64d7e226630e791314c204c547c4">  579</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#a548c64d7e226630e791314c204c547c4">owns_dns_poll</a>; </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>  <span class="comment">/* HTTP CONNECT specific */</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a901962a8ee7faa216d870d2394a8d17d">  582</a></span>  SocketHTTP1_Parser_T <a class="code hl_variable" href="group__proxy__private.html#a901962a8ee7faa216d870d2394a8d17d">http_parser</a>; </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>  <span class="comment">/* State machine */</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a6676b0ed3643ee6154d26738af148a99">  585</a></span>  <a class="code hl_enumeration" href="group__core__io.html#gaf9f1c72bfcb303aa9ee5dae6d903b9be">SocketProxy_State</a> <a class="code hl_variable" href="group__proxy__private.html#a6676b0ed3643ee6154d26738af148a99">state</a>;            </div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a813513bee1ea5117ffea491c85edcd81">  586</a></span>  <a class="code hl_enumeration" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">SocketProxy_ProtoState</a> <a class="code hl_variable" href="group__proxy__private.html#a813513bee1ea5117ffea491c85edcd81">proto_state</a>; </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a5e794c6894f28dda56acf59529745a7e">  587</a></span>  <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a> <a class="code hl_variable" href="group__proxy__private.html#a5e794c6894f28dda56acf59529745a7e">result</a>;          </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  <span class="comment">/* SOCKS5 state */</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno"><a class="line" href="group__proxy__private.html#af601d7eeeb78ef4fe2c694ad20ee6f44">  590</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#af601d7eeeb78ef4fe2c694ad20ee6f44">socks5_auth_method</a>; </div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a4fa34ec2122d2d9c4a3718565359c86b">  591</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#a4fa34ec2122d2d9c4a3718565359c86b">socks5_need_auth</a>;   </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  <span class="comment">/* Timing */</span></div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a82625ab8fed897529b509e9caf5461b8">  594</a></span>  int64_t <a class="code hl_variable" href="group__proxy__private.html#a82625ab8fed897529b509e9caf5461b8">start_time_ms</a>;           </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ac8dbe4bd33e376a5595c7966f9f40113">  595</a></span>  int64_t <a class="code hl_variable" href="group__proxy__private.html#ac8dbe4bd33e376a5595c7966f9f40113">handshake_start_time_ms</a>; </div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  <span class="comment">/* I/O state */</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a64870d3e5ff24323c4d1566bc1fb06c6">  598</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="group__proxy__private.html#a64870d3e5ff24323c4d1566bc1fb06c6">send_buf</a>[<a class="code hl_define" href="group__proxy__private.html#gadfe4c6b10bc2da57d2677a32a8fc2f02">SOCKET_PROXY_BUFFER_SIZE</a>]; </div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno"><a class="line" href="group__proxy__private.html#af843e68c0b6e0e73085fc72e3a28823d">  599</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="group__proxy__private.html#af843e68c0b6e0e73085fc72e3a28823d">send_len</a>;                                  </div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno"><a class="line" href="group__proxy__private.html#abcf5a9fbce4f4235b67e65f35833611c">  600</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="group__proxy__private.html#abcf5a9fbce4f4235b67e65f35833611c">send_offset</a>;                               </div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a614ffa636c6ca6f92b39f8af950c50a3">  601</a></span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="group__proxy__private.html#a614ffa636c6ca6f92b39f8af950c50a3">recv_buf</a>[<a class="code hl_define" href="group__proxy__private.html#gadfe4c6b10bc2da57d2677a32a8fc2f02">SOCKET_PROXY_BUFFER_SIZE</a>]; </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a74f03365dce0726d5f66c35f561b742b">  602</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="group__proxy__private.html#a74f03365dce0726d5f66c35f561b742b">recv_len</a>;    </div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a63bb3dea323c1f69e223786294aac653">  603</a></span>  <span class="keywordtype">size_t</span> <a class="code hl_variable" href="group__proxy__private.html#a63bb3dea323c1f69e223786294aac653">recv_offset</a>; </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  <span class="comment">/* Error tracking */</span></div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno"><a class="line" href="group__proxy__private.html#aaaed59222364e1228661678468b42283">  606</a></span>  <span class="keywordtype">char</span> <a class="code hl_variable" href="group__proxy__private.html#aaaed59222364e1228661678468b42283">error_buf</a>[<a class="code hl_define" href="group__proxy__private.html#ga787c1af36f15b60e2f85339f94bfbe49">SOCKET_PROXY_ERROR_BUFSIZE</a>]; </div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno"><a class="line" href="group__proxy__private.html#a12a3779149de75f678c5c1329e6cf88c">  607</a></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="group__proxy__private.html#a12a3779149de75f678c5c1329e6cf88c">transferred</a>; </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>};</div>
</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span> </div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span><span class="comment"> * Internal Helper Functions - Time</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span><span class="comment"> */</span></div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span><span class="keyword">static</span> <span class="keyword">inline</span> int64_t</div>
<div class="foldopen" id="foldopen00630" data-start="{" data-end="}">
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno"><a class="line" href="group__core__io.html#ga89a14153269ffab409e6ebfaf6deebdd">  630</a></span><a class="code hl_function" href="group__core__io.html#ga89a14153269ffab409e6ebfaf6deebdd">socketproxy_get_time_ms</a> (<span class="keywordtype">void</span>)</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>{</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  <span class="keyword">struct </span>timespec ts;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>  <span class="keywordflow">if</span> (clock_gettime (CLOCK_MONOTONIC, &amp;ts) &lt; 0)</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span> </div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <span class="keywordflow">return</span> (int64_t)ts.tv_sec * <a class="code hl_define" href="group__proxy__private.html#ga9f5752234c11ead463ea1e91cf03a2ad">SOCKET_PROXY_MS_PER_SEC</a></div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>         + (int64_t)ts.tv_nsec / <a class="code hl_define" href="group__proxy__private.html#ga52309497faa9acfa9ff1c6c143ef7d07">SOCKET_PROXY_NS_PER_MS</a>;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>}</div>
</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span><span class="keyword">static</span> <span class="keyword">inline</span> int64_t</div>
<div class="foldopen" id="foldopen00656" data-start="{" data-end="}">
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno"><a class="line" href="group__core__io.html#gaed6f15d7cead4ae400033b6811f283e6">  656</a></span><a class="code hl_function" href="group__core__io.html#gaed6f15d7cead4ae400033b6811f283e6">socketproxy_elapsed_ms</a> (int64_t start_ms)</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>{</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  int64_t elapsed = <a class="code hl_function" href="group__core__io.html#ga89a14153269ffab409e6ebfaf6deebdd">socketproxy_get_time_ms</a> () - start_ms;</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>  <span class="keywordflow">return</span> (elapsed &lt; 0) ? 0 : elapsed;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>}</div>
</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span> </div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span><span class="comment"> * Protocol Handler Function Types</span></div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span><span class="comment"> */</span></div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span> </div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga7b70e48528fb67371dbcc45e7b6ce5c1">  688</a></span><span class="keyword">typedef</span> int (*<a class="code hl_typedef" href="group__proxy__private.html#ga7b70e48528fb67371dbcc45e7b6ce5c1">ProxySendFunc</a>) (<span class="keyword">struct </span><a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga502253ce06f453baedba160037571812">  712</a></span><span class="keyword">typedef</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a> (*<a class="code hl_typedef" href="group__proxy__private.html#ga502253ce06f453baedba160037571812">ProxyRecvFunc</a>) (<span class="keyword">struct </span><a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span> </div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span><span class="comment">/* ============================================================================</span></div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span><span class="comment"> * Internal Protocol Functions - SOCKS5 (RFC 1928/1929)</span></div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span><span class="comment"> * ============================================================================</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span><span class="comment"> */</span></div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga0fcced421154218776f5077fa437f58e">  778</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__proxy__private.html#ga0fcced421154218776f5077fa437f58e">proxy_socks5_send_greeting</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span> </div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a></div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga3695eb1c73d0f31fe1ac6d51f677ab73">  846</a></span><a class="code hl_function" href="group__proxy__private.html#ga3695eb1c73d0f31fe1ac6d51f677ab73">proxy_socks5_recv_method</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span> </div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gaf0c10ebe07ba3206fd7e5e6725960e9a">  910</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__proxy__private.html#gaf0c10ebe07ba3206fd7e5e6725960e9a">proxy_socks5_send_auth</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span> </div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a></div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga54e8297c18caa6bb448daa0d1dceafeb">  972</a></span><a class="code hl_function" href="group__proxy__private.html#ga54e8297c18caa6bb448daa0d1dceafeb">proxy_socks5_recv_auth</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span> </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gad730a252b44728ae21660f2d168b66e3"> 1038</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__proxy__private.html#gad730a252b44728ae21660f2d168b66e3">proxy_socks5_send_connect</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a></div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gae140af2a9af5d32b1786df145d2ccc07"> 1110</a></span><a class="code hl_function" href="group__proxy__private.html#gae140af2a9af5d32b1786df145d2ccc07">proxy_socks5_recv_connect</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span> </div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga4799fc5a08ded667f5518862c078c1bd"> 1167</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a> <a class="code hl_function" href="group__proxy__private.html#ga4799fc5a08ded667f5518862c078c1bd">proxy_socks5_reply_to_result</a> (<span class="keywordtype">int</span> reply);</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span> </div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga93a6b1c4f6b287b308b18207368ad092"> 1235</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__proxy__private.html#ga93a6b1c4f6b287b308b18207368ad092">proxy_socks4_send_connect</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span> </div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga904ce0bf17f24e2e2783aaf8f1491c03"> 1290</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__proxy__private.html#ga904ce0bf17f24e2e2783aaf8f1491c03">proxy_socks4a_send_connect</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span> </div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a></div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga82d72fd16b045c8660210f9ad861a879"> 1351</a></span><a class="code hl_function" href="group__proxy__private.html#ga82d72fd16b045c8660210f9ad861a879">proxy_socks4_recv_response</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span> </div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga2f17a3a05ffed99bade9280577b4bb25"> 1389</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a> <a class="code hl_function" href="group__proxy__private.html#ga2f17a3a05ffed99bade9280577b4bb25">proxy_socks4_reply_to_result</a> (<span class="keywordtype">int</span> reply);</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span> </div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga58484981c55e00df7a24b50671aefa87"> 1460</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__proxy__private.html#ga58484981c55e00df7a24b50671aefa87">proxy_http_send_connect</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span> </div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a></div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga56bdb1756a98a60198184587c4902265"> 1533</a></span><a class="code hl_function" href="group__proxy__private.html#ga56bdb1756a98a60198184587c4902265">proxy_http_recv_response</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span> </div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga9afd213292a65fd6db0e416fa37a433b"> 1592</a></span><span class="keyword">extern</span> <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a> <a class="code hl_function" href="group__proxy__private.html#ga9afd213292a65fd6db0e416fa37a433b">proxy_http_status_to_result</a> (<span class="keywordtype">int</span> status);</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span> </div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span> *     <span class="comment">// Actually, recv calls parse which calls advance on complete</span></div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span> *     <a class="code hl_function" href="group__proxy__private.html#gada1416d62b5113240c93bd3020dc4b68">socketproxy_advance_state</a>(conn);  <span class="comment">// Progress to next phase</span></div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span> * }</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span> * <span class="keyword">@end</span>code</div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span> *</div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span> * @note Idempotent in terminal states (DONE/ERROR).</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span> * @warning Avoid calling during I/O; post-I/O only to prevent races.</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span> * @complexity O(1) average - dispatches to O(1) handlers.</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span> *</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span> * @see <a class="code hl_enumeration" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">SocketProxy_ProtoState</a> Detailed sub-states.</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span> * @see <a class="code hl_typedef" href="group__proxy__private.html#ga7b70e48528fb67371dbcc45e7b6ce5c1">ProxySendFunc</a>, <a class="code hl_typedef" href="group__proxy__private.html#ga502253ce06f453baedba160037571812">ProxyRecvFunc</a> Typedefs for dispatched funcs.</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span> * @see <a class="code hl_function" href="group__core__io.html#ga71e6170ecb08801fd53c849e1456e83c">socketproxy_do_send</a>(), <a class="code hl_function" href="group__core__io.html#gab87758fdfc1cbbf3af9740989da246fd">socketproxy_do_recv</a>() I/O triggers.</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span> * @see docs/PROXY.md<span class="preprocessor">#state-machine For full transition diagram.</span></div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span> */</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"><a class="line" href="group__proxy__private.html#gada1416d62b5113240c93bd3020dc4b68"> 1660</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__proxy__private.html#gada1416d62b5113240c93bd3020dc4b68">socketproxy_advance_state</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span> </div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"><a class="line" href="group__proxy__private.html#ga590a8e0ece3a282a17f59778b6f9d757"> 1714</a></span><span class="keyword">extern</span> <span class="keywordtype">void</span> <a class="code hl_function" href="group__proxy__private.html#ga590a8e0ece3a282a17f59778b6f9d757">socketproxy_set_error</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn,</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>                                   <a class="code hl_enumeration" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a> <a class="code hl_variable" href="group__proxy__private.html#a5e794c6894f28dda56acf59529745a7e">result</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt,</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>                                   ...);</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span> </div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"><a class="line" href="group__core__io.html#ga71e6170ecb08801fd53c849e1456e83c"> 1732</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__core__io.html#ga71e6170ecb08801fd53c849e1456e83c">socketproxy_do_send</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span> </div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"><a class="line" href="group__core__io.html#gab87758fdfc1cbbf3af9740989da246fd"> 1748</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__core__io.html#gab87758fdfc1cbbf3af9740989da246fd">socketproxy_do_recv</a> (<span class="keyword">struct</span> <a class="code hl_struct" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn);</div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span> </div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"><a class="line" href="group__core__io.html#gab2907aa0b8b21056fcf6c9ba35337ed3"> 1775</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__core__io.html#gab2907aa0b8b21056fcf6c9ba35337ed3">socketproxy_parse_scheme</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *url,</div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>                                     <a class="code hl_struct" href="group__proxy.html#structSocketProxy__Config">SocketProxy_Config</a> *config,</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>                                     <span class="keyword">const</span> <span class="keywordtype">char</span> **end);</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span> </div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"><a class="line" href="group__core__io.html#ga4284e6c37f6f115b2099885ae0f5622c"> 1794</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__core__io.html#ga4284e6c37f6f115b2099885ae0f5622c">socketproxy_parse_userinfo</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *start,</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>                                       <a class="code hl_struct" href="group__proxy.html#structSocketProxy__Config">SocketProxy_Config</a> *config,</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>                                       <a class="code hl_typedef" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> <a class="code hl_variable" href="group__proxy__private.html#a083369e24cff29efd9dc20163e541a16">arena</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> **end);</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span> </div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"><a class="line" href="group__core__io.html#gaa11b9c1ecceaca495ac3a397682a3dc0"> 1815</a></span><span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code hl_function" href="group__core__io.html#gaa11b9c1ecceaca495ac3a397682a3dc0">socketproxy_parse_hostport</a> (<span class="keyword">const</span> <span class="keywordtype">char</span> *start,</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>                                       <a class="code hl_struct" href="group__proxy.html#structSocketProxy__Config">SocketProxy_Config</a> *config,</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>                                       <a class="code hl_typedef" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a> <a class="code hl_variable" href="group__proxy__private.html#a083369e24cff29efd9dc20163e541a16">arena</a>, <span class="keywordtype">size_t</span> *consumed_out);</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span> </div>
 <span class="comment">/* proxy_private */</span><div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span> </div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span><span class="preprocessor">#endif </span><span class="comment">/* SOCKETPROXY_PRIVATE_INCLUDED */</span><span class="preprocessor"></span></div>
<div class="ttc" id="aArena_8h_html"><div class="ttname"><a href="Arena_8h.html">Arena.h</a></div><div class="ttdoc">Arena-based memory allocator for efficient bulk memory management.</div></div>
<div class="ttc" id="aSocketBuf_8h_html"><div class="ttname"><a href="SocketBuf_8h.html">SocketBuf.h</a></div><div class="ttdoc">Circular buffer for efficient socket I/O operations.</div></div>
<div class="ttc" id="aSocketDNS_8h_html"><div class="ttname"><a href="SocketDNS_8h.html">SocketDNS.h</a></div><div class="ttdoc">Asynchronous DNS resolution API for non-blocking network applications.</div></div>
<div class="ttc" id="aSocketHTTP1_8h_html"><div class="ttname"><a href="SocketHTTP1_8h.html">SocketHTTP1.h</a></div><div class="ttdoc">HTTP/1.1 message syntax parsing and serialization (RFC 9112).</div></div>
<div class="ttc" id="aSocketHappyEyeballs_8h_html"><div class="ttname"><a href="SocketHappyEyeballs_8h.html">SocketHappyEyeballs.h</a></div><div class="ttdoc">Happy Eyeballs (RFC 8305) implementation for fast dual-stack connections.</div></div>
<div class="ttc" id="aSocketPoll_8h_html"><div class="ttname"><a href="SocketPoll_8h.html">SocketPoll.h</a></div><div class="ttdoc">Cross-platform high-level interface for monitoring multiple sockets for I/O events.</div></div>
<div class="ttc" id="aSocketProxy_8h_html"><div class="ttname"><a href="SocketProxy_8h.html">SocketProxy.h</a></div><div class="ttdoc">Proxy tunneling module for HTTP CONNECT and SOCKS protocols.</div></div>
<div class="ttc" id="aSocketUtil_8h_html"><div class="ttname"><a href="SocketUtil_8h.html">SocketUtil.h</a></div><div class="ttdoc">Consolidated utility header for logging, metrics, events, and error handling.</div></div>
<div class="ttc" id="aSocket_8h_html"><div class="ttname"><a href="Socket_8h.html">Socket.h</a></div><div class="ttdoc">High-level TCP/IP and Unix domain socket interface.</div></div>
<div class="ttc" id="agroup__async__io_html_structSocketHE__T"><div class="ttname"><a href="group__async__io.html#structSocketHE__T">SocketHE_T</a></div><div class="ttdoc">Main opaque context for Happy Eyeballs (RFC 8305) dual-stack connection racing.</div><div class="ttdef"><b>Definition</b> <a href="SocketHappyEyeballs-private_8h_source.html#l00300">SocketHappyEyeballs-private.h:301</a></div></div>
<div class="ttc" id="agroup__core__io_html_ga4284e6c37f6f115b2099885ae0f5622c"><div class="ttname"><a href="group__core__io.html#ga4284e6c37f6f115b2099885ae0f5622c">socketproxy_parse_userinfo</a></div><div class="ttdeci">int socketproxy_parse_userinfo(const char *start, SocketProxy_Config *config, Arena_T arena, const char **end)</div><div class="ttdoc">Parse optional [user[:pass]@] from URL.</div></div>
<div class="ttc" id="agroup__core__io_html_ga71e6170ecb08801fd53c849e1456e83c"><div class="ttname"><a href="group__core__io.html#ga71e6170ecb08801fd53c849e1456e83c">socketproxy_do_send</a></div><div class="ttdeci">int socketproxy_do_send(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Send pending protocol data from conn-&gt;send_buf.</div></div>
<div class="ttc" id="agroup__core__io_html_ga89a14153269ffab409e6ebfaf6deebdd"><div class="ttname"><a href="group__core__io.html#ga89a14153269ffab409e6ebfaf6deebdd">socketproxy_get_time_ms</a></div><div class="ttdeci">static int64_t socketproxy_get_time_ms(void)</div><div class="ttdoc">Get current monotonic time in milliseconds.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00630">SocketProxy-private.h:630</a></div></div>
<div class="ttc" id="agroup__core__io_html_gaa11b9c1ecceaca495ac3a397682a3dc0"><div class="ttname"><a href="group__core__io.html#gaa11b9c1ecceaca495ac3a397682a3dc0">socketproxy_parse_hostport</a></div><div class="ttdeci">int socketproxy_parse_hostport(const char *start, SocketProxy_Config *config, Arena_T arena, size_t *consumed_out)</div><div class="ttdoc">Parse [host]:port from URL, handling IPv6 literals.</div></div>
<div class="ttc" id="agroup__core__io_html_gaaa33f7bdae951cc7b53a2fb049e89132"><div class="ttname"><a href="group__core__io.html#gaaa33f7bdae951cc7b53a2fb049e89132">SocketProxyType</a></div><div class="ttdeci">SocketProxyType</div><div class="ttdoc">Enumeration of supported proxy protocol types.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy_8h_source.html#l00249">SocketProxy.h:250</a></div></div>
<div class="ttc" id="agroup__core__io_html_gab2907aa0b8b21056fcf6c9ba35337ed3"><div class="ttname"><a href="group__core__io.html#gab2907aa0b8b21056fcf6c9ba35337ed3">socketproxy_parse_scheme</a></div><div class="ttdeci">int socketproxy_parse_scheme(const char *url, SocketProxy_Config *config, const char **end)</div><div class="ttdoc">Helper functions for parsing proxy URLs.</div></div>
<div class="ttc" id="agroup__core__io_html_gab87758fdfc1cbbf3af9740989da246fd"><div class="ttname"><a href="group__core__io.html#gab87758fdfc1cbbf3af9740989da246fd">socketproxy_do_recv</a></div><div class="ttdeci">int socketproxy_do_recv(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Receive protocol data into conn-&gt;recv_buf.</div></div>
<div class="ttc" id="agroup__core__io_html_gad4b3ec10874282833e1b15760efa1b6c"><div class="ttname"><a href="group__core__io.html#gad4b3ec10874282833e1b15760efa1b6c">SocketBuf_T</a></div><div class="ttdeci">struct SocketBuf_T * SocketBuf_T</div><div class="ttdoc">Opaque handle to a circular buffer instance.</div><div class="ttdef"><b>Definition</b> <a href="SocketBuf_8h_source.html#l00113">SocketBuf.h:113</a></div></div>
<div class="ttc" id="agroup__core__io_html_gae980e6a437316380a792464ce32a595e"><div class="ttname"><a href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a></div><div class="ttdeci">SocketProxy_Result</div><div class="ttdoc">Result codes for proxy operations.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy_8h_source.html#l00277">SocketProxy.h:278</a></div></div>
<div class="ttc" id="agroup__core__io_html_gaed6f15d7cead4ae400033b6811f283e6"><div class="ttname"><a href="group__core__io.html#gaed6f15d7cead4ae400033b6811f283e6">socketproxy_elapsed_ms</a></div><div class="ttdeci">static int64_t socketproxy_elapsed_ms(int64_t start_ms)</div><div class="ttdoc">Calculate elapsed time since start in milliseconds.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00656">SocketProxy-private.h:656</a></div></div>
<div class="ttc" id="agroup__core__io_html_gaf9f1c72bfcb303aa9ee5dae6d903b9be"><div class="ttname"><a href="group__core__io.html#gaf9f1c72bfcb303aa9ee5dae6d903b9be">SocketProxy_State</a></div><div class="ttdeci">SocketProxy_State</div><div class="ttdoc">States in the proxy connection state machine.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy_8h_source.html#l00319">SocketProxy.h:320</a></div></div>
<div class="ttc" id="agroup__dns_html_structSocketDNS__T"><div class="ttname"><a href="group__dns.html#structSocketDNS__T">SocketDNS_T</a></div><div class="ttdoc">Async DNS resolver structure.</div><div class="ttdef"><b>Definition</b> <a href="SocketDNS-private_8h_source.html#l00221">SocketDNS-private.h:222</a></div></div>
<div class="ttc" id="agroup__foundation_html_gac1ed22b9df4eff7a3398cac608c090cc"><div class="ttname"><a href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a></div><div class="ttdeci">struct Arena_T * Arena_T</div><div class="ttdef"><b>Definition</b> <a href="Arena_8h_source.html#l00078">Arena.h:78</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a083369e24cff29efd9dc20163e541a16"><div class="ttname"><a href="group__proxy__private.html#a083369e24cff29efd9dc20163e541a16">SocketProxy_Conn_T::arena</a></div><div class="ttdeci">Arena_T arena</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00571">SocketProxy-private.h:571</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a0e96e5f0261bce7086ad5cc7af7e4b08"><div class="ttname"><a href="group__proxy__private.html#a0e96e5f0261bce7086ad5cc7af7e4b08">SocketProxy_Conn_T::proxy_host</a></div><div class="ttdeci">char * proxy_host</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00556">SocketProxy-private.h:556</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a11cf9d48eaae7621057f67b9589edf6b"><div class="ttname"><a href="group__proxy__private.html#a11cf9d48eaae7621057f67b9589edf6b">SocketProxy_Conn_T::proxy_port</a></div><div class="ttdeci">int proxy_port</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00557">SocketProxy-private.h:557</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a12a3779149de75f678c5c1329e6cf88c"><div class="ttname"><a href="group__proxy__private.html#a12a3779149de75f678c5c1329e6cf88c">SocketProxy_Conn_T::transferred</a></div><div class="ttdeci">int transferred</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00607">SocketProxy-private.h:607</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a2153b2db669de8d281e0139a91c7c92e"><div class="ttname"><a href="group__proxy__private.html#a2153b2db669de8d281e0139a91c7c92e">SocketProxy_Conn_T::he</a></div><div class="ttdeci">SocketHE_T he</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00578">SocketProxy-private.h:578</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a2224b074511d1fe06fdcae44d6953dc5"><div class="ttname"><a href="group__proxy__private.html#a2224b074511d1fe06fdcae44d6953dc5">SocketProxy_Conn_T::extra_headers</a></div><div class="ttdeci">SocketHTTP_Headers_T extra_headers</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00564">SocketProxy-private.h:564</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a257faf2aa4300a913c14f65c5941e820"><div class="ttname"><a href="group__proxy__private.html#a257faf2aa4300a913c14f65c5941e820">SocketProxy_Conn_T::target_host</a></div><div class="ttdeci">char * target_host</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00560">SocketProxy-private.h:560</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a2c3fc65e5bee85f64a52dea4c4efeb33"><div class="ttname"><a href="group__proxy__private.html#a2c3fc65e5bee85f64a52dea4c4efeb33">SocketProxy_Conn_T::socket</a></div><div class="ttdeci">Socket_T socket</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00572">SocketProxy-private.h:572</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a431a582be92ea3900cddfcf6ace76048"><div class="ttname"><a href="group__proxy__private.html#a431a582be92ea3900cddfcf6ace76048">SocketProxy_Conn_T::dns</a></div><div class="ttdeci">SocketDNS_T dns</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00576">SocketProxy-private.h:576</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a4858544617c2129855e2b8574df86cf7"><div class="ttname"><a href="group__proxy__private.html#a4858544617c2129855e2b8574df86cf7">SocketProxy_Conn_T::tls_enabled</a></div><div class="ttdeci">int tls_enabled</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00567">SocketProxy-private.h:567</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a4fa34ec2122d2d9c4a3718565359c86b"><div class="ttname"><a href="group__proxy__private.html#a4fa34ec2122d2d9c4a3718565359c86b">SocketProxy_Conn_T::socks5_need_auth</a></div><div class="ttdeci">int socks5_need_auth</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00591">SocketProxy-private.h:591</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a548c64d7e226630e791314c204c547c4"><div class="ttname"><a href="group__proxy__private.html#a548c64d7e226630e791314c204c547c4">SocketProxy_Conn_T::owns_dns_poll</a></div><div class="ttdeci">int owns_dns_poll</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00579">SocketProxy-private.h:579</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a5a7d11532a403ff7f63d99eac1186617"><div class="ttname"><a href="group__proxy__private.html#a5a7d11532a403ff7f63d99eac1186617">SocketProxy_Conn_T::tls_ctx</a></div><div class="ttdeci">SocketTLSContext_T tls_ctx</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00566">SocketProxy-private.h:566</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a5e794c6894f28dda56acf59529745a7e"><div class="ttname"><a href="group__proxy__private.html#a5e794c6894f28dda56acf59529745a7e">SocketProxy_Conn_T::result</a></div><div class="ttdeci">SocketProxy_Result result</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00587">SocketProxy-private.h:587</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a614ffa636c6ca6f92b39f8af950c50a3"><div class="ttname"><a href="group__proxy__private.html#a614ffa636c6ca6f92b39f8af950c50a3">SocketProxy_Conn_T::recv_buf</a></div><div class="ttdeci">unsigned char recv_buf[65536]</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00601">SocketProxy-private.h:601</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a63bb3dea323c1f69e223786294aac653"><div class="ttname"><a href="group__proxy__private.html#a63bb3dea323c1f69e223786294aac653">SocketProxy_Conn_T::recv_offset</a></div><div class="ttdeci">size_t recv_offset</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00603">SocketProxy-private.h:603</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a64870d3e5ff24323c4d1566bc1fb06c6"><div class="ttname"><a href="group__proxy__private.html#a64870d3e5ff24323c4d1566bc1fb06c6">SocketProxy_Conn_T::send_buf</a></div><div class="ttdeci">unsigned char send_buf[65536]</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00598">SocketProxy-private.h:598</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a6676b0ed3643ee6154d26738af148a99"><div class="ttname"><a href="group__proxy__private.html#a6676b0ed3643ee6154d26738af148a99">SocketProxy_Conn_T::state</a></div><div class="ttdeci">SocketProxy_State state</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00585">SocketProxy-private.h:585</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a74f03365dce0726d5f66c35f561b742b"><div class="ttname"><a href="group__proxy__private.html#a74f03365dce0726d5f66c35f561b742b">SocketProxy_Conn_T::recv_len</a></div><div class="ttdeci">size_t recv_len</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00602">SocketProxy-private.h:602</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a7d71e6abcb8cb29cc286d94caa492142"><div class="ttname"><a href="group__proxy__private.html#a7d71e6abcb8cb29cc286d94caa492142">SocketProxy_Conn_T::password</a></div><div class="ttdeci">char * password</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00559">SocketProxy-private.h:559</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a813513bee1ea5117ffea491c85edcd81"><div class="ttname"><a href="group__proxy__private.html#a813513bee1ea5117ffea491c85edcd81">SocketProxy_Conn_T::proto_state</a></div><div class="ttdeci">SocketProxy_ProtoState proto_state</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00586">SocketProxy-private.h:586</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a82625ab8fed897529b509e9caf5461b8"><div class="ttname"><a href="group__proxy__private.html#a82625ab8fed897529b509e9caf5461b8">SocketProxy_Conn_T::start_time_ms</a></div><div class="ttdeci">int64_t start_time_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00594">SocketProxy-private.h:594</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a84361c1bf1c9efec61171b729effa6e1"><div class="ttname"><a href="group__proxy__private.html#a84361c1bf1c9efec61171b729effa6e1">SocketProxy_Conn_T::poll</a></div><div class="ttdeci">SocketPoll_T poll</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00577">SocketProxy-private.h:577</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a894986448a6771af2c160558763cf5cc"><div class="ttname"><a href="group__proxy__private.html#a894986448a6771af2c160558763cf5cc">SocketProxy_Conn_T::type</a></div><div class="ttdeci">SocketProxyType type</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00555">SocketProxy-private.h:555</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_a901962a8ee7faa216d870d2394a8d17d"><div class="ttname"><a href="group__proxy__private.html#a901962a8ee7faa216d870d2394a8d17d">SocketProxy_Conn_T::http_parser</a></div><div class="ttdeci">SocketHTTP1_Parser_T http_parser</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00582">SocketProxy-private.h:582</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_aa314392e96e493c77a1deed89728e43c"><div class="ttname"><a href="group__proxy__private.html#aa314392e96e493c77a1deed89728e43c">SocketProxy_Conn_T::handshake_timeout_ms</a></div><div class="ttdeci">int handshake_timeout_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00563">SocketProxy-private.h:563</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_aaaed59222364e1228661678468b42283"><div class="ttname"><a href="group__proxy__private.html#aaaed59222364e1228661678468b42283">SocketProxy_Conn_T::error_buf</a></div><div class="ttdeci">char error_buf[256]</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00606">SocketProxy-private.h:606</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_aafa5f04a528b20448930f6524568beb2"><div class="ttname"><a href="group__proxy__private.html#aafa5f04a528b20448930f6524568beb2">SocketProxy_Conn_T::recvbuf</a></div><div class="ttdeci">SocketBuf_T recvbuf</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00573">SocketProxy-private.h:573</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_abcf5a9fbce4f4235b67e65f35833611c"><div class="ttname"><a href="group__proxy__private.html#abcf5a9fbce4f4235b67e65f35833611c">SocketProxy_Conn_T::send_offset</a></div><div class="ttdeci">size_t send_offset</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00600">SocketProxy-private.h:600</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ac8dbe4bd33e376a5595c7966f9f40113"><div class="ttname"><a href="group__proxy__private.html#ac8dbe4bd33e376a5595c7966f9f40113">SocketProxy_Conn_T::handshake_start_time_ms</a></div><div class="ttdeci">int64_t handshake_start_time_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00595">SocketProxy-private.h:595</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ad2b795e71eb9323949e6384665970a84"><div class="ttname"><a href="group__proxy__private.html#ad2b795e71eb9323949e6384665970a84">SocketProxy_Conn_T::username</a></div><div class="ttdeci">char * username</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00558">SocketProxy-private.h:558</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ae0aebb2175653871184fe8875f57c633"><div class="ttname"><a href="group__proxy__private.html#ae0aebb2175653871184fe8875f57c633">SocketProxy_Conn_T::connect_timeout_ms</a></div><div class="ttdeci">int connect_timeout_ms</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00562">SocketProxy-private.h:562</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ae390638a08d19534bc6d0e698b4da476"><div class="ttname"><a href="group__proxy__private.html#ae390638a08d19534bc6d0e698b4da476">SocketProxy_Conn_T::target_port</a></div><div class="ttdeci">int target_port</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00561">SocketProxy-private.h:561</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_af601d7eeeb78ef4fe2c694ad20ee6f44"><div class="ttname"><a href="group__proxy__private.html#af601d7eeeb78ef4fe2c694ad20ee6f44">SocketProxy_Conn_T::socks5_auth_method</a></div><div class="ttdeci">int socks5_auth_method</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00590">SocketProxy-private.h:590</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_af843e68c0b6e0e73085fc72e3a28823d"><div class="ttname"><a href="group__proxy__private.html#af843e68c0b6e0e73085fc72e3a28823d">SocketProxy_Conn_T::send_len</a></div><div class="ttdeci">size_t send_len</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00599">SocketProxy-private.h:599</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ga0fcced421154218776f5077fa437f58e"><div class="ttname"><a href="group__proxy__private.html#ga0fcced421154218776f5077fa437f58e">proxy_socks5_send_greeting</a></div><div class="ttdeci">int proxy_socks5_send_greeting(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Builds SOCKS5 greeting message for initial protocol negotiation (RFC 1928).</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga2f17a3a05ffed99bade9280577b4bb25"><div class="ttname"><a href="group__proxy__private.html#ga2f17a3a05ffed99bade9280577b4bb25">proxy_socks4_reply_to_result</a></div><div class="ttdeci">SocketProxy_Result proxy_socks4_reply_to_result(int reply)</div><div class="ttdoc">Maps SOCKS4 reply codes to SocketProxy_Result for error consistency.</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga3695eb1c73d0f31fe1ac6d51f677ab73"><div class="ttname"><a href="group__proxy__private.html#ga3695eb1c73d0f31fe1ac6d51f677ab73">proxy_socks5_recv_method</a></div><div class="ttdeci">SocketProxy_Result proxy_socks5_recv_method(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Parses SOCKS5 server method selection response after greeting (RFC 1928).</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga4799fc5a08ded667f5518862c078c1bd"><div class="ttname"><a href="group__proxy__private.html#ga4799fc5a08ded667f5518862c078c1bd">proxy_socks5_reply_to_result</a></div><div class="ttdeci">SocketProxy_Result proxy_socks5_reply_to_result(int reply)</div><div class="ttdoc">Maps SOCKS5 reply codes from CONNECT response to library result enums.</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga502253ce06f453baedba160037571812"><div class="ttname"><a href="group__proxy__private.html#ga502253ce06f453baedba160037571812">ProxyRecvFunc</a></div><div class="ttdeci">SocketProxy_Result(* ProxyRecvFunc)(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Function type for protocol-specific response parsing.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00712">SocketProxy-private.h:712</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ga52309497faa9acfa9ff1c6c143ef7d07"><div class="ttname"><a href="group__proxy__private.html#ga52309497faa9acfa9ff1c6c143ef7d07">SOCKET_PROXY_NS_PER_MS</a></div><div class="ttdeci">#define SOCKET_PROXY_NS_PER_MS</div><div class="ttdoc">Nanoseconds per millisecond for high-precision time conversion.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00177">SocketProxy-private.h:177</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ga54e8297c18caa6bb448daa0d1dceafeb"><div class="ttname"><a href="group__proxy__private.html#ga54e8297c18caa6bb448daa0d1dceafeb">proxy_socks5_recv_auth</a></div><div class="ttdeci">SocketProxy_Result proxy_socks5_recv_auth(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Parses SOCKS5 authentication response for username/password method (RFC 1929).</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga56bdb1756a98a60198184587c4902265"><div class="ttname"><a href="group__proxy__private.html#ga56bdb1756a98a60198184587c4902265">proxy_http_recv_response</a></div><div class="ttdeci">SocketProxy_Result proxy_http_recv_response(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Parses HTTP response to CONNECT request for tunnel confirmation.</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga58484981c55e00df7a24b50671aefa87"><div class="ttname"><a href="group__proxy__private.html#ga58484981c55e00df7a24b50671aefa87">proxy_http_send_connect</a></div><div class="ttdeci">int proxy_http_send_connect(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Internal functions for HTTP CONNECT proxy method (RFC 7230).</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga590a8e0ece3a282a17f59778b6f9d757"><div class="ttname"><a href="group__proxy__private.html#ga590a8e0ece3a282a17f59778b6f9d757">socketproxy_set_error</a></div><div class="ttdeci">void socketproxy_set_error(struct SocketProxy_Conn_T *conn, SocketProxy_Result result, const char *fmt,...)</div><div class="ttdoc">Sets error condition in connection context with formatted message.</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga787c1af36f15b60e2f85339f94bfbe49"><div class="ttname"><a href="group__proxy__private.html#ga787c1af36f15b60e2f85339f94bfbe49">SOCKET_PROXY_ERROR_BUFSIZE</a></div><div class="ttdeci">#define SOCKET_PROXY_ERROR_BUFSIZE</div><div class="ttdoc">Internal constants for buffer sizes, timeouts, and protocol limits.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00104">SocketProxy-private.h:104</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ga7b70e48528fb67371dbcc45e7b6ce5c1"><div class="ttname"><a href="group__proxy__private.html#ga7b70e48528fb67371dbcc45e7b6ce5c1">ProxySendFunc</a></div><div class="ttdeci">int(* ProxySendFunc)(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Function type for protocol-specific request building.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00688">SocketProxy-private.h:688</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ga82d72fd16b045c8660210f9ad861a879"><div class="ttname"><a href="group__proxy__private.html#ga82d72fd16b045c8660210f9ad861a879">proxy_socks4_recv_response</a></div><div class="ttdeci">SocketProxy_Result proxy_socks4_recv_response(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Parses SOCKS4/SOCKS4a response to check connection result.</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga8d5525862e31c82df86ea8ec9ccd493c"><div class="ttname"><a href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">SocketProxy_ProtoState</a></div><div class="ttdeci">SocketProxy_ProtoState</div><div class="ttdoc">Protocol-specific sub-state for proxy handshakes.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00364">SocketProxy-private.h:365</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_ga904ce0bf17f24e2e2783aaf8f1491c03"><div class="ttname"><a href="group__proxy__private.html#ga904ce0bf17f24e2e2783aaf8f1491c03">proxy_socks4a_send_connect</a></div><div class="ttdeci">int proxy_socks4a_send_connect(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Builds SOCKS4a CONNECT request using domain name (unofficial extension).</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga93a6b1c4f6b287b308b18207368ad092"><div class="ttname"><a href="group__proxy__private.html#ga93a6b1c4f6b287b308b18207368ad092">proxy_socks4_send_connect</a></div><div class="ttdeci">int proxy_socks4_send_connect(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Internal functions for SOCKS4 and SOCKS4a protocol handling.</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga9afd213292a65fd6db0e416fa37a433b"><div class="ttname"><a href="group__proxy__private.html#ga9afd213292a65fd6db0e416fa37a433b">proxy_http_status_to_result</a></div><div class="ttdeci">SocketProxy_Result proxy_http_status_to_result(int status)</div><div class="ttdoc">Maps HTTP status codes from CONNECT response to SocketProxy_Result.</div></div>
<div class="ttc" id="agroup__proxy__private_html_ga9f5752234c11ead463ea1e91cf03a2ad"><div class="ttname"><a href="group__proxy__private.html#ga9f5752234c11ead463ea1e91cf03a2ad">SOCKET_PROXY_MS_PER_SEC</a></div><div class="ttdeci">#define SOCKET_PROXY_MS_PER_SEC</div><div class="ttdoc">Milliseconds per second constant for timeout calculations.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00164">SocketProxy-private.h:164</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gad730a252b44728ae21660f2d168b66e3"><div class="ttname"><a href="group__proxy__private.html#gad730a252b44728ae21660f2d168b66e3">proxy_socks5_send_connect</a></div><div class="ttdeci">int proxy_socks5_send_connect(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Builds SOCKS5 CONNECT command to establish tunnel to target (RFC 1928).</div></div>
<div class="ttc" id="agroup__proxy__private_html_gada1416d62b5113240c93bd3020dc4b68"><div class="ttname"><a href="group__proxy__private.html#gada1416d62b5113240c93bd3020dc4b68">socketproxy_advance_state</a></div><div class="ttdeci">void socketproxy_advance_state(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Internal state machine functions for proxy negotiation.</div></div>
<div class="ttc" id="agroup__proxy__private_html_gadfe4c6b10bc2da57d2677a32a8fc2f02"><div class="ttname"><a href="group__proxy__private.html#gadfe4c6b10bc2da57d2677a32a8fc2f02">SOCKET_PROXY_BUFFER_SIZE</a></div><div class="ttdeci">#define SOCKET_PROXY_BUFFER_SIZE</div><div class="ttdoc">Default size for internal send/receive buffers during handshake.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00121">SocketProxy-private.h:121</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gae140af2a9af5d32b1786df145d2ccc07"><div class="ttname"><a href="group__proxy__private.html#gae140af2a9af5d32b1786df145d2ccc07">proxy_socks5_recv_connect</a></div><div class="ttdeci">SocketProxy_Result proxy_socks5_recv_connect(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Parses SOCKS5 CONNECT response to determine tunnel establishment (RFC 1928).</div></div>
<div class="ttc" id="agroup__proxy__private_html_gaf0c10ebe07ba3206fd7e5e6725960e9a"><div class="ttname"><a href="group__proxy__private.html#gaf0c10ebe07ba3206fd7e5e6725960e9a">proxy_socks5_send_auth</a></div><div class="ttdeci">int proxy_socks5_send_auth(struct SocketProxy_Conn_T *conn)</div><div class="ttdoc">Constructs SOCKS5 username/password subnegotiation request (RFC 1929).</div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493ca385541d759585795ce1310609ec3d6bd"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca385541d759585795ce1310609ec3d6bd">PROTO_STATE_DONE</a></div><div class="ttdeci">@ PROTO_STATE_DONE</div><div class="ttdoc">Handshake protocol phase complete. Success or failure reflected in conn-&gt;result and high-level state....</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00406">SocketProxy-private.h:403</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493ca4111e707281eccc70e9e6aa97777a1a9"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca4111e707281eccc70e9e6aa97777a1a9">PROTO_STATE_SOCKS4_CONNECT_SENT</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS4_CONNECT_SENT</div><div class="ttdoc">SOCKS4 CONNECT request sent (IPv4 only or 4a extension). VN=4, CMD=1, DSTPORT, DSTIP (0....</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00390">SocketProxy-private.h:388</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493ca429c6f1b7b064fcfe594a9de4d5bd85b"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca429c6f1b7b064fcfe594a9de4d5bd85b">PROTO_STATE_SOCKS5_AUTH_RECEIVED</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS5_AUTH_RECEIVED</div><div class="ttdoc">Auth response received and validated. On success (STATUS=0), proceed to CONNECT; failure maps to PROX...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00380">SocketProxy-private.h:379</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493ca4cf8dced08ab39ea15cda595922bf111"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca4cf8dced08ab39ea15cda595922bf111">PROTO_STATE_SOCKS5_CONNECT_RECEIVED</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS5_CONNECT_RECEIVED</div><div class="ttdoc">CONNECT reply fully parsed. REP=0x00 success (tunnel ready, ignore bound addr); other REPs map to spe...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00385">SocketProxy-private.h:384</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493ca6ebbcb3c7028113f0d93a18a1fa96155"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca6ebbcb3c7028113f0d93a18a1fa96155">PROTO_STATE_HTTP_RESPONSE_RECEIVED</a></div><div class="ttdeci">@ PROTO_STATE_HTTP_RESPONSE_RECEIVED</div><div class="ttdoc">HTTP response headers fully parsed via http_parser. Expect status 200 &quot;Connection established&quot;; 4xx/5...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00400">SocketProxy-private.h:398</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493ca798e97b768cc911a58b89bca9e242d08"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca798e97b768cc911a58b89bca9e242d08">PROTO_STATE_SOCKS4_CONNECT_RECEIVED</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS4_CONNECT_RECEIVED</div><div class="ttdoc">SOCKS4 reply received and checked. CD=90 success; 91-93 errors mapped via proxy_socks4_reply_to_resul...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00392">SocketProxy-private.h:391</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493ca8767b75e57730c4169d8e5299fbf81f7"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca8767b75e57730c4169d8e5299fbf81f7">PROTO_STATE_SOCKS5_METHOD_RECEIVED</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS5_METHOD_RECEIVED</div><div class="ttdoc">Method selection response parsed successfully. Auth method stored in conn-&gt;socks5_auth_method; if non...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00375">SocketProxy-private.h:373</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493cac2f57b720922a9a40199634cf679beb2"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cac2f57b720922a9a40199634cf679beb2">PROTO_STATE_HTTP_REQUEST_SENT</a></div><div class="ttdeci">@ PROTO_STATE_HTTP_REQUEST_SENT</div><div class="ttdoc">HTTP CONNECT target_host:target_port HTTP/1.1 request sent. Includes Host:, optional Proxy-Authorizat...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00397">SocketProxy-private.h:395</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493cad9cbdb2e2397158bbd069ababd33e7af"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cad9cbdb2e2397158bbd069ababd33e7af">PROTO_STATE_SOCKS5_AUTH_SENT</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS5_AUTH_SENT</div><div class="ttdoc">Username/password authentication request sent (method 0x02). Format per RFC 1929: VER=1,...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00378">SocketProxy-private.h:376</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493caf20756c410fcc0f622ea89994f10c81a"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493caf20756c410fcc0f622ea89994f10c81a">PROTO_STATE_SOCKS5_CONNECT_SENT</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS5_CONNECT_SENT</div><div class="ttdoc">SOCKS5 CONNECT command sent with target details. CMD=0x01, ATYP (IPv4/domain/IPv6),...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00383">SocketProxy-private.h:381</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493caf5542717d2ee90d3d17b63b4cf6ece64"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493caf5542717d2ee90d3d17b63b4cf6ece64">PROTO_STATE_INIT</a></div><div class="ttdeci">@ PROTO_STATE_INIT</div><div class="ttdoc">Initial state before any protocol interaction. Ready to build and send first message (greeting for SO...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00367">SocketProxy-private.h:366</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_gga8d5525862e31c82df86ea8ec9ccd493cafba3acda31e424f195898a8ba5488940"><div class="ttname"><a href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cafba3acda31e424f195898a8ba5488940">PROTO_STATE_SOCKS5_GREETING_SENT</a></div><div class="ttdeci">@ PROTO_STATE_SOCKS5_GREETING_SENT</div><div class="ttdoc">SOCKS5 version 5 greeting sent to proxy. Lists supported auth methods (SOCKS5_AUTH_NONE,...</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00372">SocketProxy-private.h:370</a></div></div>
<div class="ttc" id="agroup__proxy__private_html_structSocketProxy__Conn__T"><div class="ttname"><a href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a></div><div class="ttdoc">Opaque proxy connection context for managing tunneling negotiation.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy-private_8h_source.html#l00552">SocketProxy-private.h:553</a></div></div>
<div class="ttc" id="agroup__proxy_html_structSocketProxy__Config"><div class="ttname"><a href="group__proxy.html#structSocketProxy__Config">SocketProxy_Config</a></div><div class="ttdoc">Configuration structure for proxy connections.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy_8h_source.html#l00360">SocketProxy.h:361</a></div></div>
<div class="ttc" id="agroup__security_html_structSocketTLSContext__T"><div class="ttname"><a href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a></div><div class="ttdoc">TLS context structure for managing OpenSSL SSL_CTX with secure defaults, certificates,...</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS-private_8h_source.html#l00678">SocketTLS-private.h:679</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<footer class="footer">
  <div style="max-width: 960px; margin: 0 auto; padding: 40px 24px;">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 40px;">
      <!-- Brand -->
      <div style="flex: 1; min-width: 200px;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 6px;"></div>
          <span style="font-size: 1rem; font-weight: 600; color: #f7f9fa;">Socket Library</span>
        </div>
        <p style="color: #8b98a5; font-size: 0.8125rem; line-height: 1.6; margin: 0;">
          High-performance socket toolkit for POSIX systems with exception-based error handling and TLS 1.3 support.
        </p>
      </div>
      <!-- Links -->
      <div style="display: flex; gap: 48px; flex-wrap: wrap;">
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Documentation</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="index.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Getting Started</a></li>
            <li style="margin: 6px 0;"><a href="annotated.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Data Structures</a></li>
            <li style="margin: 6px 0;"><a href="globals.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">API Reference</a></li>
          </ul>
        </div>
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Resources</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="files.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Header Files</a></li>
            <li style="margin: 6px 0;"><a href="https://x.com/tetsuocorp" target="_blank" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Twitter/X</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Bottom -->
    <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #30363d; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
      <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 0.75rem; font-weight: 500; color: #10b981; background: rgba(16, 185, 129, 0.1); padding: 4px 8px; border-radius: 4px;">C11</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #3b82f6; background: rgba(59, 130, 246, 0.1); padding: 4px 8px; border-radius: 4px;">POSIX</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #8b5cf6; background: rgba(139, 92, 246, 0.1); padding: 4px 8px; border-radius: 4px;">TLS 1.3</span>
      </div>
      <div style="color: #6e7681; font-size: 0.75rem; display: flex; align-items: center; gap: 8px;">
        <span> 2025 Tetsuo Corporation</span>
        <span style="color: #30363d;"></span>
        <a href="https://opensource.org/licenses/MIT" target="_blank" style="color: #8b98a5; text-decoration: none;">MIT License</a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
