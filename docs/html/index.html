<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Socket Library: Socket Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Socket Library<span id="projectnumber">&#160;1.0.0</span>
   </div>
   <div id="projectbrief">High-performance, exception-driven socket toolkit for POSIX systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Socket Library </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> High-performance, exception-driven socket toolkit for POSIX systems. Provides a clean, modern API for TCP, UDP, and Unix domain sockets with comprehensive error handling, zero-copy I/O, and cross-platform event polling.</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Features</h1>
<h2><a class="anchor" id="autotoc_md2"></a>
Core Capabilities</h2>
<ul>
<li><b>TCP Stream Sockets</b> - Full-featured TCP client/server support</li>
<li><b>UDP Datagram Sockets</b> - Connectionless and connected UDP modes</li>
<li><b>Unix Domain Sockets</b> - IPC sockets for local communication</li>
<li><b>TLS/SSL Support</b> - Secure communication via OpenSSL integration</li>
<li><b>Exception-Based Error Handling</b> - Clean error propagation with <code>TRY/EXCEPT/FINALLY</code></li>
<li><b>Asynchronous DNS Resolution</b> - Non-blocking DNS with thread pool</li>
<li><b>Cross-Platform Event Polling</b> - epoll (Linux), kqueue (BSD/macOS), poll fallback</li>
<li><b><a class="el" href="structConnection.html">Connection</a> Pooling</b> - Efficient connection management with buffers</li>
<li><b>Zero-Copy I/O</b> - Platform-optimized <code>sendfile()</code> and scatter/gather I/O</li>
<li><b>Advanced TCP Options</b> - Congestion control, Fast Open, user timeout</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Production-Ready Features</h2>
<ul>
<li>Thread-safe error reporting</li>
<li>Comprehensive timeout support</li>
<li>Observability (logging, metrics, events)</li>
<li>Memory-safe arena allocation</li>
<li>Platform detection with graceful fallbacks</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Platform Requirements</h1>
<ul>
<li><b>POSIX-compliant system</b> (Linux, BSD, macOS)</li>
<li><b>IPv6 support</b> in kernel (for dual-stack sockets)</li>
<li><b>POSIX threads</b> (pthread) for thread-safe operations</li>
<li><b>NOT portable to Windows</b> without Winsock adaptation layer</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Quick Start</h1>
<h2><a class="anchor" id="autotoc_md6"></a>
Building</h2>
<div class="fragment"><div class="line">cmake -S . -B build</div>
<div class="line">cmake --build build -j</div>
<div class="line">cmake --build build --target test</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Basic TCP Server</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Socket_8h.html">socket/Socket.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Except_8h.html">core/Except.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    signal(SIGPIPE, SIG_IGN);  <span class="comment">/* Required on macOS/BSD */</span></div>
<div class="line">    </div>
<div class="line">    <a class="code hl_struct" href="structSocket__T.html">Socket_T</a> server = <a class="code hl_function" href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a></div>
<div class="line">        <a class="code hl_function" href="Socket_8h.html#aa20213f48dd43a3129c9c9f3b03c9854">Socket_bind</a>(server, NULL, 8080);  <span class="comment">/* Bind to any address */</span></div>
<div class="line">        <a class="code hl_function" href="Socket_8h.html#afb9495f689b00ffc14f393d8173c98a4">Socket_listen</a>(server, 10);</div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">while</span> (1) {</div>
<div class="line">            <a class="code hl_struct" href="structSocket__T.html">Socket_T</a> client = <a class="code hl_function" href="Socket_8h.html#af21e0268831aeee010b41d28ac61b464">Socket_accept</a>(server);</div>
<div class="line">            <span class="keywordflow">if</span> (client) {</div>
<div class="line">                <span class="keywordtype">char</span> buf[1024];</div>
<div class="line">                ssize_t n = <a class="code hl_function" href="Socket_8h.html#af5ec96ac4f3517384ca22c1ef50d646a">Socket_recv</a>(client, buf, <span class="keyword">sizeof</span>(buf) - 1);</div>
<div class="line">                <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line">                    buf[n] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">                    <a class="code hl_function" href="Socket_8h.html#afa7bde7e1ab3130c4674e0c7bcb94ea8">Socket_sendall</a>(client, buf, n);</div>
<div class="line">                }</div>
<div class="line">                <a class="code hl_function" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a>(&amp;client);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    <a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#a84516221c8fd2d4bdfde8d05eaf42cc6">Socket_Failed</a>)</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Error: %s\n&quot;</span>, Socket_error());</div>
<div class="line">    <a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a>(&amp;server);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aExcept_8h_html"><div class="ttname"><a href="Except_8h.html">Except.h</a></div></div>
<div class="ttc" id="aExcept_8h_html_ab5e72fc2bd41014c75e0ace4feabfe8e"><div class="ttname"><a href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a></div><div class="ttdeci">#define EXCEPT(e)</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00107">Except.h:107</a></div></div>
<div class="ttc" id="aExcept_8h_html_ad2746371528bdf15c3910b7bf217dac0"><div class="ttname"><a href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a></div><div class="ttdeci">#define TRY</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00092">Except.h:92</a></div></div>
<div class="ttc" id="aExcept_8h_html_ae6628ac788ad213363b89dba9868420b"><div class="ttname"><a href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a></div><div class="ttdeci">#define END_TRY</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00146">Except.h:146</a></div></div>
<div class="ttc" id="aSocket_8h_html"><div class="ttname"><a href="Socket_8h.html">Socket.h</a></div></div>
<div class="ttc" id="aSocket_8h_html_a221d64c385da1687c988f7ffeb67697d"><div class="ttname"><a href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a></div><div class="ttdeci">void Socket_free(T *socket)</div><div class="ttdoc">Socket_free - Free a socket and close the connection @socket: Pointer to socket (will be set to NULL)</div></div>
<div class="ttc" id="aSocket_8h_html_a48a12cae4cd51b880e7927a22ab82641"><div class="ttname"><a href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new</a></div><div class="ttdeci">T Socket_new(int domain, int type, int protocol)</div></div>
<div class="ttc" id="aSocket_8h_html_a84516221c8fd2d4bdfde8d05eaf42cc6"><div class="ttname"><a href="Socket_8h.html#a84516221c8fd2d4bdfde8d05eaf42cc6">Socket_Failed</a></div><div class="ttdeci">Except_T Socket_Failed</div><div class="ttdoc">General socket operation failure.</div></div>
<div class="ttc" id="aSocket_8h_html_aa20213f48dd43a3129c9c9f3b03c9854"><div class="ttname"><a href="Socket_8h.html#aa20213f48dd43a3129c9c9f3b03c9854">Socket_bind</a></div><div class="ttdeci">void Socket_bind(T socket, const char *host, int port)</div><div class="ttdoc">Socket_bind - Bind socket to address and port @socket: Socket to bind @host: IP address or NULL/&quot;0....</div></div>
<div class="ttc" id="aSocket_8h_html_af21e0268831aeee010b41d28ac61b464"><div class="ttname"><a href="Socket_8h.html#af21e0268831aeee010b41d28ac61b464">Socket_accept</a></div><div class="ttdeci">T Socket_accept(T socket)</div><div class="ttdoc">Socket_accept - Accept incoming connection @socket: Listening socket Returns: New socket or NULL if w...</div></div>
<div class="ttc" id="aSocket_8h_html_af5ec96ac4f3517384ca22c1ef50d646a"><div class="ttname"><a href="Socket_8h.html#af5ec96ac4f3517384ca22c1ef50d646a">Socket_recv</a></div><div class="ttdeci">ssize_t Socket_recv(T socket, void *buf, size_t len)</div><div class="ttdoc">Socket_recv - Receive data @socket: Connected socket @buf: Buffer for received data @len: Buffer size...</div></div>
<div class="ttc" id="aSocket_8h_html_afa7bde7e1ab3130c4674e0c7bcb94ea8"><div class="ttname"><a href="Socket_8h.html#afa7bde7e1ab3130c4674e0c7bcb94ea8">Socket_sendall</a></div><div class="ttdeci">ssize_t Socket_sendall(T socket, const void *buf, size_t len)</div><div class="ttdoc">Socket_sendall - Send all data (handles partial sends) @socket: Connected socket @buf: Data to send @...</div></div>
<div class="ttc" id="aSocket_8h_html_afb9495f689b00ffc14f393d8173c98a4"><div class="ttname"><a href="Socket_8h.html#afb9495f689b00ffc14f393d8173c98a4">Socket_listen</a></div><div class="ttdeci">void Socket_listen(T socket, int backlog)</div><div class="ttdoc">Socket_listen - Listen for incoming connections @socket: Bound socket @backlog: Maximum pending conne...</div></div>
<div class="ttc" id="astructSocket__T_html"><div class="ttname"><a href="structSocket__T.html">Socket_T</a></div><div class="ttdef"><b>Definition</b> <a href="Socket-private_8h_source.html#l00009">Socket-private.h:10</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Basic TCP Client</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Socket_8h.html">socket/Socket.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Except_8h.html">core/Except.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    signal(SIGPIPE, SIG_IGN);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_struct" href="structSocket__T.html">Socket_T</a> client = <a class="code hl_function" href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a></div>
<div class="line">        <a class="code hl_function" href="Socket_8h.html#a6425897f52a2ee266a88f674de18ddd3">Socket_connect</a>(client, <span class="stringliteral">&quot;127.0.0.1&quot;</span>, 8080);</div>
<div class="line">        </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *msg = <span class="stringliteral">&quot;Hello, Server!&quot;</span>;</div>
<div class="line">        <a class="code hl_function" href="Socket_8h.html#afa7bde7e1ab3130c4674e0c7bcb94ea8">Socket_sendall</a>(client, msg, strlen(msg));</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">char</span> buf[1024];</div>
<div class="line">        ssize_t n = <a class="code hl_function" href="Socket_8h.html#af21e86cdf39ae94b27c74b19e6c29c28">Socket_recvall</a>(client, buf, strlen(msg));</div>
<div class="line">        buf[n] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">        printf(<span class="stringliteral">&quot;Received: %s\n&quot;</span>, buf);</div>
<div class="line">    <a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#a84516221c8fd2d4bdfde8d05eaf42cc6">Socket_Failed</a>)</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Error: %s\n&quot;</span>, Socket_error());</div>
<div class="line">    <a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#ae149a16c5ec76f277f565783bc39469e">Socket_Closed</a>)</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Connection closed\n&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="line">    </div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a>(&amp;client);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aSocket_8h_html_a6425897f52a2ee266a88f674de18ddd3"><div class="ttname"><a href="Socket_8h.html#a6425897f52a2ee266a88f674de18ddd3">Socket_connect</a></div><div class="ttdeci">void Socket_connect(T socket, const char *host, int port)</div><div class="ttdoc">Socket_connect - Connect to remote host @socket: Socket to connect @host: Remote IP address or hostna...</div></div>
<div class="ttc" id="aSocket_8h_html_ae149a16c5ec76f277f565783bc39469e"><div class="ttname"><a href="Socket_8h.html#ae149a16c5ec76f277f565783bc39469e">Socket_Closed</a></div><div class="ttdeci">Except_T Socket_Closed</div><div class="ttdoc">Connection closed by peer.</div></div>
<div class="ttc" id="aSocket_8h_html_af21e86cdf39ae94b27c74b19e6c29c28"><div class="ttname"><a href="Socket_8h.html#af21e86cdf39ae94b27c74b19e6c29c28">Socket_recvall</a></div><div class="ttdeci">ssize_t Socket_recvall(T socket, void *buf, size_t len)</div><div class="ttdoc">Socket_recvall - Receive all requested data (handles partial receives) @socket: Connected socket @buf...</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md9"></a>
Usage Patterns</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
Error Handling</h2>
<p>All socket operations use exception-based error handling:</p>
<div class="fragment"><div class="line"><a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a></div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#a6425897f52a2ee266a88f674de18ddd3">Socket_connect</a>(socket, <span class="stringliteral">&quot;example.com&quot;</span>, 80);</div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#afa7bde7e1ab3130c4674e0c7bcb94ea8">Socket_sendall</a>(socket, data, len);</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#a84516221c8fd2d4bdfde8d05eaf42cc6">Socket_Failed</a>)</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Socket error: %s\n&quot;</span>, Socket_error());</div>
<div class="line">    <span class="comment">/* Handle error */</span></div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#ae149a16c5ec76f277f565783bc39469e">Socket_Closed</a>)</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Connection closed\n&quot;</span>);</div>
<div class="line">    <span class="comment">/* Handle closure */</span></div>
<div class="line"><a class="code hl_define" href="Except_8h.html#a0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a></div>
<div class="line">    <span class="comment">/* Cleanup code always executes */</span></div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a>(&amp;socket);</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aExcept_8h_html_a0e2a75478cd44f1666a6aca626c5c50b"><div class="ttname"><a href="Except_8h.html#a0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a></div><div class="ttdeci">#define FINALLY</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00133">Except.h:133</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Non-Blocking I/O</h2>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structSocket__T.html">Socket_T</a> socket = <a class="code hl_function" href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a08886d4588009f86d4e5778363fd379e">Socket_setnonblocking</a>(socket);</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a></div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#a6425897f52a2ee266a88f674de18ddd3">Socket_connect</a>(socket, <span class="stringliteral">&quot;example.com&quot;</span>, 80);</div>
<div class="line">    <span class="comment">/* connect() returns immediately */</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* Use SocketPoll to wait for connection */</span></div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#a84516221c8fd2d4bdfde8d05eaf42cc6">Socket_Failed</a>)</div>
<div class="line">    <span class="comment">/* Handle error */</span></div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aSocket_8h_html_a08886d4588009f86d4e5778363fd379e"><div class="ttname"><a href="Socket_8h.html#a08886d4588009f86d4e5778363fd379e">Socket_setnonblocking</a></div><div class="ttdeci">void Socket_setnonblocking(T socket)</div><div class="ttdoc">Socket_setnonblocking - Enable non-blocking mode @socket: Socket to modify Raises: Socket_Failed on e...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
Event-Driven Server with SocketPoll</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Socket_8h.html">socket/Socket.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketPoll_8h.html">poll/SocketPoll.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="structSocket__T.html">Socket_T</a> server = <a class="code hl_function" href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#aa20213f48dd43a3129c9c9f3b03c9854">Socket_bind</a>(server, NULL, 8080);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#afb9495f689b00ffc14f393d8173c98a4">Socket_listen</a>(server, 10);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a08886d4588009f86d4e5778363fd379e">Socket_setnonblocking</a>(server);</div>
<div class="line"> </div>
<div class="line">SocketPoll_T poll = <a class="code hl_function" href="SocketPoll_8h.html#aae64ff18791dbd4acacc3c5ee6f4f710">SocketPoll_new</a>(100);</div>
<div class="line"><a class="code hl_function" href="SocketPoll_8h.html#a13c47bc69be50329371df6dd5e8bee70">SocketPoll_add</a>(poll, server, <a class="code hl_enumvalue" href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, NULL);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (1) {</div>
<div class="line">    <a class="code hl_struct" href="structSocketEvent.html">SocketEvent_T</a> events[10];</div>
<div class="line">    <span class="keywordtype">int</span> n = <a class="code hl_function" href="SocketPoll_8h.html#a838225b94dfd40f308c49482bca2e7fd">SocketPoll_wait</a>(poll, events, 10, 1000);</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line">        <span class="keywordflow">if</span> (events[i].socket == server) {</div>
<div class="line">            <a class="code hl_struct" href="structSocket__T.html">Socket_T</a> client = <a class="code hl_function" href="Socket_8h.html#af21e0268831aeee010b41d28ac61b464">Socket_accept</a>(server);</div>
<div class="line">            <span class="keywordflow">if</span> (client) {</div>
<div class="line">                <a class="code hl_function" href="Socket_8h.html#a08886d4588009f86d4e5778363fd379e">Socket_setnonblocking</a>(client);</div>
<div class="line">                <a class="code hl_function" href="SocketPoll_8h.html#a13c47bc69be50329371df6dd5e8bee70">SocketPoll_add</a>(poll, client, <a class="code hl_enumvalue" href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, client);</div>
<div class="line">            }</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">/* Handle client I/O */</span></div>
<div class="line">            <a class="code hl_struct" href="structSocket__T.html">Socket_T</a> client = events[i].<a class="code hl_variable" href="structSocketEvent.html#a609a22a6854c4771febb24b8642f8b0b">socket</a>;</div>
<div class="line">            <span class="keywordtype">char</span> buf[1024];</div>
<div class="line">            ssize_t n = <a class="code hl_function" href="Socket_8h.html#af5ec96ac4f3517384ca22c1ef50d646a">Socket_recv</a>(client, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line">            <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line">                <a class="code hl_function" href="Socket_8h.html#afa7bde7e1ab3130c4674e0c7bcb94ea8">Socket_sendall</a>(client, buf, n);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                SocketPoll_remove(poll, client);</div>
<div class="line">                <a class="code hl_function" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a>(&amp;client);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aSocketPoll_8h_html"><div class="ttname"><a href="SocketPoll_8h.html">SocketPoll.h</a></div></div>
<div class="ttc" id="aSocketPoll_8h_html_a13c47bc69be50329371df6dd5e8bee70"><div class="ttname"><a href="SocketPoll_8h.html#a13c47bc69be50329371df6dd5e8bee70">SocketPoll_add</a></div><div class="ttdeci">void SocketPoll_add(T poll, Socket_T socket, unsigned events, void *data)</div><div class="ttdoc">SocketPoll_add - Add socket to poll set @poll: Poll instance @socket: Socket to monitor @events: Even...</div></div>
<div class="ttc" id="aSocketPoll_8h_html_a838225b94dfd40f308c49482bca2e7fd"><div class="ttname"><a href="SocketPoll_8h.html#a838225b94dfd40f308c49482bca2e7fd">SocketPoll_wait</a></div><div class="ttdeci">int SocketPoll_wait(T poll, SocketEvent_T **events, int timeout)</div><div class="ttdoc">SocketPoll_wait - Wait for events @poll: Poll instance @events: Output - array of events that occurre...</div></div>
<div class="ttc" id="aSocketPoll_8h_html_a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8"><div class="ttname"><a href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a></div><div class="ttdeci">@ POLL_READ</div><div class="ttdoc">Data available for reading.</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00044">SocketPoll.h:44</a></div></div>
<div class="ttc" id="aSocketPoll_8h_html_aae64ff18791dbd4acacc3c5ee6f4f710"><div class="ttname"><a href="SocketPoll_8h.html#aae64ff18791dbd4acacc3c5ee6f4f710">SocketPoll_new</a></div><div class="ttdeci">T SocketPoll_new(int maxevents)</div><div class="ttdoc">SocketPoll_new - Create a new event poll @maxevents: Maximum events to return per wait call Returns: ...</div></div>
<div class="ttc" id="astructSocketEvent_html"><div class="ttname"><a href="structSocketEvent.html">SocketEvent</a></div><div class="ttdoc">Event structure returned by SocketPoll_wait.</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00053">SocketPoll.h:54</a></div></div>
<div class="ttc" id="astructSocketEvent_html_a609a22a6854c4771febb24b8642f8b0b"><div class="ttname"><a href="structSocketEvent.html#a609a22a6854c4771febb24b8642f8b0b">SocketEvent::socket</a></div><div class="ttdeci">Socket_T socket</div><div class="ttdoc">Socket that triggered event.</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00055">SocketPoll.h:55</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md13"></a>
UDP Server</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketDgram_8h.html">socket/SocketDgram.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line">SocketDgram_T server = <a class="code hl_function" href="SocketDgram_8h.html#a5f43b6d23b1541f9779c401be7c457a9">SocketDgram_new</a>(AF_INET, 0);</div>
<div class="line"><a class="code hl_function" href="SocketDgram_8h.html#ac461e869db9bcc13afce9670f50befc2">SocketDgram_bind</a>(server, NULL, 5000);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">char</span> buffer[65536];</div>
<div class="line"><span class="keywordtype">char</span> sender_host[256];</div>
<div class="line"><span class="keywordtype">int</span> sender_port;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (1) {</div>
<div class="line">    ssize_t n = <a class="code hl_function" href="SocketDgram_8h.html#aacd858e5105c8899e691c06f10cead6c">SocketDgram_recvfrom</a>(server, buffer, <span class="keyword">sizeof</span>(buffer),</div>
<div class="line">                                     sender_host, <span class="keyword">sizeof</span>(sender_host),</div>
<div class="line">                                     &amp;sender_port);</div>
<div class="line">    <span class="keywordflow">if</span> (n &gt; 0) {</div>
<div class="line">        <span class="comment">/* Echo back to sender */</span></div>
<div class="line">        <a class="code hl_function" href="SocketDgram_8h.html#a1a5b340d1fcc92169e6205a94afd7de2">SocketDgram_sendto</a>(server, buffer, n, sender_host, sender_port);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aSocketDgram_8h_html"><div class="ttname"><a href="SocketDgram_8h.html">SocketDgram.h</a></div></div>
<div class="ttc" id="aSocketDgram_8h_html_a1a5b340d1fcc92169e6205a94afd7de2"><div class="ttname"><a href="SocketDgram_8h.html#a1a5b340d1fcc92169e6205a94afd7de2">SocketDgram_sendto</a></div><div class="ttdeci">ssize_t SocketDgram_sendto(T socket, const void *buf, size_t len, const char *host, int port)</div><div class="ttdoc">SocketDgram_sendto - Send datagram to specific address @socket: Socket to send from @buf: Data to sen...</div></div>
<div class="ttc" id="aSocketDgram_8h_html_a5f43b6d23b1541f9779c401be7c457a9"><div class="ttname"><a href="SocketDgram_8h.html#a5f43b6d23b1541f9779c401be7c457a9">SocketDgram_new</a></div><div class="ttdeci">T SocketDgram_new(int domain, int protocol)</div></div>
<div class="ttc" id="aSocketDgram_8h_html_aacd858e5105c8899e691c06f10cead6c"><div class="ttname"><a href="SocketDgram_8h.html#aacd858e5105c8899e691c06f10cead6c">SocketDgram_recvfrom</a></div><div class="ttdeci">ssize_t SocketDgram_recvfrom(T socket, void *buf, size_t len, char *host, size_t host_len, int *port)</div><div class="ttdoc">SocketDgram_recvfrom - Receive datagram and get sender address @socket: Socket to receive from @buf: ...</div></div>
<div class="ttc" id="aSocketDgram_8h_html_ac461e869db9bcc13afce9670f50befc2"><div class="ttname"><a href="SocketDgram_8h.html#ac461e869db9bcc13afce9670f50befc2">SocketDgram_bind</a></div><div class="ttdeci">void SocketDgram_bind(T socket, const char *host, int port)</div><div class="ttdoc">SocketDgram_bind - Bind socket to address and port @socket: Socket to bind @host: IP address or NULL/...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md14"></a>
Connection Pooling</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketPool_8h.html">pool/SocketPool.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="Arena_8h.html">core/Arena.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line">Arena_T arena = <a class="code hl_function" href="Arena_8h.html#a89ed54bb26ea8d3b5adf6dd91bbfabcc">Arena_new</a>();</div>
<div class="line">SocketPool_T pool = <a class="code hl_function" href="SocketPool_8h.html#a74388803e1d08380acf64f7abbd00414">SocketPool_new</a>(arena, 1000, 8192);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Add accepted socket to pool */</span></div>
<div class="line"><a class="code hl_struct" href="structSocket__T.html">Socket_T</a> client = <a class="code hl_function" href="Socket_8h.html#af21e0268831aeee010b41d28ac61b464">Socket_accept</a>(server);</div>
<div class="line"><a class="code hl_struct" href="structConnection.html">Connection_T</a> conn = <a class="code hl_function" href="SocketPool_8h.html#a4b466dc021839d7eeec5f1ab320a7715">SocketPool_add</a>(pool, client);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Look up connection later */</span></div>
<div class="line"><a class="code hl_struct" href="structConnection.html">Connection_T</a> conn = <a class="code hl_function" href="SocketPool_8h.html#a85a96cfcffc6de6cfce0f3571e7adb18">SocketPool_get</a>(pool, client);</div>
<div class="line">SocketBuf_T input = Connection_input(conn);</div>
<div class="line">SocketBuf_T output = Connection_output(conn);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Clean up idle connections periodically */</span></div>
<div class="line"><a class="code hl_function" href="SocketPool_8h.html#a7087165181060dbdd9e37d5ff5e92c85">SocketPool_cleanup</a>(pool, 300);  <span class="comment">/* Remove idle &gt; 300 seconds */</span></div>
<div class="ttc" id="aArena_8h_html"><div class="ttname"><a href="Arena_8h.html">Arena.h</a></div></div>
<div class="ttc" id="aArena_8h_html_a89ed54bb26ea8d3b5adf6dd91bbfabcc"><div class="ttname"><a href="Arena_8h.html#a89ed54bb26ea8d3b5adf6dd91bbfabcc">Arena_new</a></div><div class="ttdeci">T Arena_new(void)</div><div class="ttdoc">Arena_new - Create a new memory arena Returns: New arena instance, or NULL on allocation failure Note...</div></div>
<div class="ttc" id="aSocketPool_8h_html"><div class="ttname"><a href="SocketPool_8h.html">SocketPool.h</a></div></div>
<div class="ttc" id="aSocketPool_8h_html_a4b466dc021839d7eeec5f1ab320a7715"><div class="ttname"><a href="SocketPool_8h.html#a4b466dc021839d7eeec5f1ab320a7715">SocketPool_add</a></div><div class="ttdeci">Connection_T SocketPool_add(T pool, Socket_T socket)</div><div class="ttdoc">SocketPool_add - Add socket to pool @pool: Pool instance @socket: Socket to add Returns: New connecti...</div></div>
<div class="ttc" id="aSocketPool_8h_html_a7087165181060dbdd9e37d5ff5e92c85"><div class="ttname"><a href="SocketPool_8h.html#a7087165181060dbdd9e37d5ff5e92c85">SocketPool_cleanup</a></div><div class="ttdeci">void SocketPool_cleanup(T pool, time_t idle_timeout)</div><div class="ttdoc">SocketPool_cleanup - Remove idle connections @pool: Pool instance @idle_timeout: Seconds inactive bef...</div></div>
<div class="ttc" id="aSocketPool_8h_html_a74388803e1d08380acf64f7abbd00414"><div class="ttname"><a href="SocketPool_8h.html#a74388803e1d08380acf64f7abbd00414">SocketPool_new</a></div><div class="ttdeci">T SocketPool_new(Arena_T arena, size_t maxconns, size_t bufsize)</div><div class="ttdoc">SocketPool_new - Create a new connection pool @arena: Arena for memory allocation @maxconns: Maximum ...</div></div>
<div class="ttc" id="aSocketPool_8h_html_a85a96cfcffc6de6cfce0f3571e7adb18"><div class="ttname"><a href="SocketPool_8h.html#a85a96cfcffc6de6cfce0f3571e7adb18">SocketPool_get</a></div><div class="ttdeci">Connection_T SocketPool_get(T pool, Socket_T socket)</div><div class="ttdoc">SocketPool_get - Look up connection by socket @pool: Pool instance @socket: Socket to find Returns: C...</div></div>
<div class="ttc" id="astructConnection_html"><div class="ttname"><a href="structConnection.html">Connection</a></div><div class="ttdef"><b>Definition</b> <a href="SocketPool-private_8h_source.html#l00014">SocketPool-private.h:15</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Zero-Copy File Transfer</h2>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> file_fd = open(<span class="stringliteral">&quot;largefile.bin&quot;</span>, O_RDONLY);</div>
<div class="line">off_t offset = 0;</div>
<div class="line">ssize_t sent = <a class="code hl_function" href="Socket_8h.html#a618437cdccde7f979f09307b99ad2b73">Socket_sendfileall</a>(socket, file_fd, &amp;offset, file_size);</div>
<div class="line">close(file_fd);</div>
<div class="ttc" id="aSocket_8h_html_a618437cdccde7f979f09307b99ad2b73"><div class="ttname"><a href="Socket_8h.html#a618437cdccde7f979f09307b99ad2b73">Socket_sendfileall</a></div><div class="ttdeci">ssize_t Socket_sendfileall(T socket, int file_fd, off_t *offset, size_t count)</div><div class="ttdoc">Socket_sendfileall - Zero-copy file-to-socket transfer (handles partial transfers) @socket: Connected...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
Scatter/Gather I/O</h2>
<div class="fragment"><div class="line"><span class="keyword">struct </span>iovec iov[3];</div>
<div class="line">iov[0].iov_base = header;</div>
<div class="line">iov[0].iov_len = header_len;</div>
<div class="line">iov[1].iov_base = body;</div>
<div class="line">iov[1].iov_len = body_len;</div>
<div class="line">iov[2].iov_base = footer;</div>
<div class="line">iov[2].iov_len = footer_len;</div>
<div class="line"> </div>
<div class="line">ssize_t sent = <a class="code hl_function" href="Socket_8h.html#abb71b00d768e2285da07038dd6144e8e">Socket_sendvall</a>(socket, iov, 3);</div>
<div class="ttc" id="aSocket_8h_html_abb71b00d768e2285da07038dd6144e8e"><div class="ttname"><a href="Socket_8h.html#abb71b00d768e2285da07038dd6144e8e">Socket_sendvall</a></div><div class="ttdeci">ssize_t Socket_sendvall(T socket, const struct iovec *iov, int iovcnt)</div><div class="ttdoc">Socket_sendvall - Scatter/gather send all (handles partial sends) @socket: Connected socket @iov: Arr...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md17"></a>
Advanced TCP Options</h2>
<div class="fragment"><div class="line"><span class="comment">/* Set congestion control algorithm (Linux only) */</span></div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a914404cbf71b91e14240ae961b30df73">Socket_setcongestion</a>(socket, <span class="stringliteral">&quot;bbr&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Enable TCP Fast Open (Linux 3.7+, FreeBSD 10.0+, macOS 10.11+) */</span></div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a2a60e026631198fa2ee225a74565afd5">Socket_setfastopen</a>(socket, 1);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Set TCP user timeout (Linux 2.6.37+) */</span></div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#af4873c11dcc702d693ee8bc930e61387">Socket_setusertimeout</a>(socket, 30000);  <span class="comment">/* 30 seconds */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Adjust buffer sizes */</span></div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#ac74d806db96f89a2e08338ddf59ad16a">Socket_setrcvbuf</a>(socket, 65536);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#aeecc754a971fa566e2b396d9025b961a">Socket_setsndbuf</a>(socket, 65536);</div>
<div class="ttc" id="aSocket_8h_html_a2a60e026631198fa2ee225a74565afd5"><div class="ttname"><a href="Socket_8h.html#a2a60e026631198fa2ee225a74565afd5">Socket_setfastopen</a></div><div class="ttdeci">void Socket_setfastopen(T socket, int enable)</div><div class="ttdoc">Socket_setfastopen - Enable TCP Fast Open @socket: Socket to modify @enable: 1 to enable,...</div></div>
<div class="ttc" id="aSocket_8h_html_a914404cbf71b91e14240ae961b30df73"><div class="ttname"><a href="Socket_8h.html#a914404cbf71b91e14240ae961b30df73">Socket_setcongestion</a></div><div class="ttdeci">void Socket_setcongestion(T socket, const char *algorithm)</div><div class="ttdoc">Socket_setcongestion - Set TCP congestion control algorithm @socket: Socket to modify @algorithm: Alg...</div></div>
<div class="ttc" id="aSocket_8h_html_ac74d806db96f89a2e08338ddf59ad16a"><div class="ttname"><a href="Socket_8h.html#ac74d806db96f89a2e08338ddf59ad16a">Socket_setrcvbuf</a></div><div class="ttdeci">void Socket_setrcvbuf(T socket, int size)</div><div class="ttdoc">Socket_setrcvbuf - Set receive buffer size @socket: Socket to modify @size: Buffer size in bytes (&gt; 0...</div></div>
<div class="ttc" id="aSocket_8h_html_aeecc754a971fa566e2b396d9025b961a"><div class="ttname"><a href="Socket_8h.html#aeecc754a971fa566e2b396d9025b961a">Socket_setsndbuf</a></div><div class="ttdeci">void Socket_setsndbuf(T socket, int size)</div><div class="ttdoc">Socket_setsndbuf - Set send buffer size @socket: Socket to modify @size: Buffer size in bytes (&gt; 0) R...</div></div>
<div class="ttc" id="aSocket_8h_html_af4873c11dcc702d693ee8bc930e61387"><div class="ttname"><a href="Socket_8h.html#af4873c11dcc702d693ee8bc930e61387">Socket_setusertimeout</a></div><div class="ttdeci">void Socket_setusertimeout(T socket, unsigned int timeout_ms)</div><div class="ttdoc">Socket_setusertimeout - Set TCP user timeout @socket: Socket to modify @timeout_ms: Timeout in millis...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md18"></a>
Asynchronous DNS Resolution</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketDNS_8h.html">dns/SocketDNS.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line">SocketDNS_T dns = <a class="code hl_function" href="SocketDNS_8h.html#a2b71ee0fa3c022f0342dd1bf9d2d9c14">SocketDNS_new</a>();</div>
<div class="line">SocketPoll_T poll = <a class="code hl_function" href="SocketPoll_8h.html#aae64ff18791dbd4acacc3c5ee6f4f710">SocketPoll_new</a>(100);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Start async resolution */</span></div>
<div class="line">SocketDNS_Request_T req = <a class="code hl_function" href="SocketDNS_8h.html#a3da13a84fbce512f59c75d3cdf53a3f9">SocketDNS_resolve</a>(dns, <span class="stringliteral">&quot;example.com&quot;</span>, 80, NULL, NULL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Add DNS resolver to poll set */</span></div>
<div class="line"><span class="keywordtype">int</span> dns_fd = <a class="code hl_function" href="SocketDNS_8h.html#a5bad005b6f546b3014c95735b5503020">SocketDNS_pollfd</a>(dns);</div>
<div class="line"><a class="code hl_function" href="SocketPoll_8h.html#a13c47bc69be50329371df6dd5e8bee70">SocketPoll_add</a>(poll, dns_fd, <a class="code hl_enumvalue" href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, dns);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* In event loop */</span></div>
<div class="line"><a class="code hl_struct" href="structSocketEvent.html">SocketEvent_T</a> events[10];</div>
<div class="line"><span class="keywordtype">int</span> n = <a class="code hl_function" href="SocketPoll_8h.html#a838225b94dfd40f308c49482bca2e7fd">SocketPoll_wait</a>(poll, events, 10, 1000);</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (events[i].data == dns) {</div>
<div class="line">        <a class="code hl_function" href="SocketDNS_8h.html#abd6710a0d5f406255e39a6ab44fa7603">SocketDNS_check</a>(dns);  <span class="comment">/* Process completed requests */</span></div>
<div class="line">        </div>
<div class="line">        <span class="comment">/* Get result */</span></div>
<div class="line">        <span class="keyword">struct </span>addrinfo *result = <a class="code hl_function" href="SocketDNS_8h.html#a9bf4ce3f4cc95b946d7a3418a74da3df">SocketDNS_getresult</a>(req);</div>
<div class="line">        <span class="keywordflow">if</span> (result) {</div>
<div class="line">            <span class="comment">/* Use result for connection */</span></div>
<div class="line">            Socket_connect_addrinfo(socket, result);</div>
<div class="line">            freeaddrinfo(result);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aSocketDNS_8h_html"><div class="ttname"><a href="SocketDNS_8h.html">SocketDNS.h</a></div></div>
<div class="ttc" id="aSocketDNS_8h_html_a2b71ee0fa3c022f0342dd1bf9d2d9c14"><div class="ttname"><a href="SocketDNS_8h.html#a2b71ee0fa3c022f0342dd1bf9d2d9c14">SocketDNS_new</a></div><div class="ttdeci">T SocketDNS_new(void)</div><div class="ttdoc">SocketDNS_new - Create a new async DNS resolver Returns: New DNS resolver instance Raises: SocketDNS_...</div></div>
<div class="ttc" id="aSocketDNS_8h_html_a3da13a84fbce512f59c75d3cdf53a3f9"><div class="ttname"><a href="SocketDNS_8h.html#a3da13a84fbce512f59c75d3cdf53a3f9">SocketDNS_resolve</a></div><div class="ttdeci">Request_T SocketDNS_resolve(T dns, const char *host, int port, SocketDNS_Callback callback, void *data)</div><div class="ttdoc">SocketDNS_resolve - Start async DNS resolution @dns: DNS resolver instance @host: Hostname or IP addr...</div></div>
<div class="ttc" id="aSocketDNS_8h_html_a5bad005b6f546b3014c95735b5503020"><div class="ttname"><a href="SocketDNS_8h.html#a5bad005b6f546b3014c95735b5503020">SocketDNS_pollfd</a></div><div class="ttdeci">int SocketDNS_pollfd(T dns)</div><div class="ttdoc">SocketDNS_pollfd - Get pollable file descriptor for SocketPoll integration @dns: DNS resolver instanc...</div></div>
<div class="ttc" id="aSocketDNS_8h_html_a9bf4ce3f4cc95b946d7a3418a74da3df"><div class="ttname"><a href="SocketDNS_8h.html#a9bf4ce3f4cc95b946d7a3418a74da3df">SocketDNS_getresult</a></div><div class="ttdeci">struct addrinfo * SocketDNS_getresult(T dns, Request_T req)</div><div class="ttdoc">SocketDNS_getresult - Get result of completed request @dns: DNS resolver instance @req: Request handl...</div></div>
<div class="ttc" id="aSocketDNS_8h_html_abd6710a0d5f406255e39a6ab44fa7603"><div class="ttname"><a href="SocketDNS_8h.html#abd6710a0d5f406255e39a6ab44fa7603">SocketDNS_check</a></div><div class="ttdeci">int SocketDNS_check(T dns)</div><div class="ttdoc">SocketDNS_check - Check for completed requests (non-blocking) @dns: DNS resolver instance Returns: Nu...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
TLS/SSL Secure Communication</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketTLS_8h.html">tls/SocketTLS.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SocketTLSContext_8h.html">tls/SocketTLSContext.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Create TLS context */</span></div>
<div class="line">SocketTLSContext_T ctx = SocketTLSContext_new_client(<span class="stringliteral">&quot;ca-bundle.crt&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Create and connect socket */</span></div>
<div class="line"><a class="code hl_struct" href="structSocket__T.html">Socket_T</a> socket = <a class="code hl_function" href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a6425897f52a2ee266a88f674de18ddd3">Socket_connect</a>(socket, <span class="stringliteral">&quot;example.com&quot;</span>, 443);</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Enable TLS */</span></div>
<div class="line">SocketTLS_enable(socket, ctx);</div>
<div class="line">SocketTLS_set_hostname(socket, <span class="stringliteral">&quot;example.com&quot;</span>); <span class="comment">/* SNI */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Perform handshake */</span></div>
<div class="line"><span class="keywordflow">while</span> (SocketTLS_handshake(socket) != TLS_HANDSHAKE_COMPLETE) {</div>
<div class="line">    <span class="comment">/* Handle non-blocking handshake if needed */</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Send/Recv encrypted data */</span></div>
<div class="line">SocketTLS_send(socket, <span class="stringliteral">&quot;GET / HTTP/1.1\r\n\r\n&quot;</span>, 18);</div>
<div class="line"><span class="keywordtype">char</span> buf[1024];</div>
<div class="line">SocketTLS_recv(socket, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Cleanup */</span></div>
<div class="line">SocketTLS_shutdown(socket);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a>(&amp;socket);</div>
<div class="line">SocketTLSContext_free(&amp;ctx);</div>
<div class="ttc" id="aSocketTLSContext_8h_html"><div class="ttname"><a href="SocketTLSContext_8h.html">SocketTLSContext.h</a></div></div>
<div class="ttc" id="aSocketTLS_8h_html"><div class="ttname"><a href="SocketTLS_8h.html">SocketTLS.h</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20"></a>
API Reference</h1>
<h2><a class="anchor" id="autotoc_md21"></a>
Core Modules</h2>
<h3><a class="anchor" id="autotoc_md22"></a>
Socket (TCP Stream Sockets)</h3>
<p><b>Creation and Lifecycle:</b></p><ul>
<li><code><a class="el" href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new()</a></code> - Create new socket</li>
<li><code><a class="el" href="Socket_8h.html#a98ea06a38e059da3259baf352f74bf15" title="SocketPair_new - Create a pair of connected Unix domain sockets @type: Socket type (SOCK_STREAM or SO...">SocketPair_new()</a></code> - Create connected Unix domain socket pair</li>
<li><code><a class="el" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d" title="Socket_free - Free a socket and close the connection @socket: Pointer to socket (will be set to NULL)">Socket_free()</a></code> - Free socket and close connection</li>
<li><code><a class="el" href="Socket_8h.html#ac3a53c77fcff7863928e76e3f1d853eb" title="Socket_fd - Get underlying file descriptor @socket: Socket instance Returns: File descriptor.">Socket_fd()</a></code> - Get underlying file descriptor</li>
</ul>
<p><b><a class="el" href="structConnection.html">Connection</a> Management:</b></p><ul>
<li><code><a class="el" href="Socket_8h.html#aa20213f48dd43a3129c9c9f3b03c9854" title="Socket_bind - Bind socket to address and port @socket: Socket to bind @host: IP address or NULL/&quot;0....">Socket_bind()</a></code> - Bind socket to address/port</li>
<li><code><a class="el" href="Socket_8h.html#afb9495f689b00ffc14f393d8173c98a4" title="Socket_listen - Listen for incoming connections @socket: Bound socket @backlog: Maximum pending conne...">Socket_listen()</a></code> - Start listening for connections</li>
<li><code><a class="el" href="Socket_8h.html#af21e0268831aeee010b41d28ac61b464" title="Socket_accept - Accept incoming connection @socket: Listening socket Returns: New socket or NULL if w...">Socket_accept()</a></code> - Accept incoming connection</li>
<li><code><a class="el" href="Socket_8h.html#a6425897f52a2ee266a88f674de18ddd3" title="Socket_connect - Connect to remote host @socket: Socket to connect @host: Remote IP address or hostna...">Socket_connect()</a></code> - Connect to remote host</li>
<li><code><a class="el" href="Socket_8h.html#a04bb2a02d1e1cde1316ebb24bc6d33ee" title="Socket_shutdown - Disable further sends and/or receives @socket: Connected socket @how: Shutdown mode...">Socket_shutdown()</a></code> - Shutdown connection</li>
<li><code><a class="el" href="Socket_8h.html#a4c832b75a949f8716f52b2a25fa54071" title="Socket_isconnected - Check if socket is connected @socket: Socket to check Returns: 1 if connected,...">Socket_isconnected()</a></code> - Check connection state</li>
<li><code><a class="el" href="Socket_8h.html#a87607a3fb7bb47442e3ca5c8664cadf3" title="Socket_isbound - Check if socket is bound to an address @socket: Socket to check Returns: 1 if bound,...">Socket_isbound()</a></code> - Check bind state</li>
<li><code><a class="el" href="Socket_8h.html#aaf51b653c9d3ad62e91c87ffb8977459" title="Socket_islistening - Check if socket is listening for connections @socket: Socket to check Returns: 1...">Socket_islistening()</a></code> - Check listen state</li>
</ul>
<p><b>I/O Operations:</b></p><ul>
<li><code><a class="el" href="Socket_8h.html#ab72bbc8824c7adf5aa55af88b784b9d0" title="Socket_send - Send data @socket: Connected socket @buf: Data to send @len: Length of data (&gt; 0) Retur...">Socket_send()</a></code> / <code><a class="el" href="Socket_8h.html#af5ec96ac4f3517384ca22c1ef50d646a" title="Socket_recv - Receive data @socket: Connected socket @buf: Buffer for received data @len: Buffer size...">Socket_recv()</a></code> - Basic send/receive</li>
<li><code><a class="el" href="Socket_8h.html#afa7bde7e1ab3130c4674e0c7bcb94ea8" title="Socket_sendall - Send all data (handles partial sends) @socket: Connected socket @buf: Data to send @...">Socket_sendall()</a></code> / <code><a class="el" href="Socket_8h.html#af21e86cdf39ae94b27c74b19e6c29c28" title="Socket_recvall - Receive all requested data (handles partial receives) @socket: Connected socket @buf...">Socket_recvall()</a></code> - Complete send/receive (handles partial I/O)</li>
<li><code><a class="el" href="Socket_8h.html#ab675b5c1dbc4531aa0c1fc289475823b" title="Socket_sendv - Scatter/gather send (writev wrapper) @socket: Connected socket @iov: Array of iovec st...">Socket_sendv()</a></code> / <code><a class="el" href="Socket_8h.html#af2a76fbae389a57c9a0389a691f90766" title="Socket_recvv - Scatter/gather receive (readv wrapper) @socket: Connected socket @iov: Array of iovec ...">Socket_recvv()</a></code> - Scatter/gather I/O</li>
<li><code><a class="el" href="Socket_8h.html#abb71b00d768e2285da07038dd6144e8e" title="Socket_sendvall - Scatter/gather send all (handles partial sends) @socket: Connected socket @iov: Arr...">Socket_sendvall()</a></code> / <code><a class="el" href="Socket_8h.html#ac157beed03142752182021261a263671" title="Socket_recvvall - Scatter/gather receive all (handles partial receives) @socket: Connected socket @io...">Socket_recvvall()</a></code> - Complete scatter/gather I/O</li>
<li><code><a class="el" href="Socket_8h.html#acb117caeae8c8c1ce3b50a0568be35da" title="Socket_sendfile - Zero-copy file-to-socket transfer @socket: Connected socket to send to @file_fd: Fi...">Socket_sendfile()</a></code> / <code><a class="el" href="Socket_8h.html#a618437cdccde7f979f09307b99ad2b73" title="Socket_sendfileall - Zero-copy file-to-socket transfer (handles partial transfers) @socket: Connected...">Socket_sendfileall()</a></code> - Zero-copy file transfer</li>
<li><code><a class="el" href="Socket_8h.html#ab76433dc005a43612f7ce752d01884e3" title="Socket_sendmsg - Send message with ancillary data (sendmsg wrapper) @socket: Connected socket @msg: M...">Socket_sendmsg()</a></code> / <code><a class="el" href="Socket_8h.html#a3aec26ecfd893efb26b95ec741c46656" title="Socket_recvmsg - Receive message with ancillary data (recvmsg wrapper) @socket: Connected socket @msg...">Socket_recvmsg()</a></code> - Advanced message I/O with ancillary data</li>
</ul>
<p><b>Socket Options:</b></p><ul>
<li><code><a class="el" href="Socket_8h.html#a08886d4588009f86d4e5778363fd379e" title="Socket_setnonblocking - Enable non-blocking mode @socket: Socket to modify Raises: Socket_Failed on e...">Socket_setnonblocking()</a></code> - Enable non-blocking mode</li>
<li><code><a class="el" href="Socket_8h.html#aa9ad5151bf257e772cf3cfb32f4b13bb" title="Socket_setreuseaddr - Enable address reuse @socket: Socket to modify Raises: Socket_Failed on error.">Socket_setreuseaddr()</a></code> - Enable address reuse</li>
<li><code><a class="el" href="Socket_8h.html#a0ce3128becb062e541c093f2277f03fe" title="Socket_setreuseport - Enable port reuse across sockets @socket: Socket to modify Raises: Socket_Faile...">Socket_setreuseport()</a></code> - Enable port reuse</li>
<li><code><a class="el" href="Socket_8h.html#a12e9038dc4c692fb378b28d221bf7236" title="Socket_settimeout - Set socket timeout @socket: Socket to modify @timeout_sec: Timeout in seconds (0 ...">Socket_settimeout()</a></code> - Set socket timeout</li>
<li><code><a class="el" href="Socket_8h.html#a168b58f8fb7cb65ddb1a417c79cf0d6c" title="Socket_setkeepalive - Enable TCP keepalive @socket: Socket to modify @idle: Seconds before sending ke...">Socket_setkeepalive()</a></code> - Configure TCP keepalive</li>
<li><code><a class="el" href="Socket_8h.html#a228f425d55147dafd5e29799d5c03af0" title="Socket_setnodelay - Disable Nagle&#39;s algorithm @socket: Socket to modify @nodelay: 1 to disable Nagle,...">Socket_setnodelay()</a></code> - Disable Nagle's algorithm</li>
<li><code><a class="el" href="Socket_8h.html#ac74d806db96f89a2e08338ddf59ad16a" title="Socket_setrcvbuf - Set receive buffer size @socket: Socket to modify @size: Buffer size in bytes (&gt; 0...">Socket_setrcvbuf()</a></code> / <code><a class="el" href="Socket_8h.html#a9262ae6cbe3a40b63967ba700a011016" title="Socket_getrcvbuf - Get receive buffer size @socket: Socket to query Returns: Receive buffer size in b...">Socket_getrcvbuf()</a></code> - Receive buffer size</li>
<li><code><a class="el" href="Socket_8h.html#aeecc754a971fa566e2b396d9025b961a" title="Socket_setsndbuf - Set send buffer size @socket: Socket to modify @size: Buffer size in bytes (&gt; 0) R...">Socket_setsndbuf()</a></code> / <code><a class="el" href="Socket_8h.html#ad9c1ac9908662a224b8c818e6d55f0ec" title="Socket_getsndbuf - Get send buffer size @socket: Socket to query Returns: Send buffer size in bytes R...">Socket_getsndbuf()</a></code> - Send buffer size</li>
<li><code><a class="el" href="Socket_8h.html#a914404cbf71b91e14240ae961b30df73" title="Socket_setcongestion - Set TCP congestion control algorithm @socket: Socket to modify @algorithm: Alg...">Socket_setcongestion()</a></code> / <code><a class="el" href="Socket_8h.html#a4e65e3db5bd05c0ff61ba863b9b8732e" title="Socket_getcongestion - Get TCP congestion control algorithm @socket: Socket to query @algorithm: Outp...">Socket_getcongestion()</a></code> - TCP congestion control (Linux)</li>
<li><code><a class="el" href="Socket_8h.html#a2a60e026631198fa2ee225a74565afd5" title="Socket_setfastopen - Enable TCP Fast Open @socket: Socket to modify @enable: 1 to enable,...">Socket_setfastopen()</a></code> / <code><a class="el" href="Socket_8h.html#a0734cbd1a3c15bd40d84878102f4cb3f" title="Socket_getfastopen - Get TCP Fast Open setting @socket: Socket to query Returns: 1 if enabled,...">Socket_getfastopen()</a></code> - TCP Fast Open</li>
<li><code><a class="el" href="Socket_8h.html#af4873c11dcc702d693ee8bc930e61387" title="Socket_setusertimeout - Set TCP user timeout @socket: Socket to modify @timeout_ms: Timeout in millis...">Socket_setusertimeout()</a></code> / <code><a class="el" href="Socket_8h.html#a5fa721bd54b028d6e92cc459c76b96ef" title="Socket_getusertimeout - Get TCP user timeout @socket: Socket to query Returns: Timeout in millisecond...">Socket_getusertimeout()</a></code> - TCP user timeout (Linux)</li>
</ul>
<p><b>Timeouts:</b></p><ul>
<li><code><a class="el" href="Socket_8h.html#a617c15d23eeff4b6b91aca2d1993a407" title="Socket_timeouts_set - Set per-socket timeout configuration @socket: Socket instance @timeouts: Timeou...">Socket_timeouts_set()</a></code> - Set per-socket timeouts</li>
<li><code><a class="el" href="Socket_8h.html#a590cc74ce83a3ed92afa6f50bb6de788" title="Socket_timeouts_get - Retrieve per-socket timeout configuration @socket: Socket instance @timeouts: O...">Socket_timeouts_get()</a></code> - Get per-socket timeouts</li>
<li><code><a class="el" href="Socket_8h.html#a0385e87c51740c37c9d90ff5bba1eced" title="Socket_timeouts_setdefaults - Set global default timeouts @timeouts: New default timeout configuratio...">Socket_timeouts_setdefaults()</a></code> - Set global default timeouts</li>
<li><code><a class="el" href="Socket_8h.html#acfcc79428e54b0284cc7cad257d56adf" title="Socket_timeouts_getdefaults - Get global default timeouts @timeouts: Output timeout structure contain...">Socket_timeouts_getdefaults()</a></code> - Get global default timeouts</li>
</ul>
<h3><a class="anchor" id="autotoc_md23"></a>
SocketDgram (UDP Datagram Sockets)</h3>
<p><b>Creation:</b></p><ul>
<li><code><a class="el" href="SocketDgram_8h.html#a5f43b6d23b1541f9779c401be7c457a9">SocketDgram_new()</a></code> - Create UDP socket</li>
<li><code><a class="el" href="SocketDgram_8h.html#ab3b092057e1cc0df4b645d749571569a" title="SocketDgram_free - Free a socket and close the connection @socket: Pointer to socket (will be set to ...">SocketDgram_free()</a></code> - Free socket</li>
</ul>
<p><b><a class="el" href="structConnection.html">Connection</a> Management:</b></p><ul>
<li><code><a class="el" href="SocketDgram_8h.html#ac461e869db9bcc13afce9670f50befc2" title="SocketDgram_bind - Bind socket to address and port @socket: Socket to bind @host: IP address or NULL/...">SocketDgram_bind()</a></code> - Bind socket</li>
<li><code><a class="el" href="SocketDgram_8h.html#a09d2f34ab008429afe4706f6a0080c63" title="SocketDgram_connect - Set default destination for socket @socket: Socket to connect @host: Remote IP ...">SocketDgram_connect()</a></code> - Connect socket (for send/recv)</li>
<li><code><a class="el" href="SocketDgram_8h.html#ab94c1cd04fb37a553c8811d305142a48" title="SocketDgram_isconnected - Check if datagram socket is connected @socket: Socket to check Returns: 1 i...">SocketDgram_isconnected()</a></code> - Check connection state</li>
<li><code><a class="el" href="SocketDgram_8h.html#a467564f594aa8e9779956218761ebf2d" title="SocketDgram_isbound - Check if datagram socket is bound to an address @socket: Socket to check Return...">SocketDgram_isbound()</a></code> - Check bind state</li>
</ul>
<p><b>I/O Operations:</b></p><ul>
<li><code><a class="el" href="SocketDgram_8h.html#a1a5b340d1fcc92169e6205a94afd7de2" title="SocketDgram_sendto - Send datagram to specific address @socket: Socket to send from @buf: Data to sen...">SocketDgram_sendto()</a></code> / <code><a class="el" href="SocketDgram_8h.html#aacd858e5105c8899e691c06f10cead6c" title="SocketDgram_recvfrom - Receive datagram and get sender address @socket: Socket to receive from @buf: ...">SocketDgram_recvfrom()</a></code> - Connectionless I/O</li>
<li><code><a class="el" href="SocketDgram_8h.html#a29f7bba242b53faa2e1d2ebbb77b484a" title="SocketDgram_send - Send to default destination (connected socket) @socket: Connected socket @buf: Dat...">SocketDgram_send()</a></code> / <code><a class="el" href="SocketDgram_8h.html#a36406c4a6e9073a01665493fcf56684f" title="SocketDgram_recv - Receive from default source (connected socket) @socket: Connected socket @buf: Buf...">SocketDgram_recv()</a></code> - Connected I/O</li>
<li><code><a class="el" href="SocketDgram_8h.html#af2211ccb0fe4e9c39936b9214dfcad57" title="SocketDgram_sendall - Send all data (handles partial sends) @socket: Connected socket @buf: Data to s...">SocketDgram_sendall()</a></code> / <code><a class="el" href="SocketDgram_8h.html#acdf18d210c55d4f6683cb714445d6298" title="SocketDgram_recvall - Receive all requested data (handles partial receives) @socket: Connected socket...">SocketDgram_recvall()</a></code> - Complete I/O</li>
<li><code><a class="el" href="SocketDgram_8h.html#a4cdff701bb596a34edbad25c1c3fe0e4" title="SocketDgram_sendv - Scatter/gather send (writev wrapper) @socket: Connected socket @iov: Array of iov...">SocketDgram_sendv()</a></code> / <code><a class="el" href="SocketDgram_8h.html#a20bdc35f196074cf7e79d48efe175ff4" title="SocketDgram_recvv - Scatter/gather receive (readv wrapper) @socket: Connected socket @iov: Array of i...">SocketDgram_recvv()</a></code> - Scatter/gather I/O</li>
<li><code><a class="el" href="SocketDgram_8h.html#a8583cc87120211fb72fe2475beefd8a8" title="SocketDgram_sendvall - Scatter/gather send all (handles partial sends) @socket: Connected socket @iov...">SocketDgram_sendvall()</a></code> / <code><a class="el" href="SocketDgram_8h.html#a1bee9ae981b2503ee294007d9686563c" title="SocketDgram_recvvall - Scatter/gather receive all (handles partial receives) @socket: Connected socke...">SocketDgram_recvvall()</a></code> - Complete scatter/gather</li>
</ul>
<p><b>Multicast/Broadcast:</b></p><ul>
<li><code><a class="el" href="SocketDgram_8h.html#a2029cc165b79dff7810c98406ee5c8d2" title="SocketDgram_setbroadcast - Enable broadcast @socket: Socket to modify @enable: 1 to enable,...">SocketDgram_setbroadcast()</a></code> - Enable broadcast</li>
<li><code>SocketDgram_join_multicast()</code> - Join multicast group</li>
<li><code>SocketDgram_leave_multicast()</code> - Leave multicast group</li>
<li><code><a class="el" href="SocketDgram_8h.html#a8e6f537e879fee3ef5e16ba91cd05ecb" title="SocketDgram_setttl - Set time-to-live (hop limit) @socket: Socket to modify @ttl: TTL value (1-255) R...">SocketDgram_setttl()</a></code> - Set TTL</li>
</ul>
<h3><a class="anchor" id="autotoc_md24"></a>
SocketPoll (Event Polling)</h3>
<ul>
<li><code><a class="el" href="SocketPoll_8h.html#aae64ff18791dbd4acacc3c5ee6f4f710" title="SocketPoll_new - Create a new event poll @maxevents: Maximum events to return per wait call Returns: ...">SocketPoll_new()</a></code> - Create poll instance</li>
<li><code><a class="el" href="SocketPoll_8h.html#ac93edae1d8976b9f30f1dff1d18ca62b" title="SocketPoll_free - Free an event poll @poll: Pointer to poll (will be set to NULL) Closes the underlyi...">SocketPoll_free()</a></code> - Free poll instance</li>
<li><code><a class="el" href="SocketPoll_8h.html#a13c47bc69be50329371df6dd5e8bee70" title="SocketPoll_add - Add socket to poll set @poll: Poll instance @socket: Socket to monitor @events: Even...">SocketPoll_add()</a></code> - Add socket to poll set</li>
<li><code>SocketPoll_remove()</code> - Remove socket from poll set</li>
<li><code>SocketPoll_modify()</code> - Modify socket events</li>
<li><code><a class="el" href="SocketPoll_8h.html#a838225b94dfd40f308c49482bca2e7fd" title="SocketPoll_wait - Wait for events @poll: Poll instance @events: Output - array of events that occurre...">SocketPoll_wait()</a></code> - Wait for events</li>
<li><code>SocketPoll_get_backend()</code> - Get backend name (epoll/kqueue/poll)</li>
</ul>
<h3><a class="anchor" id="autotoc_md25"></a>
SocketPool (Connection Pooling)</h3>
<ul>
<li><code><a class="el" href="SocketPool_8h.html#a74388803e1d08380acf64f7abbd00414" title="SocketPool_new - Create a new connection pool @arena: Arena for memory allocation @maxconns: Maximum ...">SocketPool_new()</a></code> - Create pool</li>
<li><code><a class="el" href="SocketPool_8h.html#a4d90769ccea1288fb30e50ec18e4f0c4" title="SocketPool_free - Free a connection pool @pool: Pointer to pool (will be set to NULL) Note: Does not ...">SocketPool_free()</a></code> - Free pool</li>
<li><code><a class="el" href="SocketPool_8h.html#a4b466dc021839d7eeec5f1ab320a7715" title="SocketPool_add - Add socket to pool @pool: Pool instance @socket: Socket to add Returns: New connecti...">SocketPool_add()</a></code> - Add socket to pool</li>
<li><code><a class="el" href="SocketPool_8h.html#a2a5f1ef514ea1ccbe5133b4eca4f5dfb" title="SocketPool_remove - Remove socket from pool @pool: Pool instance @socket: Socket to remove Clears buf...">SocketPool_remove()</a></code> - Remove socket from pool</li>
<li><code><a class="el" href="SocketPool_8h.html#a85a96cfcffc6de6cfce0f3571e7adb18" title="SocketPool_get - Look up connection by socket @pool: Pool instance @socket: Socket to find Returns: C...">SocketPool_get()</a></code> - Look up connection</li>
<li><code><a class="el" href="SocketPool_8h.html#a7087165181060dbdd9e37d5ff5e92c85" title="SocketPool_cleanup - Remove idle connections @pool: Pool instance @idle_timeout: Seconds inactive bef...">SocketPool_cleanup()</a></code> - Remove idle connections</li>
<li><code><a class="el" href="SocketPool_8h.html#aaeff7efb1109a312f56e35689b67c652" title="Connection_socket - Get connection&#39;s socket @conn: Connection Returns: Socket.">Connection_socket()</a></code> - Get connection's socket</li>
<li><code>Connection_input()</code> - Get input buffer</li>
<li><code>Connection_output()</code> - Get output buffer</li>
<li><code><a class="el" href="SocketPool_8h.html#a1faf8c706d1ed9418446fc155fa289dd" title="Connection_data - Get user data @conn: Connection Returns: User data.">Connection_data()</a></code> - Get/set user data</li>
</ul>
<h3><a class="anchor" id="autotoc_md26"></a>
SocketDNS (Asynchronous DNS)</h3>
<ul>
<li><code><a class="el" href="SocketDNS_8h.html#a2b71ee0fa3c022f0342dd1bf9d2d9c14" title="SocketDNS_new - Create a new async DNS resolver Returns: New DNS resolver instance Raises: SocketDNS_...">SocketDNS_new()</a></code> - Create DNS resolver</li>
<li><code><a class="el" href="SocketDNS_8h.html#a5aa225e09d741aebee12bf0b5ab61e3c" title="SocketDNS_free - Free a DNS resolver @dns: Pointer to resolver (will be set to NULL) Drains pending r...">SocketDNS_free()</a></code> - Free resolver</li>
<li><code><a class="el" href="SocketDNS_8h.html#a3da13a84fbce512f59c75d3cdf53a3f9" title="SocketDNS_resolve - Start async DNS resolution @dns: DNS resolver instance @host: Hostname or IP addr...">SocketDNS_resolve()</a></code> - Start async resolution</li>
<li><code><a class="el" href="SocketDNS_8h.html#a9bf4ce3f4cc95b946d7a3418a74da3df" title="SocketDNS_getresult - Get result of completed request @dns: DNS resolver instance @req: Request handl...">SocketDNS_getresult()</a></code> - Get resolution result</li>
<li><code><a class="el" href="SocketDNS_8h.html#ab8a9f6d43d9a9044391e3d91a050e7bf" title="SocketDNS_cancel - Cancel a pending DNS resolution @dns: DNS resolver instance @req: Request handle t...">SocketDNS_cancel()</a></code> - Cancel resolution</li>
<li><code><a class="el" href="SocketDNS_8h.html#a5bad005b6f546b3014c95735b5503020" title="SocketDNS_pollfd - Get pollable file descriptor for SocketPoll integration @dns: DNS resolver instanc...">SocketDNS_pollfd()</a></code> - Get poll file descriptor</li>
<li><code><a class="el" href="SocketDNS_8h.html#abd6710a0d5f406255e39a6ab44fa7603" title="SocketDNS_check - Check for completed requests (non-blocking) @dns: DNS resolver instance Returns: Nu...">SocketDNS_check()</a></code> - Process completed requests</li>
</ul>
<h3><a class="anchor" id="autotoc_md27"></a>
SocketTLS (TLS/SSL)</h3>
<ul>
<li><code>SocketTLSContext_new_client()</code> - Create client TLS context</li>
<li><code>SocketTLSContext_new_server()</code> - Create server TLS context</li>
<li><code>SocketTLSContext_free()</code> - Free TLS context</li>
<li><code>SocketTLS_enable()</code> - Enable TLS on socket</li>
<li><code>SocketTLS_handshake()</code> - Perform TLS handshake</li>
<li><code>SocketTLS_send()</code> / <code>SocketTLS_recv()</code> - Encrypted I/O</li>
<li><code>SocketTLS_shutdown()</code> - Graceful TLS shutdown</li>
<li><code>SocketTLS_set_hostname()</code> - Set SNI hostname</li>
</ul>
<h2><a class="anchor" id="autotoc_md28"></a>
Exception Types</h2>
<ul>
<li><code>Socket_Failed</code> - General socket operation failure</li>
<li><code>Socket_Closed</code> - <a class="el" href="structConnection.html">Connection</a> closed by peer</li>
<li><code>SocketDgram_Failed</code> - UDP socket operation failure</li>
<li><code>SocketPoll_Failed</code> - Event polling failure</li>
<li><code>SocketPool_Failed</code> - <a class="el" href="structConnection.html">Connection</a> pool operation failure</li>
<li><code>SocketDNS_Failed</code> - DNS resolution failure</li>
<li><code>SocketTLS_Failed</code> - General TLS operation failure</li>
<li><code>SocketTLS_HandshakeFailed</code> - TLS handshake failure</li>
<li><code>SocketTLS_VerifyFailed</code> - Certificate verification failure</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
Error Reporting</h2>
<ul>
<li><code>Socket_error()</code> - Get last error message (thread-local)</li>
<li><code><a class="el" href="SocketError_8h.html#aacd3ef2f86186c451f2eb90cd490eae5" title="Socket_geterrno - Get the last captured errno value Returns: Last errno value captured by error macro...">Socket_geterrno()</a></code> - Get last errno value</li>
<li><code><a class="el" href="SocketError_8h.html#a46f8d730d28e8c5cbd55e3cbe4c83945" title="Socket_geterrorcode - Get the last error as a SocketErrorCode enum Returns: SocketErrorCode enum valu...">Socket_geterrorcode()</a></code> - Get structured error code</li>
</ul>
<h1><a class="anchor" id="autotoc_md30"></a>
Building</h1>
<h2><a class="anchor" id="autotoc_md31"></a>
Requirements</h2>
<ul>
<li>CMake 3.10+</li>
<li>C11 compiler with pthread support</li>
<li>POSIX-compliant system</li>
</ul>
<h2><a class="anchor" id="autotoc_md32"></a>
Build Commands</h2>
<div class="fragment"><div class="line"># Configure</div>
<div class="line">cmake -S . -B build</div>
<div class="line"> </div>
<div class="line"># Build</div>
<div class="line">cmake --build build -j</div>
<div class="line"> </div>
<div class="line"># Run tests</div>
<div class="line">cmake --build build --target test</div>
<div class="line"> </div>
<div class="line"># Install (optional)</div>
<div class="line">cmake --install build --prefix /usr/local</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md33"></a>
Build Options</h2>
<ul>
<li><code>CMAKE_BUILD_TYPE</code> - Debug or Release (default: Debug)</li>
<li>Platform-specific backends are automatically detected</li>
</ul>
<h1><a class="anchor" id="autotoc_md34"></a>
Thread Safety</h1>
<ul>
<li><b>Socket operations</b> - Thread-safe per socket (one thread per socket recommended)</li>
<li><b>Error reporting</b> - Thread-local (safe for concurrent use)</li>
<li><b>SocketPoll</b> - Thread-safe (protected by mutexes)</li>
<li><b>SocketPool</b> - Thread-safe (protected by mutexes)</li>
<li><b>SocketDNS</b> - Thread-safe (uses thread pool)</li>
</ul>
<h1><a class="anchor" id="autotoc_md35"></a>
Memory Management</h1>
<p>The library uses <b>arena allocation</b> for related objects. Sockets and their associated resources are managed through arenas, ensuring efficient memory usage and automatic cleanup.</p>
<div class="fragment"><div class="line">Arena_T arena = <a class="code hl_function" href="Arena_8h.html#a89ed54bb26ea8d3b5adf6dd91bbfabcc">Arena_new</a>();</div>
<div class="line"><a class="code hl_struct" href="structSocket__T.html">Socket_T</a> socket = <a class="code hl_function" href="Socket_8h.html#a48a12cae4cd51b880e7927a22ab82641">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><span class="comment">/* Socket uses arena internally */</span></div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a221d64c385da1687c988f7ffeb67697d">Socket_free</a>(&amp;socket);  <span class="comment">/* Frees socket and arena */</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md36"></a>
Performance Considerations</h1>
<ul>
<li><b>Zero-copy I/O</b> - Uses platform-specific <code>sendfile()</code> when available</li>
<li><b>Scatter/gather I/O</b> - Efficient multi-buffer operations</li>
<li><b>Event polling</b> - O(1) event delivery with epoll/kqueue</li>
<li><b><a class="el" href="structConnection.html">Connection</a> pooling</b> - O(1) lookup with hash tables</li>
<li><b>Non-blocking I/O</b> - Full support for async operations</li>
</ul>
<h1><a class="anchor" id="autotoc_md37"></a>
Examples</h1>
<p>See <code>src/test/</code> directory for comprehensive usage examples:</p><ul>
<li><code>test_socket.c</code> - TCP socket examples</li>
<li><code>test_socketdgram.c</code> - UDP socket examples</li>
<li><code>test_socketpoll.c</code> - Event polling examples</li>
<li><code>test_socketpool.c</code> - <a class="el" href="structConnection.html">Connection</a> pooling examples</li>
<li><code>test_socketdns.c</code> - Async DNS examples</li>
<li><code>test_integration.c</code> - Integration test scenarios</li>
</ul>
<h1><a class="anchor" id="autotoc_md38"></a>
Documentation</h1>
<ul>
<li><b>Release Notes</b> - See RELEASE_NOTES.md for latest changes</li>
<li><b>Architecture</b> - See <code>.cursor/rules/</code> for detailed design patterns</li>
<li><b>API Documentation</b> - All functions include Doxygen-style comments</li>
</ul>
<h2><a class="anchor" id="autotoc_md39"></a>
Generating API Reference</h2>
<p>To generate modern, beautiful HTML API documentation:</p>
<div class="fragment"><div class="line"># Install Doxygen (if not already installed)</div>
<div class="line"># Ubuntu/Debian: sudo apt-get install doxygen</div>
<div class="line"># macOS: brew install doxygen</div>
<div class="line"> </div>
<div class="line"># Generate documentation (includes modern CSS theme)</div>
<div class="line">cmake --build build --target doc</div>
<div class="line"># or</div>
<div class="line">make doc</div>
<div class="line"># or directly</div>
<div class="line">doxygen Doxyfile</div>
<div class="line"> </div>
<div class="line"># View documentation</div>
<div class="line">open docs/html/index.html  # macOS</div>
<div class="line">xdg-open docs/html/index.html  # Linux</div>
</div><!-- fragment --><p><b>Features:</b></p><ul>
<li>Modern, clean design with dark mode support</li>
<li>Tree view navigation for easy browsing</li>
<li>Enhanced search functionality</li>
<li>Responsive layout for mobile devices</li>
<li>Syntax highlighting for code examples</li>
<li>Professional typography and spacing</li>
</ul>
<p>The generated documentation will be in <code>docs/html/</code> directory with a modern CSS theme applied.</p>
<h1><a class="anchor" id="autotoc_md40"></a>
License</h1>
<p>See <code>LICENSE</code> (if provided) for usage details. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
