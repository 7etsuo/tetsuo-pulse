<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="High-performance, exception-driven socket toolkit for POSIX systems">
<meta name="keywords" content="socket, networking, C, POSIX, TCP, UDP, TLS, async, high-performance, library">
<meta name="author" content="Tetsuo Corporation">
<meta name="theme-color" content="#3b82f6">
<title>SocketProxy Private Implementation Details</title>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%233b82f6'/><stop offset='100%25' stop-color='%238b5cf6'/></linearGradient></defs><rect width='100' height='100' rx='20' fill='url(%23g)'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white' font-family='sans-serif' font-weight='bold'>S</text></svg>">
</head>
<body>
<div id="top">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Socket Library<span id="projectnumber">1.0.0</span></div>
   <div id="projectbrief">High-performance, exception-driven socket toolkit for POSIX systems</div>
  </td>
  <td style="text-align: right; padding: 20px; vertical-align: middle;">
    <div style="display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap; align-items: center;">
      <a href="index.html" class="quick-link">Home</a>
      <a href="annotated.html" class="quick-link">Structures</a>
      <a href="files.html" class="quick-link">Files</a>
      <a href="globals.html" class="quick-link">API</a>
    </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__proxy__private.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a>  </div>
  <div class="headertitle"><div class="title">SocketProxy Private Implementation Details<div class="ingroups"><a class="el" href="group__core__io.html">Core I/O Modules</a></div></div></div>
</div><!--header-->
<div class="contents">
<div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketProxy Private Implementation Details:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><iframe scrolling="no" frameborder="0" src="group__proxy__private.svg" width="474" height="54"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structSocketProxy__Conn__T" id="r_structSocketProxy__Conn__T"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a></td></tr>
<tr class="memdesc:structSocketProxy__Conn__T"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opaque proxy connection context for managing tunneling negotiation.  <a href="group__proxy__private.html#structSocketProxy__Conn__T">More...</a><br /></td></tr>
<tr class="separator:structSocketProxy__Conn__T"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga787c1af36f15b60e2f85339f94bfbe49" id="r_ga787c1af36f15b60e2f85339f94bfbe49"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga787c1af36f15b60e2f85339f94bfbe49">SOCKET_PROXY_ERROR_BUFSIZE</a>&#160;&#160;&#160;256</td></tr>
<tr class="memdesc:ga787c1af36f15b60e2f85339f94bfbe49"><td class="mdescLeft">&#160;</td><td class="mdescRight">Internal constants for buffer sizes, timeouts, and protocol limits.  <br /></td></tr>
<tr class="separator:ga787c1af36f15b60e2f85339f94bfbe49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadfe4c6b10bc2da57d2677a32a8fc2f02" id="r_gadfe4c6b10bc2da57d2677a32a8fc2f02"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gadfe4c6b10bc2da57d2677a32a8fc2f02">SOCKET_PROXY_BUFFER_SIZE</a>&#160;&#160;&#160;65536</td></tr>
<tr class="memdesc:gadfe4c6b10bc2da57d2677a32a8fc2f02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default size for internal send/receive buffers during handshake.  <br /></td></tr>
<tr class="separator:gadfe4c6b10bc2da57d2677a32a8fc2f02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9af35160f08629ec1a5b5700581c9a34" id="r_ga9af35160f08629ec1a5b5700581c9a34"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga9af35160f08629ec1a5b5700581c9a34">SOCKET_PROXY_MAX_URL_LEN</a>&#160;&#160;&#160;2048</td></tr>
<tr class="memdesc:ga9af35160f08629ec1a5b5700581c9a34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length for proxy URL strings in parsing.  <br /></td></tr>
<tr class="separator:ga9af35160f08629ec1a5b5700581c9a34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0f936941652891a3270993b5bd57730d" id="r_ga0f936941652891a3270993b5bd57730d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga0f936941652891a3270993b5bd57730d">SOCKET_PROXY_STATIC_BUFFER_SIZE</a>&#160;&#160;&#160;1024</td></tr>
<tr class="memdesc:ga0f936941652891a3270993b5bd57730d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of static buffer for temporary URL parsing (when no arena provided).  <br /></td></tr>
<tr class="separator:ga0f936941652891a3270993b5bd57730d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9f5752234c11ead463ea1e91cf03a2ad" id="r_ga9f5752234c11ead463ea1e91cf03a2ad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga9f5752234c11ead463ea1e91cf03a2ad">SOCKET_PROXY_MS_PER_SEC</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:ga9f5752234c11ead463ea1e91cf03a2ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Milliseconds per second constant for timeout calculations.  <br /></td></tr>
<tr class="separator:ga9f5752234c11ead463ea1e91cf03a2ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga52309497faa9acfa9ff1c6c143ef7d07" id="r_ga52309497faa9acfa9ff1c6c143ef7d07"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga52309497faa9acfa9ff1c6c143ef7d07">SOCKET_PROXY_NS_PER_MS</a>&#160;&#160;&#160;1000000LL</td></tr>
<tr class="memdesc:ga52309497faa9acfa9ff1c6c143ef7d07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Nanoseconds per millisecond for high-precision time conversion.  <br /></td></tr>
<tr class="separator:ga52309497faa9acfa9ff1c6c143ef7d07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7c7855b84a0bc59ee29df1d16f3b390" id="r_gad7c7855b84a0bc59ee29df1d16f3b390"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gad7c7855b84a0bc59ee29df1d16f3b390">SOCKET_PROXY_DEFAULT_POLL_TIMEOUT_MS</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:gad7c7855b84a0bc59ee29df1d16f3b390"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default timeout for SocketPoll_wait when no deadline pending.  <br /></td></tr>
<tr class="separator:gad7c7855b84a0bc59ee29df1d16f3b390"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4c409afdc74bda0aa590309dbfb60e83" id="r_ga4c409afdc74bda0aa590309dbfb60e83"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga4c409afdc74bda0aa590309dbfb60e83">SOCKS4_VERSION</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:ga4c409afdc74bda0aa590309dbfb60e83"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS4 and SOCKS5 protocol constants per RFCs.  <br /></td></tr>
<tr class="separator:ga4c409afdc74bda0aa590309dbfb60e83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab3df315d612ee6df173a2567c464ed7e" id="r_gab3df315d612ee6df173a2567c464ed7e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gab3df315d612ee6df173a2567c464ed7e">SOCKS4_CMD_CONNECT</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:gab3df315d612ee6df173a2567c464ed7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS4 CONNECT command code.Value: 1 CD field in request for TCP connect.  <br /></td></tr>
<tr class="separator:gab3df315d612ee6df173a2567c464ed7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7df58477af7c9a978ce11fb41564d4c1" id="r_ga7df58477af7c9a978ce11fb41564d4c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga7df58477af7c9a978ce11fb41564d4c1">SOCKS4_REPLY_GRANTED</a>&#160;&#160;&#160;90</td></tr>
<tr class="memdesc:ga7df58477af7c9a978ce11fb41564d4c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS4 reply codes for connection result.90: Granted, 91: Rejected, 92: No identd, 93: Ident mismatch. Mapped in <a class="el" href="group__core__io.html#ga2f17a3a05ffed99bade9280577b4bb25" title="Map SOCKS4 reply code to SocketProxy_Result.">proxy_socks4_reply_to_result()</a>.  <br /></td></tr>
<tr class="separator:ga7df58477af7c9a978ce11fb41564d4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad060585ee25e3b3b62753d0a57c662ef" id="r_gad060585ee25e3b3b62753d0a57c662ef"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gad060585ee25e3b3b62753d0a57c662ef">SOCKS4_REPLY_REJECTED</a>&#160;&#160;&#160;91</td></tr>
<tr class="separator:gad060585ee25e3b3b62753d0a57c662ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac55e6af1d26c1b104efbf39e27553947" id="r_gac55e6af1d26c1b104efbf39e27553947"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gac55e6af1d26c1b104efbf39e27553947">SOCKS4_REPLY_NO_IDENTD</a>&#160;&#160;&#160;92</td></tr>
<tr class="separator:gac55e6af1d26c1b104efbf39e27553947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1923310fdf482b7aebd613652b7eb2bf" id="r_ga1923310fdf482b7aebd613652b7eb2bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga1923310fdf482b7aebd613652b7eb2bf">SOCKS4_REPLY_IDENTD_MISMATCH</a>&#160;&#160;&#160;93</td></tr>
<tr class="separator:ga1923310fdf482b7aebd613652b7eb2bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5b416217434efd51f168a4d339a92eb3" id="r_ga5b416217434efd51f168a4d339a92eb3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga5b416217434efd51f168a4d339a92eb3">SOCKS5_VERSION</a>&#160;&#160;&#160;5</td></tr>
<tr class="memdesc:ga5b416217434efd51f168a4d339a92eb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 protocol version number.Value: 5 VER field in all messages.  <br /></td></tr>
<tr class="separator:ga5b416217434efd51f168a4d339a92eb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga341dfd976e8ded0551eba1d09d4818c9" id="r_ga341dfd976e8ded0551eba1d09d4818c9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga341dfd976e8ded0551eba1d09d4818c9">SOCKS5_AUTH_VERSION</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:ga341dfd976e8ded0551eba1d09d4818c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 subnegotiation auth version (RFC 1929).Value: 1 VER in username/password auth request/response.  <br /></td></tr>
<tr class="separator:ga341dfd976e8ded0551eba1d09d4818c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f574e2ab614cc6e85d36a9fa363c59d" id="r_ga7f574e2ab614cc6e85d36a9fa363c59d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga7f574e2ab614cc6e85d36a9fa363c59d">SOCKS5_AUTH_NONE</a>&#160;&#160;&#160;0x00</td></tr>
<tr class="memdesc:ga7f574e2ab614cc6e85d36a9fa363c59d"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 authentication method codes.0x00: No auth, 0x01: GSSAPI, 0x02: Password, 0xFF: No acceptable. Listed in greeting; selected in response.  <br /></td></tr>
<tr class="separator:ga7f574e2ab614cc6e85d36a9fa363c59d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabd8de982ea3b948d3a1258ca8b36699d" id="r_gabd8de982ea3b948d3a1258ca8b36699d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gabd8de982ea3b948d3a1258ca8b36699d">SOCKS5_AUTH_GSSAPI</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="separator:gabd8de982ea3b948d3a1258ca8b36699d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga899b27c99a9931c5696e2f82660a5747" id="r_ga899b27c99a9931c5696e2f82660a5747"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga899b27c99a9931c5696e2f82660a5747">SOCKS5_AUTH_PASSWORD</a>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:ga899b27c99a9931c5696e2f82660a5747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4d23c2ae0d1914d13bb1cb21863c8db" id="r_gad4d23c2ae0d1914d13bb1cb21863c8db"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gad4d23c2ae0d1914d13bb1cb21863c8db">SOCKS5_AUTH_NO_ACCEPTABLE</a>&#160;&#160;&#160;0xFF</td></tr>
<tr class="separator:gad4d23c2ae0d1914d13bb1cb21863c8db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga108e237a994aebc73ad3bbcf141b6de4" id="r_ga108e237a994aebc73ad3bbcf141b6de4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga108e237a994aebc73ad3bbcf141b6de4">SOCKS5_CMD_CONNECT</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="memdesc:ga108e237a994aebc73ad3bbcf141b6de4"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 command codes.0x01: Connect, 0x02: Bind, 0x03: UDP associate. Only CONNECT used for tunneling.  <br /></td></tr>
<tr class="separator:ga108e237a994aebc73ad3bbcf141b6de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae1581edc98795710ca1a7995170c0594" id="r_gae1581edc98795710ca1a7995170c0594"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gae1581edc98795710ca1a7995170c0594">SOCKS5_CMD_BIND</a>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:gae1581edc98795710ca1a7995170c0594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga18469924a98b80175ed350975ac5ffdb" id="r_ga18469924a98b80175ed350975ac5ffdb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga18469924a98b80175ed350975ac5ffdb">SOCKS5_CMD_UDP_ASSOCIATE</a>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:ga18469924a98b80175ed350975ac5ffdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9be4c9660ff9166120889c3680d91539" id="r_ga9be4c9660ff9166120889c3680d91539"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga9be4c9660ff9166120889c3680d91539">SOCKS5_ATYP_IPV4</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="memdesc:ga9be4c9660ff9166120889c3680d91539"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 address type codes (ATYP).0x01: IPv4 (4 bytes), 0x03: Domain (len + bytes), 0x04: IPv6 (16 bytes). Used in CONNECT request/reply.  <br /></td></tr>
<tr class="separator:ga9be4c9660ff9166120889c3680d91539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga14afd87de02a66fe870f981f9efe9862" id="r_ga14afd87de02a66fe870f981f9efe9862"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga14afd87de02a66fe870f981f9efe9862">SOCKS5_ATYP_DOMAIN</a>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:ga14afd87de02a66fe870f981f9efe9862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga64e32f131e3d76116ebec676d9866594" id="r_ga64e32f131e3d76116ebec676d9866594"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga64e32f131e3d76116ebec676d9866594">SOCKS5_ATYP_IPV6</a>&#160;&#160;&#160;0x04</td></tr>
<tr class="separator:ga64e32f131e3d76116ebec676d9866594"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac61a81038f320a72896daefe88499731" id="r_gac61a81038f320a72896daefe88499731"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gac61a81038f320a72896daefe88499731">SOCKS5_REPLY_SUCCESS</a>&#160;&#160;&#160;0x00</td></tr>
<tr class="memdesc:gac61a81038f320a72896daefe88499731"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 reply codes (REP) for commands.0x00: Success, 0x01-0x08: Various failures. Mapped to SocketProxy_Result in recv_connect.  <br /></td></tr>
<tr class="separator:gac61a81038f320a72896daefe88499731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga29296d14962426df565a8032fc35f17d" id="r_ga29296d14962426df565a8032fc35f17d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga29296d14962426df565a8032fc35f17d">SOCKS5_REPLY_GENERAL_FAILURE</a>&#160;&#160;&#160;0x01</td></tr>
<tr class="separator:ga29296d14962426df565a8032fc35f17d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5d6ec38590c939fd2badd59f50fb67a" id="r_gae5d6ec38590c939fd2badd59f50fb67a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gae5d6ec38590c939fd2badd59f50fb67a">SOCKS5_REPLY_NOT_ALLOWED</a>&#160;&#160;&#160;0x02</td></tr>
<tr class="separator:gae5d6ec38590c939fd2badd59f50fb67a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaae81fa32c9a7e2b16ac437ddccf8459a" id="r_gaae81fa32c9a7e2b16ac437ddccf8459a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gaae81fa32c9a7e2b16ac437ddccf8459a">SOCKS5_REPLY_NETWORK_UNREACHABLE</a>&#160;&#160;&#160;0x03</td></tr>
<tr class="separator:gaae81fa32c9a7e2b16ac437ddccf8459a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf97dacb625f06c93f7af9297a66373e6" id="r_gaf97dacb625f06c93f7af9297a66373e6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gaf97dacb625f06c93f7af9297a66373e6">SOCKS5_REPLY_HOST_UNREACHABLE</a>&#160;&#160;&#160;0x04</td></tr>
<tr class="separator:gaf97dacb625f06c93f7af9297a66373e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga734956bbb3cba2c1c28b62ca06000442" id="r_ga734956bbb3cba2c1c28b62ca06000442"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga734956bbb3cba2c1c28b62ca06000442">SOCKS5_REPLY_CONNECTION_REFUSED</a>&#160;&#160;&#160;0x05</td></tr>
<tr class="separator:ga734956bbb3cba2c1c28b62ca06000442"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7f1453ad2ffabd1b55a8449044544951" id="r_ga7f1453ad2ffabd1b55a8449044544951"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga7f1453ad2ffabd1b55a8449044544951">SOCKS5_REPLY_TTL_EXPIRED</a>&#160;&#160;&#160;0x06</td></tr>
<tr class="separator:ga7f1453ad2ffabd1b55a8449044544951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89e495f86e65eb8e16b3627a4746bdf6" id="r_ga89e495f86e65eb8e16b3627a4746bdf6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga89e495f86e65eb8e16b3627a4746bdf6">SOCKS5_REPLY_COMMAND_NOT_SUPPORTED</a>&#160;&#160;&#160;0x07</td></tr>
<tr class="separator:ga89e495f86e65eb8e16b3627a4746bdf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga959bad341e17a9074582254d97b2ca91" id="r_ga959bad341e17a9074582254d97b2ca91"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga959bad341e17a9074582254d97b2ca91">SOCKS5_REPLY_ADDRESS_TYPE_NOT_SUPPORTED</a>&#160;&#160;&#160;0x08</td></tr>
<tr class="separator:ga959bad341e17a9074582254d97b2ca91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8acf82fb4990e729e3d2173f897484c1" id="r_ga8acf82fb4990e729e3d2173f897484c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga8acf82fb4990e729e3d2173f897484c1">SOCKS5_IPV4_ADDR_SIZE</a>&#160;&#160;&#160;4</td></tr>
<tr class="memdesc:ga8acf82fb4990e729e3d2173f897484c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fixed address and port sizes for SOCKS5 messages (RFC 1928 Sec 4).IPv4: 4 bytes, IPv6: 16 bytes, Port: 2 bytes (big-endian). Used for buffer allocation and parsing bounds.  <br /></td></tr>
<tr class="separator:ga8acf82fb4990e729e3d2173f897484c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga13428a508dd2f201ff1a4c348b600ab3" id="r_ga13428a508dd2f201ff1a4c348b600ab3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga13428a508dd2f201ff1a4c348b600ab3">SOCKS5_IPV6_ADDR_SIZE</a>&#160;&#160;&#160;16</td></tr>
<tr class="separator:ga13428a508dd2f201ff1a4c348b600ab3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac06606832cfef92d3ffea479fff6d709" id="r_gac06606832cfef92d3ffea479fff6d709"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gac06606832cfef92d3ffea479fff6d709">SOCKS5_PORT_SIZE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:gac06606832cfef92d3ffea479fff6d709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf311c4dffb9708d0a95e14abaa8f11dd" id="r_gaf311c4dffb9708d0a95e14abaa8f11dd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gaf311c4dffb9708d0a95e14abaa8f11dd">SOCKS5_METHOD_RESPONSE_SIZE</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:gaf311c4dffb9708d0a95e14abaa8f11dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 response message size constants.Method response: 2 bytes, Auth response: 2 bytes, Connect header: 4 bytes (VER+REP+RSV+ATYP). Used for expected recv lengths in state machine.  <br /></td></tr>
<tr class="separator:gaf311c4dffb9708d0a95e14abaa8f11dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f777fd21e113340db6dc6b29615bccd" id="r_ga6f777fd21e113340db6dc6b29615bccd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga6f777fd21e113340db6dc6b29615bccd">SOCKS5_AUTH_RESPONSE_SIZE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:ga6f777fd21e113340db6dc6b29615bccd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3b6c9b679741441ebb94976c60debdd9" id="r_ga3b6c9b679741441ebb94976c60debdd9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga3b6c9b679741441ebb94976c60debdd9">SOCKS5_CONNECT_HEADER_SIZE</a>&#160;&#160;&#160;4</td></tr>
<tr class="separator:ga3b6c9b679741441ebb94976c60debdd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9988f978dd580fa47a6806c10b396b6e" id="r_ga9988f978dd580fa47a6806c10b396b6e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga9988f978dd580fa47a6806c10b396b6e">SOCKS5_CONNECT_IPV4_RESPONSE_SIZE</a>&#160;&#160;&#160;  (<a class="el" href="group__proxy__private.html#ga3b6c9b679741441ebb94976c60debdd9">SOCKS5_CONNECT_HEADER_SIZE</a> + <a class="el" href="group__proxy__private.html#ga8acf82fb4990e729e3d2173f897484c1">SOCKS5_IPV4_ADDR_SIZE</a> + <a class="el" href="group__proxy__private.html#gac06606832cfef92d3ffea479fff6d709">SOCKS5_PORT_SIZE</a>)</td></tr>
<tr class="memdesc:ga9988f978dd580fa47a6806c10b396b6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">SOCKS5 CONNECT response total sizes for common address types.IPv4: Header + 4 + 2 = 10 bytes, IPv6: Header + 16 + 2 = 22 bytes. Used to validate full response recv.  <br /></td></tr>
<tr class="separator:ga9988f978dd580fa47a6806c10b396b6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab22b33a4f85b73bdcce74accde1798f4" id="r_gab22b33a4f85b73bdcce74accde1798f4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gab22b33a4f85b73bdcce74accde1798f4">SOCKS5_CONNECT_IPV6_RESPONSE_SIZE</a>&#160;&#160;&#160;  (<a class="el" href="group__proxy__private.html#ga3b6c9b679741441ebb94976c60debdd9">SOCKS5_CONNECT_HEADER_SIZE</a> + <a class="el" href="group__proxy__private.html#ga13428a508dd2f201ff1a4c348b600ab3">SOCKS5_IPV6_ADDR_SIZE</a> + <a class="el" href="group__proxy__private.html#gac06606832cfef92d3ffea479fff6d709">SOCKS5_PORT_SIZE</a>)</td></tr>
<tr class="separator:gab22b33a4f85b73bdcce74accde1798f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae461bf5ddae6eda683926a6303af87f6" id="r_gae461bf5ddae6eda683926a6303af87f6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gae461bf5ddae6eda683926a6303af87f6">SOCKET_LOG_COMPONENT</a>&#160;&#160;&#160;&quot;Proxy&quot;</td></tr>
<tr class="memdesc:gae461bf5ddae6eda683926a6303af87f6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Module-specific exception and logging macros for proxy operations.  <br /></td></tr>
<tr class="separator:gae461bf5ddae6eda683926a6303af87f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabe33454412b97fd3d344b2bbfd042b2d" id="r_gabe33454412b97fd3d344b2bbfd042b2d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gabe33454412b97fd3d344b2bbfd042b2d">PROXY_ERROR_FMT</a>(fmt, ...)&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#adf114e63024eabf6e40f1ed7f89c79b8">SOCKET_ERROR_FMT</a> (fmt, ##__VA_ARGS__)</td></tr>
<tr class="memdesc:gabe33454412b97fd3d344b2bbfd042b2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Error formatting macros delegating to SocketUtil infrastructure.  <br /></td></tr>
<tr class="separator:gabe33454412b97fd3d344b2bbfd042b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1e37b31329a2b2041a65e255cc2a77d8" id="r_ga1e37b31329a2b2041a65e255cc2a77d8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga1e37b31329a2b2041a65e255cc2a77d8">PROXY_ERROR_MSG</a>(fmt, ...)&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (fmt, ##__VA_ARGS__)</td></tr>
<tr class="memdesc:ga1e37b31329a2b2041a65e255cc2a77d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Format proxy error without errno details.  <br /></td></tr>
<tr class="separator:ga1e37b31329a2b2041a65e255cc2a77d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae79febff78c4084b69989b8b3099ae33" id="r_gae79febff78c4084b69989b8b3099ae33"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#gae79febff78c4084b69989b8b3099ae33">RAISE_PROXY_ERROR</a>(e)&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (Proxy, e)</td></tr>
<tr class="memdesc:gae79febff78c4084b69989b8b3099ae33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Raise formatted Proxy exception using module infrastructure.  <br /></td></tr>
<tr class="separator:gae79febff78c4084b69989b8b3099ae33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga7b70e48528fb67371dbcc45e7b6ce5c1" id="r_ga7b70e48528fb67371dbcc45e7b6ce5c1"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga7b70e48528fb67371dbcc45e7b6ce5c1">ProxySendFunc</a>) (struct <a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn)</td></tr>
<tr class="memdesc:ga7b70e48528fb67371dbcc45e7b6ce5c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function type for protocol-specific request building.  <br /></td></tr>
<tr class="separator:ga7b70e48528fb67371dbcc45e7b6ce5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga502253ce06f453baedba160037571812" id="r_ga502253ce06f453baedba160037571812"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga502253ce06f453baedba160037571812">ProxyRecvFunc</a>) (struct <a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn)</td></tr>
<tr class="memdesc:ga502253ce06f453baedba160037571812"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function type for protocol-specific response parsing.  <br /></td></tr>
<tr class="separator:ga502253ce06f453baedba160037571812"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga8d5525862e31c82df86ea8ec9ccd493c" id="r_ga8d5525862e31c82df86ea8ec9ccd493c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">SocketProxy_ProtoState</a> { <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493caf5542717d2ee90d3d17b63b4cf6ece64">PROTO_STATE_INIT</a> = 0
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cafba3acda31e424f195898a8ba5488940">PROTO_STATE_SOCKS5_GREETING_SENT</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca8767b75e57730c4169d8e5299fbf81f7">PROTO_STATE_SOCKS5_METHOD_RECEIVED</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cad9cbdb2e2397158bbd069ababd33e7af">PROTO_STATE_SOCKS5_AUTH_SENT</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca429c6f1b7b064fcfe594a9de4d5bd85b">PROTO_STATE_SOCKS5_AUTH_RECEIVED</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493caf20756c410fcc0f622ea89994f10c81a">PROTO_STATE_SOCKS5_CONNECT_SENT</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca4cf8dced08ab39ea15cda595922bf111">PROTO_STATE_SOCKS5_CONNECT_RECEIVED</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca4111e707281eccc70e9e6aa97777a1a9">PROTO_STATE_SOCKS4_CONNECT_SENT</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca798e97b768cc911a58b89bca9e242d08">PROTO_STATE_SOCKS4_CONNECT_RECEIVED</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493cac2f57b720922a9a40199634cf679beb2">PROTO_STATE_HTTP_REQUEST_SENT</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca6ebbcb3c7028113f0d93a18a1fa96155">PROTO_STATE_HTTP_RESPONSE_RECEIVED</a>
, <br />
&#160;&#160;<a class="el" href="group__proxy__private.html#gga8d5525862e31c82df86ea8ec9ccd493ca385541d759585795ce1310609ec3d6bd">PROTO_STATE_DONE</a>
<br />
 }</td></tr>
<tr class="memdesc:ga8d5525862e31c82df86ea8ec9ccd493c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Protocol-specific sub-state for proxy handshakes.  <a href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">More...</a><br /></td></tr>
<tr class="separator:ga8d5525862e31c82df86ea8ec9ccd493c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Exposes opaque types, constants, state enums, error macros, and helper functions for implementing proxy tunneling via SOCKS and HTTP CONNECT protocols.</p>
<p>Key internals:</p><ul>
<li><a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T" title="Opaque proxy connection context for managing tunneling negotiation.">SocketProxy_Conn_T</a>: Opaque context for connection lifecycle management including DNS resolution, socket I/O, protocol handshakes, and timeouts.</li>
<li>SocketProxy_ProtoState: Sub-states for SOCKS5 multi-step negotiation (greeting, auth, connect).</li>
<li>Protocol handler types (ProxySendFunc, ProxyRecvFunc) for state machine dispatching.</li>
<li>SOCKS-specific functions for request building and response parsing (RFC 1928/1929).</li>
<li>HTTP CONNECT handlers using SocketHTTP1_Parser_T for response validation.</li>
<li>Time utilities using CLOCK_MONOTONIC for reliable timeout enforcement.</li>
<li>URL parsing helpers supporting standard proxy URL formats.</li>
</ul>
<p>Security considerations:</p><ul>
<li>Credentials (username/password) copied to arena and securely cleared after use.</li>
<li>Protocol parsing bounds-checked to prevent buffer overflows or injection attacks.</li>
<li>Timeouts enforced to mitigate denial-of-service from malicious/slow proxies.</li>
<li>Integration with SocketSYNProtect possible via pool for server-side proxying.</li>
</ul>
<p>Dependencies and reuse:</p><ul>
<li>Socket (core I/O) for buffered send/recv and TLS passthrough.</li>
<li>SocketBuf for temporary protocol message buffering.</li>
<li>SocketPoll and SocketDNS for asynchronous connection establishment.</li>
<li>SocketHappyEyeballs for parallel proxy server resolution/connect racing.</li>
<li>SocketHTTP1 for HTTP response parsing in CONNECT method.</li>
<li>SocketTLSContext (conditional) for HTTPS proxy (TLS to proxy server).</li>
</ul>
<p>Error handling: Uses module exceptions (Proxy_Failed, etc.) with formatted messages via PROXY_ERROR_* macros delegating to SocketUtil infrastructure.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketProxy_8h.html" title="Proxy tunneling module for HTTP CONNECT and SOCKS protocols.">SocketProxy.h</a> for public synchronous/asynchronous APIs. </dd>
<dd>
<a class="el" href="SocketHappyEyeballs_8h.html" title="Happy Eyeballs (RFC 8305) implementation for fast dual-stack connections.">SocketHappyEyeballs.h</a> for <a class="el" href="group__proxy.html" title="Transparent TCP proxy support with sync/async APIs.">Proxy Tunneling Module</a> server connection optimization. </dd>
<dd>
<a class="el" href="SocketHTTP1_8h.html" title="HTTP/1.1 message syntax parsing and serialization (RFC 9112).">SocketHTTP1.h</a> for HTTP CONNECT integration. </dd>
<dd>
<a class="el" href="SocketTLS_8h.html" title="TLS/SSL socket integration with TLS 1.3 support.">SocketTLS.h</a> for optional HTTPS <a class="el" href="group__proxy.html" title="Transparent TCP proxy support with sync/async APIs.">Proxy Tunneling Module</a> support (#if SOCKET_HAS_TLS). </dd>
<dd>
<a class="el" href="group__core__io.html">Core I/O Modules</a> for foundational socket operations. </dd>
<dd>
<a class="el" href="PROXY_8md.html">docs/PROXY.md</a> for overview, URL formats, and usage examples. </dd>
<dd>
<a class="el" href="SECURITY_8md.html">docs/SECURITY.md</a> for credential and TLS best practices. </dd>
<dd>
docs/ERROR_HANDLING.md for exception patterns.</dd>
<dd>
<a class="el" href="group__core__io.html" title="Fundamental socket operations for TCP, UDP, and Unix domain sockets.The Core I/O group provides the b...">Core I/O Modules</a> for related socket primitives. </dd></dl>
<hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structSocketProxy__Conn__T" id="structSocketProxy__Conn__T"></a>
<h2 class="memtitle"><span class="permalink"><a href="#structSocketProxy__Conn__T">&#9670;&#160;</a></span>SocketProxy_Conn_T</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct SocketProxy_Conn_T</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"><p>Opaque proxy connection context for managing tunneling negotiation. </p>
<p>Central structure for a single proxy operation, handling configuration, resources, asynchronous components, state machine, I/O buffering, timing, and error tracking.</p>
<p>Lifecycle: Allocated from arena in public APIs like <a class="el" href="group__core__io.html#ga6d17fac3f6b21b9905aa7c4b0d7d47f7" title="Create proxy connection context with blocking proxy connect, async handshake.">SocketProxy_Conn_new()</a>; fields private. Success transfers socket to caller; failure sets error; free cleans remaining.</p>
<p>Groups:</p><ul>
<li>Configuration (copied from user config): proxy/target details, creds, timeouts, headers, TLS.</li>
<li>Resources (owned/managed): arena for memory, socket for I/O (transferred), recvbuf for parsing.</li>
<li>Async resources: dns resolver, poll instance, HappyEyeballs for connect racing (optional external).</li>
<li>HTTP specific: http_parser for CONNECT response validation.</li>
<li>State machine: high-level state, proto_state, result code, SOCKS5 auth flags.</li>
<li>Timing: start times for timeout enforcement using monotonic clock.</li>
<li>I/O state: send/recv buffers (SOCKET_PROXY_BUFFER_SIZE=64KB), offsets for partial transfers.</li>
<li>Error handling: error_buf for messages, transferred flag to prevent double-free.</li>
</ul>
<p>Thread safety: No - single-threaded design; concurrent access undefined. Memory safety: Arena-managed; secure clear for creds if implemented. TLS conditional: tls_ctx and tls_enabled for HTTPS proxy support.</p>
<dl class="section note"><dt>Note</dt><dd>Opaque to public; internal access only via module functions. </dd>
<dd>
owns_dns_poll flag determines cleanup of async resources. </dd>
<dd>
Buffer sizes configurable via defines; error_buf fixed size.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketProxy_8h.html" title="Proxy tunneling module for HTTP CONNECT and SOCKS protocols.">SocketProxy.h</a> public SocketProxy_Conn_* API for usage. </dd>
<dd>
<a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T" title="Opaque proxy connection context for managing tunneling negotiation.">SocketProxy_Conn_T</a> fields (internal reference). </dd>
<dd>
<a class="el" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c" title="Protocol-specific sub-state for proxy handshakes.">SocketProxy_ProtoState</a> for detailed protocol sub-states. </dd>
<dd>
<a class="el" href="group__core__io.html#gaf9f1c72bfcb303aa9ee5dae6d903b9be" title="States in the proxy connection state machine.">SocketProxy_State</a> for connection lifecycle states. </dd>
<dd>
SocketHappyEyeballs_T::he for <a class="el" href="group__proxy.html" title="Transparent TCP proxy support with sync/async APIs.">Proxy Tunneling Module</a> server connection. </dd>
<dd>
SocketHTTP1_Parser_T::http_parser for HTTP parsing. </dd>
<dd>
SocketBuf_T::recvbuf for receive buffering. </dd>
<dd>
Arena_T::arena for memory management. </dd>
<dd>
<a class="el" href="group__dns.html">DNS module</a> for resolution. </dd>
<dd>
<a class="el" href="group__event__system.html">Event system</a> for <a class="el" href="group__proxy__private.html#a84361c1bf1c9efec61171b729effa6e1">poll</a> integration. </dd>
<dd>
<a class="el" href="group__security.html">Security module</a> for TLS. </dd>
<dd>
<a class="el" href="PROXY_8md.html">docs/PROXY.md</a> for internals and examples. </dd>
<dd>
docs/MEMORY_MANAGEMENT.md for <a class="el" href="group__proxy__private.html#a083369e24cff29efd9dc20163e541a16">arena</a> usage. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00552">552</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>
</div><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Collaboration diagram for SocketProxy_Conn_T:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structSocketProxy__Conn__T__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a id="a083369e24cff29efd9dc20163e541a16" name="a083369e24cff29efd9dc20163e541a16"></a><a class="el" href="group__foundation.html#gac1ed22b9df4eff7a3398cac608c090cc">Arena_T</a></td>
<td class="fieldname">
arena</td>
<td class="fielddoc">
<p>Memory arena for all allocations </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae0aebb2175653871184fe8875f57c633" name="ae0aebb2175653871184fe8875f57c633"></a>int</td>
<td class="fieldname">
connect_timeout_ms</td>
<td class="fielddoc">
<p>Proxy connect timeout </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a431a582be92ea3900cddfcf6ace76048" name="a431a582be92ea3900cddfcf6ace76048"></a><a class="el" href="group__dns.html#structSocketDNS__T">SocketDNS_T</a></td>
<td class="fieldname">
dns</td>
<td class="fielddoc">
<p>DNS resolver for async connection </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aaaed59222364e1228661678468b42283" name="aaaed59222364e1228661678468b42283"></a>char</td>
<td class="fieldname">
error_buf[256]</td>
<td class="fielddoc">
<p>Error message </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2224b074511d1fe06fdcae44d6953dc5" name="a2224b074511d1fe06fdcae44d6953dc5"></a>SocketHTTP_Headers_T</td>
<td class="fieldname">
extra_headers</td>
<td class="fielddoc">
<p>HTTP CONNECT extra headers </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ac8dbe4bd33e376a5595c7966f9f40113" name="ac8dbe4bd33e376a5595c7966f9f40113"></a>int64_t</td>
<td class="fieldname">
handshake_start_time_ms</td>
<td class="fielddoc">
<p>When handshake started </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aa314392e96e493c77a1deed89728e43c" name="aa314392e96e493c77a1deed89728e43c"></a>int</td>
<td class="fieldname">
handshake_timeout_ms</td>
<td class="fielddoc">
<p>Handshake timeout </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2153b2db669de8d281e0139a91c7c92e" name="a2153b2db669de8d281e0139a91c7c92e"></a><a class="el" href="group__async__io.html#structSocketHE__T">SocketHE_T</a></td>
<td class="fieldname">
he</td>
<td class="fielddoc">
<p>HappyEyeballs context (during connect) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a901962a8ee7faa216d870d2394a8d17d" name="a901962a8ee7faa216d870d2394a8d17d"></a>SocketHTTP1_Parser_T</td>
<td class="fieldname">
http_parser</td>
<td class="fielddoc">
<p>HTTP response parser </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a548c64d7e226630e791314c204c547c4" name="a548c64d7e226630e791314c204c547c4"></a>int</td>
<td class="fieldname">
owns_dns_poll</td>
<td class="fielddoc">
<p>1 if we own dns/poll (sync wrapper), 0 if external </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a7d71e6abcb8cb29cc286d94caa492142" name="a7d71e6abcb8cb29cc286d94caa492142"></a>char *</td>
<td class="fieldname">
password</td>
<td class="fielddoc">
<p>Password (arena copy, may be NULL) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a84361c1bf1c9efec61171b729effa6e1" name="a84361c1bf1c9efec61171b729effa6e1"></a><a class="el" href="group__event__system.html#structSocketPoll__T">SocketPoll_T</a></td>
<td class="fieldname">
poll</td>
<td class="fielddoc">
<p>Poll instance for async connection </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a813513bee1ea5117ffea491c85edcd81" name="a813513bee1ea5117ffea491c85edcd81"></a><a class="el" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">SocketProxy_ProtoState</a></td>
<td class="fieldname">
proto_state</td>
<td class="fielddoc">
<p>Protocol sub-state </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a0e96e5f0261bce7086ad5cc7af7e4b08" name="a0e96e5f0261bce7086ad5cc7af7e4b08"></a>char *</td>
<td class="fieldname">
proxy_host</td>
<td class="fielddoc">
<p>Proxy hostname (arena copy) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a11cf9d48eaae7621057f67b9589edf6b" name="a11cf9d48eaae7621057f67b9589edf6b"></a>int</td>
<td class="fieldname">
proxy_port</td>
<td class="fielddoc">
<p>Proxy port </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a614ffa636c6ca6f92b39f8af950c50a3" name="a614ffa636c6ca6f92b39f8af950c50a3"></a>unsigned char</td>
<td class="fieldname">
recv_buf[65536]</td>
<td class="fielddoc">
<p>Temp receive buffer </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a74f03365dce0726d5f66c35f561b742b" name="a74f03365dce0726d5f66c35f561b742b"></a>size_t</td>
<td class="fieldname">
recv_len</td>
<td class="fielddoc">
<p>Data in receive buffer </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a63bb3dea323c1f69e223786294aac653" name="a63bb3dea323c1f69e223786294aac653"></a>size_t</td>
<td class="fieldname">
recv_offset</td>
<td class="fielddoc">
<p>Bytes already processed </p>
</td></tr>
<tr><td class="fieldtype">
<a id="aafa5f04a528b20448930f6524568beb2" name="aafa5f04a528b20448930f6524568beb2"></a><a class="el" href="group__core__io.html#gad4b3ec10874282833e1b15760efa1b6c">SocketBuf_T</a></td>
<td class="fieldname">
recvbuf</td>
<td class="fielddoc">
<p>Receive buffer for protocol parsing </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5e794c6894f28dda56acf59529745a7e" name="a5e794c6894f28dda56acf59529745a7e"></a><a class="el" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a></td>
<td class="fieldname">
result</td>
<td class="fielddoc">
<p>Final result </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a64870d3e5ff24323c4d1566bc1fb06c6" name="a64870d3e5ff24323c4d1566bc1fb06c6"></a>unsigned char</td>
<td class="fieldname">
send_buf[65536]</td>
<td class="fielddoc">
<p>Send buffer </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af843e68c0b6e0e73085fc72e3a28823d" name="af843e68c0b6e0e73085fc72e3a28823d"></a>size_t</td>
<td class="fieldname">
send_len</td>
<td class="fielddoc">
<p>Data in send buffer </p>
</td></tr>
<tr><td class="fieldtype">
<a id="abcf5a9fbce4f4235b67e65f35833611c" name="abcf5a9fbce4f4235b67e65f35833611c"></a>size_t</td>
<td class="fieldname">
send_offset</td>
<td class="fielddoc">
<p>Bytes already sent </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a2c3fc65e5bee85f64a52dea4c4efeb33" name="a2c3fc65e5bee85f64a52dea4c4efeb33"></a>Socket_T</td>
<td class="fieldname">
socket</td>
<td class="fielddoc">
<p>Proxy socket (transferred to caller on success) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="af601d7eeeb78ef4fe2c694ad20ee6f44" name="af601d7eeeb78ef4fe2c694ad20ee6f44"></a>int</td>
<td class="fieldname">
socks5_auth_method</td>
<td class="fielddoc">
<p>Selected auth method </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a4fa34ec2122d2d9c4a3718565359c86b" name="a4fa34ec2122d2d9c4a3718565359c86b"></a>int</td>
<td class="fieldname">
socks5_need_auth</td>
<td class="fielddoc">
<p>1 if auth required </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a82625ab8fed897529b509e9caf5461b8" name="a82625ab8fed897529b509e9caf5461b8"></a>int64_t</td>
<td class="fieldname">
start_time_ms</td>
<td class="fielddoc">
<p>When operation started </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a6676b0ed3643ee6154d26738af148a99" name="a6676b0ed3643ee6154d26738af148a99"></a><a class="el" href="group__core__io.html#gaf9f1c72bfcb303aa9ee5dae6d903b9be">SocketProxy_State</a></td>
<td class="fieldname">
state</td>
<td class="fielddoc">
<p>Main state </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a257faf2aa4300a913c14f65c5941e820" name="a257faf2aa4300a913c14f65c5941e820"></a>char *</td>
<td class="fieldname">
target_host</td>
<td class="fielddoc">
<p>Target hostname (arena copy) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ae390638a08d19534bc6d0e698b4da476" name="ae390638a08d19534bc6d0e698b4da476"></a>int</td>
<td class="fieldname">
target_port</td>
<td class="fielddoc">
<p>Target port </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a5a7d11532a403ff7f63d99eac1186617" name="a5a7d11532a403ff7f63d99eac1186617"></a><a class="el" href="group__security.html#structSocketTLSContext__T">SocketTLSContext_T</a></td>
<td class="fieldname">
tls_ctx</td>
<td class="fielddoc">
<p>TLS context from config (copied ptr) </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a4858544617c2129855e2b8574df86cf7" name="a4858544617c2129855e2b8574df86cf7"></a>int</td>
<td class="fieldname">
tls_enabled</td>
<td class="fielddoc">
<p>1 after successful TLS handshake to proxy </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a12a3779149de75f678c5c1329e6cf88c" name="a12a3779149de75f678c5c1329e6cf88c"></a>int</td>
<td class="fieldname">
transferred</td>
<td class="fielddoc">
<p>1 if socket transferred to caller </p>
</td></tr>
<tr><td class="fieldtype">
<a id="a894986448a6771af2c160558763cf5cc" name="a894986448a6771af2c160558763cf5cc"></a><a class="el" href="group__core__io.html#gaaa33f7bdae951cc7b53a2fb049e89132">SocketProxyType</a></td>
<td class="fieldname">
type</td>
<td class="fielddoc">
<p>Proxy type </p>
</td></tr>
<tr><td class="fieldtype">
<a id="ad2b795e71eb9323949e6384665970a84" name="ad2b795e71eb9323949e6384665970a84"></a>char *</td>
<td class="fieldname">
username</td>
<td class="fielddoc">
<p>Username (arena copy, may be NULL) </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gabe33454412b97fd3d344b2bbfd042b2d" name="gabe33454412b97fd3d344b2bbfd042b2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabe33454412b97fd3d344b2bbfd042b2d">&#9670;&#160;</a></span>PROXY_ERROR_FMT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROXY_ERROR_FMT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#adf114e63024eabf6e40f1ed7f89c79b8">SOCKET_ERROR_FMT</a> (fmt, ##__VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Error formatting macros delegating to SocketUtil infrastructure. </p>
<p>Use socket_error_buf (thread-local, SOCKET_PROXY_ERROR_BUFSIZE bytes) for messages. Called before RAISE_PROXY_ERROR to populate details.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> SOCKET_ERROR_* base macros.</dd></dl>
<p>Format proxy error with errno details included.</p>
<p>Populates thread-local buffer with fmt + strerror(errno). Use immediately before raise for detailed exceptions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fmt</td><td>printf format. </td></tr>
    <tr><td class="paramname">...</td><td>fmt args. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Void - error in global buf. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__proxy__private.html#ga1e37b31329a2b2041a65e255cc2a77d8" title="Format proxy error without errno details.">PROXY_ERROR_MSG</a> without errno. </dd>
<dd>
<a class="el" href="SocketUtil_8h.html#adf114e63024eabf6e40f1ed7f89c79b8" title="SOCKET_ERROR_FMT - Format error message with errno information.">SOCKET_ERROR_FMT</a> base. </dd>
<dd>
<a class="el" href="group__proxy__private.html#gae79febff78c4084b69989b8b3099ae33" title="Raise formatted Proxy exception using module infrastructure.">RAISE_PROXY_ERROR</a> usage example. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00469">469</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga1e37b31329a2b2041a65e255cc2a77d8" name="ga1e37b31329a2b2041a65e255cc2a77d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1e37b31329a2b2041a65e255cc2a77d8">&#9670;&#160;</a></span>PROXY_ERROR_MSG</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROXY_ERROR_MSG</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fmt, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb">SOCKET_ERROR_MSG</a> (fmt, ##__VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Format proxy error without errno details. </p>
<p>Populates buffer with fmt only (no strerror). For cases where errno not relevant or already included.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fmt</td><td>printf format. </td></tr>
    <tr><td class="paramname">...</td><td>fmt args. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Void - error in global buf. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__proxy__private.html#gabe33454412b97fd3d344b2bbfd042b2d" title="Error formatting macros delegating to SocketUtil infrastructure.">PROXY_ERROR_FMT</a> with errno. </dd>
<dd>
<a class="el" href="SocketUtil_8h.html#a1feea47474a6b6e939c442cdd7c42fdb" title="SOCKET_ERROR_MSG - Format error message without errno.">SOCKET_ERROR_MSG</a> base. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00484">484</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gae79febff78c4084b69989b8b3099ae33" name="gae79febff78c4084b69989b8b3099ae33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae79febff78c4084b69989b8b3099ae33">&#9670;&#160;</a></span>RAISE_PROXY_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RAISE_PROXY_ERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">e</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b">SOCKET_RAISE_MODULE_ERROR</a> (Proxy, e)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Raise formatted Proxy exception using module infrastructure. </p>
<p>Raises via <a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b" title="SOCKET_RAISE_MODULE_ERROR - Raise module-specific exception.">SOCKET_RAISE_MODULE_ERROR(Proxy, e)</a> after formatting in thread-local buf. Integrates with Except stack for TRY/EXCEPT handling.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">e</td><td>Exception type (e.g., Proxy_Failed, Proxy_Timeout). </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Specified</td><td>e with details from buf. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Requires <a class="el" href="SocketUtil_8h.html#a9a80f14591d4cdb7347af54b5f66e766" title="SOCKET_DECLARE_MODULE_EXCEPTION - Declare thread-local exception.">SOCKET_DECLARE_MODULE_EXCEPTION(Proxy)</a> in .c. </dd>
<dd>
Thread-safe via local buf. </dd></dl>
<dl class="section see"><dt>See also</dt><dd>PROXY_ERROR_* for pre-raise formatting. </dd>
<dd>
<a class="el" href="SocketUtil_8h.html#aba03b2fa3f583e8cc687a3247db5a91b" title="SOCKET_RAISE_MODULE_ERROR - Raise module-specific exception.">SOCKET_RAISE_MODULE_ERROR</a> base. </dd>
<dd>
<a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> error section. </dd>
<dd>
docs/ERROR_HANDLING.md patterns. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00502">502</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gae461bf5ddae6eda683926a6303af87f6" name="gae461bf5ddae6eda683926a6303af87f6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae461bf5ddae6eda683926a6303af87f6">&#9670;&#160;</a></span>SOCKET_LOG_COMPONENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_LOG_COMPONENT&#160;&#160;&#160;&quot;Proxy&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Module-specific exception and logging macros for proxy operations. </p>
<p>Centralized error handling using <a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> base for thread-safe formatting and raising. Overrides log component to "Proxy" for SocketLog_emit. Macros populate thread-local buffer before raising <a class="el" href="group__foundation.html#structExcept__T" title="Exception structure for structured error handling.">Except_T</a> via module exception.</p>
<p>Pattern:</p><ul>
<li>Declare in .c: <a class="el" href="SocketUtil_8h.html#a9a80f14591d4cdb7347af54b5f66e766" title="SOCKET_DECLARE_MODULE_EXCEPTION - Declare thread-local exception.">SOCKET_DECLARE_MODULE_EXCEPTION(Proxy)</a></li>
<li>Format: PROXY_ERROR_FMT("SOCKS5 connect failed: %s", reason);</li>
<li>Raise: <a class="el" href="group__proxy__private.html#gae79febff78c4084b69989b8b3099ae33" title="Raise formatted Proxy exception using module infrastructure.">RAISE_PROXY_ERROR(Proxy_Failed)</a>;</li>
</ul>
<p>Benefits:</p><ul>
<li>Consistent with library-wide error patterns.</li>
<li>Thread-local buf (256 bytes) prevents races.</li>
<li>Auto-logs errors if SocketLog callback set.</li>
<li>Supports retry categorization via SocketError_* utils.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Declare exception in every .c file using these. </dd>
<dd>
Buf size SOCKET_PROXY_ERROR_BUFSIZE; truncate if exceed. </dd>
<dd>
Log component "Proxy" for module-specific tracing.</dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> error/logging sections. </dd>
<dd>
<a class="el" href="group__proxy__private.html#gabe33454412b97fd3d344b2bbfd042b2d" title="Error formatting macros delegating to SocketUtil infrastructure.">PROXY_ERROR_FMT</a>, <a class="el" href="group__proxy__private.html#ga1e37b31329a2b2041a65e255cc2a77d8" title="Format proxy error without errno details.">PROXY_ERROR_MSG</a> for formatting. </dd>
<dd>
<a class="el" href="group__proxy__private.html#gae79febff78c4084b69989b8b3099ae33" title="Raise formatted Proxy exception using module infrastructure.">RAISE_PROXY_ERROR</a> for raising. </dd>
<dd>
<a class="el" href="group__foundation.html#ga1364e85e147f0f6d43c82b4ce3e326c1" title="Emit a log message.">SocketLog_emit</a> for logging integration. </dd>
<dd>
docs/ERROR_HANDLING.md for TRY/EXCEPT usage. </dd>
<dd>
<a class="el" href="group__foundation.html">Foundation</a> for <a class="el" href="group__foundation.html#structExcept__T" title="Exception structure for structured error handling.">Except_T</a>. </dd>
<dd>
<a class="el" href="group__utilities.html">Utilities</a> for SocketLog, SocketError. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00443">443</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gadfe4c6b10bc2da57d2677a32a8fc2f02" name="gadfe4c6b10bc2da57d2677a32a8fc2f02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadfe4c6b10bc2da57d2677a32a8fc2f02">&#9670;&#160;</a></span>SOCKET_PROXY_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_PROXY_BUFFER_SIZE&#160;&#160;&#160;65536</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default size for internal send/receive buffers during handshake. </p>
<p>Value: 65536 bytes (64KB) - accommodates large HTTP CONNECT responses or SOCKS5 addr. Increased for HTTP headers (max per <a class="el" href="SocketHTTP_8h.html" title="Protocol-agnostic HTTP types, header handling, URI parsing, and utilities.">SocketHTTP.h</a>); used in conn-&gt;send_buf/recv_buf. Balances memory and performance for typical proxy messages.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__proxy__private.html#a64870d3e5ff24323c4d1566bc1fb06c6">SocketProxy_Conn_T::send_buf</a>, ::recv_buf </dd>
<dd>
SocketBuf_T::recvbuf for <a class="el" href="graceful__shutdown_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> receive buffer. </dd>
<dd>
<a class="el" href="group__core__io.html#ga71e6170ecb08801fd53c849e1456e83c" title="Send pending protocol data from conn-&gt;send_buf.">socketproxy_do_send()</a>, <a class="el" href="group__core__io.html#gab87758fdfc1cbbf3af9740989da246fd" title="Receive protocol data into conn-&gt;recv_buf.">socketproxy_do_recv()</a> for usage. </dd>
<dd>
<a class="el" href="SocketHTTP1_8h.html" title="HTTP/1.1 message syntax parsing and serialization (RFC 9112).">SocketHTTP1.h</a> for header size limits. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00121">121</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gad7c7855b84a0bc59ee29df1d16f3b390" name="gad7c7855b84a0bc59ee29df1d16f3b390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad7c7855b84a0bc59ee29df1d16f3b390">&#9670;&#160;</a></span>SOCKET_PROXY_DEFAULT_POLL_TIMEOUT_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_PROXY_DEFAULT_POLL_TIMEOUT_MS&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Default timeout for SocketPoll_wait when no deadline pending. </p>
<p>Value: 1000 ms (1s) - prevents busy loops in async poll while allowing progress checks. Used when connect/handshake timeouts not active.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gaf64af0e87ee1735152783f2b7fd132c9" title="Calculate milliseconds until next internal timeout.">SocketProxy_Conn_next_timeout_ms()</a> for dynamic calc. </dd>
<dd>
<a class="el" href="group__event__system.html#gaa3d47365dd18329d50ee636284839738" title="Wait for I/O events on registered sockets.">SocketPoll_wait()</a> integration. </dd>
<dd>
<a class="el" href="group__proxy.html#structSocketProxy__Config" title="Configuration structure for proxy connections.">SocketProxy_Config</a> timeouts for overrides. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00191">191</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga787c1af36f15b60e2f85339f94bfbe49" name="ga787c1af36f15b60e2f85339f94bfbe49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga787c1af36f15b60e2f85339f94bfbe49">&#9670;&#160;</a></span>SOCKET_PROXY_ERROR_BUFSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_PROXY_ERROR_BUFSIZE&#160;&#160;&#160;256</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Internal constants for buffer sizes, timeouts, and protocol limits. </p>
<p>Defines configurable sizes for buffers, URL parsing, and default timeouts used throughout proxy negotiation. These control memory usage and performance.</p>
<dl class="section note"><dt>Note</dt><dd>Values can be overridden via preprocessor before build. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T" title="Opaque proxy connection context for managing tunneling negotiation.">SocketProxy_Conn_T</a> for usage in fields like error_buf, send_buf. </dd>
<dd>
socketproxy_parse_* functions for URL limits. </dd>
<dd>
<a class="el" href="group__core__io.html#ga89a14153269ffab409e6ebfaf6deebdd" title="Get current monotonic time in milliseconds.">socketproxy_get_time_ms()</a> for time conversions.</dd></dl>
<p>Size of per-connection error message buffer.</p>
<p>Value: 256 bytes - sufficient for errno strings + context (e.g., "SOCKS5 auth failed on fd=5"). Used in <a class="el" href="group__proxy__private.html#aaaed59222364e1228661678468b42283">SocketProxy_Conn_T::error_buf</a> for socketproxy_set_error formatting. Thread-local fallback via SocketUtil if needed, but instance-specific here.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__proxy__private.html#aaaed59222364e1228661678468b42283">SocketProxy_Conn_T::error_buf</a> </dd>
<dd>
<a class="el" href="group__proxy__private.html#gabe33454412b97fd3d344b2bbfd042b2d" title="Error formatting macros delegating to SocketUtil infrastructure.">PROXY_ERROR_FMT()</a>, <a class="el" href="group__proxy__private.html#ga1e37b31329a2b2041a65e255cc2a77d8" title="Format proxy error without errno details.">PROXY_ERROR_MSG()</a> </dd>
<dd>
<a class="el" href="group__core__io.html#ga590a8e0ece3a282a17f59778b6f9d757" title="Set error state and format message in conn-&gt;error_buf.">socketproxy_set_error()</a> </dd>
<dd>
<a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a> "Error Handling" for base buffer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00104">104</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga9af35160f08629ec1a5b5700581c9a34" name="ga9af35160f08629ec1a5b5700581c9a34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9af35160f08629ec1a5b5700581c9a34">&#9670;&#160;</a></span>SOCKET_PROXY_MAX_URL_LEN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_PROXY_MAX_URL_LEN&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Maximum length for proxy URL strings in parsing. </p>
<p>Value: 2048 bytes - conservative limit for scheme://user:pass@host:port formats. Prevents DoS from oversized URLs; enforced in SocketProxy_parse_url.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gae16c20e1d43f38171ccaad8408598490" title="Parse proxy URL string into configuration structure.">SocketProxy_parse_url()</a> for validation. </dd>
<dd>
<a class="el" href="group__proxy.html#structSocketProxy__Config" title="Configuration structure for proxy connections.">SocketProxy_Config</a> for parsed output. </dd>
<dd>
<a class="el" href="PROXY_8md.html">docs/PROXY.md</a>#url-format for supported formats. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00136">136</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga9f5752234c11ead463ea1e91cf03a2ad" name="ga9f5752234c11ead463ea1e91cf03a2ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9f5752234c11ead463ea1e91cf03a2ad">&#9670;&#160;</a></span>SOCKET_PROXY_MS_PER_SEC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_PROXY_MS_PER_SEC&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Milliseconds per second constant for timeout calculations. </p>
<p>Value: 1000 - standard conversion used in socketproxy_elapsed_ms and deadlines.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga89a14153269ffab409e6ebfaf6deebdd" title="Get current monotonic time in milliseconds.">socketproxy_get_time_ms()</a> for time fetches. </dd>
<dd>
SocketTimeout <a class="el" href="group__utilities.html" title="Helper modules for rate limiting, retry logic, and metrics.">Utility Modules</a> in <a class="el" href="SocketUtil_8h.html" title="Consolidated utility header for logging, metrics, events, and error handling.">SocketUtil.h</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00164">164</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga52309497faa9acfa9ff1c6c143ef7d07" name="ga52309497faa9acfa9ff1c6c143ef7d07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga52309497faa9acfa9ff1c6c143ef7d07">&#9670;&#160;</a></span>SOCKET_PROXY_NS_PER_MS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_PROXY_NS_PER_MS&#160;&#160;&#160;1000000LL</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Nanoseconds per millisecond for high-precision time conversion. </p>
<p>Value: 1,000,000 - used in clock_gettime to ms conversion for monotonic timing. Ensures accurate timeout enforcement without drift.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga89a14153269ffab409e6ebfaf6deebdd" title="Get current monotonic time in milliseconds.">socketproxy_get_time_ms()</a> implementation. </dd>
<dd>
CLOCK_MONOTONIC for source. </dd>
<dd>
<a class="el" href="group__foundation.html#ga264bfa9d1cf07aa22446a4df6c4936bf" title="Socket_get_monotonic_ms - Get current monotonic time in milliseconds.">Socket_get_monotonic_ms()</a> related util. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00177">177</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga0f936941652891a3270993b5bd57730d" name="ga0f936941652891a3270993b5bd57730d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0f936941652891a3270993b5bd57730d">&#9670;&#160;</a></span>SOCKET_PROXY_STATIC_BUFFER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKET_PROXY_STATIC_BUFFER_SIZE&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of static buffer for temporary URL parsing (when no arena provided). </p>
<p>Value: 1024 bytes - used in socketproxy_parse_* helpers for host/port/userinfo. Thread-local to avoid reallocation; overwritten on next call if no arena. For thread-safety, always provide Arena_T in public APIs.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga4284e6c37f6f115b2099885ae0f5622c" title="Parse optional [user[:pass]@] from URL.">socketproxy_parse_userinfo()</a>, <a class="el" href="group__core__io.html#gaa11b9c1ecceaca495ac3a397682a3dc0" title="Parse [host]:port from URL, handling IPv6 literals.">socketproxy_parse_hostport()</a> for usage. </dd>
<dd>
<a class="el" href="group__foundation.html#ga1af76425187cb52fda8d569dcc931e2d" title="Duplicate string into arena.">socket_util_arena_strdup()</a> fallback with arena. </dd>
<dd>
<a class="el" href="group__foundation.html">Arena module</a> for safe memory. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00152">152</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gab3df315d612ee6df173a2567c464ed7e" name="gab3df315d612ee6df173a2567c464ed7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab3df315d612ee6df173a2567c464ed7e">&#9670;&#160;</a></span>SOCKS4_CMD_CONNECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS4_CMD_CONNECT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS4 CONNECT command code.Value: 1 CD field in request for TCP connect. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga93a6b1c4f6b287b308b18207368ad092" title="Internal functions for SOCKS4 and SOCKS4a protocol handling.">proxy_socks4_send_connect()</a>, <a class="el" href="group__core__io.html#ga904ce0bf17f24e2e2783aaf8f1491c03" title="Build SOCKS4a CONNECT request with hostname (non-standard extension).">proxy_socks4a_send_connect()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00231">231</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga7df58477af7c9a978ce11fb41564d4c1" name="ga7df58477af7c9a978ce11fb41564d4c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7df58477af7c9a978ce11fb41564d4c1">&#9670;&#160;</a></span>SOCKS4_REPLY_GRANTED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS4_REPLY_GRANTED&#160;&#160;&#160;90</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS4 reply codes for connection result.90: Granted, 91: Rejected, 92: No identd, 93: Ident mismatch. Mapped in <a class="el" href="group__core__io.html#ga2f17a3a05ffed99bade9280577b4bb25" title="Map SOCKS4 reply code to SocketProxy_Result.">proxy_socks4_reply_to_result()</a>. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga82d72fd16b045c8660210f9ad861a879" title="Parse SOCKS4/SOCKS4a response.">proxy_socks4_recv_response()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00239">239</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga1923310fdf482b7aebd613652b7eb2bf" name="ga1923310fdf482b7aebd613652b7eb2bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1923310fdf482b7aebd613652b7eb2bf">&#9670;&#160;</a></span>SOCKS4_REPLY_IDENTD_MISMATCH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS4_REPLY_IDENTD_MISMATCH&#160;&#160;&#160;93</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00242">242</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gac55e6af1d26c1b104efbf39e27553947" name="gac55e6af1d26c1b104efbf39e27553947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac55e6af1d26c1b104efbf39e27553947">&#9670;&#160;</a></span>SOCKS4_REPLY_NO_IDENTD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS4_REPLY_NO_IDENTD&#160;&#160;&#160;92</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00241">241</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gad060585ee25e3b3b62753d0a57c662ef" name="gad060585ee25e3b3b62753d0a57c662ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad060585ee25e3b3b62753d0a57c662ef">&#9670;&#160;</a></span>SOCKS4_REPLY_REJECTED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS4_REPLY_REJECTED&#160;&#160;&#160;91</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00240">240</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga4c409afdc74bda0aa590309dbfb60e83" name="ga4c409afdc74bda0aa590309dbfb60e83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4c409afdc74bda0aa590309dbfb60e83">&#9670;&#160;</a></span>SOCKS4_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS4_VERSION&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS4 and SOCKS5 protocol constants per RFCs. </p>
<p>Protocol versions, commands, replies, auth methods, address types, and fixed sizes for request/response parsing in proxy handshakes. Used in proxy_socks* functions for building/parsing messages.</p>
<p>SOCKS4: Basic IPv4 tunneling, no auth, single step. SOCKS5: Advanced, supports IPv6/domain, auth (none/password/GSSAPI), multi-step.</p>
<p>Reply codes mapped to SocketProxy_Result in recv functions. Sizes ensure bounds-checked parsing to prevent overflows.</p>
<dl class="section see"><dt>See also</dt><dd>RFC 1928 SOCKS5 protocol. </dd>
<dd>
RFC 1929 SOCKS5 username/password auth. </dd>
<dd>
RFC 1928 Appendix A for SOCKS4 informational. </dd>
<dd>
proxy_socks5_* functions for usage. </dd>
<dd>
<a class="el" href="group__core__io.html#gae980e6a437316380a792464ce32a595e" title="Result codes for proxy operations.">SocketProxy_Result</a> for error mapping. </dd>
<dd>
<a class="el" href="PROXY_8md.html">docs/PROXY.md</a> for SOCKS flow.</dd></dl>
<p>SOCKS4 protocol version number.</p>
<p>Value: 4 Used in request header VN field. </p><dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga93a6b1c4f6b287b308b18207368ad092" title="Internal functions for SOCKS4 and SOCKS4a protocol handling.">proxy_socks4_send_connect()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00223">223</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga14afd87de02a66fe870f981f9efe9862" name="ga14afd87de02a66fe870f981f9efe9862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga14afd87de02a66fe870f981f9efe9862">&#9670;&#160;</a></span>SOCKS5_ATYP_DOMAIN</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_ATYP_DOMAIN&#160;&#160;&#160;0x03</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00290">290</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga9be4c9660ff9166120889c3680d91539" name="ga9be4c9660ff9166120889c3680d91539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9be4c9660ff9166120889c3680d91539">&#9670;&#160;</a></span>SOCKS5_ATYP_IPV4</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_ATYP_IPV4&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 address type codes (ATYP).0x01: IPv4 (4 bytes), 0x03: Domain (len + bytes), 0x04: IPv6 (16 bytes). Used in CONNECT request/reply. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gad730a252b44728ae21660f2d168b66e3" title="Build SOCKS5 CONNECT command request (RFC 1928).">proxy_socks5_send_connect()</a>, <a class="el" href="group__core__io.html#gae140af2a9af5d32b1786df145d2ccc07" title="Parse SOCKS5 CONNECT response (RFC 1928).">proxy_socks5_recv_connect()</a> </dd>
<dd>
SocketProxy_SOCKS5H for domain resolution at <a class="el" href="group__proxy.html" title="Transparent TCP proxy support with sync/async APIs.">Proxy Tunneling Module</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00289">289</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga64e32f131e3d76116ebec676d9866594" name="ga64e32f131e3d76116ebec676d9866594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga64e32f131e3d76116ebec676d9866594">&#9670;&#160;</a></span>SOCKS5_ATYP_IPV6</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_ATYP_IPV6&#160;&#160;&#160;0x04</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00291">291</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gabd8de982ea3b948d3a1258ca8b36699d" name="gabd8de982ea3b948d3a1258ca8b36699d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabd8de982ea3b948d3a1258ca8b36699d">&#9670;&#160;</a></span>SOCKS5_AUTH_GSSAPI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_AUTH_GSSAPI&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00268">268</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gad4d23c2ae0d1914d13bb1cb21863c8db" name="gad4d23c2ae0d1914d13bb1cb21863c8db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad4d23c2ae0d1914d13bb1cb21863c8db">&#9670;&#160;</a></span>SOCKS5_AUTH_NO_ACCEPTABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_AUTH_NO_ACCEPTABLE&#160;&#160;&#160;0xFF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00270">270</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga7f574e2ab614cc6e85d36a9fa363c59d" name="ga7f574e2ab614cc6e85d36a9fa363c59d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f574e2ab614cc6e85d36a9fa363c59d">&#9670;&#160;</a></span>SOCKS5_AUTH_NONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_AUTH_NONE&#160;&#160;&#160;0x00</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 authentication method codes.0x00: No auth, 0x01: GSSAPI, 0x02: Password, 0xFF: No acceptable. Listed in greeting; selected in response. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga0fcced421154218776f5077fa437f58e" title="Build and prepare SOCKS5 greeting message (RFC 1928).">proxy_socks5_send_greeting()</a>, <a class="el" href="group__core__io.html#ga3695eb1c73d0f31fe1ac6d51f677ab73" title="Parse SOCKS5 method selection response (RFC 1928).">proxy_socks5_recv_method()</a> </dd>
<dd>
<a class="el" href="group__proxy__private.html#af601d7eeeb78ef4fe2c694ad20ee6f44">SocketProxy_Conn_T::socks5_auth_method</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00267">267</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga899b27c99a9931c5696e2f82660a5747" name="ga899b27c99a9931c5696e2f82660a5747"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga899b27c99a9931c5696e2f82660a5747">&#9670;&#160;</a></span>SOCKS5_AUTH_PASSWORD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_AUTH_PASSWORD&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00269">269</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga6f777fd21e113340db6dc6b29615bccd" name="ga6f777fd21e113340db6dc6b29615bccd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f777fd21e113340db6dc6b29615bccd">&#9670;&#160;</a></span>SOCKS5_AUTH_RESPONSE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_AUTH_RESPONSE_SIZE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>VER + STATUS </p>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00327">327</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga341dfd976e8ded0551eba1d09d4818c9" name="ga341dfd976e8ded0551eba1d09d4818c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga341dfd976e8ded0551eba1d09d4818c9">&#9670;&#160;</a></span>SOCKS5_AUTH_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_AUTH_VERSION&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 subnegotiation auth version (RFC 1929).Value: 1 VER in username/password auth request/response. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gaf0c10ebe07ba3206fd7e5e6725960e9a" title="Build SOCKS5 username/password authentication request (RFC 1929).">proxy_socks5_send_auth()</a>, <a class="el" href="group__core__io.html#ga54e8297c18caa6bb448daa0d1dceafeb" title="Parse SOCKS5 username/password authentication response (RFC 1929).">proxy_socks5_recv_auth()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00258">258</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gae1581edc98795710ca1a7995170c0594" name="gae1581edc98795710ca1a7995170c0594"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae1581edc98795710ca1a7995170c0594">&#9670;&#160;</a></span>SOCKS5_CMD_BIND</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_CMD_BIND&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00279">279</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga108e237a994aebc73ad3bbcf141b6de4" name="ga108e237a994aebc73ad3bbcf141b6de4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga108e237a994aebc73ad3bbcf141b6de4">&#9670;&#160;</a></span>SOCKS5_CMD_CONNECT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_CMD_CONNECT&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 command codes.0x01: Connect, 0x02: Bind, 0x03: UDP associate. Only CONNECT used for tunneling. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gad730a252b44728ae21660f2d168b66e3" title="Build SOCKS5 CONNECT command request (RFC 1928).">proxy_socks5_send_connect()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00278">278</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga18469924a98b80175ed350975ac5ffdb" name="ga18469924a98b80175ed350975ac5ffdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga18469924a98b80175ed350975ac5ffdb">&#9670;&#160;</a></span>SOCKS5_CMD_UDP_ASSOCIATE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_CMD_UDP_ASSOCIATE&#160;&#160;&#160;0x03</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00280">280</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga3b6c9b679741441ebb94976c60debdd9" name="ga3b6c9b679741441ebb94976c60debdd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3b6c9b679741441ebb94976c60debdd9">&#9670;&#160;</a></span>SOCKS5_CONNECT_HEADER_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_CONNECT_HEADER_SIZE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>VER + REP + RSV + ATYP </p>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00328">328</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga9988f978dd580fa47a6806c10b396b6e" name="ga9988f978dd580fa47a6806c10b396b6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9988f978dd580fa47a6806c10b396b6e">&#9670;&#160;</a></span>SOCKS5_CONNECT_IPV4_RESPONSE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_CONNECT_IPV4_RESPONSE_SIZE&#160;&#160;&#160;  (<a class="el" href="group__proxy__private.html#ga3b6c9b679741441ebb94976c60debdd9">SOCKS5_CONNECT_HEADER_SIZE</a> + <a class="el" href="group__proxy__private.html#ga8acf82fb4990e729e3d2173f897484c1">SOCKS5_IPV4_ADDR_SIZE</a> + <a class="el" href="group__proxy__private.html#gac06606832cfef92d3ffea479fff6d709">SOCKS5_PORT_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 CONNECT response total sizes for common address types.IPv4: Header + 4 + 2 = 10 bytes, IPv6: Header + 16 + 2 = 22 bytes. Used to validate full response recv. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gae140af2a9af5d32b1786df145d2ccc07" title="Parse SOCKS5 CONNECT response (RFC 1928).">proxy_socks5_recv_connect()</a> for parsing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00336">336</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gab22b33a4f85b73bdcce74accde1798f4" name="gab22b33a4f85b73bdcce74accde1798f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab22b33a4f85b73bdcce74accde1798f4">&#9670;&#160;</a></span>SOCKS5_CONNECT_IPV6_RESPONSE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_CONNECT_IPV6_RESPONSE_SIZE&#160;&#160;&#160;  (<a class="el" href="group__proxy__private.html#ga3b6c9b679741441ebb94976c60debdd9">SOCKS5_CONNECT_HEADER_SIZE</a> + <a class="el" href="group__proxy__private.html#ga13428a508dd2f201ff1a4c348b600ab3">SOCKS5_IPV6_ADDR_SIZE</a> + <a class="el" href="group__proxy__private.html#gac06606832cfef92d3ffea479fff6d709">SOCKS5_PORT_SIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00338">338</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga8acf82fb4990e729e3d2173f897484c1" name="ga8acf82fb4990e729e3d2173f897484c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8acf82fb4990e729e3d2173f897484c1">&#9670;&#160;</a></span>SOCKS5_IPV4_ADDR_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_IPV4_ADDR_SIZE&#160;&#160;&#160;4</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fixed address and port sizes for SOCKS5 messages (RFC 1928 Sec 4).IPv4: 4 bytes, IPv6: 16 bytes, Port: 2 bytes (big-endian). Used for buffer allocation and parsing bounds. </p>
<dl class="section see"><dt>See also</dt><dd>SOCKS5_ATYP_* for types. IPv4 address bytes </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00316">316</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga13428a508dd2f201ff1a4c348b600ab3" name="ga13428a508dd2f201ff1a4c348b600ab3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga13428a508dd2f201ff1a4c348b600ab3">&#9670;&#160;</a></span>SOCKS5_IPV6_ADDR_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_IPV6_ADDR_SIZE&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>IPv6 address bytes </p>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00317">317</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gaf311c4dffb9708d0a95e14abaa8f11dd" name="gaf311c4dffb9708d0a95e14abaa8f11dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf311c4dffb9708d0a95e14abaa8f11dd">&#9670;&#160;</a></span>SOCKS5_METHOD_RESPONSE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_METHOD_RESPONSE_SIZE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 response message size constants.Method response: 2 bytes, Auth response: 2 bytes, Connect header: 4 bytes (VER+REP+RSV+ATYP). Used for expected recv lengths in state machine. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga3695eb1c73d0f31fe1ac6d51f677ab73" title="Parse SOCKS5 method selection response (RFC 1928).">proxy_socks5_recv_method()</a>, <a class="el" href="group__core__io.html#ga54e8297c18caa6bb448daa0d1dceafeb" title="Parse SOCKS5 username/password authentication response (RFC 1929).">proxy_socks5_recv_auth()</a>, <a class="el" href="group__core__io.html#gae140af2a9af5d32b1786df145d2ccc07" title="Parse SOCKS5 CONNECT response (RFC 1928).">proxy_socks5_recv_connect()</a> VER + METHOD </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00326">326</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gac06606832cfef92d3ffea479fff6d709" name="gac06606832cfef92d3ffea479fff6d709"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac06606832cfef92d3ffea479fff6d709">&#9670;&#160;</a></span>SOCKS5_PORT_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_PORT_SIZE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Port bytes (network order) </p>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00318">318</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga959bad341e17a9074582254d97b2ca91" name="ga959bad341e17a9074582254d97b2ca91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga959bad341e17a9074582254d97b2ca91">&#9670;&#160;</a></span>SOCKS5_REPLY_ADDRESS_TYPE_NOT_SUPPORTED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_ADDRESS_TYPE_NOT_SUPPORTED&#160;&#160;&#160;0x08</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00308">308</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga89e495f86e65eb8e16b3627a4746bdf6" name="ga89e495f86e65eb8e16b3627a4746bdf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89e495f86e65eb8e16b3627a4746bdf6">&#9670;&#160;</a></span>SOCKS5_REPLY_COMMAND_NOT_SUPPORTED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_COMMAND_NOT_SUPPORTED&#160;&#160;&#160;0x07</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00307">307</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga734956bbb3cba2c1c28b62ca06000442" name="ga734956bbb3cba2c1c28b62ca06000442"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga734956bbb3cba2c1c28b62ca06000442">&#9670;&#160;</a></span>SOCKS5_REPLY_CONNECTION_REFUSED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_CONNECTION_REFUSED&#160;&#160;&#160;0x05</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00305">305</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga29296d14962426df565a8032fc35f17d" name="ga29296d14962426df565a8032fc35f17d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga29296d14962426df565a8032fc35f17d">&#9670;&#160;</a></span>SOCKS5_REPLY_GENERAL_FAILURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_GENERAL_FAILURE&#160;&#160;&#160;0x01</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00301">301</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gaf97dacb625f06c93f7af9297a66373e6" name="gaf97dacb625f06c93f7af9297a66373e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaf97dacb625f06c93f7af9297a66373e6">&#9670;&#160;</a></span>SOCKS5_REPLY_HOST_UNREACHABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_HOST_UNREACHABLE&#160;&#160;&#160;0x04</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00304">304</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gaae81fa32c9a7e2b16ac437ddccf8459a" name="gaae81fa32c9a7e2b16ac437ddccf8459a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaae81fa32c9a7e2b16ac437ddccf8459a">&#9670;&#160;</a></span>SOCKS5_REPLY_NETWORK_UNREACHABLE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_NETWORK_UNREACHABLE&#160;&#160;&#160;0x03</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00303">303</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gae5d6ec38590c939fd2badd59f50fb67a" name="gae5d6ec38590c939fd2badd59f50fb67a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae5d6ec38590c939fd2badd59f50fb67a">&#9670;&#160;</a></span>SOCKS5_REPLY_NOT_ALLOWED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_NOT_ALLOWED&#160;&#160;&#160;0x02</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00302">302</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="gac61a81038f320a72896daefe88499731" name="gac61a81038f320a72896daefe88499731"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac61a81038f320a72896daefe88499731">&#9670;&#160;</a></span>SOCKS5_REPLY_SUCCESS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_SUCCESS&#160;&#160;&#160;0x00</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 reply codes (REP) for commands.0x00: Success, 0x01-0x08: Various failures. Mapped to SocketProxy_Result in recv_connect. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#ga4799fc5a08ded667f5518862c078c1bd" title="Map SOCKS5 reply code to SocketProxy_Result.">proxy_socks5_reply_to_result()</a> </dd>
<dd>
<a class="el" href="group__core__io.html#gae140af2a9af5d32b1786df145d2ccc07" title="Parse SOCKS5 CONNECT response (RFC 1928).">proxy_socks5_recv_connect()</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00300">300</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga7f1453ad2ffabd1b55a8449044544951" name="ga7f1453ad2ffabd1b55a8449044544951"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7f1453ad2ffabd1b55a8449044544951">&#9670;&#160;</a></span>SOCKS5_REPLY_TTL_EXPIRED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_REPLY_TTL_EXPIRED&#160;&#160;&#160;0x06</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00306">306</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga5b416217434efd51f168a4d339a92eb3" name="ga5b416217434efd51f168a4d339a92eb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5b416217434efd51f168a4d339a92eb3">&#9670;&#160;</a></span>SOCKS5_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOCKS5_VERSION&#160;&#160;&#160;5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SOCKS5 protocol version number.Value: 5 VER field in all messages. </p>
<dl class="section see"><dt>See also</dt><dd>proxy_socks5_* functions. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00250">250</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga502253ce06f453baedba160037571812" name="ga502253ce06f453baedba160037571812"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga502253ce06f453baedba160037571812">&#9670;&#160;</a></span>ProxyRecvFunc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="group__core__io.html#gae980e6a437316380a792464ce32a595e">SocketProxy_Result</a>(* ProxyRecvFunc) (struct <a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function type for protocol-specific response parsing. </p>
<p>Called after recv to parse response from buffer, validate, update state/result. Advances proto_state on partial/complete; returns progress status.</p>
<p>Handles variable lengths (e.g., SOCKS5 addr types), maps replies to results.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>Context with recv_buf data and current proto_state. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>SocketProxy_Result: OK complete success, IN_PROGRESS need more bytes, PROTOCOL_ERROR invalid data, other errors via result set. </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Proxy_Failed</td><td>on parse failure (e.g., invalid VER).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__proxy__private.html#ga7b70e48528fb67371dbcc45e7b6ce5c1" title="Function type for protocol-specific request building.">ProxySendFunc</a> for request building. </dd>
<dd>
<a class="el" href="group__proxy__private.html#a614ffa636c6ca6f92b39f8af950c50a3">SocketProxy_Conn_T::recv_buf</a>, ::recv_len, ::proto_state for input/output. </dd>
<dd>
<a class="el" href="group__core__io.html#gab87758fdfc1cbbf3af9740989da246fd" title="Receive protocol data into conn-&gt;recv_buf.">socketproxy_do_recv()</a> for data filling buffer. </dd>
<dd>
<a class="el" href="group__core__io.html#gada1416d62b5113240c93bd3020dc4b68" title="Internal state machine functions for proxy negotiation.">socketproxy_advance_state()</a> called after successful parse. </dd>
<dd>
<a class="el" href="group__core__io.html#gae140af2a9af5d32b1786df145d2ccc07" title="Parse SOCKS5 CONNECT response (RFC 1928).">proxy_socks5_recv_connect()</a> example. </dd>
<dd>
<a class="el" href="group__core__io.html#gae980e6a437316380a792464ce32a595e" title="Result codes for proxy operations.">SocketProxy_Result</a> for return mapping. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00712">712</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<a id="ga7b70e48528fb67371dbcc45e7b6ce5c1" name="ga7b70e48528fb67371dbcc45e7b6ce5c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b70e48528fb67371dbcc45e7b6ce5c1">&#9670;&#160;</a></span>ProxySendFunc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* ProxySendFunc) (struct <a class="el" href="group__proxy__private.html#structSocketProxy__Conn__T">SocketProxy_Conn_T</a> *conn)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function type for protocol-specific request building. </p>
<p>Called by state machine to construct request message (e.g., SOCKS5 greeting, HTTP CONNECT, SOCKS4 connect) into fixed send buffer. Sets conn-&gt;send_len; does not send (handled by socketproxy_do_send).</p>
<p>Expected to use PROXY_ERROR_* and RAISE_PROXY_ERROR on failure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">conn</td><td>Proxy context with config and buffers. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 success (buffer ready), -1 error (exception raised). </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">Proxy_Failed</td><td>on invalid config or build error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__proxy__private.html#ga502253ce06f453baedba160037571812" title="Function type for protocol-specific response parsing.">ProxyRecvFunc</a> counterpart for response parsing. </dd>
<dd>
<a class="el" href="group__proxy__private.html#a64870d3e5ff24323c4d1566bc1fb06c6">SocketProxy_Conn_T::send_buf</a>, ::send_len for output. </dd>
<dd>
<a class="el" href="group__core__io.html#ga71e6170ecb08801fd53c849e1456e83c" title="Send pending protocol data from conn-&gt;send_buf.">socketproxy_do_send()</a> for actual transmission. </dd>
<dd>
<a class="el" href="group__core__io.html#ga0fcced421154218776f5077fa437f58e" title="Build and prepare SOCKS5 greeting message (RFC 1928).">proxy_socks5_send_greeting()</a> example implementation. </dd>
<dd>
<a class="el" href="PROXY_8md.html">docs/PROXY.md</a> for protocol flows. </dd></dl>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00688">688</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga8d5525862e31c82df86ea8ec9ccd493c" name="ga8d5525862e31c82df86ea8ec9ccd493c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d5525862e31c82df86ea8ec9ccd493c">&#9670;&#160;</a></span>SocketProxy_ProtoState</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__proxy__private.html#ga8d5525862e31c82df86ea8ec9ccd493c">SocketProxy_ProtoState</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Protocol-specific sub-state for proxy handshakes. </p>
<p>Enumerates detailed states for SOCKS4/5 and HTTP CONNECT protocols during the proxy negotiation process. Used in state machine to dispatch send/recv handlers and track multi-step negotiation progress.</p>
<p>Transitions driven by <a class="el" href="group__core__io.html#gada1416d62b5113240c93bd3020dc4b68" title="Internal state machine functions for proxy negotiation.">socketproxy_advance_state()</a> after successful I/O operations. Each state corresponds to a specific protocol phase, enabling modular handlers.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core__io.html#gaf9f1c72bfcb303aa9ee5dae6d903b9be" title="States in the proxy connection state machine.">SocketProxy_State</a> for high-level connection state (e.g., HANDSHAKE_SEND/RECV). </dd>
<dd>
<a class="el" href="group__proxy__private.html#a813513bee1ea5117ffea491c85edcd81">SocketProxy_Conn_T::proto_state</a> for field usage in context. </dd>
<dd>
<a class="el" href="group__proxy__private.html#ga7b70e48528fb67371dbcc45e7b6ce5c1" title="Function type for protocol-specific request building.">ProxySendFunc</a>, <a class="el" href="group__proxy__private.html#ga502253ce06f453baedba160037571812" title="Function type for protocol-specific response parsing.">ProxyRecvFunc</a> for state-specific protocol handlers. </dd>
<dd>
<a class="el" href="group__core__io.html#gada1416d62b5113240c93bd3020dc4b68" title="Internal state machine functions for proxy negotiation.">socketproxy_advance_state()</a> for state machine advancement logic. </dd>
<dd>
<a class="el" href="PROXY_8md.html">docs/PROXY.md</a> for protocol flow diagrams. </dd></dl>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493caf5542717d2ee90d3d17b63b4cf6ece64" name="gga8d5525862e31c82df86ea8ec9ccd493caf5542717d2ee90d3d17b63b4cf6ece64"></a>PROTO_STATE_INIT&#160;</td><td class="fielddoc"><p>Initial state before any protocol interaction. Ready to build and send first message (greeting for SOCKS5, request for others). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493cafba3acda31e424f195898a8ba5488940" name="gga8d5525862e31c82df86ea8ec9ccd493cafba3acda31e424f195898a8ba5488940"></a>PROTO_STATE_SOCKS5_GREETING_SENT&#160;</td><td class="fielddoc"><p>SOCKS5 version 5 greeting sent to proxy. Lists supported auth methods (SOCKS5_AUTH_NONE, optional SOCKS5_AUTH_PASSWORD). Awaiting method selection response (2-byte: VER=5, METHOD). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493ca8767b75e57730c4169d8e5299fbf81f7" name="gga8d5525862e31c82df86ea8ec9ccd493ca8767b75e57730c4169d8e5299fbf81f7"></a>PROTO_STATE_SOCKS5_METHOD_RECEIVED&#160;</td><td class="fielddoc"><p>Method selection response parsed successfully. Auth method stored in conn-&gt;socks5_auth_method; if none, proceed to connect; else transition to auth subnegotiation. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493cad9cbdb2e2397158bbd069ababd33e7af" name="gga8d5525862e31c82df86ea8ec9ccd493cad9cbdb2e2397158bbd069ababd33e7af"></a>PROTO_STATE_SOCKS5_AUTH_SENT&#160;</td><td class="fielddoc"><p>Username/password authentication request sent (method 0x02). Format per RFC 1929: VER=1, ULEN, USERID, PLEN, PASSWD. Awaiting 2-byte response (VER=1, STATUS=0x00 success). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493ca429c6f1b7b064fcfe594a9de4d5bd85b" name="gga8d5525862e31c82df86ea8ec9ccd493ca429c6f1b7b064fcfe594a9de4d5bd85b"></a>PROTO_STATE_SOCKS5_AUTH_RECEIVED&#160;</td><td class="fielddoc"><p>Auth response received and validated. On success (STATUS=0), proceed to CONNECT; failure maps to PROXY_ERROR_AUTH_FAILED. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493caf20756c410fcc0f622ea89994f10c81a" name="gga8d5525862e31c82df86ea8ec9ccd493caf20756c410fcc0f622ea89994f10c81a"></a>PROTO_STATE_SOCKS5_CONNECT_SENT&#160;</td><td class="fielddoc"><p>SOCKS5 CONNECT command sent with target details. CMD=0x01, ATYP (IPv4/domain/IPv6), ADDR, PORT; supports SOCKS5H (hostname at proxy). Awaiting variable-length reply (VER=5, REP, bound addr/port). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493ca4cf8dced08ab39ea15cda595922bf111" name="gga8d5525862e31c82df86ea8ec9ccd493ca4cf8dced08ab39ea15cda595922bf111"></a>PROTO_STATE_SOCKS5_CONNECT_RECEIVED&#160;</td><td class="fielddoc"><p>CONNECT reply fully parsed. REP=0x00 success (tunnel ready, ignore bound addr); other REPs map to specific PROXY_ERROR_* via <a class="el" href="group__core__io.html#ga4799fc5a08ded667f5518862c078c1bd" title="Map SOCKS5 reply code to SocketProxy_Result.">proxy_socks5_reply_to_result()</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493ca4111e707281eccc70e9e6aa97777a1a9" name="gga8d5525862e31c82df86ea8ec9ccd493ca4111e707281eccc70e9e6aa97777a1a9"></a>PROTO_STATE_SOCKS4_CONNECT_SENT&#160;</td><td class="fielddoc"><p>SOCKS4 CONNECT request sent (IPv4 only or 4a extension). VN=4, CMD=1, DSTPORT, DSTIP (0.0.0.x for 4a domain), USERID="socket", null-term domain (4a). Awaiting 8-byte reply (null VN, CD=90 granted or error). </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493ca798e97b768cc911a58b89bca9e242d08" name="gga8d5525862e31c82df86ea8ec9ccd493ca798e97b768cc911a58b89bca9e242d08"></a>PROTO_STATE_SOCKS4_CONNECT_RECEIVED&#160;</td><td class="fielddoc"><p>SOCKS4 reply received and checked. CD=90 success; 91-93 errors mapped via <a class="el" href="group__core__io.html#ga2f17a3a05ffed99bade9280577b4bb25" title="Map SOCKS4 reply code to SocketProxy_Result.">proxy_socks4_reply_to_result()</a>. No addr in reply. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493cac2f57b720922a9a40199634cf679beb2" name="gga8d5525862e31c82df86ea8ec9ccd493cac2f57b720922a9a40199634cf679beb2"></a>PROTO_STATE_HTTP_REQUEST_SENT&#160;</td><td class="fielddoc"><p>HTTP CONNECT target_host:target_port HTTP/1.1 request sent. Includes Host:, optional Proxy-Authorization (Basic), and extra_headers. Uses Socket_send or TLS_send; awaiting response via incremental <a class="el" href="group__http1.html#ga83fa0ae51796710bc10e16154b448a3f" title="Parse data incrementally.">SocketHTTP1_Parser_execute()</a>. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493ca6ebbcb3c7028113f0d93a18a1fa96155" name="gga8d5525862e31c82df86ea8ec9ccd493ca6ebbcb3c7028113f0d93a18a1fa96155"></a>PROTO_STATE_HTTP_RESPONSE_RECEIVED&#160;</td><td class="fielddoc"><p>HTTP response headers fully parsed via http_parser. Expect status 200 "Connection established"; 4xx/5xx map to PROXY_HTTP_ERROR via <a class="el" href="group__core__io.html#ga9afd213292a65fd6db0e416fa37a433b" title="Map HTTP status code to SocketProxy_Result for CONNECT.">proxy_http_status_to_result()</a>. Tunnel active on success; no body expected. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga8d5525862e31c82df86ea8ec9ccd493ca385541d759585795ce1310609ec3d6bd" name="gga8d5525862e31c82df86ea8ec9ccd493ca385541d759585795ce1310609ec3d6bd"></a>PROTO_STATE_DONE&#160;</td><td class="fielddoc"><p>Handshake protocol phase complete. Success or failure reflected in conn-&gt;result and high-level state. No further proxy-specific I/O; ready for application data tunneling or error handling/cleanup. </p>
</td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="SocketProxy-private_8h_source.html#l00364">364</a> of file <a class="el" href="SocketProxy-private_8h_source.html">SocketProxy-private.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<hr class="footer"/>
<footer class="footer">
  <div style="max-width: 960px; margin: 0 auto; padding: 40px 24px;">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 40px;">
      <!-- Brand -->
      <div style="flex: 1; min-width: 200px;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 6px;"></div>
          <span style="font-size: 1rem; font-weight: 600; color: #f7f9fa;">Socket Library</span>
        </div>
        <p style="color: #8b98a5; font-size: 0.8125rem; line-height: 1.6; margin: 0;">
          High-performance socket toolkit for POSIX systems with exception-based error handling and TLS 1.3 support.
        </p>
      </div>
      <!-- Links -->
      <div style="display: flex; gap: 48px; flex-wrap: wrap;">
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Documentation</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="index.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Getting Started</a></li>
            <li style="margin: 6px 0;"><a href="annotated.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Data Structures</a></li>
            <li style="margin: 6px 0;"><a href="globals.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">API Reference</a></li>
          </ul>
        </div>
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Resources</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="files.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Header Files</a></li>
            <li style="margin: 6px 0;"><a href="https://x.com/tetsuocorp" target="_blank" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Twitter/X</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Bottom -->
    <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #30363d; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
      <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 0.75rem; font-weight: 500; color: #10b981; background: rgba(16, 185, 129, 0.1); padding: 4px 8px; border-radius: 4px;">C11</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #3b82f6; background: rgba(59, 130, 246, 0.1); padding: 4px 8px; border-radius: 4px;">POSIX</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #8b5cf6; background: rgba(139, 92, 246, 0.1); padding: 4px 8px; border-radius: 4px;">TLS 1.3</span>
      </div>
      <div style="color: #6e7681; font-size: 0.75rem; display: flex; align-items: center; gap: 8px;">
        <span> 2025 Tetsuo Corporation</span>
        <span style="color: #30363d;"></span>
        <a href="https://opensource.org/licenses/MIT" target="_blank" style="color: #8b98a5; text-decoration: none;">MIT License</a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
