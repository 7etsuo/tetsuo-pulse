<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="High-performance, exception-driven socket toolkit for POSIX systems">
<meta name="keywords" content="socket, networking, C, POSIX, TCP, UDP, TLS, async, high-performance, library">
<meta name="author" content="Tetsuo Corporation">
<meta name="theme-color" content="#3b82f6">
<title>Migration Guide</title>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link href="socket-theme.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='g' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' stop-color='%233b82f6'/><stop offset='100%25' stop-color='%238b5cf6'/></linearGradient></defs><rect width='100' height='100' rx='20' fill='url(%23g)'/><text x='50' y='68' font-size='50' text-anchor='middle' fill='white' font-family='sans-serif' font-weight='bold'>S</text></svg>">
</head>
<body>
<div id="top">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Socket Library<span id="projectnumber">1.0.0</span></div>
   <div id="projectbrief">High-performance, exception-driven socket toolkit for POSIX systems</div>
  </td>
  <td style="text-align: right; padding: 20px; vertical-align: middle;">
    <div style="display: flex; gap: 8px; justify-content: flex-end; flex-wrap: wrap; align-items: center;">
      <a href="index.html" class="quick-link">Home</a>
      <a href="annotated.html" class="quick-link">Structures</a>
      <a href="files.html" class="quick-link">Files</a>
      <a href="globals.html" class="quick-link">API</a>
    </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('migration_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Migration Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Guide for migrating to the Socket Library from other networking libraries.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md280"></a>
Migration from BSD Sockets</h1>
<p>The Socket Library provides a higher-level abstraction over BSD sockets.</p>
<h2><a class="anchor" id="autotoc_md281"></a>
Socket Creation</h2>
<p><b>BSD Sockets:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> fd = socket(AF_INET, SOCK_STREAM, 0);</div>
<div class="line"><span class="keywordflow">if</span> (fd &lt; 0) {</div>
<div class="line">    perror(<span class="stringliteral">&quot;socket&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_typedef" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> sock = <a class="code hl_function" href="Socket_8h.html#a6212fb2b6eefa567592a59f55c25a6f1">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#a225f4a8fd657fd52a05146c6fc4f58b0">Socket_Failed</a>) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Error: %s\n&quot;</span>, Socket_error());</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aExcept_8h_html_ab5e72fc2bd41014c75e0ace4feabfe8e"><div class="ttname"><a href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a></div><div class="ttdeci">#define EXCEPT(e)</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00118">Except.h:118</a></div></div>
<div class="ttc" id="aExcept_8h_html_ad2746371528bdf15c3910b7bf217dac0"><div class="ttname"><a href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a></div><div class="ttdeci">#define TRY</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00103">Except.h:103</a></div></div>
<div class="ttc" id="aExcept_8h_html_ae6628ac788ad213363b89dba9868420b"><div class="ttname"><a href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a></div><div class="ttdeci">#define END_TRY</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00139">Except.h:139</a></div></div>
<div class="ttc" id="aSocket_8h_html_a1bcdb0c6d5827c2493bd622fa7751f14"><div class="ttname"><a href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a></div><div class="ttdeci">struct Socket_T * Socket_T</div><div class="ttdef"><b>Definition</b> <a href="Socket_8h_source.html#l00046">Socket.h:46</a></div></div>
<div class="ttc" id="aSocket_8h_html_a225f4a8fd657fd52a05146c6fc4f58b0"><div class="ttname"><a href="Socket_8h.html#a225f4a8fd657fd52a05146c6fc4f58b0">Socket_Failed</a></div><div class="ttdeci">const Except_T Socket_Failed</div><div class="ttdoc">General socket operation failure.</div></div>
<div class="ttc" id="aSocket_8h_html_a6212fb2b6eefa567592a59f55c25a6f1"><div class="ttname"><a href="Socket_8h.html#a6212fb2b6eefa567592a59f55c25a6f1">Socket_new</a></div><div class="ttdeci">Socket_T Socket_new(int domain, int type, int protocol)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md282"></a>
Connecting</h2>
<p><b>BSD Sockets:</b> </p><div class="fragment"><div class="line"><span class="keyword">struct </span>sockaddr_in addr;</div>
<div class="line">memset(&amp;addr, 0, <span class="keyword">sizeof</span>(addr));</div>
<div class="line">addr.sin_family = AF_INET;</div>
<div class="line">addr.sin_port = htons(port);</div>
<div class="line">inet_pton(AF_INET, host, &amp;addr.sin_addr);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (connect(fd, (<span class="keyword">struct</span> sockaddr*)&amp;addr, <span class="keyword">sizeof</span>(addr)) &lt; 0) {</div>
<div class="line">    perror(<span class="stringliteral">&quot;connect&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_function" href="Socket_8h.html#ac14390090ee26136c1f7a816fc08406e">Socket_connect</a>(sock, host, port);  <span class="comment">/* Handles DNS too */</span></div>
<div class="ttc" id="aSocket_8h_html_ac14390090ee26136c1f7a816fc08406e"><div class="ttname"><a href="Socket_8h.html#ac14390090ee26136c1f7a816fc08406e">Socket_connect</a></div><div class="ttdeci">void Socket_connect(Socket_T socket, const char *host, int port)</div><div class="ttdoc">Socket_connect - Connect to remote host @socket: Socket to connect @host: Remote IP address or hostna...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md283"></a>
Sending Data</h2>
<p><b>BSD Sockets:</b> </p><div class="fragment"><div class="line">ssize_t total = 0;</div>
<div class="line"><span class="keywordflow">while</span> (total &lt; len) {</div>
<div class="line">    ssize_t n = send(fd, buf + total, len - total, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (n &lt; 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (errno == EINTR) <span class="keywordflow">continue</span>;</div>
<div class="line">        perror(<span class="stringliteral">&quot;send&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    total += n;</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_function" href="Socket_8h.html#a6ea9ad33d78c50d327c9677b52849bcb">Socket_sendall</a>(sock, buf, len);  <span class="comment">/* Handles partial sends and EINTR */</span></div>
<div class="ttc" id="aSocket_8h_html_a6ea9ad33d78c50d327c9677b52849bcb"><div class="ttname"><a href="Socket_8h.html#a6ea9ad33d78c50d327c9677b52849bcb">Socket_sendall</a></div><div class="ttdeci">ssize_t Socket_sendall(Socket_T socket, const void *buf, size_t len)</div><div class="ttdoc">Socket_sendall - Send all data (handles partial sends) @socket: Connected socket @buf: Data to send @...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md284"></a>
Socket Options</h2>
<p><b>BSD Sockets:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> optval = 1;</div>
<div class="line">setsockopt(fd, SOL_SOCKET, SO_REUSEADDR, &amp;optval, <span class="keyword">sizeof</span>(optval));</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>linger l = {1, 0};</div>
<div class="line">setsockopt(fd, SOL_SOCKET, SO_LINGER, &amp;l, <span class="keyword">sizeof</span>(l));</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_function" href="Socket_8h.html#a2c6f352cec920859c71206898ed135fc">Socket_setreuseaddr</a>(sock);</div>
<div class="line">Socket_setlinger(sock, 1, 0);</div>
<div class="ttc" id="aSocket_8h_html_a2c6f352cec920859c71206898ed135fc"><div class="ttname"><a href="Socket_8h.html#a2c6f352cec920859c71206898ed135fc">Socket_setreuseaddr</a></div><div class="ttdeci">void Socket_setreuseaddr(Socket_T socket)</div><div class="ttdoc">Socket_setreuseaddr - Enable address reuse @socket: Socket to modify Raises: Socket_Failed on error.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md285"></a>
API Mapping (BSD -&gt; Socket Library)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">BSD Sockets   </th><th class="markdownTableHeadNone">Socket Library    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>socket()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a6212fb2b6eefa567592a59f55c25a6f1">Socket_new()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>close()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a74ad7a9bb8deaf499c59d90d6e411f37" title="Socket_free - Free a socket and close the connection @socket: Pointer to socket (will be set to NULL)">Socket_free()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>connect()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#ac14390090ee26136c1f7a816fc08406e" title="Socket_connect - Connect to remote host @socket: Socket to connect @host: Remote IP address or hostna...">Socket_connect()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>bind()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#acb65d693d8c93e2a1fe6411dd0d0af98" title="Socket_bind - Bind socket to address and port @socket: Socket to bind @host: IP address or NULL/&quot;0....">Socket_bind()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>listen()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#ab24b026bc4c69e6f766211f44675e189" title="Socket_listen - Listen for incoming connections @socket: Bound socket @backlog: Maximum pending conne...">Socket_listen()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>accept()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a32b67d95639513cd6a602f6175b48f15" title="Socket_accept - Accept incoming connection @socket: Listening socket Returns: New socket or NULL if w...">Socket_accept()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>send()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a23ace6e065fe4b9a01db8caa6513515b" title="Socket_send - Send data @socket: Connected socket @buf: Data to send @len: Length of data (&gt; 0) Retur...">Socket_send()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>recv()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a95db343f47445925cecd6b20054518e9" title="Socket_recv - Receive data @socket: Connected socket @buf: Buffer for received data @len: Buffer size...">Socket_recv()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>sendall</code> (loop)   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a6ea9ad33d78c50d327c9677b52849bcb" title="Socket_sendall - Send all data (handles partial sends) @socket: Connected socket @buf: Data to send @...">Socket_sendall()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>getsockname()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a04e55475bcedbc100767663e1e7d9de1" title="Socket_getlocaladdr - Get local IP address @socket: Socket instance Returns: IP address string (IPv4/...">Socket_getlocaladdr()</a></code>, <code><a class="el" href="Socket_8h.html#a3bdedaea9dac966d75343cdffa5d1f3e" title="Socket_getlocalport - Get local port number @socket: Socket instance Returns: Port number (1 to SOCKE...">Socket_getlocalport()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>getpeername()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#ab0957f43694d0728e70b23364a89623c" title="Socket_getpeeraddr - Get peer IP address @socket: Connected socket Returns: IP address string (IPv4/I...">Socket_getpeeraddr()</a></code>, <code><a class="el" href="Socket_8h.html#a38d7e5845519867261a9f24dfe0e03db" title="Socket_getpeerport - Get peer port number @socket: Connected socket Returns: Port number (1 to SOCKET...">Socket_getpeerport()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>fcntl(O_NONBLOCK)</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a35309677a1760480783d5f0c294d0db4" title="Socket_setnonblocking - Enable non-blocking mode @socket: Socket to modify Raises: Socket_Failed on e...">Socket_setnonblocking()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>setsockopt(SO_REUSEADDR)</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a2c6f352cec920859c71206898ed135fc" title="Socket_setreuseaddr - Enable address reuse @socket: Socket to modify Raises: Socket_Failed on error.">Socket_setreuseaddr()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>setsockopt(TCP_NODELAY)</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a55174d7f9aca0e94d25321540646e6b0" title="Socket_setnodelay - Disable Nagle&#39;s algorithm @socket: Socket to modify @nodelay: 1 to disable Nagle,...">Socket_setnodelay()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>setsockopt(SO_KEEPALIVE)</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#af03ef2a81d1894713aeb96c12bb2389b" title="Socket_setkeepalive - Enable TCP keepalive @socket: Socket to modify @idle: Seconds before sending ke...">Socket_setkeepalive()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>poll()</code> / <code>epoll</code>   </td><td class="markdownTableBodyNone"><code>SocketPoll_T</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>sendfile()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#a6262f6ab4c927347abc0fb3c105a0575" title="Socket_sendfileall - Zero-copy file-to-socket transfer (handles partial) @socket: Connected socket to...">Socket_sendfileall()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>writev()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="Socket_8h.html#af6d033a04d5041249950fa2f54a8d9fd" title="Socket_sendvall - Scatter/gather send all (handles partial sends) @socket: Connected socket @iov: Arr...">Socket_sendvall()</a></code>   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md287"></a>
Migration from libcurl</h1>
<h2><a class="anchor" id="autotoc_md288"></a>
Simple GET Request</h2>
<p><b>libcurl:</b> </p><div class="fragment"><div class="line">CURL *curl = curl_easy_init();</div>
<div class="line">curl_easy_setopt(curl, CURLOPT_URL, <span class="stringliteral">&quot;https://example.com&quot;</span>);</div>
<div class="line">curl_easy_setopt(curl, CURLOPT_WRITEFUNCTION, write_callback);</div>
<div class="line">curl_easy_setopt(curl, CURLOPT_WRITEDATA, &amp;response);</div>
<div class="line">CURLcode res = curl_easy_perform(curl);</div>
<div class="line">curl_easy_cleanup(curl);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="SocketHTTPClient_8h.html#aba14ae9994f5645e5aa8488f905aad54">SocketHTTPClient_T</a> client = <a class="code hl_function" href="SocketHTTPClient_8h.html#a2d57db3a9a6388315f253caa099e4205">SocketHTTPClient_new</a>(NULL);</div>
<div class="line"><a class="code hl_struct" href="SocketHTTPClient_8h.html#structSocketHTTPClient__Response">SocketHTTPClient_Response</a> response;</div>
<div class="line"><a class="code hl_function" href="SocketHTTPClient_8h.html#afef425814e66932f7cf1f36e9356b70e">SocketHTTPClient_get</a>(client, <span class="stringliteral">&quot;https://example.com&quot;</span>, &amp;response);</div>
<div class="line"><span class="comment">/* response.body contains data */</span></div>
<div class="line"><a class="code hl_function" href="SocketHTTPClient_8h.html#a826bca53483c23de2c8b03d456010149">SocketHTTPClient_Response_free</a>(&amp;response);</div>
<div class="line"><a class="code hl_function" href="SocketHTTPClient_8h.html#a01d6c9bebdcda63949ba9af698f8e7e5">SocketHTTPClient_free</a>(&amp;client);</div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a01d6c9bebdcda63949ba9af698f8e7e5"><div class="ttname"><a href="SocketHTTPClient_8h.html#a01d6c9bebdcda63949ba9af698f8e7e5">SocketHTTPClient_free</a></div><div class="ttdeci">void SocketHTTPClient_free(SocketHTTPClient_T *client)</div><div class="ttdoc">SocketHTTPClient_free - Free client and all resources @client: Pointer to client (set to NULL)</div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a2d57db3a9a6388315f253caa099e4205"><div class="ttname"><a href="SocketHTTPClient_8h.html#a2d57db3a9a6388315f253caa099e4205">SocketHTTPClient_new</a></div><div class="ttdeci">SocketHTTPClient_T SocketHTTPClient_new(const SocketHTTPClient_Config *config)</div><div class="ttdoc">SocketHTTPClient_new - Create HTTP client @config: Configuration (NULL for defaults)</div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a826bca53483c23de2c8b03d456010149"><div class="ttname"><a href="SocketHTTPClient_8h.html#a826bca53483c23de2c8b03d456010149">SocketHTTPClient_Response_free</a></div><div class="ttdeci">void SocketHTTPClient_Response_free(SocketHTTPClient_Response *response)</div><div class="ttdoc">SocketHTTPClient_Response_free - Free response resources @response: Response to free.</div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_aba14ae9994f5645e5aa8488f905aad54"><div class="ttname"><a href="SocketHTTPClient_8h.html#aba14ae9994f5645e5aa8488f905aad54">SocketHTTPClient_T</a></div><div class="ttdeci">struct SocketHTTPClient * SocketHTTPClient_T</div><div class="ttdoc">HTTP client instance.</div><div class="ttdef"><b>Definition</b> <a href="SocketHTTPClient_8h_source.html#l00249">SocketHTTPClient.h:249</a></div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_afef425814e66932f7cf1f36e9356b70e"><div class="ttname"><a href="SocketHTTPClient_8h.html#afef425814e66932f7cf1f36e9356b70e">SocketHTTPClient_get</a></div><div class="ttdeci">int SocketHTTPClient_get(SocketHTTPClient_T client, const char *url, SocketHTTPClient_Response *response)</div><div class="ttdoc">SocketHTTPClient_get - Perform GET request @client: Client instance @url: Full URL (http:// or https:...</div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_structSocketHTTPClient__Response"><div class="ttname"><a href="SocketHTTPClient_8h.html#structSocketHTTPClient__Response">SocketHTTPClient_Response</a></div><div class="ttdoc">HTTP response (owned by caller)</div><div class="ttdef"><b>Definition</b> <a href="SocketHTTPClient_8h_source.html#l00267">SocketHTTPClient.h:268</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md289"></a>
POST Request</h2>
<p><b>libcurl:</b> </p><div class="fragment"><div class="line">curl_easy_setopt(curl, CURLOPT_POST, 1L);</div>
<div class="line">curl_easy_setopt(curl, CURLOPT_POSTFIELDS, json);</div>
<div class="line">curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_function" href="SocketHTTPClient_8h.html#a9b47bc2dd38d4a6700af79ced0acecb2">SocketHTTPClient_post</a>(client, url, <span class="stringliteral">&quot;application/json&quot;</span>, json, strlen(json), &amp;response);</div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a9b47bc2dd38d4a6700af79ced0acecb2"><div class="ttname"><a href="SocketHTTPClient_8h.html#a9b47bc2dd38d4a6700af79ced0acecb2">SocketHTTPClient_post</a></div><div class="ttdeci">int SocketHTTPClient_post(SocketHTTPClient_T client, const char *url, const char *content_type, const void *body, size_t body_len, SocketHTTPClient_Response *response)</div><div class="ttdoc">SocketHTTPClient_post - Perform POST request @client: Client @url: Full URL @content_type: Content-Ty...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md290"></a>
Custom Headers</h2>
<p><b>libcurl:</b> </p><div class="fragment"><div class="line"><span class="keyword">struct </span>curl_slist *headers = NULL;</div>
<div class="line">headers = curl_slist_append(headers, <span class="stringliteral">&quot;Content-Type: application/json&quot;</span>);</div>
<div class="line">headers = curl_slist_append(headers, <span class="stringliteral">&quot;Authorization: Bearer token&quot;</span>);</div>
<div class="line">curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="SocketHTTPClient_8h.html#a265c0209bd77c39f219d72c3956a8818">SocketHTTPClient_Request_T</a> req = <a class="code hl_function" href="SocketHTTPClient_8h.html#a46c9c2ab8d3334dd0ad1359d2bb93102">SocketHTTPClient_Request_new</a>(client, <a class="code hl_enumvalue" href="SocketHTTP_8h.html#af6f90bb536a5cd085f4327bda4d3ee8fa90754abc55dbb76862fa50abee5af659">HTTP_METHOD_GET</a>, url);</div>
<div class="line"><a class="code hl_function" href="SocketHTTPClient_8h.html#a8a7c54a81dc916af60f9747162e844a2">SocketHTTPClient_Request_header</a>(req, <span class="stringliteral">&quot;Content-Type&quot;</span>, <span class="stringliteral">&quot;application/json&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="SocketHTTPClient_8h.html#a8a7c54a81dc916af60f9747162e844a2">SocketHTTPClient_Request_header</a>(req, <span class="stringliteral">&quot;Authorization&quot;</span>, <span class="stringliteral">&quot;Bearer token&quot;</span>);</div>
<div class="line"><a class="code hl_function" href="SocketHTTPClient_8h.html#a4ba09b6d59cc2aee465749978f62ad76">SocketHTTPClient_Request_execute</a>(req, &amp;response);</div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a265c0209bd77c39f219d72c3956a8818"><div class="ttname"><a href="SocketHTTPClient_8h.html#a265c0209bd77c39f219d72c3956a8818">SocketHTTPClient_Request_T</a></div><div class="ttdeci">struct SocketHTTPClient_Request * SocketHTTPClient_Request_T</div><div class="ttdoc">HTTP request builder.</div><div class="ttdef"><b>Definition</b> <a href="SocketHTTPClient_8h_source.html#l00252">SocketHTTPClient.h:252</a></div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a46c9c2ab8d3334dd0ad1359d2bb93102"><div class="ttname"><a href="SocketHTTPClient_8h.html#a46c9c2ab8d3334dd0ad1359d2bb93102">SocketHTTPClient_Request_new</a></div><div class="ttdeci">SocketHTTPClient_Request_T SocketHTTPClient_Request_new(SocketHTTPClient_T client, SocketHTTP_Method method, const char *url)</div><div class="ttdoc">SocketHTTPClient_Request_new - Create request builder @client: Client instance @method: HTTP method @...</div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a4ba09b6d59cc2aee465749978f62ad76"><div class="ttname"><a href="SocketHTTPClient_8h.html#a4ba09b6d59cc2aee465749978f62ad76">SocketHTTPClient_Request_execute</a></div><div class="ttdeci">int SocketHTTPClient_Request_execute(SocketHTTPClient_Request_T req, SocketHTTPClient_Response *response)</div><div class="ttdoc">SocketHTTPClient_Request_execute - Execute request @req: Request @response: Output response.</div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a8a7c54a81dc916af60f9747162e844a2"><div class="ttname"><a href="SocketHTTPClient_8h.html#a8a7c54a81dc916af60f9747162e844a2">SocketHTTPClient_Request_header</a></div><div class="ttdeci">int SocketHTTPClient_Request_header(SocketHTTPClient_Request_T req, const char *name, const char *value)</div><div class="ttdoc">Cookie SameSite attribute values.</div></div>
<div class="ttc" id="aSocketHTTP_8h_html_af6f90bb536a5cd085f4327bda4d3ee8fa90754abc55dbb76862fa50abee5af659"><div class="ttname"><a href="SocketHTTP_8h.html#af6f90bb536a5cd085f4327bda4d3ee8fa90754abc55dbb76862fa50abee5af659">HTTP_METHOD_GET</a></div><div class="ttdeci">@ HTTP_METHOD_GET</div><div class="ttdoc">RFC 9110 Section 9.3.1.</div><div class="ttdef"><b>Definition</b> <a href="SocketHTTP_8h_source.html#l00151">SocketHTTP.h:151</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md291"></a>
Proxy Configuration</h2>
<p><b>libcurl:</b> </p><div class="fragment"><div class="line">curl_easy_setopt(curl, CURLOPT_PROXY, <span class="stringliteral">&quot;socks5://localhost:1080&quot;</span>);</div>
<div class="line">curl_easy_setopt(curl, CURLOPT_PROXYUSERPWD, <span class="stringliteral">&quot;user:pass&quot;</span>);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_struct" href="SocketProxy_8h.html#structSocketProxy__Config">SocketProxy_Config</a> proxy;</div>
<div class="line"><a class="code hl_function" href="SocketProxy_8h.html#ae16c20e1d43f38171ccaad8408598490">SocketProxy_parse_url</a>(<span class="stringliteral">&quot;socks5://user:pass@localhost:1080&quot;</span>, &amp;proxy, NULL);</div>
<div class="line">config.proxy = &amp;proxy;</div>
<div class="line">client = <a class="code hl_function" href="SocketHTTPClient_8h.html#a2d57db3a9a6388315f253caa099e4205">SocketHTTPClient_new</a>(&amp;config);</div>
<div class="ttc" id="aSocketProxy_8h_html_ae16c20e1d43f38171ccaad8408598490"><div class="ttname"><a href="SocketProxy_8h.html#ae16c20e1d43f38171ccaad8408598490">SocketProxy_parse_url</a></div><div class="ttdeci">int SocketProxy_parse_url(const char *url, SocketProxy_Config *config, Arena_T arena)</div><div class="ttdoc">SocketProxy_parse_url - Parse proxy URL into config @url: Proxy URL (e.g., &quot;socks5://user:pass@proxy:...</div></div>
<div class="ttc" id="aSocketProxy_8h_html_structSocketProxy__Config"><div class="ttname"><a href="SocketProxy_8h.html#structSocketProxy__Config">SocketProxy_Config</a></div><div class="ttdoc">SocketProxy_Config - Proxy configuration.</div><div class="ttdef"><b>Definition</b> <a href="SocketProxy_8h_source.html#l00241">SocketProxy.h:242</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md292"></a>
Error Handling</h2>
<p><b>libcurl:</b> </p><div class="fragment"><div class="line">CURLcode res = curl_easy_perform(curl);</div>
<div class="line"><span class="keywordflow">if</span> (res != CURLE_OK) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Error: %s\n&quot;</span>, curl_easy_strerror(res));</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    <a class="code hl_function" href="SocketHTTPClient_8h.html#afef425814e66932f7cf1f36e9356b70e">SocketHTTPClient_get</a>(client, url, &amp;response);</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="SocketHTTPClient_8h.html#aa0847dd6efa2f627e07173f29b29c8ae">SocketHTTPClient_Timeout</a>) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;Timeout\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="SocketHTTPClient_8h.html#a50039c8c595271d7d51b28ed5a4e7196">SocketHTTPClient_DNSFailed</a>) {</div>
<div class="line">    fprintf(stderr, <span class="stringliteral">&quot;DNS error\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aSocketHTTPClient_8h_html_a50039c8c595271d7d51b28ed5a4e7196"><div class="ttname"><a href="SocketHTTPClient_8h.html#a50039c8c595271d7d51b28ed5a4e7196">SocketHTTPClient_DNSFailed</a></div><div class="ttdeci">const Except_T SocketHTTPClient_DNSFailed</div><div class="ttdoc">DNS resolution failure.</div></div>
<div class="ttc" id="aSocketHTTPClient_8h_html_aa0847dd6efa2f627e07173f29b29c8ae"><div class="ttname"><a href="SocketHTTPClient_8h.html#aa0847dd6efa2f627e07173f29b29c8ae">SocketHTTPClient_Timeout</a></div><div class="ttdeci">const Except_T SocketHTTPClient_Timeout</div><div class="ttdoc">Request timeout.</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md293"></a>
API Mapping (libcurl -&gt; Socket Library)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">libcurl   </th><th class="markdownTableHeadNone">Socket Library    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>curl_easy_init()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketHTTPClient_8h.html#a2d57db3a9a6388315f253caa099e4205" title="SocketHTTPClient_new - Create HTTP client @config: Configuration (NULL for defaults)">SocketHTTPClient_new()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>curl_easy_cleanup()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketHTTPClient_8h.html#a01d6c9bebdcda63949ba9af698f8e7e5" title="SocketHTTPClient_free - Free client and all resources @client: Pointer to client (set to NULL)">SocketHTTPClient_free()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>curl_easy_perform()</code>   </td><td class="markdownTableBodyNone"><code>SocketHTTPClient_get/post/etc()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>CURLOPT_URL</code>   </td><td class="markdownTableBodyNone">Function parameter    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>CURLOPT_TIMEOUT</code>   </td><td class="markdownTableBodyNone"><code>config.request_timeout_ms</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>CURLOPT_CONNECTTIMEOUT</code>   </td><td class="markdownTableBodyNone"><code>config.connect_timeout_ms</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>CURLOPT_FOLLOWLOCATION</code>   </td><td class="markdownTableBodyNone"><code>config.follow_redirects</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>CURLOPT_MAXREDIRS</code>   </td><td class="markdownTableBodyNone"><code>config.follow_redirects</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>CURLOPT_PROXY</code>   </td><td class="markdownTableBodyNone"><code>config.proxy</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>CURLOPT_SSL_VERIFYPEER</code>   </td><td class="markdownTableBodyNone"><code>config.verify_ssl</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>CURLOPT_HTTPHEADER</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketHTTPClient_8h.html#a8a7c54a81dc916af60f9747162e844a2" title="Cookie SameSite attribute values.">SocketHTTPClient_Request_header()</a></code>   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md295"></a>
Migration from libevent</h1>
<h2><a class="anchor" id="autotoc_md296"></a>
Event Loop</h2>
<p><b>libevent:</b> </p><div class="fragment"><div class="line"><span class="keyword">struct </span>event_base *base = event_base_new();</div>
<div class="line"><span class="keyword">struct </span>event *ev = event_new(base, fd, EV_READ | EV_PERSIST, callback, arg);</div>
<div class="line">event_add(ev, NULL);</div>
<div class="line">event_base_dispatch(base);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="SocketTimer_8h.html#af9e4be8bc025aedb61cc0b77e8926312">SocketPoll_T</a> poll = <a class="code hl_function" href="SocketPoll_8h.html#ac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a>(1000);</div>
<div class="line"><a class="code hl_function" href="SocketPoll_8h.html#a6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, socket, <a class="code hl_enumvalue" href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, userdata);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (<a class="code hl_variable" href="http__server_8c.html#af1f449cc09f8d36befcce07bc38c29c0">running</a>) {</div>
<div class="line">    <a class="code hl_struct" href="SocketPoll_8h.html#structSocketEvent__T">SocketEvent_T</a> events[100];</div>
<div class="line">    <span class="keywordtype">int</span> n = <a class="code hl_function" href="SocketPoll_8h.html#aa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, events, 100, 1000);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line">        handle_event(events[i].socket, events[i].events, events[i].data);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aSocketPoll_8h_html_a6c9f3f1a23dd85dd2d44ff9b0ced4e1e"><div class="ttname"><a href="SocketPoll_8h.html#a6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a></div><div class="ttdeci">void SocketPoll_add(SocketPoll_T poll, Socket_T socket, unsigned events, void *data)</div><div class="ttdoc">SocketPoll_add - Add socket to poll set @poll: Poll instance @socket: Socket to monitor @events: Even...</div></div>
<div class="ttc" id="aSocketPoll_8h_html_a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8"><div class="ttname"><a href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a></div><div class="ttdeci">@ POLL_READ</div><div class="ttdoc">Data available for reading.</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00045">SocketPoll.h:45</a></div></div>
<div class="ttc" id="aSocketPoll_8h_html_aa3d47365dd18329d50ee636284839738"><div class="ttname"><a href="SocketPoll_8h.html#aa3d47365dd18329d50ee636284839738">SocketPoll_wait</a></div><div class="ttdeci">int SocketPoll_wait(SocketPoll_T poll, SocketEvent_T **events, int timeout)</div><div class="ttdoc">SocketPoll_wait - Wait for events @poll: Poll instance @events: Output - array of events that occurre...</div></div>
<div class="ttc" id="aSocketPoll_8h_html_ac1fbd1a09d564f7988b0e427e5707ca7"><div class="ttname"><a href="SocketPoll_8h.html#ac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a></div><div class="ttdeci">SocketPoll_T SocketPoll_new(int maxevents)</div><div class="ttdoc">SocketPoll_new - Create a new event poll @maxevents: Maximum events to return per wait call Returns: ...</div></div>
<div class="ttc" id="aSocketPoll_8h_html_structSocketEvent__T"><div class="ttname"><a href="SocketPoll_8h.html#structSocketEvent__T">SocketEvent_T</a></div><div class="ttdoc">Event structure returned by SocketPoll_wait.</div><div class="ttdef"><b>Definition</b> <a href="SocketPoll_8h_source.html#l00054">SocketPoll.h:55</a></div></div>
<div class="ttc" id="aSocketTimer_8h_html_af9e4be8bc025aedb61cc0b77e8926312"><div class="ttname"><a href="SocketTimer_8h.html#af9e4be8bc025aedb61cc0b77e8926312">SocketPoll_T</a></div><div class="ttdeci">struct SocketPoll_T * SocketPoll_T</div><div class="ttdef"><b>Definition</b> <a href="SocketTimer_8h_source.html#l00041">SocketTimer.h:41</a></div></div>
<div class="ttc" id="ahttp__server_8c_html_af1f449cc09f8d36befcce07bc38c29c0"><div class="ttname"><a href="http__server_8c.html#af1f449cc09f8d36befcce07bc38c29c0">running</a></div><div class="ttdeci">static volatile int running</div><div class="ttdoc">http_server.c - Basic HTTP Server Example</div><div class="ttdef"><b>Definition</b> <a href="http__server_8c_source.html#l00032">http_server.c:32</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md297"></a>
Callback Style</h2>
<p><b>libevent:</b> </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> read_cb(evutil_socket_t fd, <span class="keywordtype">short</span> events, <span class="keywordtype">void</span> *arg) {</div>
<div class="line">    <span class="keywordtype">char</span> buf[1024];</div>
<div class="line">    ssize_t n = recv(fd, buf, <span class="keyword">sizeof</span>(buf), 0);</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><span class="comment">/* Event loop style - no callbacks needed */</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div>
<div class="line">    <span class="keywordflow">if</span> (events[i].events &amp; <a class="code hl_enumvalue" href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>) {</div>
<div class="line">        <span class="keywordtype">char</span> buf[1024];</div>
<div class="line">        ssize_t n = <a class="code hl_function" href="Socket_8h.html#a95db343f47445925cecd6b20054518e9">Socket_recv</a>(events[i].socket, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aSocket_8h_html_a95db343f47445925cecd6b20054518e9"><div class="ttname"><a href="Socket_8h.html#a95db343f47445925cecd6b20054518e9">Socket_recv</a></div><div class="ttdeci">ssize_t Socket_recv(Socket_T socket, void *buf, size_t len)</div><div class="ttdoc">Socket_recv - Receive data @socket: Connected socket @buf: Buffer for received data @len: Buffer size...</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md298"></a>
Timers</h2>
<p><b>libevent:</b> </p><div class="fragment"><div class="line"><span class="keyword">struct </span>event *timer = evtimer_new(base, timer_cb, arg);</div>
<div class="line"><span class="keyword">struct </span>timeval tv = {5, 0};</div>
<div class="line">evtimer_add(timer, &amp;tv);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="SocketTimer_8h.html#a89e39166f8e24595119733321f2a313e">SocketTimer_T</a> timer = SocketTimer_new(arena);</div>
<div class="line">SocketTimer_schedule(timer, 5000, timer_callback, userdata);</div>
<div class="line"><span class="comment">/* Process in poll loop */</span></div>
<div class="ttc" id="aSocketTimer_8h_html_a89e39166f8e24595119733321f2a313e"><div class="ttname"><a href="SocketTimer_8h.html#a89e39166f8e24595119733321f2a313e">SocketTimer_T</a></div><div class="ttdeci">struct SocketTimer_T * SocketTimer_T</div><div class="ttdef"><b>Definition</b> <a href="SocketTimer_8h_source.html#l00037">SocketTimer.h:37</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md299"></a>
API Mapping (libevent -&gt; Socket Library)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">libevent   </th><th class="markdownTableHeadNone">Socket Library    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>event_base_new()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketPoll_8h.html#ac1fbd1a09d564f7988b0e427e5707ca7" title="SocketPoll_new - Create a new event poll @maxevents: Maximum events to return per wait call Returns: ...">SocketPoll_new()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>event_base_free()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketPoll_8h.html#aca744c50badbdb869c52088b9f32f8d2" title="SocketPoll_free - Free an event poll @poll: Pointer to poll (will be set to NULL) Closes the underlyi...">SocketPoll_free()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>event_new()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketPoll_8h.html#a6c9f3f1a23dd85dd2d44ff9b0ced4e1e" title="SocketPoll_add - Add socket to poll set @poll: Poll instance @socket: Socket to monitor @events: Even...">SocketPoll_add()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>event_add()</code>   </td><td class="markdownTableBodyNone">Automatic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>event_del()</code>   </td><td class="markdownTableBodyNone"><code>SocketPoll_remove()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>event_base_dispatch()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketPoll_8h.html#aa3d47365dd18329d50ee636284839738" title="SocketPoll_wait - Wait for events @poll: Poll instance @events: Output - array of events that occurre...">SocketPoll_wait()</a></code> loop    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>EV_READ</code>   </td><td class="markdownTableBodyNone"><code>POLL_READ</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>EV_WRITE</code>   </td><td class="markdownTableBodyNone"><code>POLL_WRITE</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>evtimer_new()</code>   </td><td class="markdownTableBodyNone"><code>SocketTimer_schedule()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>bufferevent_*</code>   </td><td class="markdownTableBodyNone"><code>SocketBuf_T</code>   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md301"></a>
Migration from libev</h1>
<h2><a class="anchor" id="autotoc_md302"></a>
Event Loop</h2>
<p><b>libev:</b> </p><div class="fragment"><div class="line"><span class="keyword">struct </span>ev_loop *loop = ev_default_loop(0);</div>
<div class="line">ev_io watcher;</div>
<div class="line">ev_io_init(&amp;watcher, callback, fd, EV_READ);</div>
<div class="line">ev_io_start(loop, &amp;watcher);</div>
<div class="line">ev_run(loop, 0);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="SocketTimer_8h.html#af9e4be8bc025aedb61cc0b77e8926312">SocketPoll_T</a> poll = <a class="code hl_function" href="SocketPoll_8h.html#ac1fbd1a09d564f7988b0e427e5707ca7">SocketPoll_new</a>(1000);</div>
<div class="line"><a class="code hl_function" href="SocketPoll_8h.html#a6c9f3f1a23dd85dd2d44ff9b0ced4e1e">SocketPoll_add</a>(poll, socket, <a class="code hl_enumvalue" href="SocketPoll_8h.html#a9e8943c9cb47aba63dda4ad9083142b6a19f5d65c083268df50040f34f306d1b8">POLL_READ</a>, userdata);</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">while</span> (<a class="code hl_variable" href="http__server_8c.html#af1f449cc09f8d36befcce07bc38c29c0">running</a>) {</div>
<div class="line">    <a class="code hl_struct" href="SocketPoll_8h.html#structSocketEvent__T">SocketEvent_T</a> events[100];</div>
<div class="line">    <span class="keywordtype">int</span> n = <a class="code hl_function" href="SocketPoll_8h.html#aa3d47365dd18329d50ee636284839738">SocketPoll_wait</a>(poll, events, 100, 1000);</div>
<div class="line">    <span class="comment">/* Process events */</span></div>
<div class="line">}</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md304"></a>
Migration from OpenSSL Direct</h1>
<h2><a class="anchor" id="autotoc_md305"></a>
TLS Client</h2>
<p><b>OpenSSL:</b> </p><div class="fragment"><div class="line">SSL_CTX *ctx = SSL_CTX_new(TLS_client_method());</div>
<div class="line">SSL_CTX_set_min_proto_version(ctx, TLS1_3_VERSION);</div>
<div class="line">SSL *ssl = SSL_new(ctx);</div>
<div class="line">SSL_set_fd(ssl, fd);</div>
<div class="line">SSL_set_tlsext_host_name(ssl, hostname);</div>
<div class="line">SSL_connect(ssl);</div>
<div class="line">SSL_write(ssl, data, len);</div>
<div class="line">SSL_read(ssl, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line">SSL_shutdown(ssl);</div>
<div class="line">SSL_free(ssl);</div>
<div class="line">SSL_CTX_free(ctx);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a> ctx = <a class="code hl_function" href="SocketTLSContext_8h.html#a7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a>(NULL);</div>
<div class="line"><a class="code hl_function" href="SocketTLS_8h.html#ab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a>(sock, ctx);</div>
<div class="line"><a class="code hl_function" href="SocketTLS_8h.html#a15d2c8f4eaea80114bbd2123da025e56">SocketTLS_set_hostname</a>(sock, hostname);</div>
<div class="line"><span class="keywordflow">while</span> (<a class="code hl_function" href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a>(sock) &gt; 0) { }</div>
<div class="line"><a class="code hl_function" href="SocketTLS_8h.html#abdb38e692dde58bbec4ab905eeb8b3aa">SocketTLS_send</a>(sock, data, len);</div>
<div class="line"><a class="code hl_function" href="SocketTLS_8h.html#a1c71fc02141cd9e6da4fdf1c88dbbaf3">SocketTLS_recv</a>(sock, buf, <span class="keyword">sizeof</span>(buf));</div>
<div class="line"><a class="code hl_function" href="SocketTLS_8h.html#ab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a>(sock);</div>
<div class="line"><a class="code hl_function" href="Socket_8h.html#a74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a>(&amp;sock);</div>
<div class="line"><a class="code hl_function" href="SocketTLSContext_8h.html#aea7ca3e656e9b58706fafc3232147203">SocketTLSContext_free</a>(&amp;ctx);</div>
<div class="ttc" id="aSocketTLSContext_8h_html_a7fe51da14439d768bdf72f4ed8fbb022"><div class="ttname"><a href="SocketTLSContext_8h.html#a7fe51da14439d768bdf72f4ed8fbb022">SocketTLSContext_new_client</a></div><div class="ttdeci">SocketTLSContext_T SocketTLSContext_new_client(const char *ca_file)</div><div class="ttdoc">SocketTLSContext_new_client - Create client TLS context @ca_file: Optional path to CA file/directory ...</div></div>
<div class="ttc" id="aSocketTLSContext_8h_html_aea7ca3e656e9b58706fafc3232147203"><div class="ttname"><a href="SocketTLSContext_8h.html#aea7ca3e656e9b58706fafc3232147203">SocketTLSContext_free</a></div><div class="ttdeci">void SocketTLSContext_free(SocketTLSContext_T *ctx_p)</div><div class="ttdoc">SocketTLSContext_set_verify_callback - Register custom verification callback @ctx: The TLS context in...</div></div>
<div class="ttc" id="aSocketTLS_8h_html_a15d2c8f4eaea80114bbd2123da025e56"><div class="ttname"><a href="SocketTLS_8h.html#a15d2c8f4eaea80114bbd2123da025e56">SocketTLS_set_hostname</a></div><div class="ttdeci">void SocketTLS_set_hostname(Socket_T socket, const char *hostname)</div><div class="ttdoc">SocketTLS_set_hostname - Set SNI hostname for client TLS connections @socket: The socket instance @ho...</div></div>
<div class="ttc" id="aSocketTLS_8h_html_a1c71fc02141cd9e6da4fdf1c88dbbaf3"><div class="ttname"><a href="SocketTLS_8h.html#a1c71fc02141cd9e6da4fdf1c88dbbaf3">SocketTLS_recv</a></div><div class="ttdeci">ssize_t SocketTLS_recv(Socket_T socket, void *buf, size_t len)</div><div class="ttdoc">SocketTLS_recv - Receive data from TLS-encrypted connection @socket: The socket instance with complet...</div></div>
<div class="ttc" id="aSocketTLS_8h_html_ab11506db6f41f31e9fc170b3d0e848f1"><div class="ttname"><a href="SocketTLS_8h.html#ab11506db6f41f31e9fc170b3d0e848f1">SocketTLS_shutdown</a></div><div class="ttdeci">void SocketTLS_shutdown(Socket_T socket)</div><div class="ttdoc">SocketTLS_shutdown - Perform graceful TLS connection shutdown @socket: The socket instance with TLS e...</div></div>
<div class="ttc" id="aSocketTLS_8h_html_ab9a8fb788aa1f0d21b5773bc43a48d6f"><div class="ttname"><a href="SocketTLS_8h.html#ab9a8fb788aa1f0d21b5773bc43a48d6f">SocketTLS_enable</a></div><div class="ttdeci">void SocketTLS_enable(Socket_T socket, SocketTLSContext_T ctx)</div><div class="ttdoc">SocketTLS_enable - Enable TLS on a socket using the provided context @socket: The socket instance to ...</div></div>
<div class="ttc" id="aSocketTLS_8h_html_abdb38e692dde58bbec4ab905eeb8b3aa"><div class="ttname"><a href="SocketTLS_8h.html#abdb38e692dde58bbec4ab905eeb8b3aa">SocketTLS_send</a></div><div class="ttdeci">ssize_t SocketTLS_send(Socket_T socket, const void *buf, size_t len)</div><div class="ttdoc">SocketTLS_send - Send data over TLS-encrypted connection @socket: The socket instance with completed ...</div></div>
<div class="ttc" id="aSocketTLS_8h_html_ac46f2ab9dacbb1af2d590f2974e21577"><div class="ttname"><a href="SocketTLS_8h.html#ac46f2ab9dacbb1af2d590f2974e21577">SocketTLSContext_T</a></div><div class="ttdeci">struct SocketTLSContext_T * SocketTLSContext_T</div><div class="ttdef"><b>Definition</b> <a href="SocketTLS_8h_source.html#l00058">SocketTLS.h:58</a></div></div>
<div class="ttc" id="aSocketTLS_8h_html_aeaa77dd7852b535baf17b53ee2518454"><div class="ttname"><a href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454">SocketTLS_handshake</a></div><div class="ttdeci">TLSHandshakeState SocketTLS_handshake(Socket_T socket)</div><div class="ttdoc">SocketTLS_handshake - Perform non-blocking TLS handshake @socket: The socket instance with TLS enable...</div></div>
<div class="ttc" id="aSocket_8h_html_a74ad7a9bb8deaf499c59d90d6e411f37"><div class="ttname"><a href="Socket_8h.html#a74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a></div><div class="ttdeci">void Socket_free(Socket_T *socket)</div><div class="ttdoc">Socket_free - Free a socket and close the connection @socket: Pointer to socket (will be set to NULL)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md306"></a>
API Mapping (OpenSSL -&gt; Socket Library)</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">OpenSSL   </th><th class="markdownTableHeadNone">Socket Library    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SSL_CTX_new()</code>   </td><td class="markdownTableBodyNone"><code>SocketTLSContext_new_client/server()</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SSL_CTX_free()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLSContext_8h.html#aea7ca3e656e9b58706fafc3232147203" title="SocketTLSContext_set_verify_callback - Register custom verification callback @ctx: The TLS context in...">SocketTLSContext_free()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SSL_new()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#ab9a8fb788aa1f0d21b5773bc43a48d6f" title="SocketTLS_enable - Enable TLS on a socket using the provided context @socket: The socket instance to ...">SocketTLS_enable()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SSL_set_fd()</code>   </td><td class="markdownTableBodyNone">Automatic    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SSL_set_tlsext_host_name()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#a15d2c8f4eaea80114bbd2123da025e56" title="SocketTLS_set_hostname - Set SNI hostname for client TLS connections @socket: The socket instance @ho...">SocketTLS_set_hostname()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SSL_connect()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454" title="SocketTLS_handshake - Perform non-blocking TLS handshake @socket: The socket instance with TLS enable...">SocketTLS_handshake()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SSL_accept()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#aeaa77dd7852b535baf17b53ee2518454" title="SocketTLS_handshake - Perform non-blocking TLS handshake @socket: The socket instance with TLS enable...">SocketTLS_handshake()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SSL_write()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#abdb38e692dde58bbec4ab905eeb8b3aa" title="SocketTLS_send - Send data over TLS-encrypted connection @socket: The socket instance with completed ...">SocketTLS_send()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SSL_read()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#a1c71fc02141cd9e6da4fdf1c88dbbaf3" title="SocketTLS_recv - Receive data from TLS-encrypted connection @socket: The socket instance with complet...">SocketTLS_recv()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SSL_shutdown()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#ab11506db6f41f31e9fc170b3d0e848f1" title="SocketTLS_shutdown - Perform graceful TLS connection shutdown @socket: The socket instance with TLS e...">SocketTLS_shutdown()</a></code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>SSL_get_version()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#aef0f67021658d05419f1da479be2957e" title="SocketTLS_get_version - Get negotiated TLS protocol version @socket: The socket instance with complet...">SocketTLS_get_version()</a></code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>SSL_get_cipher()</code>   </td><td class="markdownTableBodyNone"><code><a class="el" href="SocketTLS_8h.html#a0859f0a6e05840bdc037c3765e22b7b1" title="SocketTLS_get_cipher - Get negotiated cipher suite name @socket: The socket instance with completed h...">SocketTLS_get_cipher()</a></code>   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md308"></a>
Common Patterns</h1>
<h2><a class="anchor" id="autotoc_md309"></a>
Error Handling Pattern</h2>
<p><b>Other Libraries (error codes):</b> </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> result = some_function();</div>
<div class="line"><span class="keywordflow">if</span> (result &lt; 0) {</div>
<div class="line">    <span class="keywordflow">switch</span> (errno) {</div>
<div class="line">        <span class="keywordflow">case</span> ETIMEDOUT: <span class="comment">/* timeout */</span> <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> ECONNREFUSED: <span class="comment">/* refused */</span> <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>: <span class="comment">/* error */</span> <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Socket Library (exceptions):</b> </p><div class="fragment"><div class="line"><a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    some_function();</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(Socket_Timeout) {</div>
<div class="line">    <span class="comment">/* timeout */</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ab5e72fc2bd41014c75e0ace4feabfe8e">EXCEPT</a>(<a class="code hl_variable" href="Socket_8h.html#a225f4a8fd657fd52a05146c6fc4f58b0">Socket_Failed</a>) {</div>
<div class="line">    <span class="comment">/* error - Socket_error() for details */</span></div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md310"></a>
Resource Cleanup Pattern</h2>
<p><b>Other Libraries:</b> </p><div class="fragment"><div class="line">Socket *sock = create_socket();</div>
<div class="line"><span class="keywordflow">if</span> (!sock) <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">if</span> (connect(sock) &lt; 0) <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"><span class="keywordflow">if</span> (send(sock) &lt; 0) <span class="keywordflow">goto</span> cleanup;</div>
<div class="line"> </div>
<div class="line">cleanup:</div>
<div class="line">    <span class="keywordflow">if</span> (sock) free_socket(sock);</div>
</div><!-- fragment --><p><b>Socket Library:</b> </p><div class="fragment"><div class="line"><a class="code hl_typedef" href="Socket_8h.html#a1bcdb0c6d5827c2493bd622fa7751f14">Socket_T</a> sock = NULL;</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ad2746371528bdf15c3910b7bf217dac0">TRY</a> {</div>
<div class="line">    sock = <a class="code hl_function" href="Socket_8h.html#a6212fb2b6eefa567592a59f55c25a6f1">Socket_new</a>(AF_INET, SOCK_STREAM, 0);</div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#ac14390090ee26136c1f7a816fc08406e">Socket_connect</a>(sock, host, port);</div>
<div class="line">    <a class="code hl_function" href="Socket_8h.html#a6ea9ad33d78c50d327c9677b52849bcb">Socket_sendall</a>(sock, data, len);</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#a0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a> {</div>
<div class="line">    <span class="keywordflow">if</span> (sock) <a class="code hl_function" href="Socket_8h.html#a74ad7a9bb8deaf499c59d90d6e411f37">Socket_free</a>(&amp;sock);</div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="Except_8h.html#ae6628ac788ad213363b89dba9868420b">END_TRY</a>;</div>
<div class="ttc" id="aExcept_8h_html_a0e2a75478cd44f1666a6aca626c5c50b"><div class="ttname"><a href="Except_8h.html#a0e2a75478cd44f1666a6aca626c5c50b">FINALLY</a></div><div class="ttdeci">#define FINALLY</div><div class="ttdef"><b>Definition</b> <a href="Except_8h_source.html#l00132">Except.h:132</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md312"></a>
Key Differences</h1>
<h2><a class="anchor" id="autotoc_md313"></a>
Memory Management</h2>
<ul>
<li><b>Arena allocation</b> - Related objects allocated together</li>
<li><b>Automatic cleanup</b> - <a class="el" href="Arena_8h.html#a6842e66018614df08139e67826cf3e0d" title="Arena_dispose - Dispose of an arena and all its allocations @ap: Pointer to arena pointer (will be se...">Arena_dispose()</a> frees everything</li>
<li><b>No manual free</b> for individual objects in arena</li>
</ul>
<h2><a class="anchor" id="autotoc_md314"></a>
Error Handling</h2>
<ul>
<li><b>Exceptions</b> instead of error codes</li>
<li><b>Thread-local</b> error messages</li>
<li><b>Detailed context</b> in exceptions</li>
</ul>
<h2><a class="anchor" id="autotoc_md315"></a>
Thread Safety</h2>
<ul>
<li><b>Instance-based</b> - One instance per thread</li>
<li><b>Thread-local</b> storage for errors</li>
<li><b>No global state</b></li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md317"></a>
Getting Started</h1>
<ol type="1">
<li><b>Replace socket creation</b> with <code><a class="el" href="Socket_8h.html#a6212fb2b6eefa567592a59f55c25a6f1">Socket_new()</a></code></li>
<li><b>Wrap operations</b> in TRY/EXCEPT blocks</li>
<li><b>Use convenience functions</b> (sendall, setreuseaddr, etc.)</li>
<li><b>Replace poll/select</b> with <code>SocketPoll_T</code></li>
<li><b>Use SocketHTTPClient</b> for HTTP instead of raw sockets</li>
<li><b>Enable TLS</b> with <code><a class="el" href="SocketTLS_8h.html#ab9a8fb788aa1f0d21b5773bc43a48d6f" title="SocketTLS_enable - Enable TLS on a socket using the provided context @socket: The socket instance to ...">SocketTLS_enable()</a></code> for HTTPS</li>
</ol>
<hr  />
<h1><a class="anchor" id="autotoc_md319"></a>
See Also</h1>
<ul>
<li><a class="el" href="http_guide.html">HTTP Guide</a></li>
<li><a class="el" href="websocket_guide.html">WebSocket Guide</a></li>
<li><a class="el" href="security_guide.html">Security Guide</a></li>
<li><a class="el" href="Socket_8h.html">Socket.h</a></li>
<li><a class="el" href="SocketPoll_8h.html">SocketPoll.h</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<hr class="footer"/>
<footer class="footer">
  <div style="max-width: 960px; margin: 0 auto; padding: 40px 24px;">
    <div style="display: flex; justify-content: space-between; align-items: flex-start; flex-wrap: wrap; gap: 40px;">
      <!-- Brand -->
      <div style="flex: 1; min-width: 200px;">
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
          <div style="width: 24px; height: 24px; background: linear-gradient(135deg, #3b82f6, #8b5cf6); border-radius: 6px;"></div>
          <span style="font-size: 1rem; font-weight: 600; color: #f7f9fa;">Socket Library</span>
        </div>
        <p style="color: #8b98a5; font-size: 0.8125rem; line-height: 1.6; margin: 0;">
          High-performance socket toolkit for POSIX systems with exception-based error handling and TLS 1.3 support.
        </p>
      </div>
      <!-- Links -->
      <div style="display: flex; gap: 48px; flex-wrap: wrap;">
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Documentation</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="index.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Getting Started</a></li>
            <li style="margin: 6px 0;"><a href="annotated.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Data Structures</a></li>
            <li style="margin: 6px 0;"><a href="globals.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">API Reference</a></li>
          </ul>
        </div>
        <div>
          <h4 style="font-size: 0.75rem; font-weight: 600; color: #f7f9fa; text-transform: uppercase; letter-spacing: 0.05em; margin: 0 0 12px 0;">Resources</h4>
          <ul style="list-style: none; padding: 0; margin: 0;">
            <li style="margin: 6px 0;"><a href="files.html" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Header Files</a></li>
            <li style="margin: 6px 0;"><a href="https://x.com/tetsuocorp" target="_blank" style="color: #8b98a5; text-decoration: none; font-size: 0.8125rem;">Twitter/X</a></li>
          </ul>
        </div>
      </div>
    </div>
    <!-- Bottom -->
    <div style="margin-top: 32px; padding-top: 24px; border-top: 1px solid #30363d; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 16px;">
      <div style="display: flex; align-items: center; gap: 12px;">
        <span style="font-size: 0.75rem; font-weight: 500; color: #10b981; background: rgba(16, 185, 129, 0.1); padding: 4px 8px; border-radius: 4px;">C11</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #3b82f6; background: rgba(59, 130, 246, 0.1); padding: 4px 8px; border-radius: 4px;">POSIX</span>
        <span style="font-size: 0.75rem; font-weight: 500; color: #8b5cf6; background: rgba(139, 92, 246, 0.1); padding: 4px 8px; border-radius: 4px;">TLS 1.3</span>
      </div>
      <div style="color: #6e7681; font-size: 0.75rem; display: flex; align-items: center; gap: 8px;">
        <span> 2025 Tetsuo Corporation</span>
        <span style="color: #30363d;"></span>
        <a href="https://opensource.org/licenses/MIT" target="_blank" style="color: #8b98a5; text-decoration: none;">MIT License</a>
      </div>
    </div>
  </div>
</footer>
</body>
</html>
